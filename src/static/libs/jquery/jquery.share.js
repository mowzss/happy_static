!function(c){c.fn.share=function(e){var t=c(document.head),t={url:location.href,site_url:location.origin,source:c("h1").text()||t.find("[name=site], [name=Site]").attr("content")||document.title,title:c("h1").text()||t.find("[name=title], [name=Title]").attr("content")||document.title,description:c(".content-body").find("p").eq(1).text()||t.find("[name=description], [name=Description]").attr("content")||"",image:c(".content-body").find("img").prop("src")||c(".nav-logo").find("img").prop("src")||"",imageSelector:void 0,weiboKey:"",wechatQrcodeTitle:"微信扫一扫：分享",wechatQrcodeHelper:"<p>微信里点“发现”，扫一下</p><p>二维码便可将本文分享至朋友圈。</p>",wechatQrcodeSize:100,mobileSites:[],sites:["wechat","qzone","weibo","qq","poster","copy","fav","agree"],disabled:[],initialized:!1,agreeUrl:"",favUrl:"",agreeNum:0,infoId:c("[data-id]").data("id"),posterUrl:""},i=c.extend({},t,e),o={qzone:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url={{URL}}&title={{TITLE}}&desc={{DESCRIPTION}}&summary={{SUMMARY}}&site={{SOURCE}}",qq:"http://connect.qq.com/widget/shareqq/index.html?url={{URL}}&title={{TITLE}}&source={{SOURCE}}&desc={{DESCRIPTION}}&pics={{IMAGE}}",weibo:"https://service.weibo.com/share/share.php?url={{URL}}&title={{TITLE}}&pic={{IMAGE}}&appkey={{WEIBOKEY}}",wechat:"javascript:;",douban:"http://shuo.douban.com/!service/share?href={{URL}}&name={{TITLE}}&text={{DESCRIPTION}}&image={{IMAGE}}&starid=0&aid=0&style=11",copy:"javascript:;",fav:"javascript:;",agree:"javascript:;",poster:"javascript:;"},s={qzone:"空间",qq:"QQ",weibo:"微博",wechat:"微信",douban:"豆瓣",copy:"复制",fav:"收藏",agree:"点赞",poster:"海报"};this.each(function(){if(c(this).data("initialized"))return!0;var r,n,e=c.extend({},i,c(this).data()),t=(e.imageSelector&&(e.image=c(e.imageSelector).map(function(){return c(this).prop("src")}).get().join("||")),c(this).addClass("share-component share-icon")),a=(r=t,a=function(e){0===e.mobileSites.length&&e.sites.length&&(e.mobileSites=e.sites);var a=(c(window).width()<=768?e.mobileSites:e.sites.length?e.sites:[]).slice(0),e=e.disabled;"string"==typeof a&&(a=a.split(/\s*,\s*/));"string"==typeof e&&(e=e.split(/\s*,\s*/));/MicroMessenger/i.test(navigator.userAgent)&&e.push("wechat");return e.length&&c.each(e,function(e,t){t=c.inArray(t,a);-1!==t&&a.splice(t,1)}),a}(n=e),"prepend"==n.mode&&a.reverse(),a.length&&c.each(a,function(e,t){var a=function(e,t){var a,i=o[e];for(a in t.summary=t.description,t){var r;t.hasOwnProperty(a)&&(r=e+a.replace(/^[a-z]/,function(e){return e.toUpperCase()}),r=encodeURIComponent(void 0===t[r]?t[a]:t[r]),i=i.replace(new RegExp("{{"+a.toUpperCase()+"}}","g"),r))}return i}(t,n),i=n.initialized?r.find(".share-"+t):c('<a class="share-icon-box share-'+t+'"></a>');if(!i.length)return!0;i.prop("aria-label","分享到 "+s[t]),i.prop("href","javascript:;"),i.text(s[t]),"wechat"===t?i.prop("tabindex",-1):"copy"===t?i.attr("data-copy",n.url):"agree"===t?(i.attr("data-agrees",n.agreeUrl),i.attr("data-value","id#"+n.infoId),i.append('(<span id="agreeNum">'+n.agreeNum+"</span>)")):"fav"===t?(i.attr("data-fav",n.favUrl),i.attr("data-value","id#"+n.infoId)):"poster"===t?i.attr("data-poster",n.posterUrl):i.attr("data-open-window",a),n.initialized||("prepend"==n.mode?r.prepend(i):r.append(i))}),t),t=e;(a=a.find("a.share-wechat")).length&&(a.append('<div class="wechat-qrcode"><h4>'+t.wechatQrcodeTitle+'</h4><div class="qrcode"></div><div class="help">'+t.wechatQrcodeHelper+"</div></div>"),a.find(".qrcode").qrcode({render:"image",size:t.wechatQrcodeSize,text:t.url}),a.offset().top<100)&&a.find(".wechat-qrcode").addClass("bottom"),c(this).data("initialized",!0)})},c(function(){c("[data-share]").share()})}(jQuery);