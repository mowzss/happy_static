import{calculateSecondsSinceMidnight,compareDates,compareTimes,createDateFormatter,parseSeconds}from"../utils/dates";function minMaxTimePlugin(a){void 0===a&&(a={});var o={formatDate:createDateFormatter({}),tableDateFormat:a.tableDateFormat||"Y-m-d",defaults:{minTime:void 0,maxTime:void 0}};return function(n){return{onReady:function(){o.formatDate=this.formatDate,o.defaults={minTime:this.config.minTime&&o.formatDate(this.config.minTime,"H:i"),maxTime:this.config.maxTime&&o.formatDate(this.config.maxTime,"H:i")},n.loadedPlugins.push("minMaxTime")},onChange:function(){var e,i,t=this.latestSelectedDateObj,m=t&&(m=t,void 0!==a.table?a.table[o.formatDate(m,o.tableDateFormat)]:a.getTimeLimits&&a.getTimeLimits(m));t&&void 0!==m?(this.set(m),n.config.minTime.setFullYear(t.getFullYear()),n.config.maxTime.setFullYear(t.getFullYear()),n.config.minTime.setMonth(t.getMonth()),n.config.maxTime.setMonth(t.getMonth()),n.config.minTime.setDate(t.getDate()),n.config.maxTime.setDate(t.getDate()),n.config.minTime>n.config.maxTime?(i=calculateSecondsSinceMidnight(n.config.minTime.getHours(),n.config.minTime.getMinutes(),n.config.minTime.getSeconds()),calculateSecondsSinceMidnight(n.config.maxTime.getHours(),n.config.maxTime.getMinutes(),n.config.maxTime.getSeconds())<(e=calculateSecondsSinceMidnight(t.getHours(),t.getMinutes(),t.getSeconds()))&&e<i&&(e=parseSeconds(i),n.setDate(new Date(t.getTime()).setHours(e[0],e[1],e[2]),!1))):0<compareDates(t,n.config.maxTime,!1)?n.setDate(new Date(t.getTime()).setHours(n.config.maxTime.getHours(),n.config.maxTime.getMinutes(),n.config.maxTime.getSeconds(),n.config.maxTime.getMilliseconds()),!1):compareDates(t,n.config.minTime,!1)<0&&n.setDate(new Date(t.getTime()).setHours(n.config.minTime.getHours(),n.config.minTime.getMinutes(),n.config.minTime.getSeconds(),n.config.minTime.getMilliseconds()),!1)):(this.set(o.defaults||{minTime:void 0,maxTime:void 0}),t&&(e=(i=n.config).minTime,i=i.maxTime,e&&compareTimes(t,e)<0?n.setDate(new Date(t.getTime()).setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),!1):i&&0<compareTimes(t,i)&&n.setDate(new Date(t.getTime()).setHours(i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()))))}}}}export default minMaxTimePlugin;