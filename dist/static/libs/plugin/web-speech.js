define([],function(){let r="speechSynthesis"in window,n=window.SpeechRecognition||window.webkitSpeechRecognition,i=!!n,s=null,o=null,e=null,u=!1,c="",l=null,p=null,a=null,t=24e4;function h(){return r?(s=window.speechSynthesis,!0):(console.error("Web Speech Synthesis is not supported in this browser"),!1)}function S(e={}){return i?((u=e.continuous||!1)&&(t=e.restartInterval||t),(o=new n).continuous=u,o.interimResults=e.interimResults||!1,o.lang=e.lang||"en-US",!0):(console.error("Web Speech Recognition is not supported in this browser"),!1)}function d(n){var t=[];for(let e=0;e<n.results.length;e++)t.push(n.results[e][0].transcript);var e=t.join(" ");u?(c+=e,l&&l(c,n.results)):l&&l(e,n.results)}function g(){u&&o&&(o.stop(),setTimeout(()=>{u&&(o.start(),w())},500))}function w(){e&&clearTimeout(e),u&&(e=setTimeout(g,t))}return{isSpeechSynthesisSupported:r,isSpeechRecognitionSupported:i,initSynthesis:h,initRecognition:S,speak:function(i,o={}){return new Promise((e,n)=>{var t;r?s||h()?(s.cancel(),(t=new SpeechSynthesisUtterance(i)).lang=o.lang||"en-US",t.volume=void 0!==o.volume?o.volume:1,t.rate=void 0!==o.rate?o.rate:1,t.pitch=void 0!==o.pitch?o.pitch:1,t.onend=e,t.onerror=e=>n(e.error),s.speak(t)):n(new Error("Failed to initialize speech synthesis")):n(new Error("Web Speech Synthesis is not supported"))})},getAvailableVoices:function(){return r&&s?s.getVoices():[]},setVoice:function(e){},startListening:function(e,n,t){i?(l=e,p=n,a=t,c="",o||S()?(o.onresult=d,o.onerror=e=>{p&&p(e.error),u&&g()},o.onend=()=>{a&&a(),u&&g()},o.start(),w()):n&&n("Failed to initialize speech recognition")):n&&n("Web Speech Recognition is not supported")},stopListening:function(){e&&(clearTimeout(e),e=null),u=!1,i&&o&&o.stop()}}});