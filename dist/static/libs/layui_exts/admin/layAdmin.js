layui.define(["util","element","layer","jquery","layTabs","layMenu"],function(e){let a=layui.util,i=layui.layer,l=layui.jquery,t=layui.tabs,n=layui.layTabs,s=layui.layMenu,o=layui.element;e("layAdmin",{config:{menuUrl:""},render:function(e){this.config=l.extend({},this.config,e),this.renderTabs(),s.render(this.config.menuUrl),this.events(),this.initTabs(),this.closeLoading()},initTabs:function(){var e=JSON.parse(sessionStorage.getItem("tabsList"))||[];let a=String(sessionStorage.getItem("tabsActiveId"));e.forEach(e=>{n.add(e)}),a&&e.some(e=>e.id===a)?t.change(n.config.elem,a):0<e.length&&t.change(n.config.elem,e[0].id)},renderTabs:function(){var e=`
        <div class="layui-body-tabs layui-tab-rollTool layui-tabs layui-hide-v" id="${n.config.elem}" lay-options="{headerMode:'scroll',closable:true}">
            <ul class="layui-tabs-header"></ul>
            <div class="layui-tabs-body"></div>        
        </div>
    `;l("#happy-content").html(e),t.render()},closeLoading:function(){l(".loading-mask").addClass("hidden")},showLoading:function(){l(".loading-mask").removeClass("hidden")},events:function(){n.on(),a.event("lay-header-event",{home:function(){t.change(n.config.elem,"home")},cleanCache:function(e){let a=e.data("url");i.confirm("确认清理缓存？",function(){sessionStorage.clear(),a?l.ajax({url:a,type:"GET",success:function(e){i.msg(e.msg)}}):i.msg("本地缓存已清空")})},fullScreen:function(e){let a=e.find("em");if(document.fullscreenElement)try{n.exitFullscreen().then(()=>{a.removeClass("layui-icon-screen-restore").addClass("layui-icon-screen-full"),e.attr("title","全屏")}).catch(e=>{i.msg("无法退出全屏模式,请手动操作")})}catch(e){i.msg("无法退出全屏模式,请手动操作")}else try{n.requestFullscreen(document.documentElement).then(()=>{a.removeClass("layui-icon-screen-full").addClass("layui-icon-screen-restore"),e.attr("title","退出全屏")}).catch(e=>{i.msg("无法进入全屏模式,请手动操作")})}catch(e){i.msg("无法进入全屏模式,请手动操作")}},logout:function(e){let a=e.data("href");a&&i.confirm("确认退出系统？",function(){l.ajax({url:a,type:"GET",success:function(e){i.msg(e.msg),0===e.code&&setTimeout(function(){sessionStorage.clear(),localStorage.clear(),location.href=e.url},1e3)}})})},menuSwitch:function(e){var a=l(".happy-admin-layout").find(".layui-layout-admin");a.hasClass("mini-nav")?(l(".layui-nav-item i").css("left",25),a.removeClass("mini-nav"),localStorage.setItem("mimiMenu","false")):(l(".layui-nav-item i").css("left",20),a.addClass("mini-nav"),localStorage.setItem("mimiMenu","true"))}}),o.on("nav(lay-nav)",function(e){var a,t,e=l(e);1===e.parents(".mini-nav").length&&l('[lay-header-event="menuSwitch"]').trigger("click"),0===e.find(".layui-nav-more").length&&(a=(e=l(this)).find(".happy-nav-title").html(),t=e.attr("lay-id"),e=e.attr("lay-url"),n.add({id:t,title:a,url:e,closable:!0}))}),this.onBody()},onBody:function(){var e=l("body");e.on("click","[data-open]",function(e){var a=l(e.target).data("open"),t=a.split("?")[0],e=l(e.target).text();n.add({id:t,title:e,url:a,closable:!0,change:!0})}),e.on("click","[data-win-open]",function(e){e=l(e.target).data("winOpen");window.open(e,"_blank")}),e.on("click","[data-ajax]",function(e){let a=i.load(1);e.preventDefault();var e=this.dataset.ajax,t=this.dataset.type||"GET",n=this.dataset.value||{};l.ajax({url:e,type:t,data:n,success:function(e){i.close(a),e.code,i.msg(e.msg)},error:function(){i.close(a),i.msg("网络错误")}})})}})});