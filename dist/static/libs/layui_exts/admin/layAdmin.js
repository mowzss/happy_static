layui.define(["util","element","layer","jquery","layTabs","layMenu"],function(e){let a=layui.util,l=layui.layer,i=layui.jquery,t=layui.tabs,n=layui.layTabs,s=layui.layMenu,o=layui.element;e("layAdmin",{config:{menuUrl:""},render:function(e){this.config=i.extend({},this.config,e),this.renderTabs(),s.render(this.config.menuUrl),this.events(),this.initTabs(),this.closeLoading()},initTabs:function(){var e=JSON.parse(sessionStorage.getItem("tabsList"))||[];let a=String(sessionStorage.getItem("tabsActiveId"));e.forEach(e=>{n.add(e)}),a&&e.some(e=>e.id===a)?t.change(n.config.elem,a):0<e.length&&t.change(n.config.elem,e[0].id)},renderTabs:function(){var e=`
        <div class="layui-body-tabs layui-tab-rollTool layui-tabs layui-hide-v" id="${n.config.elem}" lay-options="{headerMode:'scroll',closable:true}">
            <ul class="layui-tabs-header"></ul>
            <div class="layui-tabs-body"></div>        
        </div>
    `;i("#happy-content").html(e),t.render()},closeLoading:function(){i(".loading-mask").addClass("hidden")},showLoading:function(){i(".loading-mask").removeClass("hidden")},events:function(){n.on(),a.event("lay-header-event",{cleanCache:function(e){let a=e.data("url");l.confirm("确认清理缓存？",function(){sessionStorage.clear(),a?i.ajax({url:a,type:"GET",success:function(e){l.msg(e.msg)}}):l.msg("本地缓存已清空")})},fullScreen:function(e){let a=e.find("em");if(document.fullscreenElement)try{n.exitFullscreen().then(()=>{a.removeClass("layui-icon-screen-restore").addClass("layui-icon-screen-full"),e.attr("title","全屏")}).catch(e=>{l.msg("无法退出全屏模式,请手动操作")})}catch(e){l.msg("无法退出全屏模式,请手动操作")}else try{n.requestFullscreen(document.documentElement).then(()=>{a.removeClass("layui-icon-screen-full").addClass("layui-icon-screen-restore"),e.attr("title","退出全屏")}).catch(e=>{l.msg("无法进入全屏模式,请手动操作")})}catch(e){l.msg("无法进入全屏模式,请手动操作")}},logout:function(e){let a=e.data("href");a&&l.confirm("确认退出系统？",function(){i.ajax({url:a,type:"GET",success:function(e){l.msg(e.msg),0===e.code&&setTimeout(function(){sessionStorage.clear(),localStorage.clear(),location.href=e.url},1e3)}})})}}),a.event("lay-on",{open:function(){}}),o.on("nav(lay-nav)",function(e){var a,t,e=i(e);1===e.parents(".mini-nav").length&&i('[lay-header-event="menuSwitch"]').trigger("click"),0===e.find(".layui-nav-more").length&&(a=(e=i(this)).find(".happy-nav-title").html(),t=e.attr("lay-id"),e=e.attr("lay-url"),n.add({id:t,title:a,url:e,closable:!0}))}),this.onBody()},onBody:function(){var e=i("body");e.on("click","[data-open]",function(e){var a=i(e.target).data("open"),t=a.split("?")[0],e=i(e.target).text();n.add({id:t,title:e,url:a,closable:!0,change:!0})}),e.on("click","[data-win-open]",function(e){e=i(e.target).data("winOpen");window.open(e,"_blank")}),e.on("click","[data-ajax]",function(e){let a=l.load(1);e.preventDefault();var e=this.dataset.ajax,t=this.dataset.type||"GET",n=this.dataset.value||{};i.ajax({url:e,type:t,data:n,success:function(e){l.close(a),e.code,l.msg(e.msg)},error:function(){l.close(a),l.msg("网络错误")}})})}})});