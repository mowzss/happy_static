layui.define(["jquery","element","layTabs"],function(e){let i=layui.jquery,t=layui.layTabs,n={render:function(e){this.loadAllMenuData(e)},loadAllMenuData:function(e){var a=Date.now(),e=e+(e.includes("?")?"&":"?")+"ts="+a;i.ajax({url:e,method:"GET",success:function(e){e&&0<e.length?(n.allMenuData=e,e=n.separateMenuData(e),n.topNavItems=e.topNavItems,n.sideNavItems=e.sideNavItems,n.initTopNav(),n.renderAllSideNavs(),i("#topNav .layui-nav-item:first-child a").trigger("click"),0===(JSON.parse(sessionStorage.getItem("tabsList"))||[]).length&&(e={id:"home",url:((e=(e=window.location.href).match(/(https?:\/\/[^\/]+\/[^\/?#]+)/))&&e[1]?e[1]:(console.error("未能正确解析URL"),null))+"/index/index/main",title:"首页",closable:!1},t.add(e)),(e=String(sessionStorage.getItem("tabsActiveId")))&&t.activeTabMenu(e)):console.error("菜单数据为空")},error:function(e,a,t){console.error("获取菜单数据失败:",t)}})},separateMenuData:function(e){let t=[],i={};return function a(e){e.forEach(function(e){e.isParent?((0===e.pid?t:(i[e.pid]||(i[e.pid]=[]),i[e.pid])).push(e),e.children&&0<e.children.length&&a(e.children)):(i[e.pid]||(i[e.pid]=[]),i[e.pid].push(e))})}(e),{topNavItems:t,sideNavItems:i}},initTopNav:function(){var e=n.topNavItems.map(function(e){return`<li class="layui-nav-item" data-tab-id="${e.id}">
                            <a href="javascript:;">
                              ${e.title}
                            </a>
                        </li>`}).join("");i("#topNav").html(e),i("#topNav .layui-nav-item a").on("click",function(){var e=i(this).parent().attr("data-tab-id");i(this).parent().addClass("layui-this").siblings().removeClass("layui-this"),i(".side-menu-container[data-tab-id]").hide(),i(`.side-menu-container[data-tab-id="${e}"]`).show()})},renderAllSideNavs:function(){let t=i("#menu-container ul");n.topNavItems.forEach(function(e){var a=n.sideNavItems[e.id]||[],a=n.generateMenuHtml(a),e=`
                    <div class="side-menu-container" data-tab-id="${e.id}" style="display:none;">
                        ${a}
                    </div>
                `;t.append(e)}),layui.element.init()},findFirstLeafMenuItem:function(e){for(var a of e){if(1===a.type)return a;if(a.children&&0<a.children.length){a=n.findFirstLeafMenuItem(a.children);if(a)return a}}return null},generateMenuHtml:function(e){let a="";return e.forEach(function(e){0===e.type?(a=(a+='<li class="layui-nav-item layui-nav-itemed"><a href="javascript:">')+'<i class="'+e.icon+'"></i><span class="happy-nav-title">'+e.title+"</span></a>",e.children&&0<e.children.length&&(a=(a+='<dl class="layui-nav-child">')+n.generateMenuHtml(e.children)+"</dl>"),a+="</li>"):1===e.type&&(a=(a=(a=(a+='<li class="layui-nav-item">')+'<a lay-url="'+e.href+'" lay-id="'+e.id+'">')+'<span class="happy-nav-title">'+e.title+"</span>")+"</a></li>")}),a}};e("layMenu",n)});