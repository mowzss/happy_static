(()=>{var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=t=>e=>e.options.get(t);let n=t("insertdatetime_dateformat"),i=t("insertdatetime_timeformat"),s=t("insertdatetime_formats"),l=t("insertdatetime_element"),o=e=>{var t=s(e);return 0<t.length?t[0]:i(e)},r="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),m="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),d="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),c="January February March April May June July August September October November December".split(" "),u=(t,a)=>{if((t=""+t).length<a)for(let e=0;e<a-t.length;e++)t="0"+t;return t},p=(e,t,a=new Date)=>t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace("%D","%m/%d/%Y")).replace("%r","%I:%M:%S %p")).replace("%Y",""+a.getFullYear())).replace("%y",""+a.getYear())).replace("%m",u(a.getMonth()+1,2))).replace("%d",u(a.getDate(),2))).replace("%H",""+u(a.getHours(),2))).replace("%M",""+u(a.getMinutes(),2))).replace("%S",""+u(a.getSeconds(),2))).replace("%I",""+((a.getHours()+11)%12+1))).replace("%p",a.getHours()<12?"AM":"PM")).replace("%B",""+e.translate(c[a.getMonth()]))).replace("%b",""+e.translate(d[a.getMonth()]))).replace("%A",""+e.translate(m[a.getDay()]))).replace("%a",""+e.translate(r[a.getDay()]))).replace("%%","%"),g=(e,t,a,r)=>{a=e.dom.create("time",{datetime:a},r);e.dom.replace(a,t),e.selection.select(a,!0),e.selection.collapse(!1)},y=(t,a)=>{if(l(t)&&t.selection.isEditable()){var r=p(t,a);let e;e=/%[HMSIp]/.test(a)?p(t,"%Y-%m-%dT%H:%M"):p(t,"%Y-%m-%d");var n=t.dom.getParent(t.selection.getStart(),"time");n?g(t,n,e,r):t.insertContent('<time datetime="'+e+'">'+r+"</time>")}else t.insertContent(p(t,a))},M=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}};var S=tinymce.util.Tools.resolve("tinymce.util.Tools");let f=a=>e=>{let t=()=>{e.setEnabled(a.selection.isEditable())};return a.on("NodeChange",t),t(),()=>{a.off("NodeChange",t)}},h=a=>{let t=s(a),r=M(o(a)),n=e=>a.execCommand("mceInsertDate",!1,e);a.ui.registry.addSplitButton("insertdatetime",{icon:"insert-time",tooltip:"Insert date/time",select:e=>e===r.get(),fetch:e=>{e(S.map(t,e=>({type:"choiceitem",text:p(a,e),value:e})))},onAction:e=>{n(r.get())},onItemAction:(e,t)=>{r.set(t),n(t)},onSetup:f(a)});a.ui.registry.addNestedMenuItem("insertdatetime",{icon:"insert-time",text:"Date/time",getSubmenuItems:()=>S.map(t,e=>{return{type:"menuitem",text:p(a,e),onAction:(t=e,()=>{r.set(t),n(t)})};var t}),onSetup:f(a)})};e.add("insertdatetime",e=>{var t,a,r;(a=(t=e).options.register)("insertdatetime_dateformat",{processor:"string",default:t.translate("%Y-%m-%d")}),a("insertdatetime_timeformat",{processor:"string",default:t.translate("%H:%M:%S")}),a("insertdatetime_formats",{processor:"string[]",default:["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"]}),a("insertdatetime_element",{processor:"boolean",default:!1}),(r=e).addCommand("mceInsertDate",(e,t)=>{y(r,null!=t?t:n(r))}),r.addCommand("mceInsertTime",(e,t)=>{y(r,null!=t?t:i(r))}),h(e)})})();