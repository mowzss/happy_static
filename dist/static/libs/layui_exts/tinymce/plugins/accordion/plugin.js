(()=>{var $=tinymce.util.Tools.resolve("tinymce.PluginManager");let V=()=>window.crypto.getRandomValues(new Uint32Array(1))[0]/4294967295,I=0,j=e=>{var t=(new Date).getTime();return e+"_"+Math.floor(1e9*V())+ ++I+String(t)},q=(e,t,o)=>!!o(e,t.prototype)||(null==(o=e.constructor)?void 0:o.name)===t.name;var o,t,e=t=>e=>typeof e===t;let r=e=>{return t=typeof(e=e),(null===e?"null":"object"==t&&Array.isArray(e)?"array":"object"==t&&q(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t)===o;var t},F=e("boolean"),s=e=>null==e,m=e=>!s(e),l=e("function"),H=e("number"),z=(t,o)=>e=>t(o(e)),n=e=>()=>e,K=(e,t)=>e===t,d=n(!(o="string"));class i{constructor(e,t){this.tag=e,this.value=t}static some(e){return new i(!0,e)}static none(){return i.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?i.some(e(this.value)):i.none()}bind(e){return this.tag?e(this.value):i.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:i.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return m(e)?i.some(e):i.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}i.singletonNone=new i(!1);let U=Array.prototype.indexOf,Y=(e,t)=>U.call(e,t),a=(e,t)=>-1<Y(e,t),c=(t,o)=>{var r=t.length,n=new Array(r);for(let e=0;e<r;e++){var a=t[e];n[e]=o(a,e)}return n},u=(o,r)=>{for(let e=0,t=o.length;e<t;e++)r(o[e],e)},_=(o,r)=>{var n=[];for(let e=0,t=o.length;e<t;e++){var a=o[e];r(a,e)&&n.push(a)}return n},G=(e,o,r)=>(u(e,(e,t)=>{r=o(r,e,t)}),r),J=Object.keys,Q=(o,r)=>{var n=J(o);for(let e=0,t=n.length;e<t;e++){var a=n[e];r(o[a],a)}},W=("undefined"!=typeof window||Function("return this;")(),8),g=9,X=11,p=1,h=e=>e.dom.nodeName.toLowerCase(),Z=e=>e.dom.nodeType,ee=e=>Z(e)===W||"#comment"===h(e),f=(e=t=>e=>Z(e)===t)(p),v=e(3),te=e(g),oe=e(X),re=(e,t,o)=>{if(!(r(o)||F(o)||H(o)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,o+"")},ne=(e,t,o)=>{re(e.dom,t,o)},y=(e,t)=>{e=e.dom.getAttribute(t);return null===e?void 0:e},ae=(e,t)=>i.from(y(e,t)),w=(e,t)=>{e.dom.removeAttribute(t)},b=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},N={fromHtml:(e,t)=>{var o,t=(t||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw o="HTML does not have a single root node",console.error(o,e),new Error(o);return b(t.childNodes[0])},fromTag:(e,t)=>{t=(t||document).createElement(e);return b(t)},fromText:(e,t)=>{t=(t||document).createTextNode(e);return b(t)},fromDom:b,fromPoint:(e,t,o)=>i.from(e.dom.elementFromPoint(t,o)).map(b)},T=(e,t)=>{e=e.dom;if(e.nodeType!==p)return!1;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},ie=e=>e.nodeType!==p&&e.nodeType!==g&&e.nodeType!==X||0===e.childElementCount,le=(e,t)=>{t=void 0===t?document:t.dom;return ie(t)?[]:c(t.querySelectorAll(e),N.fromDom)},de=(e,t)=>{t=void 0===t?document:t.dom;return ie(t)?i.none():i.from(t.querySelector(e)).map(N.fromDom)},se=(e,t)=>e.dom===t.dom,me=T,ce=(e,t,o=K)=>e.exists(e=>o(e,t)),ue=(t=/^\s+|\s+$/g,e=>e.replace(t,"")),A=e=>void 0!==e.style&&l(e.style.getPropertyValue),ge=e=>N.fromDom(e.dom.ownerDocument),C=e=>i.from(e.dom.parentNode).map(N.fromDom),pe=(e,t)=>{var o=l(t)?t:d;let r=e.dom;for(var n=[];null!=r.parentNode;){var a=r.parentNode,i=N.fromDom(a);if(n.push(i),!0===o(i))break;r=a}return n},he=e=>i.from(e.dom.previousSibling).map(N.fromDom),fe=e=>i.from(e.dom.nextSibling).map(N.fromDom),S=e=>c(e.dom.childNodes,N.fromDom),ve=(e,t)=>{e=e.dom.childNodes;return i.from(e[t]).map(N.fromDom)},ye=e=>ve(e,0),we=e=>oe(e)&&m(e.dom.host),be=e=>N.fromDom(e.dom.getRootNode()),Ne=e=>{e=be(e);return we(e)?i.some(e):i.none()},Te=e=>N.fromDom(e.dom.host),Ae=e=>{let t=v(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let o=t.ownerDocument;return Ne(N.fromDom(t)).fold(()=>o.body.contains(t),z(Ae,Te))},Ce=(e,t,o)=>{if(!r(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);A(e)&&e.style.setProperty(t,o)},Se=(e,t)=>{A(e)&&e.style.removeProperty(t)},xe=(e,t,o)=>{e=e.dom;Ce(e,t,o)},De=(e,t)=>{var o=e.dom,r=window.getComputedStyle(o).getPropertyValue(t);return""!==r||Ae(e)?r:Ee(o,t)},Ee=(e,t)=>A(e)?e.style.getPropertyValue(t):"",Oe=(e,t)=>{e=e.dom,e=Ee(e,t);return i.from(e).filter(e=>0<e.length)},Me=(e,t)=>{var o=e.dom;Se(o,t),ce(ae(e,"style").map(ue),"")&&w(e,"style")},x=(t,o)=>{C(t).each(e=>{e.dom.insertBefore(o.dom,t.dom)})},Pe=(e,t)=>{fe(e).fold(()=>{C(e).each(e=>{D(e,t)})},e=>{x(e,t)})},Re=(t,o)=>{ye(t).fold(()=>{D(t,o)},e=>{t.dom.insertBefore(o.dom,e.dom)})},D=(e,t)=>{e.dom.appendChild(t.dom)},ke=(e,t)=>{x(e,t),D(t,e)},Be=(o,r)=>{u(r,(e,t)=>{t=0===t?o:r[t-1];Pe(t,e)})},Le=(t,e)=>{u(e,e=>{D(t,e)})},$e=(e,t)=>{let o=[];return u(S(e),e=>{o=(o=t(e)?o.concat([e]):o).concat($e(e,t))}),o};var Ve=(e,t,o,r,n)=>e(o,r)?i.some(o):l(n)&&n(o)?i.none():t(o,r,n);let Ie=(e,t,o)=>{let r=e.dom;for(var n=l(o)?o:d;r.parentNode;){r=r.parentNode;var a=N.fromDom(r);if(t(a))return i.some(a);if(n(a))break}return i.none()},je=e=>{e=e.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},qe=e=>{var t=S(e);0<t.length&&Be(e,t),je(e)},Fe=(e,t)=>le(t,e),He=(e,t,o)=>Ie(e,e=>T(e,t),o),ze=(e,t)=>de(t,e),Ke=(e,t,o)=>Ve((e,t)=>T(e,t),He,e,t,o),Ue=((o,r)=>{let t=e=>o(e)?i.from(e.dom.nodeValue):i.none();return{get:e=>{if(o(e))return t(e).getOr("");throw new Error("Can only get "+r+" value of a "+r+" node")},getOption:t,set:(e,t)=>{if(!o(e))throw new Error("Can only set raw "+r+" value of a "+r+" node");e.dom.nodeValue=t}}})(v,"text"),Ye=e=>Ue.get(e),_e=(e,t)=>Ue.set(e,t);var Ge=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];let Je=(e,t)=>({element:e,offset:t}),Qe=(t,e,o)=>t.property().isText(e)&&0===t.property().getText(e).trim().length||t.property().isComment(e)?o(e).bind(e=>Qe(t,e,o).orThunk(()=>i.some(e))):i.none(),We=(e,t)=>(e.property().isText(t)?e.property().getText(t):e.property().children(t)).length,Xe=(e,t)=>{var o,t=Qe(e,t,e.query().prevSibling).getOr(t);return!e.property().isText(t)&&0<(o=e.property().children(t)).length?Xe(e,o[o.length-1]):Je(t,We(e,t))},Ze=Xe,et={up:n({selector:He,closest:Ke,predicate:Ie,all:pe}),down:n({selector:Fe,predicate:$e}),styles:n({get:De,getRaw:Oe,set:xe,remove:Me}),attrs:n({get:y,set:ne,remove:w,copyTo:(e,t)=>{e=e,((e,t)=>{let o=e.dom;Q(t,(e,t)=>{re(o,t,e)})})(t,G(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}))}}),insert:n({before:x,after:Pe,afterAll:Be,append:D,appendAll:Le,prepend:Re,wrap:ke}),remove:n({unwrap:qe,remove:je}),create:n({nu:N.fromTag,clone:e=>N.fromDom(e.dom.cloneNode(!1)),text:N.fromText}),query:n({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:he,nextSibling:fe}),property:n({children:S,name:h,parent:C,document:e=>(e=e,(te(e)?e:ge(e)).dom),isText:v,isComment:ee,isElement:f,isSpecial:e=>{e=h(e);return a(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],e)},getLanguage:e=>f(e)?ae(e,"lang"):i.none(),getText:Ye,setText:_e,isBoundary:e=>!!f(e)&&("body"===h(e)||a(Ge,h(e))),isEmptyTag:e=>!!f(e)&&a(["br","img","hr","input"],h(e)),isNonEditable:e=>f(e)&&"false"===y(e,"contenteditable")}),eq:se,is:me},tt=e=>Ze(et,e),ot=(e,t,o)=>e.dispatch("ToggledAccordion",{element:t,state:o}),rt=(e,t,o)=>e.dispatch("ToggledAllAccordions",{elements:t,state:o}),E="details",nt="mce-accordion",O="mce-accordion-summary",M="mce-accordion-body",P="div";var at=tinymce.util.Tools.resolve("tinymce.util.Tools");let R=e=>"SUMMARY"===(null==e?void 0:e.nodeName),it=e=>"DETAILS"===(null==e?void 0:e.nodeName),lt=e=>e.hasAttribute("open"),dt=e=>{var t=e.selection.getNode();return R(t)||Boolean(e.dom.getParent(t,R))},st=e=>{e=e.selection.getRng();return it(e.startContainer)&&e.collapsed&&0===e.startOffset},mt=e=>!dt(e)&&e.dom.isEditable(e.selection.getNode())&&!e.mode.isReadOnly(),k=e=>i.from(e.dom.getParent(e.selection.getNode(),it)),ct=e=>k(e).isSome(),ut=e=>(e.innerHTML='<br data-mce-bogus="1" />',e),gt=e=>ut(e.dom.create("p")),pt=e=>ut(e.dom.create("summary")),ht=(e,t)=>{var o=gt(e);t.insertAdjacentElement("afterend",o),e.selection.setCursorLocation(o,0)},ft=(e,t)=>{var o;R(null==t?void 0:t.lastChild)&&(o=gt(e),t.appendChild(o),e.selection.setCursorLocation(o,0))},vt=(e,t)=>{var o;R(null==t?void 0:t.firstChild)||(o=pt(e),t.prepend(o),e.selection.setCursorLocation(o,0))},yt=t=>e=>{ft(t,e),vt(t,e)},wt=e=>{at.each(at.grep(e.dom.select("details",e.getBody())),yt(e))},bt=n=>{if(mt(n)){let e=N.fromDom(n.getBody()),t=j("acc");var a=n.dom.encode(n.selection.getRng().toString()||n.translate("Accordion summary...")),i=n.dom.encode(n.translate("Accordion body..."));let o=`<summary class="${O}">${a}</summary>`,r=`<${P} class="${M}"><p>${i}</p></${P}>`;n.undoManager.transact(()=>{n.insertContent([`<details data-mce-id="${t}" class="${nt}" open="open">`,o,r,"</details>"].join("")),ze(e,`[data-mce-id="${t}"]`).each(e=>{w(e,"data-mce-id"),ze(e,"summary").each(e=>{var t=n.dom.createRng(),e=tt(e);t.setStart(e.element.dom,e.offset),t.setEnd(e.element.dom,e.offset),n.selection.setRng(t)})})})}},Nt=(e,t)=>{t=null!=t?t:!lt(e);return t?e.setAttribute("open","open"):e.removeAttribute("open"),t},Tt=(t,o)=>{k(t).each(e=>{ot(t,e,Nt(e,o))})},At=o=>{o.mode.isReadOnly()||k(o).each(e=>{var t=e.nextSibling;t?(o.selection.select(t,!0),o.selection.collapse(!0)):ht(o,e),e.remove()})},Ct=(e,t)=>{var o=Array.from(e.getBody().querySelectorAll("details"));0!==o.length&&(u(o,e=>Nt(e,null!=t?t:!lt(e))),rt(e,o,t))};var B=tinymce.util.Tools.resolve("tinymce.html.Node");let L=e=>null!=(e=null==(e=e.attr("class"))?void 0:e.split(" "))?e:[],St=(e,t)=>{t=new Set([...L(e),...t]),t=Array.from(t);0<t.length&&e.attr("class",t.join(" "))},xt=(e,t)=>{var o=_(L(e),e=>!t.has(e));e.attr("class",0<o.length?o.join(" "):null)},Dt=e=>e.name===E&&a(L(e),nt),Et=e=>e.name===P&&a(L(e),M),Ot=e=>{var t=e.children();let o,r;var n=[];for(let e=0;e<t.length;e++){var a=t[e];"summary"===a.name&&s(o)?o=a:Et(a)&&s(r)?r=a:n.push(a)}return{summaryNode:o,wrapperNode:r,otherNodes:n}},Mt=e=>{var t=new B("br",1);t.attr("data-mce-bogus","1"),e.empty(),e.append(t)};var Pt=tinymce.util.Tools.resolve("tinymce.util.VK");let Rt=t=>{t.on("keydown",e=>{(!e.shiftKey&&e.keyCode===Pt.ENTER&&dt(t)||st(t))&&(e.preventDefault(),t.execCommand("ToggleAccordion"))})};var kt=tinymce.util.Tools.resolve("tinymce.Env");let Bt=o=>e=>{let t=()=>e.setEnabled(mt(o));return o.on("NodeChange",t),()=>o.off("NodeChange",t)};$.add("accordion",e=>{var t,o,r,n,a,i;o=()=>t.execCommand("InsertAccordion"),(t=e).ui.registry.addButton("accordion",{icon:"accordion",tooltip:"Insert accordion",onSetup:Bt(t),onAction:o}),t.ui.registry.addMenuItem("accordion",{icon:"accordion",text:"Accordion",onSetup:Bt(t),onAction:o}),t.ui.registry.addToggleButton("accordiontoggle",{icon:"accordion-toggle",tooltip:"Toggle accordion",onAction:()=>t.execCommand("ToggleAccordion")}),t.ui.registry.addToggleButton("accordionremove",{icon:"remove",tooltip:"Delete accordion",onAction:()=>t.execCommand("RemoveAccordion")}),t.ui.registry.addContextToolbar("accordion",{predicate:e=>t.dom.is(e,"details")&&t.getBody().contains(e)&&t.dom.isEditable(e.parentNode),items:"accordiontoggle accordionremove",scope:"node",position:"node"}),(r=e).addCommand("InsertAccordion",()=>bt(r)),r.addCommand("ToggleAccordion",(e,t)=>Tt(r,t)),r.addCommand("ToggleAllAccordions",(e,t)=>Ct(r,t)),r.addCommand("RemoveAccordion",()=>At(r)),n=e,Rt(n),n.on("ExecCommand",e=>{e=e.command.toLowerCase();"delete"!==e&&"forwarddelete"!==e||!ct(n)||wt(n)}),(a=e).on("PreInit",()=>{var{serializer:e,parser:t}=a;t.addNodeFilter(E,t=>{for(let e=0;e<t.length;e++){var o=t[e];if(Dt(o)){var{summaryNode:r,wrapperNode:n,otherNodes:a}=Ot(o),i=m(r),r=i?r:new B("summary",1),i=(s(r.firstChild)&&Mt(r),St(r,[O]),i||(m(o.firstChild)?o.insert(r,o.firstChild,!0):o.append(r)),m(n)),l=i?n:new B(P,1);if(l.attr("data-mce-bogus","1"),St(l,[M]),0<a.length)for(let e=0;e<a.length;e++){var d=a[e];l.append(d)}s(l.firstChild)&&(r=new B("p",1),Mt(r),l.append(r)),i||o.append(l)}}}),e.addNodeFilter(E,t=>{var o=new Set([O]);for(let e=0;e<t.length;e++){var r,n=t[e];Dt(n)&&(n=n,{summaryNode:n,wrapperNode:r}=Ot(n),m(n)&&xt(n,o),m(r))&&r.unwrap()}})}),i=e,kt.browser.isSafari()&&i.on("click",e=>{var t;R(e.target)&&(e=e.target,(t=i.selection.getRng()).collapsed)&&t.startContainer===e.parentNode&&0===t.startOffset&&i.selection.setCursorLocation(e,0)})})})();