tinymce.PluginManager.add("kityformula-editor",function(e,t){var n=tinymce.baseURL+"/plugins/kityformula-editor/kityFormula.html",a=(e.on("dblclick",function(){var t=e.selection.getContent();0==t.search(/\<img(.*?)src="data:image\/png;base64,[A-Za-z0-9+/=]*"(.*?)data-latex="(.*?)" \/>/g)&&t.replace(/data-latex="(.*?)"/g,function(t,e){e=encodeURIComponent(e);return a(e),t})}),function(t){return e.windowManager.openUrl({title:"插入公式",size:"large",width:785,height:475,url:t?n+"?c="+t:n,buttons:[{type:"cancel",text:"Close"},{type:"custom",text:"Save",name:"save",primary:!0}],onAction:function(t,e){"save"===e.name&&t.sendMessage("save")}})});return e.ui.registry.addButton("kityformula-editor",{text:"公式",tooltip:"插入公式",onAction:function(){a()}}),e.ui.registry.addMenuItem("kityformula-editor",{text:"公式",onAction:function(){a()}}),{getMetadata:function(){return{name:"公式",url:"http://hgcserver.gitee.io"}}}});