(()=>{var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),a=a=>e=>e.options.get(a);let i=a("pagebreak_separator"),g=a("pagebreak_split_block"),p="mce-pagebreak",c=e=>{var a=`<img src="${t.transparentSrc}" class="${p}" data-mce-resize="false" data-mce-placeholder />`;return e?`<p>${a}</p>`:a},n=t=>e=>{let a=()=>{e.setEnabled(t.selection.isEditable())};return t.on("NodeChange",a),a(),()=>{t.off("NodeChange",a)}};e.add("pagebreak",e=>{var a,t,r,o;(e=>{e=e.options.register;e("pagebreak_separator",{processor:"string",default:"\x3c!-- pagebreak --\x3e"}),e("pagebreak_split_block",{processor:"boolean",default:!1})})(e),(a=e).addCommand("mcePageBreak",()=>{a.insertContent(c(g(a)))}),r=()=>t.execCommand("mcePageBreak"),(t=e).ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction:r,onSetup:n(t)}),t.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction:r,onSetup:n(t)}),(n=>{let l=i(n),s=()=>g(n),a=new RegExp(l.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,e=>"\\"+e),"gi");n.on("BeforeSetContent",e=>{e.content=e.content.replace(a,c(s()))}),n.on("PreInit",()=>{n.serializer.addNodeFilter("img",e=>{let a=e.length,t,r;for(;a--;){var o;t=e[a],(r=t.attr("class"))&&-1!==r.indexOf(p)&&((o=t.parent)&&n.schema.getBlockElements()[o.name]&&s()?(o.type=3,o.value=l,o.raw=!0,t.remove()):(t.type=3,t.value=l,t.raw=!0))}})})})(e),(o=e).on("ResolveName",e=>{"IMG"===e.target.nodeName&&o.dom.hasClass(e.target,p)&&(e.name="pagebreak")})})})();