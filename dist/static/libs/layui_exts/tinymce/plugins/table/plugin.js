(()=>{var B=tinymce.util.Tools.resolve("tinymce.PluginManager");let F=(e,t,o)=>!!o(e,t.prototype)||(null==(o=e.constructor)?void 0:o.name)===t.name;var q,e=o=>e=>{return t=typeof(e=e),(null===e?"null":"object"==t&&Array.isArray(e)?"array":"object"==t&&F(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t)===o;var t},t=t=>e=>typeof e===t;let j=e("string"),L=e("array"),H=t("boolean"),V=(q=void 0,e=>q===e),$=e=>null==e,W=e=>!$(e),m=t("function"),z=t("number"),U=()=>{},G=(t,o)=>e=>t(o(e)),d=e=>()=>e,K=e=>e,J=(e,t)=>e===t;function c(t,...o){return(...e)=>{e=o.concat(e);return t.apply(null,e)}}let Q=e=>{e()},f=d(!1),i=d(!0);class y{constructor(e,t){this.tag=e,this.value=t}static some(e){return new y(!0,e)}static none(){return y.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?y.some(e(this.value)):y.none()}bind(e){return this.tag?e(this.value):y.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:y.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return W(e)?y.some(e):y.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}y.singletonNone=new y(!1);let u=Object.keys,X=Object.hasOwnProperty,n=(o,l)=>{var r=u(o);for(let e=0,t=r.length;e<t;e++){var n=r[e];l(o[n],n)}},Y=o=>(e,t)=>{o[t]=e},Z=(e,o,l,r)=>{n(e,(e,t)=>{(o(e,t)?l:r)(e,t)})},ee=(e,t)=>{var o={};return Z(e,t,Y(o),U),o},te=(e,o)=>{let l=[];return n(e,(e,t)=>{l.push(o(e,t))}),l},oe=e=>te(e,K),p=e=>u(e).length,r=(e,t)=>b(e,t)?y.from(e[t]):y.none(),b=(e,t)=>X.call(e,t),le=(e,t)=>b(e,t)&&null!=e[t],re=e=>{for(var t in e)if(X.call(e,t))return!1;return!0},ne=Array.prototype.indexOf,ae=Array.prototype.push,se=(e,t)=>ne.call(e,t),g=(e,t)=>-1<se(e,t),ce=(o,l)=>{for(let e=0,t=o.length;e<t;e++)if(l(o[e],e))return!0;return!1},ie=(t,o)=>{var l=[];for(let e=0;e<t;e++)l.push(o(e));return l},a=(t,o)=>{var l=t.length,r=new Array(l);for(let e=0;e<l;e++){var n=t[e];r[e]=o(n,e)}return r},w=(o,l)=>{for(let e=0,t=o.length;e<t;e++)l(o[e],e)},me=(t,o)=>{for(let e=t.length-1;0<=e;e--)o(t[e],e)},de=(o,l)=>{var r=[],n=[];for(let e=0,t=o.length;e<t;e++){var a=o[e];(l(a,e)?r:n).push(a)}return{pass:r,fail:n}},S=(o,l)=>{var r=[];for(let e=0,t=o.length;e<t;e++){var n=o[e];l(n,e)&&r.push(n)}return r},ue=(e,o,l)=>(me(e,(e,t)=>{l=o(l,e,t)}),l),pe=(e,o,l)=>(w(e,(e,t)=>{l=o(l,e,t)}),l),be=(o,l,r)=>{for(let e=0,t=o.length;e<t;e++){var n=o[e];if(l(n,e))return y.some(n);if(r(n,e))break}return y.none()},ge=(e,t)=>be(e,t,f),he=o=>{var l=[];for(let e=0,t=o.length;e<t;++e){if(!L(o[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+o);ae.apply(l,o[e])}return l},l=(e,t)=>he(a(e,t)),fe=(o,l)=>{for(let e=0,t=o.length;e<t;++e)if(!0!==l(o[e],e))return!1;return!0},ye=(o,l)=>{var r={};for(let e=0,t=o.length;e<t;e++){var n=o[e];r[String(n)]=l(n,e)}return r},we=(e,t)=>0<=t&&t<e.length?y.some(e[t]):y.none(),Se=e=>we(e,0),ve=e=>we(e,e.length-1),Ce=(t,o)=>{for(let e=0;e<t.length;e++){var l=o(t[e],e);if(l.isSome())return l}return y.none()},Te=8,xe=9,Ae=11,Re=1,s=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},h={fromHtml:(e,t)=>{var o,t=(t||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw o="HTML does not have a single root node",console.error(o,e),new Error(o);return s(t.childNodes[0])},fromTag:(e,t)=>{t=(t||document).createElement(e);return s(t)},fromText:(e,t)=>{t=(t||document).createTextNode(e);return s(t)},fromDom:s,fromPoint:(e,t,o)=>y.from(e.dom.elementFromPoint(t,o)).map(s)},v=(e,t)=>{e=e.dom;if(e.nodeType!==Re)return!1;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Oe=e=>e.nodeType!==Re&&e.nodeType!==xe&&e.nodeType!==Ae||0===e.childElementCount,_e=(e,t)=>{t=void 0===t?document:t.dom;return Oe(t)?[]:a(t.querySelectorAll(e),h.fromDom)},De=(e,t)=>{t=void 0===t?document:t.dom;return Oe(t)?y.none():y.from(t.querySelector(e)).map(h.fromDom)},C=(e,t)=>e.dom===t.dom,Ie=v,T=("undefined"!=typeof window||Function("return this;")(),e=>e.dom.nodeName.toLowerCase()),Ne=e=>e.dom.nodeType,Me=e=>Ne(e)===Te||"#comment"===T(e),o=(e=t=>e=>Ne(e)===t)(Re),Pe=e(3),ke=e(xe),Ee=e(Ae),Be=t=>e=>o(e)&&T(e)===t,Fe=e=>h.fromDom(e.dom.ownerDocument),qe=e=>y.from(e.dom.parentNode).map(h.fromDom),je=(e,t)=>{var o=m(t)?t:f;let l=e.dom;for(var r=[];null!=l.parentNode;){var n=l.parentNode,a=h.fromDom(n);if(r.push(a),!0===o(a))break;l=n}return r},Le=e=>y.from(e.dom.previousSibling).map(h.fromDom),He=e=>y.from(e.dom.nextSibling).map(h.fromDom),x=e=>a(e.dom.childNodes,h.fromDom),Ve=(e,t)=>{e=e.dom.childNodes;return y.from(e[t]).map(h.fromDom)},$e=e=>Ve(e,0),We=e=>Ee(e)&&W(e.dom.host),ze=e=>h.fromDom(e.dom.getRootNode()),Ue=e=>{e=ze(e);return We(e)?y.some(e):y.none()},Ge=e=>h.fromDom(e.dom.host),Ke=e=>{let t=Pe(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let o=t.ownerDocument;return Ue(h.fromDom(t)).fold(()=>o.body.contains(t),G(Ke,Ge))};var Je,Qe=(e,t,o,l,r)=>e(o,l)?y.some(o):m(r)&&r(o)?y.none():t(o,l,r);let Xe=(e,t,o)=>{let l=e.dom;for(var r=m(o)?o:f;l.parentNode;){l=l.parentNode;var n=h.fromDom(l);if(t(n))return y.some(n);if(r(n))break}return y.none()},Ye=(e,t,o)=>Qe((e,t)=>t(e),Xe,e,t,o),Ze=(e,t)=>ge(e.dom.childNodes,e=>t(h.fromDom(e))).map(h.fromDom),A=(e,t,o)=>Xe(e,e=>v(e,t),o),et=(e,t)=>Ze(e,e=>v(e,t)),tt=(e,t)=>De(t,e),ot=(e,t,o)=>Qe((e,t)=>v(e,t),A,e,t,o),lt=e=>ot(e,"[contenteditable]"),rt=(e,t=!1)=>Ke(e)?e.dom.isContentEditable:lt(e).fold(d(t),e=>"true"===nt(e)),nt=e=>e.dom.contentEditable,at=e=>e.nodeName.toLowerCase(),st=e=>h.fromDom(e.getBody()),R=t=>e=>C(e,st(t)),ct=e=>e?e.replace(/px$/,""):"",O=e=>/^\d+(\.\d+)?$/.test(e)?e+"px":e,it=e=>h.fromDom(e.selection.getStart()),mt=e=>h.fromDom(e.selection.getEnd()),dt=e=>Ye(e,Be("table")).forall(rt),ut=(e,t)=>S(x(e),t),pt=(e,t)=>{let o=[];return w(x(e),e=>{o=(o=t(e)?o.concat([e]):o).concat(pt(e,t))}),o},bt=(e,t)=>ut(e,e=>v(e,t)),gt=(e,t)=>_e(t,e),ht=(e,t,o)=>{if(!(j(o)||H(o)||z(o)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,o+"")},ft=(e,t,o)=>{ht(e.dom,t,o)},yt=(e,t)=>{e=e.dom.getAttribute(t);return null===e?void 0:e},_=(e,t)=>y.from(yt(e,t)),wt=(e,t)=>{e.dom.removeAttribute(t)},St=(e,t,o=J)=>e.exists(e=>o(e,t)),vt=t=>{let o=[];var l=e=>{o.push(e)};for(let e=0;e<t.length;e++)t[e].each(l);return o},Ct=(e,t,o)=>e.isSome()&&t.isSome()?y.some(o(e.getOrDie(),t.getOrDie())):y.none(),Tt=e=>e.bind(K),xt=(e,t)=>e?y.some(t):y.none(),At=(e,t)=>e.substring(t),Rt=(e,t,o)=>""===t||e.length>=t.length&&e.substr(o,o+t.length)===t,Ot=(e,t)=>_t(e,t)?At(e,t.length):e,_t=(e,t)=>Rt(e,t,0),Dt=(Je=/^\s+|\s+$/g,e=>e.replace(Je,"")),It=e=>0<e.length,Nt=e=>!It(e),Mt=(e,t=10)=>{e=parseInt(e,t);return isNaN(e)?y.none():y.some(e)},Pt=e=>{e=parseFloat(e);return isNaN(e)?y.none():y.some(e)},kt=e=>void 0!==e.style&&m(e.style.getPropertyValue),Et=(e,t,o)=>{if(!j(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);kt(e)&&e.style.setProperty(t,o)},Bt=(e,t)=>{kt(e)&&e.style.removeProperty(t)},Ft=(e,t,o)=>{e=e.dom;Et(e,t,o)},qt=(e,t)=>{var o=e.dom,l=window.getComputedStyle(o).getPropertyValue(t);return""!==l||Ke(e)?l:jt(o,t)},jt=(e,t)=>kt(e)?e.style.getPropertyValue(t):"",D=(e,t)=>{e=e.dom,e=jt(e,t);return y.from(e).filter(e=>0<e.length)},Lt=(e,t)=>{var o=e.dom;Bt(o,t),St(_(e,"style").map(Dt),"")&&wt(e,"style")},Ht=(e,t,o=0)=>_(e,t).map(e=>parseInt(e,10)).getOr(o),Vt=(e,t)=>$t(e,t,i),$t=(e,t,o)=>l(x(e),e=>v(e,t)?o(e)?[e]:[]:$t(e,t,o)),Wt=["tfoot","thead","tbody","colgroup"],zt=e=>g(Wt,e),Ut=(e,t)=>({rows:e,columns:t}),Gt=(e,t,o)=>({element:e,rowspan:t,colspan:o}),Kt=(e,t,o,l,r,n)=>({element:e,rowspan:t,colspan:o,row:l,column:r,isLocked:n}),Jt=(e,t,o)=>({element:e,cells:t,section:o}),Qt=(e,t,o,l)=>({startRow:e,startCol:t,finishRow:o,finishCol:l}),Xt=(e,t,o)=>({element:e,colspan:t,column:o}),Yt=(e,t)=>({element:e,columns:t}),Zt=(e,t,o=f)=>o(t)?y.none():g(e,T(t))?y.some(t):A(t,e.join(","),e=>v(e,"table")||o(e)),eo=(e,t)=>Zt(["td","th"],e,t),to=e=>Vt(e,"th,td"),oo=e=>v(e,"colgroup")?bt(e,"col"):l(ro(e),e=>bt(e,"col")),I=(e,t)=>ot(e,"table",t),lo=e=>Vt(e,"tr"),ro=e=>I(e).fold(d([]),e=>bt(e,"colgroup")),no=(e,o)=>a(e,t=>{var e;if("colgroup"!==T(t))return e=a(to(t),e=>{var t=Ht(e,"rowspan",1),o=Ht(e,"colspan",1);return Gt(e,t,o)}),Jt(t,e,o(t));{let e=a(oo(t),e=>{var t=Ht(e,"span",1);return Gt(e,1,t)});return Jt(t,e,"colgroup")}}),ao=e=>qe(e).map(e=>{e=T(e);return zt(e)?e:"tbody"}).getOr("tbody"),so="data-snooker-locked-cols",co=e=>_(e,so).bind(e=>y.from(e.match(/\d+/g))).map(e=>ye(e,i)),io=(e,t)=>e+","+t,mo=(e,t)=>{e=l(e.all,e=>e.cells);return S(e,t)},uo=e=>{let l={},r=0;return w(e.cells,t=>{let o=t.colspan;ie(o,e=>{e=r+e;l[e]=Xt(t.element,o,e)}),r+=o}),l},po=e=>{let s={},o=[];let c=Se(e).map(e=>e.element).bind(I).bind(co).getOr({}),l=0,i=0,m=0;var{pass:e,fail:t}=de(e,e=>"colgroup"===e.section),{columns:t,colgroups:e}=(w(t,e=>{let t=[];w(e.cells,o=>{let l=0;for(;void 0!==s[io(m,l)];)l++;var e=le(c,l.toString()),r=Kt(o.element,o.rowspan,o.colspan,m,l,e);for(let t=0;t<o.colspan;t++)for(let e=0;e<o.rowspan;e++){var n=m+e,a=l+t,n=io(n,a);s[n]=r,i=Math.max(i,a+1)}t.push(r)}),l++,o.push(Jt(e.element,t,e.section)),m++}),ve(e).map(e=>{var t=uo(e);return{colgroups:[Yt(e.element,oe(t))],columns:t}}).getOrThunk(()=>({colgroups:[],columns:{}})));return{grid:Ut(l,i),access:s,all:o,columns:t,colgroups:e}},N={fromTable:e=>{e=e,t=lo(e),e=[...ro(e),...t];var t=no(e,ao);return po(t)},generate:po,getAt:(e,t,o)=>y.from(e.access[io(t,o)]),findItem:(e,t,o)=>{e=mo(e,e=>o(t,e.element));return 0<e.length?y.some(e[0]):y.none()},filterItems:mo,justCells:e=>l(e.all,e=>e.cells),justColumns:e=>oe(e.columns),hasColumns:e=>0<u(e.columns).length,getColumnAt:(e,t)=>y.from(e.columns[t])};var bo=tinymce.util.Tools.resolve("tinymce.util.Tools");let go=(t,e,o)=>{var l=t.select("td,th",e);let r;for(let e=0;e<l.length;e++){var n=t.getStyle(l[e],o);if((r=V(r)?n:r)!==n)return""}return r},ho=(t,o,l)=>{bo.each("left center right".split(" "),e=>{e!==l&&t.formatter.remove("align"+e,{},o)}),l&&t.formatter.apply("align"+l,{},o)},fo=(t,o,l)=>{bo.each("top middle bottom".split(" "),e=>{e!==l&&t.formatter.remove("valign"+e,{},o)}),l&&t.formatter.apply("valign"+l,{},o)},yo=(e,t,o)=>{e.dispatch("TableModified",{...o,table:t})},wo=(e,t)=>Pt(e).getOr(t),So=(e,t,o)=>wo(qt(e,t),o),vo=(e,t,o,l)=>t-So(e,"padding-"+o,0)-So(e,"padding-"+l,0)-So(e,`border-${o}-width`,0)-So(e,`border-${l}-width`,0),Co=e=>{return t="content-box",o=(o=(e=e).dom).getBoundingClientRect().width||o.offsetWidth,"border-box"===t?o:vo(e,o,"left","right");var t,o};var To=tinymce.util.Tools.resolve("tinymce.Env");let xo="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol",Ao=ie(5,e=>{e=e+1+"px";return{title:e,value:e}}),Ro=a(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],e=>({title:e,value:e.toLowerCase()})),Oo="100%",_o=e=>{var t=e.dom,t=null!=(t=t.getParent(e.selection.getStart(),t.isBlock))?t:e.getBody();return Co(h.fromDom(t))+"px"},Do=(e,t)=>Uo(e)||!P(e)?t:zo(e)?{...t,width:_o(e)}:{...t,width:Oo},Io=(e,t)=>Uo(e)||P(e)?t:zo(e)?{...t,width:_o(e)}:{...t,width:Oo},No=e=>{e=e.options.register;e("table_border_widths",{processor:"object[]",default:Ao}),e("table_border_styles",{processor:"object[]",default:Ro}),e("table_cell_advtab",{processor:"boolean",default:!0}),e("table_row_advtab",{processor:"boolean",default:!0}),e("table_advtab",{processor:"boolean",default:!0}),e("table_appearance_options",{processor:"boolean",default:!0}),e("table_grid",{processor:"boolean",default:!To.deviceType.isTouch()}),e("table_cell_class_list",{processor:"object[]",default:[]}),e("table_row_class_list",{processor:"object[]",default:[]}),e("table_class_list",{processor:"object[]",default:[]}),e("table_toolbar",{processor:"string",default:xo}),e("table_background_color_map",{processor:"object[]",default:[]}),e("table_border_color_map",{processor:"object[]",default:[]})},Mo=(t=t=>e=>e.options.get(t))("table_sizing_mode"),Po=t("table_border_widths"),ko=t("table_border_styles"),Eo=t("table_cell_advtab"),Bo=t("table_row_advtab"),M=t("table_advtab"),Fo=t("table_appearance_options"),qo=t("table_grid"),P=t("table_style_by_css"),jo=t("table_cell_class_list"),Lo=t("table_row_class_list"),Ho=t("table_class_list"),Vo=t("table_toolbar"),$o=t("table_background_color_map"),Wo=t("table_border_color_map"),zo=e=>"fixed"===Mo(e),Uo=e=>"responsive"===Mo(e),Go=e=>{var t=e.options,o=t.get("table_default_styles");return t.isSet("table_default_styles")?o:Do(e,o)},Ko=e=>{var t=e.options,o=t.get("table_default_attributes");return t.isSet("table_default_attributes")?o:Io(e,o)},Jo=(e,t)=>t.column>=e.startCol&&t.column+t.colspan-1<=e.finishCol&&t.row>=e.startRow&&t.row+t.rowspan-1<=e.finishRow,Qo=(o,l)=>{let r=!0;var n=c(Jo,l);for(let t=l.startRow;t<=l.finishRow;t++)for(let e=l.startCol;e<=l.finishCol;e++)r=r&&N.getAt(o,t,e).exists(n);return r?y.some(l):y.none()},Xo=(e,t)=>Qt(Math.min(e.row,t.row),Math.min(e.column,t.column),Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),Math.max(e.column+e.colspan-1,t.column+t.colspan-1)),Yo=(e,t,o)=>{t=N.findItem(e,t,C);let l=N.findItem(e,o,C);return t.bind(t=>l.map(e=>Xo(t,e)))},Zo=(t,e,o)=>Yo(t,e,o).bind(e=>Qo(t,e)),el=(e,t,o)=>{e=tl(e);return Zo(e,t,o)},tl=N.fromTable,ol=(t,o)=>{qe(t).each(e=>{e.dom.insertBefore(o.dom,t.dom)})},ll=(e,t)=>{He(e).fold(()=>{qe(e).each(e=>{nl(e,t)})},e=>{ol(e,t)})},rl=(t,o)=>{$e(t).fold(()=>{nl(t,o)},e=>{t.dom.insertBefore(o.dom,e.dom)})},nl=(e,t)=>{e.dom.appendChild(t.dom)},al=(e,t)=>{ol(e,t),nl(t,e)},sl=(o,l)=>{w(l,(e,t)=>{t=0===t?o:l[t-1];ll(t,e)})},cl=(t,e)=>{w(e,e=>{nl(t,e)})},il=e=>{e=e.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},ml=e=>{var t=x(e);0<t.length&&sl(e,t),il(e)},dl=((o,l)=>{let t=e=>o(e)?y.from(e.dom.nodeValue):y.none();return{get:e=>{if(o(e))return t(e).getOr("");throw new Error("Can only get "+l+" value of a "+l+" node")},getOption:t,set:(e,t)=>{if(!o(e))throw new Error("Can only set raw "+l+" value of a "+l+" node");e.dom.nodeValue=t}}})(Pe,"text"),ul=e=>dl.get(e),pl=(e,t)=>dl.set(e,t);var bl=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];let gl=(o,l,e,t)=>{e=l(o,e);return ue(t,(e,t)=>{t=l(o,t);return hl(o,e,t)},e)},hl=(t,e,o)=>e.bind(e=>o.filter(c(t.eq,e))),fl=(e,t,o)=>0<o.length?(e=e,t=t,o=o,gl(e,t,o[0],o.slice(1))):y.none(),yl={up:d({selector:A,closest:ot,predicate:Xe,all:je}),down:d({selector:gt,predicate:pt}),styles:d({get:qt,getRaw:D,set:Ft,remove:Lt}),attrs:d({get:yt,set:ft,remove:wt,copyTo:(e,t)=>{e=e,((e,t)=>{let o=e.dom;n(t,(e,t)=>{ht(o,t,e)})})(t,pe(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}))}}),insert:d({before:ol,after:ll,afterAll:sl,append:nl,appendAll:cl,prepend:rl,wrap:al}),remove:d({unwrap:ml,remove:il}),create:d({nu:h.fromTag,clone:e=>h.fromDom(e.dom.cloneNode(!1)),text:h.fromText}),query:d({comparePosition:(e,t)=>e.dom.compareDocumentPosition(t.dom),prevSibling:Le,nextSibling:He}),property:d({children:x,name:T,parent:qe,document:e=>(e=e,(ke(e)?e:Fe(e)).dom),isText:Pe,isComment:Me,isElement:o,isSpecial:e=>{e=T(e);return g(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],e)},getLanguage:e=>o(e)?_(e,"lang"):y.none(),getText:ul,setText:pl,isBoundary:e=>!!o(e)&&("body"===T(e)||g(bl,T(e))),isEmptyTag:e=>!!o(e)&&g(["br","img","hr","input"],T(e)),isNonEditable:e=>o(e)&&"false"===yt(e,"contenteditable")}),eq:C,is:Ie},wl=(o,e)=>fl(yl,(e,t)=>o(t),e),Sl=e=>A(e,"table"),vl=(e,t)=>{e=gt(e,t);return 0<e.length?y.some(e):y.none()},Cl=(e,t,l)=>tt(e,t).bind(o=>tt(e,l).bind(t=>wl(Sl,[o,t]).map(e=>({first:o,last:t,table:e})))),Tl=(e,t)=>vl(e,t),xl=(n,e,t)=>Cl(n,e,t).bind(o=>{var e=e=>C(n,e),t="thead,tfoot,tbody,table",l=A(o.first,t,e);let r=A(o.last,t,e);return l.bind(t=>r.bind(e=>C(t,e)?el(o.table,o.first,o.last):y.none()))}),Al=e=>a(e,h.fromDom);var Rl="data-mce-last-selected";let Ol={selected:e="data-mce-selected",selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:t="data-mce-first-selected",firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:Rl,lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},_l=(e=l=>(e,t)=>{var o=T(e),o="col"===o||"colgroup"===o?(o=e,I(o).bind(e=>Tl(e,Ol.firstSelectedSelector)).fold(d(o),e=>e[0])):e;return ot(o,l,t)})("th,td,caption"),Dl=e("th,td"),Il=e=>Al(e.model.table.getSelectedCells()),Nl=(e,o)=>{var e=Dl(e),t=e.bind(e=>I(e)).map(e=>lo(e));return Ct(e,t,(t,e)=>S(e,e=>ce(Al(e.dom.cells),e=>"1"===yt(e,o)||C(e,t)))).getOr([])},Ml=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],Pl=e=>({value:Fl(e)}),kl=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,El=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Bl=e=>kl.test(e)||El.test(e),Fl=e=>Ot(e,"#").toUpperCase(),ql=e=>Bl(e)?y.some({value:Fl(e)}):y.none(),jl=e=>{e=e.toString(16);return(1===e.length?"0"+e:e).toUpperCase()},Ll=e=>{e=jl(e.red)+jl(e.green)+jl(e.blue);return Pl(e)},Hl=/^\s*rgb\s*\(\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*(\d+)\s*\)\s*$/i,Vl=/^\s*rgba\s*\(\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*((?:\d?\.\d+|\d+)%?)\s*\)\s*$/i,$l=(e,t,o,l)=>({red:e,green:t,blue:o,alpha:l}),Wl=(e,t,o,l)=>{e=parseInt(e,10),t=parseInt(t,10),o=parseInt(o,10),l=parseFloat(l);return $l(e,t,o,l)},zl=e=>{var t=Hl.exec(e);return null!==t?y.some(Wl(t[1],t[2],t[3],"1")):null!==(t=Vl.exec(e))?y.some(Wl(t[1],t[2],t[3],t[4])):y.none()},Ul=r=>ql(r).orThunk(()=>zl(r).map(Ll)).getOrThunk(()=>{var e=document.createElement("canvas"),t=(e.height=1,e.width=1,e.getContext("2d")),e=(t.clearRect(0,0,e.width,e.height),t.fillStyle="#FFFFFF",t.fillStyle=r,t.fillRect(0,0,1,1),t.getImageData(0,0,1,1).data),t=e[0],o=e[1],l=e[2],e=e[3];return Ll($l(t,o,l,e))}),Gl=e=>zl(e).map(Ll).map(e=>"#"+e.value).getOr(e),Kl=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},Jl=e=>{let t=Kl(y.none()),o=()=>t.get().each(e);return{clear:()=>{o(),t.set(y.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{o(),t.set(y.some(e))}}},Ql=()=>Jl(e=>e.unbind()),Xl=(n,a,s)=>o=>{let l=Ql(),r=Nt(s);var e=()=>{var e=Il(n),t=e=>n.formatter.match(a,{value:s},e.dom,r);r?(o.setActive(!ce(e,t)),l.set(n.formatter.formatChanged(a,e=>o.setActive(!e),!0))):(o.setActive(fe(e,t)),l.set(n.formatter.formatChanged(a,o.setActive,!1,{value:s})))};return n.initialized?e():n.on("init",e),l.clear},Yl=e=>le(e,"menu"),Zl=e=>a(e,e=>{var t=e.text||e.title||"";return Yl(e)?{text:t,items:Zl(e.menu)}:{text:t,value:e.value}}),er=e=>e.length?y.some(Zl([{text:"Select...",value:"mce-no-match"},...e])):y.none(),k=(o,e,l,r)=>a(e,e=>{var t=e.text||e.title;return Yl(e)?{type:"nestedmenuitem",text:t,getSubmenuItems:()=>k(o,e.menu,l,r)}:{text:t,type:"togglemenuitem",onAction:()=>r(e.value),onSetup:Xl(o,l,e.value)}}),E=(t,o)=>e=>{t.execCommand("mceTableApplyCellStyle",!1,{[o]:e})},tr=e=>l(e,e=>Yl(e)?[{...e,menu:tr(e.menu)}]:It(e.value)?[e]:[]),or=(t,o,l,r)=>e=>e(k(t,o,l,r)),lr=(t,e,o)=>{e=a(e,e=>({text:e.title,value:"#"+Ul(e.value).value,type:"choiceitem"}));return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:0<e.length?e:void 0,allowCustomColors:!1},onAction:e=>{e="remove"===e.value?"":e.value;t.execCommand("mceTableApplyCellStyle",!1,{[o]:e})}}]},rr=t=>()=>{var e=t.queryCommandValue("mceTableRowType");t.execCommand("mceTableRowType",!1,{type:"header"===e?"body":"header"})},nr=t=>()=>{var e=t.queryCommandValue("mceTableColType");t.execCommand("mceTableColType",!1,{type:"th"===e?"td":"th"})},ar=e=>er(jo(e)).map(e=>({name:"class",type:"listbox",label:"Class",items:e})),sr=[{name:"width",type:"input",label:"Width"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:Ml}],cr=e=>sr.concat(ar(e).toArray()),ir=(e,t)=>{e=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""}].concat(Zl(ko(e)))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===t?[{name:"borderwidth",type:"input",label:"Border width"}].concat(e):e}},mr={normal:(o,l)=>{let r=o.dom;return{setAttrib:(e,t)=>{r.setAttrib(l,e,t)},setStyle:(e,t)=>{r.setStyle(l,e,t)},setFormat:(e,t)=>{""===t?o.formatter.remove(e,{value:null},l,!0):o.formatter.apply(e,{value:t},l)}}}},dr=Be("th"),ur=(e,t)=>e&&t?"sectionCells":e?"section":"cells",pr=e=>{var t="thead"===e.section,o=St(br(e.cells),"th");return"tfoot"===e.section?{type:"footer"}:t||o?{type:"header",subType:ur(t,o)}:{type:"body"}},br=e=>{var t=S(e,e=>dr(e.element));return 0===t.length?y.some("td"):t.length===e.length?y.some("th"):y.none()},gr=t=>{let o=!1,l;return(...e)=>(o||(o=!0,l=t.apply(null,e)),l)},hr=(e,t)=>Ce(e.all,e=>ge(e.cells,e=>C(t,e.element))),fr=(t,e,o)=>{e=a(e.selection,e=>eo(e).bind(e=>hr(t,e)).filter(o)),e=vt(e);return xt(0<e.length,e)},yr=(e,t)=>t.mergable,wr=(e,t)=>t.unmergable,Sr=(e,t)=>fr(e,t,i),vr=(e,t)=>hr(e,t).exists(e=>!e.isLocked),Cr=(t,e)=>fe(e,e=>vr(t,e)),Tr=(t,e)=>yr(t,e).filter(e=>Cr(t,e.cells)),xr=(t,e)=>wr(t,e).filter(e=>Cr(t,e));const Ar=n=>{if(!L(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");let a=[],s={};return w(n,(e,t)=>{var o=u(e);if(1!==o.length)throw new Error("one and only one name per case");let l=o[0],r=e[l];if(void 0!==s[l])throw new Error("duplicate key detected:"+l);if("cata"===l)throw new Error("cannot have a case named cata (sorry)");if(!L(r))throw new Error("case arguments must be an array");a.push(l),s[l]=(...o)=>{var e=o.length;if(e!==r.length)throw new Error("Wrong number of arguments to case "+l+". Expected "+r.length+" ("+r+"), got "+e);return{fold:(...e)=>{if(e.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+e.length);return e[t].apply(null,o)},match:e=>{let t=u(e);if(a.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+t.join(","));if(fe(a,e=>g(t,e)))return e[l].apply(null,o);throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+a.join(", "))},log:e=>{console.log(e,{constructors:a,constructor:l,params:o})}}}}),s};({...Ar([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}])});let Rr=(e,t)=>{let l=N.fromTable(e);return Sr(l,t).bind(e=>{var t,o=e[e.length-1],e=e[0].row,o=o.row+o.rowspan,e=l.all.slice(e,o);return o=e,o=a(o,e=>pr(e).type),e=g(o,"header"),t=g(o,"footer"),e||t?(o=g(o,"body"),!e||o||t?e||o||!t?y.none():y.some("footer"):y.some("header")):y.some("body")}).getOr("")},Or=e=>_t(e,"rgb")?Gl(e):e,_r=e=>{e=h.fromDom(e);return{borderwidth:D(e,"border-width").getOr(""),borderstyle:D(e,"border-style").getOr(""),bordercolor:D(e,"border-color").map(Or).getOr(""),backgroundcolor:D(e,"background-color").map(Or).getOr("")}},Dr=e=>{let r=e[0];e=e.slice(1);return w(e,e=>{w(u(r),l=>{n(e,(e,t)=>{var o=r[l];""!==o&&l===t&&o!==e&&(r[l]="class"===l?"mce-no-match":"")})})}),r},Ir=c(t=(e,t,o,l)=>ge(e,e=>!V(o.formatter.matchNode(l,t+e))).getOr(""),["left","center","right"],"align"),Nr=c(t,["top","middle","bottom"],"valign"),Mr=(e,t)=>{let o=Go(e),l=Ko(e);var t=t?{borderstyle:r(o,"border-style").getOr(""),bordercolor:Or(r(o,"border-color").getOr("")),backgroundcolor:Or(r(o,"background-color").getOr(""))}:{};return{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:"",...o,...l,...t,...(t=o["border-width"],P(e)&&t?{border:t}:r(l,"border").fold(()=>({}),e=>({border:e}))),...(e=r(o,"border-spacing").or(r(l,"cellspacing")).fold(()=>({}),e=>({cellspacing:e})),t=r(o,"border-padding").or(r(l,"cellpadding")).fold(()=>({}),e=>({cellpadding:e})),{...e,...t})}},Pr=o=>I(h.fromDom(o)).map(e=>{var t={selection:Al(o.cells)};return Rr(e,t)}).getOr(""),kr=(e,t,o)=>{var l,r=e.dom,n=P(e)?r.getStyle(t,"border-spacing")||r.getAttrib(t,"cellspacing"):r.getAttrib(t,"cellspacing")||r.getStyle(t,"border-spacing"),a=P(e)?go(r,t,"padding")||r.getAttrib(t,"cellpadding"):r.getAttrib(t,"cellpadding")||go(r,t,"padding");return{width:r.getStyle(t,"width")||r.getAttrib(t,"width"),height:r.getStyle(t,"height")||r.getAttrib(t,"height"),cellspacing:null!=n?n:"",cellpadding:null!=a?a:"",border:(n=r,a=t,l=D(h.fromDom(a),"border-width"),P(e)&&l.isSome()?l.getOr(""):n.getAttrib(a,"border")||go(e.dom,a,"border-width")||go(e.dom,a,"border")||""),caption:!!r.select("caption",t)[0],class:r.getAttrib(t,"class",""),align:Ir(e,t),...o?_r(t):{}}},Er=(e,t,o)=>{var l=e.dom;return{height:l.getStyle(t,"height")||l.getAttrib(t,"height"),class:l.getAttrib(t,"class",""),type:Pr(t),align:Ir(e,t),...o?_r(t):{}}},Br=(e,t,o,l)=>{let r=e.dom;var n,l=l.getOr(t);return{width:(l=l,n="width",r.getStyle(l,n)||r.getAttrib(l,n)),scope:r.getAttrib(t,"scope"),celltype:at(t),class:r.getAttrib(t,"class",""),halign:Ir(e,t),valign:Nr(e,t),...o?_r(t):{}}},Fr=(e,o)=>{let t=N.fromTable(e);e=N.justCells(t),e=S(e,t=>ce(o,e=>C(t.element,e)));return a(e,e=>({element:e.element.dom,column:N.getColumnAt(t,e.column).map(e=>e.element.dom)}))},qr=(e,t,o,l)=>{l("scope")&&e.setAttrib("scope",o.scope),l("class")&&"mce-no-match"!==o.class&&e.setAttrib("class",o.class),l("width")&&t.setStyle("width",O(o.width))},jr=(e,t,o)=>{o("backgroundcolor")&&e.setFormat("tablecellbackgroundcolor",t.backgroundcolor),o("bordercolor")&&e.setFormat("tablecellbordercolor",t.bordercolor),o("borderstyle")&&e.setFormat("tablecellborderstyle",t.borderstyle),o("borderwidth")&&e.setFormat("tablecellborderwidth",O(t.borderwidth))},Lr=(r,e,n,a)=>{let s=1===e.length;w(e,e=>{var t=e.element,o=s?i:a,l=mr.normal(r,t),e=e.column.map(e=>mr.normal(r,e)).getOr(l);qr(l,e,n,o),Eo(r)&&jr(l,n,o),a("halign")&&ho(r,t,n.halign),a("valign")&&fo(r,t,n.valign)})},Hr=(e,t)=>{e.execCommand("mceTableCellType",!1,{type:t.celltype,no_events:!0})},Vr=(r,n,o,a)=>{let s=ee(a,(e,t)=>o[t]!==e);0<p(s)&&1<=n.length&&I(n[0]).each(e=>{var t=Fr(e,n),o=0<p(ee(s,(e,t)=>"scope"!==t&&"celltype"!==t)),l=b(s,"celltype");(o||b(s,"scope"))&&Lr(r,t,a,c(b,s)),l&&Hr(r,a),yo(r,e.dom,{structure:l,style:o})})},$r=(e,t,o,l)=>{let r=l.getData();l.close(),e.undoManager.transact(()=>{Vr(e,t,o,r),e.focus()})},Wr=(t,o)=>{var e=I(o[0]).map(e=>a(Fr(e,o),e=>Br(t,e.element,Eo(t),e.column)));return Dr(e.getOrDie())},zr=e=>{var t,o,l,r=Il(e);0!==r.length&&(t=Wr(e,r),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:cr(e)},ir(e,"cell")]},l={type:"panel",items:[{type:"grid",columns:2,items:cr(e)}]},e.windowManager.open({title:"Cell Properties",size:"normal",body:Eo(e)?o:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:t,onSubmit:c($r,e,r,t)}))},Ur=e=>er(Lo(e)).map(e=>({name:"class",type:"listbox",label:"Class",items:e})),Gr=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Kr=e=>Gr.concat(Ur(e).toArray()),Jr=(e,t,o)=>{o("class")&&"mce-no-match"!==t.class&&e.setAttrib("class",t.class),o("height")&&e.setStyle("height",O(t.height))},Qr=(e,t,o)=>{o("backgroundcolor")&&e.setStyle("background-color",t.backgroundcolor),o("bordercolor")&&e.setStyle("border-color",t.bordercolor),o("borderstyle")&&e.setStyle("border-style",t.borderstyle)},Xr=(l,e,r,n)=>{let a=1===e.length?i:n;w(e,e=>{var t=bt(h.fromDom(e),"td,th"),o=mr.normal(l,e);Jr(o,r,a),Bo(l)&&Qr(o,r,a),n("height")&&w(t,e=>{l.dom.setStyle(e.dom,"height",null)}),n("align")&&ho(l,e,r.align)})},Yr=(e,t)=>{e.execCommand("mceTableRowType",!1,{type:t.type,no_events:!0})},Zr=(l,e,o,r)=>{var n=ee(r,(e,t)=>o[t]!==e);if(0<p(n)){let t=b(n,"type"),o=!t||1<p(n);o&&Xr(l,e,r,c(b,n)),t&&Yr(l,r),I(h.fromDom(e[0])).each(e=>yo(l,e.dom,{structure:t,style:o}))}},en=(e,t,o,l)=>{let r=l.getData();l.close(),e.undoManager.transact(()=>{Zr(e,t,o,r),e.focus()})},tn=t=>{var e,o,l,r=Nl(it(t),Ol.selected);0!==r.length&&(e=a(r,e=>Er(t,e.dom,Bo(t))),e=Dr(e),o={type:"tabpanel",tabs:[{title:"General",name:"general",items:Kr(t)},ir(t,"row")]},l={type:"panel",items:[{type:"grid",columns:2,items:Kr(t)}]},t.windowManager.open({title:"Row Properties",size:"normal",body:Bo(t)?o:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:e,onSubmit:c(en,t,a(r,e=>e.dom),e)}))},on=(e,t,o)=>{o=o?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],e=Fo(e)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],t=0<t.length?[{name:"class",type:"listbox",label:"Class",items:t}]:[];return o.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(e).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(t)},ln=(t,o,l,r)=>{if("TD"===o.tagName||"TH"===o.tagName)j(l)&&W(r)?t.setStyle(o,l,r):t.setStyles(o,l);else if(o.children)for(let e=0;e<o.children.length;e++)ln(t,o.children[e],l,r)},rn=(e,t,o,l)=>{var r=e.dom,n={},a={},s=P(e),c=M(e),i=0===parseFloat(o.border);if(V(o.class)||"mce-no-match"===o.class||(n.class=o.class),a.height=O(o.height),s?a.width=O(o.width):r.getAttrib(t,"width")&&(n.width=ct(o.width)),s?(i?(n.border=0,a["border-width"]=""):(a["border-width"]=O(o.border),n.border=1),a["border-spacing"]=O(o.cellspacing)):(n.border=i?0:o.border,n.cellpadding=o.cellpadding,n.cellspacing=o.cellspacing),s&&t.children){var m={};if(i?m["border-width"]="":l.border&&(m["border-width"]=O(o.border)),l.cellpadding&&(m.padding=O(o.cellpadding)),c&&l.bordercolor&&(m["border-color"]=o.bordercolor),!re(m))for(let e=0;e<t.children.length;e++)ln(r,t.children[e],m)}c&&(a["background-color"]=(s=o).backgroundcolor,a["border-color"]=s.bordercolor,a["border-style"]=s.borderstyle),r.setStyles(t,{...Go(e),...a}),r.setAttribs(t,{...Ko(e),...n})},nn=(o,l,r,e)=>{let n=o.dom,a=e.getData(),s=ee(a,(e,t)=>r[t]!==e);e.close(),o.undoManager.transact(()=>{var e,t;l||(t=Mt(a.cols).getOr(1),e=Mt(a.rows).getOr(1),o.execCommand("mceInsertTable",!1,{rows:e,columns:t}),l=Dl(it(o),R(o)).bind(e=>I(e,R(o))).map(e=>e.dom).getOrDie()),0<p(s)&&(e={border:b(s,"border"),bordercolor:b(s,"bordercolor"),cellpadding:b(s,"cellpadding")},rn(o,l,a,e),((t=n.select("caption",l)[0])&&!a.caption||!t&&a.caption)&&o.execCommand("mceTableToggleCaption"),ho(o,l,a.align)),o.focus(),o.addVisual(),0<p(s)&&(t=!(e=b(s,"caption"))||1<p(s),yo(o,l,{structure:e,style:t}))})},an=(e,t)=>{var o=e.dom;let l,r=Mr(e,M(e));t?(r.cols="1",r.rows="1",M(e)&&(r.borderstyle="",r.bordercolor="",r.backgroundcolor="")):(l=o.getParent(e.selection.getStart(),"table",e.getBody()))?r=kr(e,l,M(e)):M(e)&&(r.borderstyle="",r.bordercolor="",r.backgroundcolor="");o=er(Ho(e));o.isSome()&&r.class&&(r.class=r.class.replace(/\s*mce\-item\-table\s*/g,""));let n={type:"grid",columns:2,items:on(e,o.getOr([]),t)};o=M(e)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[n]},ir(e,"table")]}:{type:"panel",items:[n]};e.windowManager.open({title:"Table Properties",size:"normal",body:o,onSubmit:c(nn,e,l,r),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r})},sn=o=>{n({mceTableProps:c(an,o,!1),mceTableRowProps:c(tn,o),mceTableCellProps:c(zr,o),mceInsertTableDialog:c(an,o,!0)},(t,e)=>o.addCommand(e,()=>{var e;e=t,dt(it(o))&&e()}))},cn=(e,t)=>et(e,t).isSome(),mn=K,dn=e=>{let t=(e,t)=>_(e,t).exists(e=>1<parseInt(e,10));return 0<e.length&&fe(e,e=>t(e,"rowspan")||t(e,"colspan"))?y.some(e):y.none()},un=(e,t,o)=>t.length<=1?y.none():xl(e,o.firstSelectedSelector,o.lastSelectedSelector).map(e=>({bounds:e,cells:t})),pn=e=>({element:e,mergable:y.none(),unmergable:y.none(),selection:[e]}),bn=(e,t,o)=>({element:o,mergable:un(t,e,Ol),unmergable:dn(e),selection:mn(e)}),gn=r=>{let e=Kl(y.none()),o=Kl([]),l=y.none(),n=Be("caption"),t=t=>l.forall(e=>!e[t]),a=()=>_l(it(r),R(r)),s=()=>_l(mt(r),R(r)),c=()=>a().bind(o=>Tt(Ct(I(o),s().bind(I),(e,t)=>C(e,t)?n(o)?y.some(pn(o)):y.some(bn(Il(r),e,o)):y.none()))),i=t=>I(t.element).map(e=>{let o=N.fromTable(e);e=Sr(o,t).getOr([]),e=pe(e,(e,t)=>(t.isLocked&&(e.onAny=!0,0===t.column?e.onFirst=!0:t.column+t.colspan>=o.grid.columns&&(e.onLast=!0)),e),{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:Tr(o,t).isSome(),unmergeable:xr(o,t).isSome(),locked:e}});var m=()=>{e.set(gr(c)()),l=e.get().bind(i),w(o.get(),Q)};let d=t=>(t(),o.set(o.get().concat([t])),()=>{o.set(S(o.get(),e=>e!==t))}),u=(t,o)=>d(()=>e.get().fold(()=>{t.setEnabled(!1)},e=>{t.setEnabled(!o(e)&&r.selection.isEditable())})),p=(t,o,l)=>d(()=>e.get().fold(()=>{t.setEnabled(!1),t.setActive(!1)},e=>{t.setEnabled(!o(e)&&r.selection.isEditable()),t.setActive(l(e))})),b=t=>l.exists(e=>e.locked[t]);var g=(t,o)=>e=>p(e,e=>n(e.element),()=>r.queryCommandValue(t)===o),h=g("mceTableRowType","header"),g=g("mceTableColType","th");return r.on("NodeChange ExecCommand TableSelectorChange",m),{onSetupTable:e=>u(e,e=>!1),onSetupCellOrRow:e=>u(e,e=>n(e.element)),onSetupColumn:t=>e=>u(e,e=>n(e.element)||b(t)),onSetupPasteable:t=>e=>u(e,e=>n(e.element)||t().isNone()),onSetupPasteableColumn:(t,o)=>e=>u(e,e=>n(e.element)||t().isNone()||b(o)),onSetupMergeable:e=>u(e,e=>t("mergeable")),onSetupUnmergeable:e=>u(e,e=>t("unmergeable")),resetTargets:m,onSetupTableWithCaption:e=>p(e,f,e=>I(e.element,R(r)).exists(e=>cn(e,"caption"))),onSetupTableRowHeaders:h,onSetupTableColumnHeaders:g,targets:e.get}};var hn=tinymce.util.Tools.resolve("tinymce.FakeClipboard");let fn=(Rl="x-tinymce/dom-table-")+"rows",yn=Rl+"columns",wn=t=>{var e=null!=(e=hn.read())?e:[];return Ce(e,e=>y.from(e.getType(t)))},Sn=()=>wn(fn),vn=()=>wn(yn),Cn=o=>e=>{let t=()=>{e.setEnabled(o.selection.isEditable())};return o.on("NodeChange",t),t(),()=>{o.off("NodeChange",t)}},Tn=(o,e)=>{o.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",onSetup:Cn(o),fetch:e=>e("inserttable | cell row column | advtablesort | tableprops deletetable")});let l=e=>()=>o.execCommand(e);var t=(e,t)=>{o.queryCommandSupported(t.command)&&o.ui.registry.addButton(e,{...t,onAction:m(t.onAction)?t.onAction:l(t.command)})},r=(e,t)=>{o.queryCommandSupported(t.command)&&o.ui.registry.addToggleButton(e,{...t,onAction:m(t.onAction)?t.onAction:l(t.command)})},t=(t("tableprops",{tooltip:"Table properties",command:"mceTableProps",icon:"table",onSetup:e.onSetupTable}),t("tabledelete",{tooltip:"Delete table",command:"mceTableDelete",icon:"table-delete-table",onSetup:e.onSetupTable}),t("tablecellprops",{tooltip:"Cell properties",command:"mceTableCellProps",icon:"table-cell-properties",onSetup:e.onSetupCellOrRow}),t("tablemergecells",{tooltip:"Merge cells",command:"mceTableMergeCells",icon:"table-merge-cells",onSetup:e.onSetupMergeable}),t("tablesplitcells",{tooltip:"Split cell",command:"mceTableSplitCells",icon:"table-split-cells",onSetup:e.onSetupUnmergeable}),t("tableinsertrowbefore",{tooltip:"Insert row before",command:"mceTableInsertRowBefore",icon:"table-insert-row-above",onSetup:e.onSetupCellOrRow}),t("tableinsertrowafter",{tooltip:"Insert row after",command:"mceTableInsertRowAfter",icon:"table-insert-row-after",onSetup:e.onSetupCellOrRow}),t("tabledeleterow",{tooltip:"Delete row",command:"mceTableDeleteRow",icon:"table-delete-row",onSetup:e.onSetupCellOrRow}),t("tablerowprops",{tooltip:"Row properties",command:"mceTableRowProps",icon:"table-row-properties",onSetup:e.onSetupCellOrRow}),t("tableinsertcolbefore",{tooltip:"Insert column before",command:"mceTableInsertColBefore",icon:"table-insert-column-before",onSetup:e.onSetupColumn("onFirst")}),t("tableinsertcolafter",{tooltip:"Insert column after",command:"mceTableInsertColAfter",icon:"table-insert-column-after",onSetup:e.onSetupColumn("onLast")}),t("tabledeletecol",{tooltip:"Delete column",command:"mceTableDeleteCol",icon:"table-delete-column",onSetup:e.onSetupColumn("onAny")}),t("tablecutrow",{tooltip:"Cut row",command:"mceTableCutRow",icon:"cut-row",onSetup:e.onSetupCellOrRow}),t("tablecopyrow",{tooltip:"Copy row",command:"mceTableCopyRow",icon:"duplicate-row",onSetup:e.onSetupCellOrRow}),t("tablepasterowbefore",{tooltip:"Paste row before",command:"mceTablePasteRowBefore",icon:"paste-row-before",onSetup:e.onSetupPasteable(Sn)}),t("tablepasterowafter",{tooltip:"Paste row after",command:"mceTablePasteRowAfter",icon:"paste-row-after",onSetup:e.onSetupPasteable(Sn)}),t("tablecutcol",{tooltip:"Cut column",command:"mceTableCutCol",icon:"cut-column",onSetup:e.onSetupColumn("onAny")}),t("tablecopycol",{tooltip:"Copy column",command:"mceTableCopyCol",icon:"duplicate-column",onSetup:e.onSetupColumn("onAny")}),t("tablepastecolbefore",{tooltip:"Paste column before",command:"mceTablePasteColBefore",icon:"paste-column-before",onSetup:e.onSetupPasteableColumn(vn,"onFirst")}),t("tablepastecolafter",{tooltip:"Paste column after",command:"mceTablePasteColAfter",icon:"paste-column-after",onSetup:e.onSetupPasteableColumn(vn,"onLast")}),t("tableinsertdialog",{tooltip:"Insert table",command:"mceInsertTableDialog",icon:"table",onSetup:Cn(o)}),tr(Ho(o))),t=(0!==t.length&&o.queryCommandSupported("mceTableToggleClass")&&o.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:or(o,t,"tableclass",e=>o.execCommand("mceTableToggleClass",!1,e)),onSetup:e.onSetupTable}),tr(jo(o)));0!==t.length&&o.queryCommandSupported("mceTableCellToggleClass")&&o.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:or(o,t,"tablecellclass",e=>o.execCommand("mceTableCellToggleClass",!1,e)),onSetup:e.onSetupCellOrRow}),o.queryCommandSupported("mceTableApplyCellStyle")&&(o.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:or(o,Ml,"tablecellverticalalign",E(o,"vertical-align")),onSetup:e.onSetupCellOrRow}),o.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:or(o,Po(o),"tablecellborderwidth",E(o,"border-width")),onSetup:e.onSetupCellOrRow}),o.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:or(o,ko(o),"tablecellborderstyle",E(o,"border-style")),onSetup:e.onSetupCellOrRow}),o.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:e=>e(lr(o,$o(o),"background-color")),onSetup:e.onSetupCellOrRow}),o.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:e=>e(lr(o,Wo(o),"border-color")),onSetup:e.onSetupCellOrRow})),r("tablecaption",{tooltip:"Table caption",icon:"table-caption",command:"mceTableToggleCaption",onSetup:e.onSetupTableWithCaption}),r("tablerowheader",{tooltip:"Row header",icon:"table-top-header",command:"mceTableRowType",onAction:rr(o),onSetup:e.onSetupTableRowHeaders}),r("tablecolheader",{tooltip:"Column header",icon:"table-left-header",command:"mceTableColType",onAction:nr(o),onSetup:e.onSetupTableColumnHeaders})},xn=t=>{var e=Vo(t);0<e.length&&t.ui.registry.addContextToolbar("table",{predicate:e=>t.dom.is(e,"table")&&t.getBody().contains(e)&&t.dom.isEditable(e.parentNode),items:e,scope:"node",position:"node"})},An=o=>e=>{let t=()=>{e.setEnabled(o.selection.isEditable())};return o.on("NodeChange",t),t(),()=>{o.off("NodeChange",t)}},Rn=(o,e)=>{let l=e=>()=>o.execCommand(e);var t=(e,t)=>!!o.queryCommandSupported(t.command)&&(o.ui.registry.addMenuItem(e,{...t,onAction:m(t.onAction)?t.onAction:l(t.command)}),!0),r=(e,t)=>{o.queryCommandSupported(t.command)&&o.ui.registry.addToggleMenuItem(e,{...t,onAction:m(t.onAction)?t.onAction:l(t.command)})};var n=[t("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",command:"mceTableInsertRowBefore",onSetup:e.onSetupCellOrRow}),t("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",command:"mceTableInsertRowAfter",onSetup:e.onSetupCellOrRow}),t("tabledeleterow",{text:"Delete row",icon:"table-delete-row",command:"mceTableDeleteRow",onSetup:e.onSetupCellOrRow}),t("tablerowprops",{text:"Row properties",icon:"table-row-properties",command:"mceTableRowProps",onSetup:e.onSetupCellOrRow}),t("tablecutrow",{text:"Cut row",icon:"cut-row",command:"mceTableCutRow",onSetup:e.onSetupCellOrRow}),t("tablecopyrow",{text:"Copy row",icon:"duplicate-row",command:"mceTableCopyRow",onSetup:e.onSetupCellOrRow}),t("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",command:"mceTablePasteRowBefore",onSetup:e.onSetupPasteable(Sn)}),t("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",command:"mceTablePasteRowAfter",onSetup:e.onSetupPasteable(Sn)})],a=[t("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",command:"mceTableInsertColBefore",onSetup:e.onSetupColumn("onFirst")}),t("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",command:"mceTableInsertColAfter",onSetup:e.onSetupColumn("onLast")}),t("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",command:"mceTableDeleteCol",onSetup:e.onSetupColumn("onAny")}),t("tablecutcolumn",{text:"Cut column",icon:"cut-column",command:"mceTableCutCol",onSetup:e.onSetupColumn("onAny")}),t("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",command:"mceTableCopyCol",onSetup:e.onSetupColumn("onAny")}),t("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",command:"mceTablePasteColBefore",onSetup:e.onSetupPasteableColumn(vn,"onFirst")}),t("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",command:"mceTablePasteColAfter",onSetup:e.onSetupPasteableColumn(vn,"onLast")})],s=[t("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",command:"mceTableCellProps",onSetup:e.onSetupCellOrRow}),t("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",command:"mceTableMergeCells",onSetup:e.onSetupMergeable}),t("tablesplitcells",{text:"Split cell",icon:"table-split-cells",command:"mceTableSplitCells",onSetup:e.onSetupUnmergeable})];qo(o)?o.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"inserttable",onAction:e=>{o.execCommand("mceInsertTable",!1,{rows:e.numRows,columns:e.numColumns})}}],onSetup:An(o)}):o.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:l("mceInsertTableDialog"),onSetup:An(o)}),o.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:l("mceInsertTableDialog"),onSetup:An(o)}),t("tableprops",{text:"Table properties",onSetup:e.onSetupTable,command:"mceTableProps"}),t("deletetable",{text:"Delete table",icon:"table-delete-table",onSetup:e.onSetupTable,command:"mceTableDelete"}),g(n,!0)&&o.ui.registry.addNestedMenuItem("row",{type:"nestedmenuitem",text:"Row",getSubmenuItems:d("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")}),g(a,!0)&&o.ui.registry.addNestedMenuItem("column",{type:"nestedmenuitem",text:"Column",getSubmenuItems:d("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")}),g(s,!0)&&o.ui.registry.addNestedMenuItem("cell",{type:"nestedmenuitem",text:"Cell",getSubmenuItems:d("tablecellprops tablemergecells tablesplitcells")}),o.ui.registry.addContextMenu("table",{update:()=>(e.resetTargets(),e.targets().fold(d(""),e=>"caption"===T(e.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"))});let c=tr(Ho(o)),i=(0!==c.length&&o.queryCommandSupported("mceTableToggleClass")&&o.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:()=>k(o,c,"tableclass",e=>o.execCommand("mceTableToggleClass",!1,e)),onSetup:e.onSetupTable}),tr(jo(o)));0!==i.length&&o.queryCommandSupported("mceTableCellToggleClass")&&o.ui.registry.addNestedMenuItem("tablecellclass",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:()=>k(o,i,"tablecellclass",e=>o.execCommand("mceTableCellToggleClass",!1,e)),onSetup:e.onSetupCellOrRow}),o.queryCommandSupported("mceTableApplyCellStyle")&&(o.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:()=>k(o,Ml,"tablecellverticalalign",E(o,"vertical-align")),onSetup:e.onSetupCellOrRow}),o.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:()=>k(o,Po(o),"tablecellborderwidth",E(o,"border-width")),onSetup:e.onSetupCellOrRow}),o.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:()=>k(o,ko(o),"tablecellborderstyle",E(o,"border-style")),onSetup:e.onSetupCellOrRow}),o.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:()=>lr(o,$o(o),"background-color"),onSetup:e.onSetupCellOrRow}),o.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:()=>lr(o,Wo(o),"border-color"),onSetup:e.onSetupCellOrRow})),r("tablecaption",{icon:"table-caption",text:"Table caption",command:"mceTableToggleCaption",onSetup:e.onSetupTableWithCaption}),r("tablerowheader",{text:"Row header",icon:"table-top-header",command:"mceTableRowType",onAction:rr(o),onSetup:e.onSetupTableRowHeaders}),r("tablecolheader",{text:"Column header",icon:"table-left-header",command:"mceTableColType",onAction:nr(o),onSetup:e.onSetupTableRowHeaders})},On=e=>{var t=gn(e);No(e),sn(e),Rn(e,t),Tn(e,t),xn(e)};B.add("table",On)})();