(()=>{let a=Object.getPrototypeOf,s=(e,t,o)=>!!o(e,t.prototype)||(null==(o=e.constructor)?void 0:o.name)===t.name;var l,c=o=>e=>{return t=typeof(e=e),(null===e?"null":"object"==t&&Array.isArray(e)?"array":"object"==t&&s(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t)===o;var t},f=t=>e=>typeof e===t,v=t=>e=>t===e;let x=(e,t)=>j(e)&&s(e,t,(e,t)=>a(e)===t),y=c("string"),j=c("object"),G=e=>x(e,Object),$=c("array"),Y=v(null),X=f("boolean"),q=v(void 0),K=e=>null==e,J=e=>!K(e),Q=f("function"),Z=f("number"),ee=(o,n)=>{if($(o)){for(let e=0,t=o.length;e<t;++e)if(!n(o[e]))return!1;return!0}return!1},S=()=>{},te=e=>()=>e(),oe=(t,o)=>(...e)=>t(o.apply(null,e)),ne=(t,o)=>e=>t(o(e)),T=e=>()=>e,re=e=>e,ae=(e,t)=>e===t;function ie(t,...o){return(...e)=>{e=o.concat(e);return t.apply(null,e)}}let se=t=>e=>!t(e),le=e=>()=>{throw new Error(e)},ce=e=>e(),de=T(!1),me=T(!0);class D{constructor(e,t){this.tag=e,this.value=t}static some(e){return new D(!0,e)}static none(){return D.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?D.some(e(this.value)):D.none()}bind(e){return this.tag?e(this.value):D.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:D.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(null!=e?e:"Called getOrDie on None")}static from(e){return J(e)?D.some(e):D.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}D.singletonNone=new D(!1);let ue=Array.prototype.slice,ge=Array.prototype.indexOf,pe=Array.prototype.push,he=(e,t)=>ge.call(e,t),fe=(e,t)=>{e=he(e,t);return-1===e?D.none():D.some(e)},ve=(e,t)=>-1<he(e,t),be=(o,n)=>{for(let e=0,t=o.length;e<t;e++)if(n(o[e],e))return!0;return!1},xe=(t,o)=>{var n=[];for(let e=0;e<t;e++)n.push(o(e));return n},ye=(t,o)=>{var n=[];for(let e=0;e<t.length;e+=o){var r=ue.call(t,e,e+o);n.push(r)}return n},C=(t,o)=>{var n=t.length,r=new Array(n);for(let e=0;e<n;e++){var a=t[e];r[e]=o(a,e)}return r},E=(o,n)=>{for(let e=0,t=o.length;e<t;e++)n(o[e],e)},we=(t,o)=>{for(let e=t.length-1;0<=e;e--)o(t[e],e)},Se=(o,n)=>{var r=[],a=[];for(let e=0,t=o.length;e<t;e++){var i=o[e];(n(i,e)?r:a).push(i)}return{pass:r,fail:a}},Ce=(o,n)=>{var r=[];for(let e=0,t=o.length;e<t;e++){var a=o[e];n(a,e)&&r.push(a)}return r},ke=(e,o,n)=>(we(e,(e,t)=>{n=o(n,e,t)}),n),Oe=(e,o,n)=>(E(e,(e,t)=>{n=o(n,e,t)}),n),_e=(o,n,r)=>{for(let e=0,t=o.length;e<t;e++){var a=o[e];if(n(a,e))return D.some(a);if(r(a,e))break}return D.none()},Te=(e,t)=>_e(e,t,de),Ee=(o,n)=>{for(let e=0,t=o.length;e<t;e++)if(n(o[e],e))return D.some(e);return D.none()},De=o=>{var n=[];for(let e=0,t=o.length;e<t;++e){if(!$(o[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+o);pe.apply(n,o[e])}return n},Ae=(e,t)=>De(C(e,t)),Me=(o,n)=>{for(let e=0,t=o.length;e<t;++e)if(!0!==n(o[e],e))return!1;return!0},Be=e=>{e=ue.call(e,0);return e.reverse(),e},Ie=(e,t)=>Ce(e,e=>!ve(t,e)),Fe=(o,n)=>{var r={};for(let e=0,t=o.length;e<t;e++){var a=o[e];r[String(a)]=n(a,e)}return r},Re=e=>[e],Ne=(e,t)=>{e=ue.call(e,0);return e.sort(t),e},ze=(e,t)=>0<=t&&t<e.length?D.some(e[t]):D.none(),Ve=e=>ze(e,0),Le=e=>ze(e,e.length-1),He=Q(Array.from)?Array.from:e=>ue.call(e),Pe=(t,o)=>{for(let e=0;e<t.length;e++){var n=o(t[e],e);if(n.isSome())return n}return D.none()},Ue=Object.keys,We=Object.hasOwnProperty,je=(o,n)=>{var r=Ue(o);for(let e=0,t=r.length;e<t;e++){var a=r[e];n(o[a],a)}},Ge=(e,o)=>$e(e,(e,t)=>({k:t,v:o(e,t)})),$e=(e,o)=>{let n={};return je(e,(e,t)=>{e=o(e,t);n[e.k]=e.v}),n},Ye=o=>(e,t)=>{o[t]=e},Xe=(e,o,n,r)=>{je(e,(e,t)=>{(o(e,t)?n:r)(e,t)})},qe=(e,t)=>{var o={},n={};return Xe(e,t,Ye(o),Ye(n)),{t:o,f:n}},Ke=(e,t)=>{var o={};return Xe(e,t,Ye(o),S),o},Je=(e,o)=>{let n=[];return je(e,(e,t)=>{n.push(o(e,t))}),n},Qe=(o,n)=>{var r=Ue(o);for(let e=0,t=r.length;e<t;e++){var a=r[e],i=o[a];if(n(i,a,o))return D.some(i)}return D.none()},Ze=e=>Je(e,re),k=(e,t)=>et(e,t)?D.from(e[t]):D.none(),et=(e,t)=>We.call(e,t),tt=(e,t)=>et(e,t)&&null!=e[t],ot=(e,t,o=ae)=>e.exists(e=>o(e,t)),nt=(e,t,o=ae)=>at(e,t,o).getOr(e.isNone()&&t.isNone()),rt=t=>{let o=[];var n=e=>{o.push(e)};for(let e=0;e<t.length;e++)t[e].each(n);return o},at=(e,t,o)=>e.isSome()&&t.isSome()?D.some(o(e.getOrDie(),t.getOrDie())):D.none(),it=(e,t,o,n)=>e.isSome()&&t.isSome()&&o.isSome()?D.some(n(e.getOrDie(),t.getOrDie(),o.getOrDie())):D.none(),st=(e,t)=>null!=e?D.some(t(e)):D.none(),lt=(e,t)=>e?D.some(t):D.none(),ct=(e,t)=>e+t,dt=(e,t)=>e.substring(t),mt=(e,t,o)=>""===t||e.length>=t.length&&e.substr(o,o+t.length)===t,ut=(e,t)=>ht(e,t)?dt(e,t.length):e,gt=(e,t)=>ft(e,t)?e:ct(e,t),pt=(e,t,o=0,n)=>{e=e.indexOf(t,o);return-1!==e&&(!!q(n)||e+t.length<=n)},ht=(e,t)=>mt(e,t,0),ft=(e,t)=>mt(e,t,e.length-t.length),vt=(l=/^\s+|\s+$/g,e=>e.replace(l,"")),bt=e=>0<e.length,xt=e=>!bt(e),yt=e=>{e=parseFloat(e);return isNaN(e)?D.none():D.some(e)},wt=e=>void 0!==e.style&&Q(e.style.getPropertyValue),St=e=>{if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},O={fromHtml:(e,t)=>{var o,t=(t||document).createElement("div");if(t.innerHTML=e,!t.hasChildNodes()||1<t.childNodes.length)throw o="HTML does not have a single root node",console.error(o,e),new Error(o);return St(t.childNodes[0])},fromTag:(e,t)=>{t=(t||document).createElement(e);return St(t)},fromText:(e,t)=>{t=(t||document).createTextNode(e);return St(t)},fromDom:St,fromPoint:(e,t,o)=>D.from(e.dom.elementFromPoint(t,o)).map(St)},Ct="undefined"!=typeof window?window:Function("return this;")(),kt=(t,e)=>{let o=null!=e?e:Ct;for(let e=0;e<t.length&&null!=o;++e)o=o[t[e]];return o},Ot=(e,t)=>{e=e.split(".");return kt(e,t)},_t=(e,t)=>Ot(e,t),Tt=(e,t)=>{t=_t(e,t);if(null==t)throw new Error(e+" not available on this browser");return t},Et=Object.getPrototypeOf,Dt=e=>Tt("HTMLElement",e),At=e=>{var t=Ot("ownerDocument.defaultView",e);return j(e)&&(Dt(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(Et(e).constructor.name))},Mt=9,Bt=11,It=1,Ft=e=>e.dom.nodeName.toLowerCase(),Rt=e=>Nt(e)&&At(e.dom),Nt=(c=t=>e=>e.dom.nodeType===t)(It),zt=c(3),Vt=c(Mt),Lt=c(Bt),Ht=t=>e=>Nt(e)&&Ft(e)===t,Pt=(e,t)=>{e=e.dom;if(e.nodeType!==It)return!1;if(void 0!==e.matches)return e.matches(t);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(t);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(t);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Ut=e=>e.nodeType!==It&&e.nodeType!==Mt&&e.nodeType!==Bt||0===e.childElementCount,Wt=(e,t)=>{t=void 0===t?document:t.dom;return Ut(t)?[]:C(t.querySelectorAll(e),O.fromDom)},jt=(e,t)=>{t=void 0===t?document:t.dom;return Ut(t)?D.none():D.from(t.querySelector(e)).map(O.fromDom)},Gt=(e,t)=>e.dom===t.dom,$t=(e,t)=>{e=e.dom,t=t.dom;return e!==t&&e.contains(t)},Yt=e=>O.fromDom(e.dom.ownerDocument),Xt=e=>Vt(e)?e:Yt(e),qt=e=>O.fromDom(Xt(e).dom.documentElement),Kt=e=>O.fromDom(Xt(e).dom.defaultView),Jt=e=>D.from(e.dom.parentNode).map(O.fromDom),Qt=e=>D.from(e.dom.parentElement).map(O.fromDom),Zt=(e,t)=>{var o=Q(t)?t:de;let n=e.dom;for(var r=[];null!=n.parentNode;){var a=n.parentNode,i=O.fromDom(a);if(r.push(i),!0===o(i))break;n=a}return r},eo=e=>D.from(e.dom.offsetParent).map(O.fromDom),to=e=>D.from(e.dom.nextSibling).map(O.fromDom),oo=e=>C(e.dom.childNodes,O.fromDom),no=(e,t)=>{e=e.dom.childNodes;return D.from(e[t]).map(O.fromDom)},ro=e=>no(e,0),ao=(e,t)=>({element:e,offset:t}),io=(e,t)=>{var o=oo(e);return 0<o.length&&t<o.length?ao(o[t],0):ao(e,t)},so=e=>Lt(e)&&J(e.dom.host),lo=e=>O.fromDom(e.dom.getRootNode()),co=e=>so(e)?e:O.fromDom(Xt(e).dom.body),mo=e=>uo(e).isSome(),uo=e=>{e=lo(e);return so(e)?D.some(e):D.none()},go=e=>O.fromDom(e.dom.host),po=e=>{if(J(e.target)){var t=O.fromDom(e.target);if(Nt(t)&&ho(t)&&e.composed&&e.composedPath){t=e.composedPath();if(t)return Ve(t)}}return D.from(e.target)},ho=e=>J(e.dom.shadowRoot),fo=e=>{let t=zt(e)?e.dom.parentNode:e.dom;if(null==t||null===t.ownerDocument)return!1;let o=t.ownerDocument;return uo(O.fromDom(t)).fold(()=>o.body.contains(t),ne(fo,go))},vo=()=>bo(O.fromDom(document)),bo=e=>{e=e.dom.body;if(null==e)throw new Error("Body is not available yet");return O.fromDom(e)},xo=(e,t,o)=>{if(!(y(o)||X(o)||Z(o)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",o,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,o+"")},A=(e,t,o)=>{xo(e.dom,t,o)},yo=(e,t)=>{let o=e.dom;je(t,(e,t)=>{xo(o,t,e)})},wo=(e,t)=>{e=e.dom.getAttribute(t);return null===e?void 0:e},So=(e,t)=>D.from(wo(e,t)),Co=(e,t)=>{e=e.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(t)},ko=(e,t)=>{e.dom.removeAttribute(t)},Oo=e=>Oe(e.dom.attributes,(e,t)=>(e[t.name]=t.value,e),{}),_o=(e,t,o)=>{if(!y(o))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",o,":: Element ",e),new Error("CSS value must be a string: "+o);wt(e)&&e.style.setProperty(t,o)},To=(e,t)=>{wt(e)&&e.style.removeProperty(t)},M=(e,t,o)=>{e=e.dom;_o(e,t,o)},Eo=(e,t)=>{let o=e.dom;je(t,(e,t)=>{_o(o,t,e)})},Do=(e,t)=>{let o=e.dom;je(t,(e,t)=>{e.fold(()=>{To(o,t)},e=>{_o(o,t,e)})})},Ao=(e,t)=>{var o=e.dom,n=window.getComputedStyle(o).getPropertyValue(t);return""!==n||fo(e)?n:Mo(o,t)},Mo=(e,t)=>wt(e)?e.style.getPropertyValue(t):"",Bo=(e,t)=>{e=e.dom,e=Mo(e,t);return D.from(e).filter(e=>0<e.length)},Io=e=>{var t={},o=e.dom;if(wt(o))for(let e=0;e<o.style.length;e++){var n=o.style.item(e);t[n]=o.style[n]}return t},Fo=(e,t,o)=>{e=O.fromTag(e);return M(e,t,o),Bo(e,t).isSome()},Ro=(e,t)=>{var o=e.dom;To(o,t),ot(So(e,"style").map(vt),"")&&ko(e,"style")},No=e=>e.dom.offsetWidth,zo=(v=(o,n)=>{var e=e=>{var t=n(e);return t<=0||null===t?(e=Ao(e,o),parseFloat(e)||0):t};let r=(o,e)=>Oe(e,(e,t)=>{t=Ao(o,t),t=void 0===t?0:parseInt(t,10);return isNaN(t)?e:e+t},0);return{set:(e,t)=>{if(!Z(t)&&!t.match(/^[0-9]+$/))throw new Error(o+".set accepts only positive integer values. Value was "+t);e=e.dom;wt(e)&&(e.style[o]=t+"px")},get:e,getOuter:e,aggregate:r,max:(e,t,o)=>{e=r(e,o);return e<t?t-e:0}}})("height",e=>{var t=e.dom;return fo(e)?t.getBoundingClientRect().height:t.offsetHeight}),Vo=e=>zo.get(e),Lo=e=>zo.getOuter(e),Ho=(o,n)=>({left:o,top:n,translate:(e,t)=>Ho(o+e,n+t)}),Po=Ho,Uo=e=>{e=e.getBoundingClientRect();return Po(e.left,e.top)},Wo=(e,t)=>void 0!==e?e:void 0!==t?t:0,jo=e=>{var t,o,n=e.dom.ownerDocument,r=n.body,a=n.defaultView,n=n.documentElement;return r===e.dom?Po(r.offsetLeft,r.offsetTop):(t=Wo(null==a?void 0:a.pageYOffset,n.scrollTop),a=Wo(null==a?void 0:a.pageXOffset,n.scrollLeft),o=Wo(n.clientTop,r.clientTop),n=Wo(n.clientLeft,r.clientLeft),Go(e).translate(a-n,t-o))},Go=e=>{var t=e.dom,o=t.ownerDocument.body;return o===t?Po(o.offsetLeft,o.offsetTop):fo(e)?Uo(t):Po(0,0)},$o=v("width",e=>e.dom.offsetWidth),Yo=(e,t)=>$o.set(e,t),Xo=e=>$o.get(e),qo=e=>$o.getOuter(e),Ko=t=>{let o=!1,n;return(...e)=>(o||(o=!0,n=t.apply(null,e)),n)},Jo=(t,o)=>{for(let e=0;e<t.length;e++){var n=t[e];if(n.test(o))return n}},Qo=()=>Zo(0,0),Zo=(e,t)=>({major:e,minor:t}),en={nu:Zo,detect:(e,t)=>{t=String(t).toLowerCase();return 0===e.length?Qo():((e,t)=>{let o=Jo(e,t);return o?(e=e=>Number(t.replace(o,"$"+e)),Zo(e(1),e(2))):{major:0,minor:0}})(e,t)},unknown:Qo},tn=(e,t)=>{let o=String(t).toLowerCase();return Te(e,e=>e.search(o))},on=(v=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>pt(e,"edge/")&&pt(e,"chrome")&&pt(e,"safari")&&pt(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,f=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/],search:e=>pt(e,"chrome")&&!pt(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>pt(e,"msie")||pt(e,"trident")},{name:"Opera",versionRegexes:[f,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:(c=t=>e=>pt(e,t))("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:c("firefox")},{name:"Safari",versionRegexes:[f,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(pt(e,"safari")||pt(e,"mobile/"))&&pt(e,"applewebkit")}],f=[{name:"Windows",search:c("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>pt(e,"iphone")||pt(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:c("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:c("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:c("linux"),versionRegexes:[]},{name:"Solaris",search:c("sunos"),versionRegexes:[]},{name:"FreeBSD",search:c("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:c("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],{browsers:T(v),oses:T(f)}),nn="Edge",rn="Chromium",an="IE",sn="Opera",ln="Firefox",cn="Safari",dn=e=>{let t=e.current;var o=e=>()=>t===e;return{current:t,version:e.version,isEdge:o(nn),isChromium:o(rn),isIE:o(an),isOpera:o(sn),isFirefox:o(ln),isSafari:o(cn)}},mn={unknown:()=>dn({current:void 0,version:en.unknown()}),nu:dn,edge:T(nn),chromium:T(rn),ie:T(an),opera:T(sn),firefox:T(ln),safari:T(cn)},un="Windows",gn="iOS",pn="Android",hn="Linux",fn="macOS",vn="Solaris",bn="FreeBSD",xn="ChromeOS",yn=e=>{let t=e.current;var o=e=>()=>t===e;return{current:t,version:e.version,isWindows:o(un),isiOS:o(gn),isAndroid:o(pn),isMacOS:o(fn),isLinux:o(hn),isSolaris:o(vn),isFreeBSD:o(bn),isChromeOS:o(xn)}},wn={unknown:()=>yn({current:void 0,version:en.unknown()}),nu:yn,windows:T(un),ios:T(gn),android:T(pn),linux:T(hn),macos:T(fn),solaris:T(vn),freebsd:T(bn),chromeos:T(xn)},Sn={detect:(t,e,o)=>{let r=on.browsers();var n,a,i,s,l,c,d,m=on.oses(),e=e.bind(e=>{return n=r,e=e,Pe(e.brands,t=>{let o=t.brand.toLowerCase();return Te(n,e=>o===(null==(e=e.brand)?void 0:e.toLowerCase())).map(e=>({current:e.name,version:en.nu(parseInt(t.version,10),0)}))});var n}).orThunk(()=>{return e=r,o=t,tn(e,o).map(e=>{var t=en.detect(e.versionRegexes,o);return{current:e.name,version:t}});var e,o}).fold(mn.unknown,mn.nu),m=(m=m,n=t,tn(m,n).map(e=>{var t=en.detect(e.versionRegexes,n);return{current:e.name,version:t}}).fold(wn.unknown,wn.nu)),u=(i=e,s=t,o=o,u=(a=m).isiOS()&&!0===/ipad/i.test(s),l=a.isiOS()&&!u,c=a.isiOS()||a.isAndroid(),d=c||o("(pointer:coarse)"),o=u||!l&&c&&o("(min-device-width:768px)"),c=l||c&&!o,i=i.isSafari()&&a.isiOS()&&!1===/safari/i.test(s),s=!c&&!o&&!i,{isiPad:T(u),isiPhone:T(l),isTablet:T(o),isPhone:T(c),isTouch:T(d),isAndroid:a.isAndroid,isiOS:a.isiOS,isWebView:T(i),isDesktop:T(s)});return{browser:e,os:m,deviceType:u}}},Cn=e=>window.matchMedia(e).matches,kn=Ko(()=>Sn.detect(window.navigator.userAgent,D.from(window.navigator.userAgentData),Cn)),On=()=>kn(),_n=(e,t,o,n,r,a,i)=>({target:e,x:t,y:o,stop:n,prevent:r,kill:a,raw:i}),Tn=e=>{var t=O.fromDom(po(e).getOr(e.target)),o=()=>e.stopPropagation(),n=()=>e.preventDefault(),r=oe(n,o);return _n(t,e.clientX,e.clientY,o,n,r,e)},En=(t,o)=>e=>{t(e)&&o(Tn(e))},Dn=(e,t,o,n,r)=>{o=En(o,n);return e.dom.addEventListener(t,o,r),{unbind:ie(Bn,e,t,o,r)}},An=(e,t,o,n)=>Dn(e,t,o,n,!1),Mn=(e,t,o,n)=>Dn(e,t,o,n,!0),Bn=(e,t,o,n)=>{e.dom.removeEventListener(t,o,n)},In=(t,o)=>{Jt(t).each(e=>{e.dom.insertBefore(o.dom,t.dom)})},Fn=(e,t)=>{to(e).fold(()=>{Jt(e).each(e=>{Nn(e,t)})},e=>{In(e,t)})},Rn=(t,o)=>{ro(t).fold(()=>{Nn(t,o)},e=>{t.dom.insertBefore(o.dom,e.dom)})},Nn=(e,t)=>{e.dom.appendChild(t.dom)},zn=(e,t,o)=>{no(e,o).fold(()=>{Nn(e,t)},e=>{In(e,t)})},Vn=(t,e)=>{E(e,e=>{Nn(t,e)})},Ln=e=>{e.dom.textContent="",E(oo(e),e=>{Hn(e)})},Hn=e=>{e=e.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},Pn=e=>{var e=void 0!==e?e.dom:document,t=e.body.scrollLeft||e.documentElement.scrollLeft,e=e.body.scrollTop||e.documentElement.scrollTop;return Po(t,e)},Un=(e,t,o)=>{o=(void 0!==o?o.dom:document).defaultView;o&&o.scrollTo(e,t)},Wn=e=>{e=void 0===e?window:e;return On().browser.isFirefox()?D.none():D.from(e.visualViewport)},jn=(e,t,o,n)=>({x:e,y:t,width:o,height:n,right:e+o,bottom:t+n}),Gn=e=>{let o=void 0===e?window:e;e=o.document;let n=Pn(O.fromDom(e));return Wn(o).fold(()=>{var e=o.document.documentElement,t=e.clientWidth,e=e.clientHeight;return jn(n.left,n.top,t,e)},e=>jn(Math.max(e.pageLeft,n.left),Math.max(e.pageTop,n.top),e.width,e.height))},$n=()=>O.fromDom(document),Yn=(o,e)=>o.view(e).fold(T([]),e=>{var t=o.owner(e),t=Yn(o,t);return[e].concat(t)}),Xn=(e,t)=>{e=t.owner(e),t=Yn(t,e);return D.some(t)};var qn,Kn=Object.freeze({__proto__:null,view:e=>(e.dom===document?D.none():D.from(null==(e=e.dom.defaultView)?void 0:e.frameElement)).map(O.fromDom),owner:e=>Yt(e)});let Jn=o=>{var e=$n();let n=Pn(e);return Xn(o,Kn).fold(ie(jo,o),e=>{var t=Go(o),e=ke(e,(e,t)=>{t=Go(t);return{left:e.left+t.left,top:e.top+t.top}},{left:0,top:0});return Po(e.left+t.left+n.left,e.top+t.top+n.top)})},Qn=(e,t,o)=>({point:e,width:t,height:o}),Zn=(e,t,o,n)=>({x:e,y:t,width:o,height:n}),er=(e,t,o,n)=>({x:e,y:t,width:o,height:n,right:e+o,bottom:t+n}),tr=e=>{var t=jo(e),o=qo(e),e=Lo(e);return er(t.left,t.top,o,e)},or=e=>{var t=Jn(e),o=qo(e),e=Lo(e);return er(t.left,t.top,o,e)},nr=(e,t)=>{var o=Math.max(e.x,t.x),n=Math.max(e.y,t.y),r=Math.min(e.right,t.right)-o,e=Math.min(e.bottom,t.bottom)-n;return er(o,n,r,e)},rr=(e,t)=>Oe(t,(e,t)=>nr(e,t),e),ar=()=>Gn(window),B=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}},ir=e=>{let t=B(D.none()),o=()=>t.get().each(e);return{clear:()=>{o(),t.set(D.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:e=>{o(),t.set(D.some(e))}}},sr=()=>ir(e=>e.unbind()),lr=()=>{let t=ir(S);return{...t,on:e=>t.get().each(e)}},cr=(c=tinymce.util.Tools.resolve("tinymce.ThemeManager"),o=>{var e=e=>e(o),t=T(o),n=()=>r;let r={tag:!0,inner:o,fold:(e,t)=>t(o),isValue:me,isError:de,map:e=>I.value(e(o)),mapError:n,bind:e,exists:e,forall:e,getOr:t,or:n,getOrThunk:t,orThunk:n,getOrDie:t,each:e=>{e(o)},toOptional:()=>D.some(o)};return r}),dr=o=>{var e=()=>t;let t={tag:!1,inner:o,fold:(e,t)=>e(o),isValue:de,isError:me,map:e,mapError:e=>I.error(e(o)),bind:e,exists:de,forall:me,getOr:re,or:re,getOrThunk:ce,orThunk:ce,getOrDie:le(String(o)),each:S,toOptional:D.none};return t},I={value:cr,error:dr,fromOption:(e,t)=>e.fold(()=>dr(t),cr)},mr=((v=qn=qn||{})[v.Error=0]="Error",v[v.Value=1]="Value",(e,t,o)=>e.stype===qn.Error?t(e.serror):o(e.svalue)),ur=e=>({stype:qn.Value,svalue:e}),gr=e=>({stype:qn.Error,serror:e}),pr={fromResult:e=>e.fold(gr,ur),toResult:e=>mr(e,I.error,I.value),svalue:ur,partition:e=>{let t=[],o=[];return E(e,e=>{mr(e,e=>o.push(e),e=>t.push(e))}),{values:t,errors:o}},serror:gr,bind:(e,t)=>e.stype===qn.Value?t(e.svalue):e,bindError:(e,t)=>e.stype===qn.Error?t(e.serror):e,map:(e,t)=>e.stype===qn.Value?{stype:qn.Value,svalue:t(e.svalue)}:e,mapError:(e,t)=>e.stype===qn.Error?{stype:qn.Error,serror:t(e.serror)}:e,fold:mr},hr=(e,t,o,n)=>({tag:"field",key:e,newKey:t,presence:o,prop:n}),fr=(e,t,o)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return o(e.newKey,e.instantiator)}},vr=(f=a=>(...t)=>{if(0===t.length)throw new Error("Can't merge zero objects");var o={};for(let e=0;e<t.length;e++){var n,r=t[e];for(n in r)et(r,n)&&(o[n]=a(o[n],r[n]))}return o})((e,t)=>G(e)&&G(t)?vr(e,t):t),br=f((e,t)=>t),xr=()=>({tag:"required",process:{}}),yr=e=>({tag:"defaultedThunk",process:e}),wr=e=>yr(T(e)),Sr=()=>({tag:"option",process:{}}),Cr=e=>({tag:"mergeWithThunk",process:e}),kr=e=>oe(pr.serror,De)(e),Or={consolidateObj:(e,t)=>{var e=pr.partition(e);return 0<e.errors.length?kr(e.errors):(e=e.values,t=t,0<e.length?pr.svalue(vr(t,br.apply(void 0,e))):pr.svalue(t))},consolidateArr:e=>{e=pr.partition(e);return 0<e.errors.length?kr(e.errors):pr.svalue(e.values)}},_r=e=>j(e)&&100<Ue(e).length?" removed due to size":JSON.stringify(e,null,2),Tr=e=>{e=10<e.length?e.slice(0,10).concat([{path:[],getErrorInfo:T("... (only showing first ten failures)")}]):e;return C(e,e=>"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo())},Er=(e,t)=>pr.serror([{path:e,getErrorInfo:t}]),Dr=(e,t,o)=>Er(e,()=>'Could not find valid *required* value for "'+t+'" in '+_r(o)),Ar=(e,t)=>Er(e,()=>'Choice schema did not contain choice key: "'+t+'"'),Mr=(e,t,o)=>Er(e,()=>'The chosen schema: "'+o+'" did not exist in branches: '+_r(t)),Br=(e,t)=>Er(e,()=>"There are unsupported fields: ["+t.join(", ")+"] specified"),Ir=(e,t)=>Er(e,T(t)),Fr=o=>({extract:(t,e)=>pr.bindError(o(e),e=>Ir(t,e)),toString:T("val")}),Rr=Fr(pr.svalue),Nr=(e,t,o,n)=>k(t,o).fold(()=>Dr(e,o,t),n),zr=(e,t,o,n)=>n(k(e,t).getOrThunk(()=>o(e))),Vr=(e,t,o)=>o(k(e,t)),Lr=(t,e,o,n)=>n(k(t,e).map(e=>!0===e?o(t):e)),Hr=(t,o,n,r,a)=>{let i=e=>a.extract(o.concat([r]),e);var e=e=>e.fold(()=>pr.svalue(D.none()),e=>{e=a.extract(o.concat([r]),e);return pr.map(e,D.some)});switch(t.tag){case"required":return Nr(o,n,r,i);case"defaultedThunk":return zr(n,r,t.process,i);case"option":return Vr(n,r,e);case"defaultedOptionThunk":return Lr(n,r,t.process,e);case"mergeWithThunk":return zr(n,r,T({}),e=>{e=vr(t.process(n),e);return i(e)})}},Pr=(r,a,e)=>{let i={},s=[];for(var t of e)fr(t,(e,t,o,n)=>{o=Hr(o,r,a,e,n);pr.fold(o,e=>{s.push(...e)},e=>{i[t]=e})},(e,t)=>{i[e]=t(a)});return 0<s.length?pr.serror(s):pr.svalue(i)},Ur=(v=o=>({extract:(e,t)=>o().extract(e,t),toString:()=>o().toString()}),e=>Ue(Ke(e,J))),Wr=e=>{let n=m(e),r=ke(e,(t,e)=>fr(e,e=>vr(t,{[e]:!0}),T(t)),{});return{extract:(e,t)=>{var o=X(t)?[]:Ur(t),o=Ce(o,e=>!tt(r,e));return 0===o.length?n.extract(e,t):Br(e,o)},toString:n.toString}},m=o=>({extract:(e,t)=>Pr(e,t,o),toString:()=>"obj{\n"+C(o,e=>fr(e,(e,t,o,n)=>e+" -> "+n.toString(),(e,t)=>"state("+e+")")).join("\n")+"}"}),jr=n=>({extract:(o,e)=>{e=C(e,(e,t)=>n.extract(o.concat(["["+t+"]"]),e));return Or.consolidateArr(e)},toString:()=>"array("+n.toString()+")"}),Gr=(f=(a,e)=>{let i=void 0!==e?e:re;return{extract:(e,t)=>{var o,n=[];for(o of a){var r=o.extract(e,t);if(r.stype===qn.Value)return{stype:qn.Value,svalue:i(r.svalue)};n.push(r)}return Or.consolidateArr(n)},toString:()=>"oneOf("+C(a,e=>e.toString()).join(", ")+")"}},(r,a)=>({extract:(t,o)=>{var e=Ue(o),n=(n=t,e=e,jr(Fr(r)).extract(n,e));return pr.bind(n,e=>{e=C(e,e=>hr(e,e,xr(),a));return m(e).extract(t,o)})},toString:()=>"setOf("+a.toString()+")"})),$r=oe(jr,m),Yr=T(Rr),Xr=(hB=(o,n)=>Fr(e=>{var t=typeof e;return o(e)?pr.svalue(e):pr.serror(`Expected type: ${n} but got: `+t)}))(Z,"number"),qr=hB(y,"string"),Kr=hB(X,"boolean"),Jr=hB(Q,"function"),Qr=t=>{if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every(e=>Qr(t[e]));default:return!1}},Zr=Fr(e=>Qr(e)?pr.svalue(e):pr.serror("Expected value to be acceptable for sending via postMessage")),ea=(t,o,e,n)=>k(e,n).fold(()=>Mr(t,e,n),e=>e.extract(t.concat(["branch: "+n]),o)),ta=(e,n)=>({extract:(t,o)=>k(o,e).fold(()=>Ar(t,e),e=>ea(t,o,n,e)),toString:()=>"chooseOn("+e+"). Possible values: "+Ue(n)}),oa=t=>Fr(e=>t(e).fold(pr.serror,pr.svalue)),na=(hB=(t,e)=>Gr(e=>pr.fromResult(t(e)),e),(e,t,o)=>{t=t.extract([e],o);return pr.mapError(t,e=>({input:o,errors:e}))}),ra=(e,t,o)=>pr.toResult(na(e,t,o)),aa=e=>e.fold(e=>{throw new Error(sa(e))},re),ia=(e,t,o)=>aa(ra(e,t,o)),sa=e=>"Errors: \n"+Tr(e.errors).join("\n")+"\n\nInput object: "+_r(e.input),la=(e,t)=>ta(e,Ge(t,m));var ca=(e,t)=>(e=>{let o=Ko(e);return{extract:(e,t)=>o().extract(e,t),toString:()=>o().toString()}})(t);let da=hr,ma=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),ua=t=>oa(e=>ve(t,e)?I.value(e):I.error(`Unsupported value: "${e}", choose one of "${t.join(", ")}".`)),i=e=>da(e,e,xr(),Yr()),ga=(e,t)=>da(e,e,xr(),t);var pa=e=>ga(e,qr),ha=(e,t)=>da(e,e,xr(),ua(t)),fa=e=>ga(e,Jr);let va=(e,t)=>da(e,e,xr(),m(t));var ba=(e,t)=>da(e,e,xr(),$r(t)),xa=(e,t)=>da(e,e,xr(),jr(t));let ya=e=>da(e,e,Sr(),Yr()),wa=(e,t)=>da(e,e,Sr(),t);var Sa=e=>wa(e,Xr);let Ca=e=>wa(e,qr);var ka=(e,t)=>wa(e,ua(t)),Oa=e=>wa(e,Jr),_a=(e,t)=>wa(e,jr(t));let Ta=(e,t)=>wa(e,m(t)),Ea=(e,t)=>wa(e,Wr(t)),u=(e,t)=>da(e,e,wr(t),Yr()),Da=(e,t,o)=>da(e,e,wr(t),o);var Aa=(e,t)=>Da(e,t,Xr);let Ma=(e,t)=>Da(e,t,qr),Ba=(e,t,o)=>Da(e,t,ua(o));var Ia=(e,t)=>Da(e,t,Kr),Fa=(e,t)=>Da(e,t,Jr),Ra=(e,t,o)=>Da(e,t,jr(o));let Na=(e,t,o)=>Da(e,t,m(o));const za=a=>{if(!$(a))throw new Error("cases must be an array");if(0===a.length)throw new Error("there must be at least one case");let i=[],s={};return E(a,(e,t)=>{var o=Ue(e);if(1!==o.length)throw new Error("one and only one name per case");let n=o[0],r=e[n];if(void 0!==s[n])throw new Error("duplicate key detected:"+n);if("cata"===n)throw new Error("cannot have a case named cata (sorry)");if(!$(r))throw new Error("case arguments must be an array");i.push(n),s[n]=(...o)=>{var e=o.length;if(e!==r.length)throw new Error("Wrong number of arguments to case "+n+". Expected "+r.length+" ("+r+"), got "+e);return{fold:(...e)=>{if(e.length!==a.length)throw new Error("Wrong number of arguments to fold. Expected "+a.length+", got "+e.length);return e[t].apply(null,o)},match:e=>{let t=Ue(e);if(i.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+i.join(",")+"\nActual: "+t.join(","));if(Me(i,e=>ve(t,e)))return e[n].apply(null,o);throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+i.join(", "))},log:e=>{console.log(e,{constructors:i,constructor:n,params:o})}}}}),s};za([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);let Va=e=>{let t=[],o=[];return E(e,e=>{e.fold(e=>{t.push(e)},e=>{o.push(e)})}),{errors:t,values:o}},La=(e,t)=>({[e]:t}),Ha=e=>{let t={};return E(e,e=>{t[e.key]=e.value}),t},Pa=(e,t)=>((e,o)=>{let n={};return je(e,(e,t)=>{ve(o,t)||(n[t]=e)}),n})(e,t),Ua=(e,t)=>La(e,t),Wa=e=>Ha(e),ja=(e,t)=>0===e.length?I.value(t):I.value(vr(t,br.apply(void 0,e))),Ga=e=>I.error(De(e)),$a=(e,t)=>{e=Va(e);return 0<e.errors.length?Ga(e.errors):ja(e.values,t)},Ya=e=>Q(e)?e:de,Xa=(e,t,o)=>{let n=e.dom;for(var r=Ya(o);n.parentNode;){n=n.parentNode;var a=O.fromDom(n),i=t(a);if(i.isSome())return i;if(r(a))break}return D.none()},qa=(e,t,o)=>{var n=t(e);let r=Ya(o);return n.orThunk(()=>r(e)?D.none():Xa(e,t,r))},Ka=(e,t)=>Gt(e.element,t.event.target),Ja={can:me,abort:de,run:S},Qa=e=>{if(tt(e,"can")||tt(e,"abort")||tt(e,"run"))return{...Ja,...e};throw new Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!")},Za=(e,n)=>(...o)=>Oe(e,(e,t)=>e&&n(t).apply(void 0,o),!0),ei=(e,n)=>(...o)=>Oe(e,(e,t)=>e||n(t).apply(void 0,o),!1),ti=e=>Q(e)?{can:me,abort:de,run:e}:e,oi=e=>({can:Za(e,e=>e.can),abort:ei(e,e=>e.abort),run:(...t)=>{E(e,e=>{e.run.apply(void 0,t)})}});var e=T;let ni=e("touchstart"),ri=e("touchmove"),ai=e("touchend"),ii=e("touchcancel"),si=e("mousedown"),li=e("mousemove"),ci=e("mouseout"),di=e("mouseup"),mi=e("mouseover"),ui=e("focusin"),gi=e("focusout"),pi=e("keydown"),hi=e("keyup"),fi=e("input"),vi=e("change"),bi=e("click"),xi=e("transitioncancel"),yi=e("transitionend"),wi=e("transitionstart"),Si=e("selectstart");var Ci,ki={tap:(e=e=>T("alloy."+e))("tap")};let Oi=e("focus"),_i=e("blur.post"),Ti=e("paste.post"),Ei=e("receive"),Di=e("execute"),Ai=e("focus.item"),Mi=ki.tap,Bi=e("longpress"),Ii=e("sandbox.close"),Fi=e("typeahead.cancel"),Ri=e("system.init"),Ni=e("system.touchmove"),zi=e("system.touchend"),Vi=e("system.scroll"),Li=e("system.resize"),Hi=e("system.attached"),Pi=e("system.detached"),Ui=e("system.dismissRequested"),Wi=(ki=e("system.repositionRequested"),e("focusmanager.shifted")),ji=e("slotcontainer.visibility"),Gi=e("system.external.element.scroll"),$i=e("change.tab"),Yi=e("dismiss.tab"),Xi=e("highlight"),qi=e("dehighlight"),b=(e,t)=>{Qi(e,e.element,t,{})},_=(e,t,o)=>{Qi(e,e.element,t,o)},Ki=e=>{b(e,Di())},Ji=(e,t,o)=>{Qi(e,t,o,{})},Qi=(e,t,o,n)=>{n={target:t,...n};e.getSystem().triggerEvent(o,t,n)},Zi=(e,t,o,n)=>{n={...n,target:t};e.getSystem().triggerEvent(o,t,n)},es=(e,t,o,n)=>{e.getSystem().triggerEvent(o,t,n.event)},ts=e=>Wa(e),os=(e,t)=>({key:e,value:Qa({abort:t})}),ns=e=>({key:e,value:Qa({run:(e,t)=>{t.event.prevent()}})}),F=(e,t)=>({key:e,value:Qa({run:t})}),rs=(e,o,n)=>({key:e,value:Qa({run:(e,t)=>{o.apply(void 0,[e,t].concat(n))}})}),as=e=>o=>({key:e,value:Qa({run:(e,t)=>{Ka(e,t)&&o(e,t)}})}),is=(e,t,o)=>{var n,r,t=t.partUids[o];return n=e,r=t,F(n,(e,t)=>{e.getSystem().getByUid(r).each(e=>{es(e,e.element,n,t)})})},ss=(e,r)=>F(e,(t,e)=>{let o=e.event;var n=t.getSystem().getByDom(o.target).getOrThunk(()=>qa(o.target,e=>t.getSystem().getByDom(e).toOptional(),de).getOr(t));r(t,n,e)}),ls=e=>F(e,(e,t)=>{t.cut()}),cs=(e,t)=>as(e)(t),ds=as(Hi()),ms=as(Pi()),us=as(Ri()),gs=(Ci=Di(),e=>F(Ci,e)),ps=(e,t,o)=>{var o=o.toString(),n=o.indexOf(")")+1,r=o.indexOf("(");let a=o.substring(r+1,n-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:hs(a.slice(0,1).concat(a.slice(3)))}),e},hs=e=>C(e,e=>ft(e,"/*")?e.substring(0,e.length-"/*".length):e),fs=(e,t)=>{var o=e.toString(),n=o.indexOf(")")+1,r=o.indexOf("(");let a=o.substring(r+1,n-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:t,parameters:hs(a)}),e},vs=(e,t)=>{var t=t.toString(),o=t.indexOf(")")+1,n=t.indexOf("(");let r=t.substring(n+1,o-1).split(/,\s*/);return e.toFunctionAnnotation=()=>({name:"OVERRIDE",parameters:hs(r.slice(1))}),e},bs=e=>({classes:q(e.classes)?[]:e.classes,attributes:q(e.attributes)?{}:e.attributes,styles:q(e.styles)?{}:e.styles}),xs=(e,t)=>({...e,attributes:{...e.attributes,...t.attributes},styles:{...e.styles,...t.styles},classes:e.classes.concat(t.classes)}),ys=(o,n,r)=>us((e,t)=>{r(e,o,n)}),ws=(e,t,o,n,r,a)=>{var i=Wr(e),e=Ta(t,[Ea("config",e)]);return ks(i,e,t,o,n,r,a)},Ss=(t,r,a)=>ps((o,...e)=>{let n=[o].concat(e);return o.config({name:T(t)}).fold(()=>{throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+a)},e=>{var t=Array.prototype.slice.call(n,1);return r.apply(void 0,[o,e.config,e.state].concat(t))})},a,r),Cs=e=>({key:e,value:void 0}),ks=(o,e,n,t,r,a,i)=>{let s=e=>tt(e,n)?e[n]():D.none();r=Ge(r,(e,t)=>Ss(n,e,t));let l={...Ge(a,(e,t)=>fs(e,t)),...r,revoke:ie(Cs,n),config:e=>{var t=ia(n+"-config",o,e);return{key:n,value:{config:t,me:l,configAsRaw:Ko(()=>ia(n+"-config",o,e)),initialConfig:e,state:i}}},schema:T(e),exhibit:(e,o)=>at(s(e),k(t,"exhibit"),(e,t)=>t(o,e.config,e.state)).getOrThunk(()=>bs({})),name:T(n),handlers:e=>s(e).map(e=>k(t,"events").getOr(()=>({}))(e.config,e.state)).getOr({})};return l},Os={init:()=>_s({readState:T("No State required")})},_s=e=>e,R=e=>Wa(e),Ts=Wr([i("fields"),i("name"),u("active",{}),u("apis",{}),u("state",Os),u("extra",{})]),Es=e=>{e=ia("Creating behaviour: "+e.name,Ts,e);return ws(e.fields,e.name,e.active,e.apis,e.extra,e.state)},Ds=Wr([i("branchKey"),i("branches"),i("name"),u("active",{}),u("apis",{}),u("state",Os),u("extra",{})]),As=(e=e=>{var t,o,n,r,a,i,e=ia("Creating behaviour: "+e.name,Ds,e);return t=la(e.branchKey,e.branches),o=e.name,n=e.active,r=e.apis,a=e.extra,e=e.state,i=t,t=Ta(o,[wa("config",t)]),ks(i,t,o,n,r,a,e)},T(void 0)),Ms=(e,t)=>{e=wo(e,t);return void 0===e||""===e?[]:e.split(" ")},Bs=(e,t,o)=>{o=Ms(e,t).concat([o]);return A(e,t,o.join(" ")),!0},Is=(e,t,o)=>{var n=Ce(Ms(e,t),e=>e!==o);return 0<n.length?A(e,t,n.join(" ")):ko(e,t),!1},Fs=e=>void 0!==e.dom.classList,Rs=e=>Ms(e,"class"),Ns=(e,t)=>Bs(e,"class",t),zs=(e,t)=>Is(e,"class",t),Vs=(e,t)=>(ve(Rs(e),t)?zs:Ns)(e,t),Ls=(e,t)=>{Fs(e)?e.dom.classList.add(t):Ns(e,t)},Hs=e=>{0===(Fs(e)?e.dom.classList:Rs(e)).length&&ko(e,"class")},Ps=(e,t)=>{Fs(e)?e.dom.classList.remove(t):zs(e,t),Hs(e)},Us=(e,t)=>{t=Fs(e)?e.dom.classList.toggle(t):Vs(e,t);return Hs(e),t},Ws=(e,t)=>Fs(e)&&e.dom.classList.contains(t),js=(t,e)=>{E(e,e=>{Ls(t,e)})},Gs=(t,e)=>{E(e,e=>{Ps(t,e)})},$s=(t,e)=>{E(e,e=>{Us(t,e)})},Ys=(t,e)=>Me(e,e=>Ws(t,e)),Xs=e=>{var t=e.dom.classList,o=new Array(t.length);for(let e=0;e<t.length;e++){var n=t.item(e);null!==n&&(o[e]=n)}return o},qs=e=>(Fs(e)?Xs:Rs)(e),Ks=(e,t,o,n,r)=>{var a=e=>e+"px";return{position:e,left:t.map(a),top:o.map(a),right:n.map(a),bottom:r.map(a)}},Js=e=>({...e,position:D.some(e.position)}),Qs=(e,t)=>{Do(e,Js(t))},Zs=e=>(ot(Bo(e,"position"),"fixed")?D.none():eo(e)).orThunk(()=>{let t=O.fromTag("span");return Jt(e).bind(e=>{Nn(e,t);e=eo(t);return Hn(t),e})}),el=e=>Zs(e).map(jo).getOrThunk(()=>Po(0,0)),tl=(e,t)=>{var o=e.element;Ls(o,t.transitionClass),Ps(o,t.fadeOutClass),Ls(o,t.fadeInClass),t.onShow(e)},ol=(e,t)=>{var o=e.element;Ls(o,t.transitionClass),Ps(o,t.fadeInClass),Ls(o,t.fadeOutClass),t.onHide(e)},nl=(e,t)=>e.y<t.bottom&&e.bottom>t.y,rl=(e,t)=>e.y>=t.y,al=(e,t)=>e.bottom<=t.bottom,il=(e,t,o)=>({location:"top",leftX:t,topY:o.bounds.y-e.y}),sl=(e,t,o)=>({location:"bottom",leftX:t,bottomY:e.bottom-o.bounds.bottom}),ll=e=>e.box.x-e.win.x,cl=(e,t,o)=>{let n=t.win,r=t.box,a=ll(t);return Pe(e,e=>{switch(e){case"bottom":return al(r,o.bounds)?D.none():D.some(sl(n,a,o));case"top":return rl(r,o.bounds)?D.none():D.some(il(n,a,o));default:return D.none()}}).getOr({location:"no-dock"})},dl=(e,t,o)=>Me(e,e=>{switch(e){case"bottom":return al(t,o.bounds);case"top":return rl(t,o.bounds)}}),ml=(t,e)=>{e=e.optScrollEnv.fold(T(t.bounds.y),e=>e.scrollElmTop+(t.bounds.y-e.currentScrollTop));return Po(t.bounds.x,e)},ul=(t,e)=>{e=e.optScrollEnv.fold(T(t.y),e=>t.y+e.currentScrollTop-e.scrollElmTop);return Po(t.x,e)},gl=(o,n,e)=>e.getInitialPos().map(e=>{var t=ml(e,n);return{box:er(t.left,t.top,Xo(o),Vo(o)),location:e.location}}),pl=(e,t,o,n,r)=>{o=ul(t,o),o=er(o.left,o.top,t.width,t.height);n.setInitialPos({style:Io(e),position:Ao(e,"position")||"static",bounds:o,location:r.location})},hl=(e,t,o,n,r)=>{n.getInitialPos().fold(()=>pl(e,t,o,n,r),()=>S)},fl=(r,a,t)=>t.getInitialPos().bind(e=>{switch(t.clearInitialPos(),e.position){case"static":return D.some({morph:"static"});case"absolute":var n=Zs(r).getOr(vo());let t=tr(n),o=null!=(n=n.dom.scrollTop)?n:0;return D.some({morph:"absolute",positionCss:Ks("absolute",k(e.style,"left").map(e=>a.x-t.x),k(e.style,"top").map(e=>a.y-t.y+o),k(e.style,"right").map(e=>t.right-a.right),k(e.style,"bottom").map(e=>t.bottom-a.bottom))});default:return D.none()}}),vl=(t,o,n)=>gl(t,o,n).filter(({box:e})=>dl(n.getModes(),e,o)).bind(({box:e})=>fl(t,e,n)),bl=e=>{switch(e.location){case"top":return D.some({morph:"fixed",positionCss:Ks("fixed",D.some(e.leftX),D.some(e.topY),D.none(),D.none())});case"bottom":return D.some({morph:"fixed",positionCss:Ks("fixed",D.some(e.leftX),D.none(),D.none(),D.some(e.bottomY))});default:return D.none()}},xl=(e,t,o)=>{var n=tr(e),r=ar(),r=cl(o.getModes(),{win:r,box:n},t);return"top"===r.location||"bottom"===r.location?(pl(e,n,t,o,r),bl(r)):D.none()},yl=(t,n,o)=>vl(t,n,o).orThunk(()=>n.optScrollEnv.bind(e=>gl(t,n,o)).bind(({box:e,location:t})=>{var o=ar(),e=ll({win:o,box:e}),t=("top"===t?il:sl)(o,e,n);return bl(t)})),wl=(e,t,o)=>{e=e.element;return(ot(Bo(e,"position"),"fixed")?yl:xl)(e,t,o)},Sl=(e,t,o)=>{let n=e.element;return gl(n,t,o).bind(({box:e})=>fl(n,e,o))},Cl=(t,e,o)=>{o.setDocked(!1),E(["left","right","top","bottom","position"],e=>Ro(t.element,e)),e.onUndocked(t)},kl=(e,t,o,n)=>{var r="fixed"===n.position;o.setDocked(r),Qs(e.element,n),(r?t.onDocked:t.onUndocked)(e)},Ol=(o,e,n,r,a=!1)=>{e.contextual.each(t=>{t.lazyContext(o).each(e=>{e=nl(e,r.bounds);e!==n.isVisible()&&(n.setVisible(e),a&&!e?(js(o.element,[t.fadeOutClass]),t.onHide(o)):(e?tl:ol)(o,t))})})},_l=(e,t,o,n,r)=>{Ol(e,t,o,n,!0),kl(e,t,o,r.positionCss)},Tl=(e,t,o,n,r)=>{switch(r.morph){case"static":return Cl(e,t,o);case"absolute":return kl(e,t,o,r.positionCss);case"fixed":return _l(e,t,o,n,r)}},El=(t,o,n)=>{let r=o.lazyViewport(t);Ol(t,o,n,r),wl(t,r,n).each(e=>{Tl(t,o,n,r,e)})},Dl=(e,t,o)=>{e.getSystem().isConnected()&&El(e,t,o)},Al=(e,t,o)=>{o.isDocked()&&((t,o,n)=>{let r=t.element;n.setDocked(!1);var e=o.lazyViewport(t);Sl(t,e,n).each(e=>{switch(e.morph){case"static":Cl(t,o,n);break;case"absolute":kl(t,o,n,e.positionCss)}}),n.setVisible(!0),o.contextual.each(e=>{Gs(r,[e.fadeInClass,e.fadeOutClass,e.transitionClass]),e.onShow(t)}),Dl(t,o,n)})(e,t,o)};var Ml,t=(Bl=d=>(t,o,n)=>{let r=o.lazyViewport(t);var e,a,i,s,l,c;e=t.element,a=r,i=n,s=d,l=tr(e),c=ar(),("bottom"===(s=s(c,ll({win:c,box:l}),a)).location||"top"===s.location?(hl(e,l,a,i,s),bl(s)):D.none()).each(e=>{_l(t,o,n,r,e)})})(il),Bl=Bl(sl),t=Object.freeze({__proto__:null,refresh:Dl,reset:Al,isDocked:(e,t,o)=>o.isDocked(),getModes:(e,t,o)=>o.getModes(),setModes:(e,t,o,n)=>o.setModes(n),forceDockToTop:t,forceDockToBottom:Bl}),Bl=Object.freeze({__proto__:null,events:(n,r)=>ts([cs(yi(),(t,o)=>{n.contextual.each(e=>{Ws(t.element,e.transitionClass)&&(Gs(t.element,[e.transitionClass,e.fadeInClass]),(r.isVisible()?e.onShown:e.onHidden)(t)),o.stop()})}),F(Vi(),(e,t)=>{Dl(e,n,r)}),F(Gi(),(e,t)=>{Dl(e,n,r)}),F(Li(),(e,t)=>{Al(e,n,r)})])});let Il=(e,t)=>{t=(t||document).createElement("div");return t.innerHTML=e,oo(O.fromDom(t))},Fl=e=>e.dom.innerHTML,Rl=(e,t)=>{var o=Yt(e).dom,n=O.fromDom(o.createDocumentFragment()),t=Il(t,o);Vn(n,t),Ln(e),Nn(e,n)},Nl=e=>{var t=O.fromTag("div"),e=O.fromDom(e.dom.cloneNode(!0));return Nn(t,e),Fl(t)},zl=(e,t)=>O.fromDom(e.dom.cloneNode(t)),Vl=e=>zl(e,!1),Ll=e=>zl(e,!0),Hl=e=>so(e)?"#shadow-root":(e=Vl(e),Nl(e)),Pl=e=>Hl(e),Ul="unknown",Wl=((Xl=Ml=Ml||{})[Xl.STOP=0]="STOP",Xl[Xl.NORMAL=1]="NORMAL",Xl[Xl.LOGGING=2]="LOGGING",B({})),jl=(t,o)=>{let n=[],r=(new Date).getTime();return{logEventCut:(e,t,o)=>{n.push({outcome:"cut",target:t,purpose:o})},logEventStopped:(e,t,o)=>{n.push({outcome:"stopped",target:t,purpose:o})},logNoParent:(e,t,o)=>{n.push({outcome:"no-parent",target:t,purpose:o})},logEventNoHandlers:(e,t)=>{n.push({outcome:"no-handlers-left",target:t})},logEventResponse:(e,t,o)=>{n.push({outcome:"response",purpose:o,target:t})},write:()=>{var e=(new Date).getTime();ve(["mousemove","mouseover","mouseout",Ri()],t)||console.log(t,{event:t,time:e-r,target:o.dom,sequence:C(n,e=>ve(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+Pl(e.target)+")":e.outcome)})}}},Gl=(t,e,o)=>{switch(k(Wl.get(),t).orThunk(()=>{var e=Ue(Wl.get());return Pe(e,e=>-1<t.indexOf(e)?D.some(Wl.get()[e]):D.none())}).getOr(Ml.NORMAL)){case Ml.NORMAL:return o(Kl());case Ml.LOGGING:var n=jl(t,e),r=o(n);return n.write(),r;case Ml.STOP:return!0}},$l=["alloy/data/Fields","alloy/debugging/Debugging"],Yl=()=>{var e=new Error;return void 0!==e.stack?(e=e.stack.split("\n"),Te(e,t=>0<t.indexOf("alloy")&&!be($l,e=>-1<t.indexOf(e))).getOr(Ul)):Ul};var Xl={logEventCut:S,logEventStopped:S,logNoParent:S,logEventNoHandlers:S,logEventResponse:S,write:S};let ql=(e,t,o)=>Gl(e,t,o),Kl=T(Xl),Jl=T([i("menu"),i("selectedMenu")]),Ql=T([i("item"),i("selectedItem")]),Zl=(T(m(Ql().concat(Jl()))),T(m(Ql())));var Xl=va("initSize",[i("numColumns"),i("numRows")]),ec=()=>va("markers",[i("backgroundMenu")].concat(Jl()).concat(Ql())),tc=e=>va("markers",C(e,i));let oc=(e,t,o)=>(Yl(),da(t,t,o,oa(t=>I.value((...e)=>t.apply(void 0,e)))));var o=e=>oc(0,e,wr(S)),nc=e=>oc(0,e,wr(D.none)),rc=e=>oc(0,e,xr()),ac=e=>oc(0,e,xr());let ic=(e,t)=>ma(e,T(t)),sc=e=>ma(e,re);var Xl=T(Xl),n=[Ta("contextual",[pa("fadeInClass"),pa("fadeOutClass"),pa("transitionClass"),fa("lazyContext"),o("onShow"),o("onShown"),o("onHide"),o("onHidden")]),Fa("lazyViewport",()=>({bounds:ar(),optScrollEnv:D.none()})),Ra("modes",["top","bottom"],qr),o("onDocked"),o("onUndocked")];let lc=Es({fields:n,name:"docking",active:Bl,apis:t,state:Object.freeze({__proto__:null,init:e=>{let t=B(!1),o=B(!0);var n=lr();let r=B(e.modes);return _s({isDocked:t.get,setDocked:t.set,getInitialPos:n.get,setInitialPos:n.set,clearInitialPos:n.clear,isVisible:o.get,setVisible:o.set,getModes:r.get,setModes:r.set,readState:()=>`docked:  ${t.get()}, visible: ${o.get()}, modes: `+r.get().join(",")})}})});var n=ts([{key:Oi(),value:Qa({can:(e,t)=>{var o,n,t=t.event,r=t.originator,t=t.target;return e=e,o=r,n=t,!(Gt(o,e.element)&&!Gt(o,n)&&(console.warn(Oi()+" did not get interpreted by the desired target. \nOriginator: "+Pl(r)+"\nTarget: "+Pl(t)+"\nCheck the "+Oi()+" event handlers"),1))}})}]),cc=Object.freeze({__proto__:null,events:n});let dc=(e,t,o,n)=>{e+=t;return n<e?o:e<o?n:e},mc=(e,t,o)=>Math.min(Math.max(e,t),o),uc=()=>window.crypto.getRandomValues(new Uint32Array(1))[0]/4294967295,gc=0,N=e=>{var t=(new Date).getTime();return e+"_"+Math.floor(1e9*uc())+ ++gc+String(t)},pc=(Bl=T("alloy-id-"),t=T("data-alloy-id"),Bl()),hc=t(),fc=(e,t)=>{e=N(pc+e);return vc(t,e),e},vc=(e,t)=>{Object.defineProperty(e.dom,hc,{value:t,writable:!0})},bc=e=>{e=Nt(e)?e.dom[hc]:null;return D.from(e)},xc=e=>N(e),yc=re,wc=t=>{let o=e=>"The component must be in a context to execute: "+e+(t?"\n"+Pl(t().element)+" is not in context.":"");var e=e=>()=>{throw new Error(o(e))},n=e=>()=>{console.warn(o(e))};return{debugInfo:T("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),build:e("build"),buildOrPatch:e("buildOrPatch"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),isConnected:de}},Sc=wc(),Cc=N("alloy-premade"),kc=e=>(Object.defineProperty(e.element.dom,Cc,{value:e.uid,writable:!0}),Ua(Cc,e)),Oc=e=>et(e.dom,Cc),_c=e=>k(e,Cc),Tc=o=>vs((e,...t)=>o(e.getApis(),e,...t),o),Ec=(t,e)=>{var o=C(e,e=>Ta(e.name(),[i("config"),u("state",Os)])),o=ra("component.behaviours",m(o),t.behaviours).fold(e=>{throw new Error(sa(e)+"\nComplete spec:\n"+JSON.stringify(t,null,2))},re);return{list:e,data:Ge(o,e=>{e=e.map(e=>({config:e.config,state:e.state.init(e.config)}));return T(e)})}},Dc=e=>e.list,Ac=e=>e.data,Mc=(e,r)=>{let a={};return je(e,(e,n)=>{je(e,(e,t)=>{var o=k(a,t).getOr([]);a[t]=o.concat([r(n,e)])})}),a},Bc=(t,e,o,n)=>{let r={...e};E(o,e=>{r[e.name()]=e.exhibit(t,n)});var e=Mc(r,(e,t)=>({name:e,modification:t})),o=e=>ke(e,(e,t)=>({...t.modification,...e}),{}),a=ke(e.classes,(e,t)=>t.modification.concat(e),[]),i=o(e.attributes),o=o(e.styles);return bs({classes:a,attributes:i,styles:o})},Ic=(r,a,e,i)=>{try{var t=Ne(e,(e,t)=>{var e=e[a],t=t[a],o=i.indexOf(e),n=i.indexOf(t);if(-1===o)throw new Error("The ordering for "+r+" does not have an entry for "+e+".\nOrder specified: "+JSON.stringify(i,null,2));if(-1===n)throw new Error("The ordering for "+r+" does not have an entry for "+t+".\nOrder specified: "+JSON.stringify(i,null,2));return o<n?-1:n<o?1:0});return I.value(t)}catch(e){return I.error([e])}},Fc=(e,t)=>({handler:e,purpose:t}),Rc=(e,t)=>({cHandler:e,purpose:t}),Nc=(e,t)=>Rc(ie.apply(void 0,[e.handler].concat(t)),e.purpose),zc=e=>e.cHandler,Vc=(e,t)=>({name:e,handler:t}),Lc=(e,t)=>{let o={};return E(e,e=>{o[e.name()]=e.handlers(t)}),o},Hc=(e,t,o)=>{o={...o,...Lc(t,e)};return Mc(o,Vc)},Pc=(e,t,o,n)=>{e=Hc(e,o,n);return Gc(e,t)},Uc=e=>{let n=ti(e);return(e,t,...o)=>{e=[e,t].concat(o);n.abort.apply(void 0,e)?t.stop():n.can.apply(void 0,e)&&n.run.apply(void 0,e)}},Wc=(e,t)=>I.error(["The event ("+e+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(C(t,e=>e.name),null,2)]),jc=(e,t,o)=>{t=t[o];return t?Ic("Event: "+o,"name",e,t).map(e=>{e=C(e,e=>e.handler);return oi(e)}):Wc(o,e)},Gc=(e,r)=>{e=Je(e,(o,n)=>(1===o.length?I.value(o[0].handler):jc(o,r,n)).map(e=>{var e=Uc(e),t=1<o.length?Ce(r[n],t=>be(o,e=>e.name===t)).join(" > "):o[0].name;return Ua(n,Fc(e,t))}));return $a(e,{})},$c=(n="alloy.base.behaviour",m([da("dom","dom",xr(),m([i("tag"),u("styles",{}),u("classes",[]),u("attributes",{}),ya("value"),ya("innerHtml")])),i("components"),i("uid"),u("events",{}),u("apis",{}),da("eventOrder","eventOrder",(Bl={[Di()]:["disabling",n,"toggling","typeaheadevents"],[Oi()]:[n,"focusing","keying"],[Ri()]:[n,"disabling","toggling","representing","tooltipping"],[fi()]:[n,"representing","streaming","invalidating"],[Pi()]:[n,"representing","item-events","toolbar-button-events","tooltipping"],[si()]:["focusing",n,"item-type-events"],[ni()]:["focusing",n,"item-type-events"],[mi()]:["item-type-events","tooltipping"],[Ei()]:["receiving","reflecting","tooltipping"]},Cr(T(Bl))),Yr()),ya("domModification")])),Yc=e=>ra("custom.definition",$c,e),Xc=e=>({...e.dom,uid:e.uid,domChildren:C(e.components,e=>e.element)}),qc=e=>e.domModification.fold(()=>bs({}),bs),Kc=e=>e.events,Jc=e=>e.dom.value,Qc=(e,t)=>{if(void 0===t)throw new Error("Value.set was undefined");e.dom.value=t},Zc=(e,t,o)=>no(e,t).map(t=>{var e;return o.exists(e=>!Gt(e,t))?(e=o.map(Ft).getOr("span"),e=O.fromTag(e),In(t,e),e):t}),ed=(e,t,o)=>{o.fold(()=>Nn(e,t),e=>{Gt(e,t)||(In(e,t),Hn(e))})},td=(e,t,o)=>{t=C(t,o),o=oo(e);return E(o.slice(t.length),Hn),t},od=(e,t,o,n)=>{var r=no(e,t),n=n(o,r),o=Zc(e,t,r);return ed(e,n.element,o),n},nd=(o,e,n)=>td(o,e,(e,t)=>od(o,t,e,n)),rd=(o,e)=>td(o,e,(e,t)=>{t=no(o,t);return ed(o,e,t),e}),ad=(e,o)=>{var t=Ue(e),n=Ue(o);return{toRemove:Ie(n,t),toSet:qe(e,(e,t)=>!et(o,t)||e!==o[t]).t}},id=(t,o)=>{let{class:e,style:n,...r}=Oo(o),{toSet:a,toRemove:i}=ad(t.attributes,r);var s=Io(o);let{toSet:l,toRemove:c}=ad(t.styles,s);s=qs(o);let d=Ie(s,t.classes),m=Ie(t.classes,s);var u;return E(i,e=>ko(o,e)),yo(o,a),js(o,m),Gs(o,d),E(c,e=>Ro(o,e)),Eo(o,l),t.innerHtml.fold(()=>{var e=t.domChildren;rd(o,e)},e=>{Rl(o,e)}),s=o,(u=t.value.getOrUndefined())!==Jc(s)&&Qc(s,null!=u?u:""),o},sd=e=>{let t=O.fromTag(e.tag);yo(t,e.attributes),js(t,e.classes),Eo(t,e.styles),e.innerHtml.each(e=>Rl(t,e));var o=e.domChildren;return Vn(t,o),e.value.each(e=>{Qc(t,e)}),t},ld=(e,t)=>{try{var o=id(e,t);return D.some(o)}catch(e){return D.none()}},cd=e=>e.innerHtml.isSome()&&0<e.domChildren.length,dd=(t,e)=>{e=e.filter(e=>Ft(e)===t.tag&&!cd(t)&&!Oc(e)).bind(e=>ld(t,e)).getOrThunk(()=>sd(t));return vc(e,t.uid),e},md=e=>{let t=k(e,"behaviours").getOr({});return Ae(Ue(t),e=>{e=t[e];return J(e)?[e.me]:[]})},ud=(e,t)=>Ec(e,t),gd=e=>{var t=md(e);return ud(e,t)},pd=(e,t,o)=>{var n=Xc(e),e=qc(e),r={"alloy.base.modification":e},o=0<t.length?Bc(o,r,t,n):e;return xs(n,o)},hd=(e,t,o)=>{var n={"alloy.base.behaviour":Kc(e)};return Pc(o,e.eventOrder,t,n).getOrDie()},fd=(o,e)=>{let t=()=>d,n=B(Sc),r=aa(Yc(o));var a=gd(o),i=Dc(a);let s=Ac(a);a=pd(r,i,s);let l=dd(a,e);a=hd(r,i,s);let c=B(r.components);let d={uid:o.uid,getSystem:n.get,config:e=>{var t=s;return(Q(t[e.name()])?t[e.name()]:()=>{throw new Error("Could not find "+e.name()+" in "+JSON.stringify(o,null,2))})()},hasConfigured:e=>Q(s[e.name()]),spec:o,readState:e=>s[e]().map(e=>e.state.readState()).getOr("not enabled"),getApis:()=>r.apis,connect:e=>{n.set(e)},disconnect:()=>{n.set(wc(t))},element:l,syncComponents:()=>{var e=oo(l),e=Ae(e,e=>n.get().getByDom(e).fold(()=>[],Re));c.set(e)},components:c.get,events:a};return d},vd=(e,t)=>{let n=k(e,"components").getOr([]);return t.fold(()=>C(n,kd),o=>C(n,(e,t)=>Cd(e,no(o,t))))},bd=(e,t)=>{let{events:o,...n}=yc(e);e=vd(n,t),e={...n,events:{...cc,...o},components:e};return I.value(fd(e,t))},xd=e=>{e=O.fromText(e);return yd({element:e})},yd=e=>{var t=ia("external.component",Wr([i("element"),ya("uid")]),e);let o=B(wc());var n=t.uid.getOrThunk(()=>xc("external"));vc(t.element,n);let r={uid:n,getSystem:o.get,config:D.none,hasConfigured:de,connect:e=>{o.set(e)},disconnect:()=>{o.set(wc(()=>r))},getApis:()=>({}),element:t.element,spec:e,readState:T("No state"),syncComponents:S,components:T([]),events:{}};return kc(r)},wd=xc,Sd=e=>et(e,"uid"),Cd=(t,o)=>_c(t).getOrThunk(()=>{var e=Sd(t)?t:{uid:wd(""),...t};return bd(e,o).getOrDie()}),kd=e=>Cd(e,D.none()),Od=kc;var _d=(e,t,o,n,r)=>e(o,n)?D.some(o):Q(r)&&r(o)?D.none():t(o,n,r);let Td=(e,t,o)=>{let n=e.dom;for(var r=Q(o)?o:de;n.parentNode;){n=n.parentNode;var a=O.fromDom(n);if(t(a))return D.some(a);if(r(a))break}return D.none()},Ed=(e,t,o)=>_d((e,t)=>t(e),Td,e,t,o),Dd=(t,o)=>{var e=t.dom;return e.parentNode?Ad(O.fromDom(e.parentNode),e=>!Gt(t,e)&&o(e)):D.none()},Ad=(e,t)=>Te(e.dom.childNodes,e=>t(O.fromDom(e))).map(O.fromDom),Md=(e,n)=>{let r=t=>{for(let e=0;e<t.childNodes.length;e++){var o=O.fromDom(t.childNodes[e]);if(n(o))return D.some(o);o=r(t.childNodes[e]);if(o.isSome())return o}return D.none()};return r(e.dom)},Bd=(e,t,o)=>Ed(e,t,o).isSome(),Id=(e,t,o)=>Td(e,e=>Pt(e,t),o),Fd=(e,t)=>Ad(e,e=>Pt(e,t)),Rd=(e,t)=>jt(t,e),Nd=(e,t,o)=>_d((e,t)=>Pt(e,t),Id,e,t,o),zd="aria-controls",Vd=e=>Ed(e,e=>!!Nt(e)&&void 0!==(e=wo(e,"id"))&&-1<e.indexOf(zd)).bind(e=>{var t=wo(e,"id"),e=lo(e);return Rd(e,`[${zd}="${t}"]`)}),Ld=()=>{let t=N(zd);return{id:t,link:e=>{A(e,zd,t)},unlink:e=>{ko(e,zd)}}},Hd=(t,e)=>Vd(e).exists(e=>Pd(t,e)),Pd=(t,e)=>Bd(e,e=>Gt(e,t.element),de)||Hd(t,e),Ud=(e,t,o,n,r,a,i,s=!1)=>({x:e,y:t,bubble:o,direction:n,placement:r,restriction:a,label:i+"-"+r,alwaysFit:s}),Wd=(t=za([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),(e,t,o,n,r,a,i,s,l)=>e.fold(t,o,n,r,a,i,s,l)),jd=(e,t,o,n)=>e.fold(t,t,n,n,t,n,o,o),Gd=(e,t,o,n)=>e.fold(t,n,t,n,o,o,t,n),$d=t.southeast,Yd=t.southwest,Xd=t.northeast,qd=t.northwest,Kd=t.south,Jd=t.north,Qd=t.east,Zd=t.west,em=(e,t)=>{switch(t){case 1:return e.x;case 0:return e.x+e.width;case 2:return e.y;case 3:return e.y+e.height}},tm=(t,o)=>Fe(["left","right","top","bottom"],e=>k(o,e).map(e=>em(t,e))),om=(a,e,i)=>{var t=(n,r)=>e[n].map(e=>{var t="top"===n||"bottom"===n,o=t?i.top:i.left,e=("left"===n||"top"===n?Math.max:Math.min)(e,r)+o;return t?mc(e,a.y,a.bottom):mc(e,a.x,a.right)}).getOr(r),o=t("left",a.x),n=t("top",a.y),r=t("right",a.right),t=t("bottom",a.bottom);return er(o,n,r-o,t-n)},nm="layout",rm=(e,t)=>e.x+e.width/2-t.width/2,am=(e,t)=>e.x+e.width-t.width,im=(e,t)=>e.y-t.height,sm=e=>e.y+e.height,lm=(e,t)=>e.y+e.height/2-t.height/2,cm=e=>e.x+e.width,dm=(e,t)=>e.x-t.width,mm=(e,t,o)=>Ud(e.x,sm(e),o.southeast(),$d(),"southeast",tm(e,{left:1,top:3}),nm),um=(e,t,o)=>Ud(am(e,t),sm(e),o.southwest(),Yd(),"southwest",tm(e,{right:0,top:3}),nm),gm=(e,t,o)=>Ud(e.x,im(e,t),o.northeast(),Xd(),"northeast",tm(e,{left:1,bottom:2}),nm),pm=(e,t,o)=>Ud(am(e,t),im(e,t),o.northwest(),qd(),"northwest",tm(e,{right:0,bottom:2}),nm),hm=(e,t,o)=>Ud(rm(e,t),im(e,t),o.north(),Jd(),"north",tm(e,{bottom:2}),nm),fm=(e,t,o)=>Ud(rm(e,t),sm(e),o.south(),Kd(),"south",tm(e,{top:3}),nm),vm=(e,t,o)=>Ud(cm(e),lm(e,t),o.east(),Qd(),"east",tm(e,{left:0}),nm),bm=(e,t,o)=>Ud(dm(e,t),lm(e,t),o.west(),Zd(),"west",tm(e,{right:1}),nm),xm=()=>[mm,um,gm,pm,fm,hm,vm,bm],ym=()=>[um,mm,pm,gm,fm,hm,vm,bm],wm=()=>[gm,pm,mm,um,hm,fm],Sm=()=>[pm,gm,um,mm,hm,fm],Cm=()=>[mm,um,gm,pm,fm,hm],km=()=>[um,mm,pm,gm,fm,hm],Om=(n=Object.freeze({__proto__:null,events:i=>ts([F(Ei(),(n,e)=>{let r=i.channels;var t=Ue(r);let a=e;e=t;var o,t=(o=a).universal?e:Ce(e,e=>ve(o.channels,e));E(t,e=>{var t=r[e],o=t.schema,e=ia("channel["+e+"] data\nReceiver: "+Pl(n.element),o,a.data);t.onReceive(n,e)})})])}),Bl=[ga("channels",hB(I.value,Wr([rc("onReceive"),u("schema",Yr())])))],Es({fields:Bl,name:"receiving",active:n})),_m=(t=Object.freeze({__proto__:null,exhibit:(e,t)=>bs({classes:[],styles:t.useFixed()?{}:{position:"relative"}})}),(e,t=!1)=>e.dom.focus({preventScroll:t})),Tm=e=>e.dom.blur(),Em=e=>{var t=lo(e).dom;return e.dom===t.activeElement},Dm=(e=$n())=>D.from(e.dom.activeElement).map(O.fromDom),Am=t=>Dm(lo(t)).filter(e=>t.dom.contains(e.dom)),Mm=(e,o)=>{let n=lo(o);var t=Dm(n).bind(t=>{var e=e=>Gt(t,e);return e(o)?D.some(o):Md(o,e)}),e=e(o);return t.each(t=>{Dm(n).filter(e=>Gt(e,t)).fold(()=>{_m(t)},S)}),e};var Bm,Bl=za([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]);let Im=(e,t,o,n,r,a)=>{var i=t.rect,o=i.x-o,n=i.y-n,r=r-(o+i.width),a=a-(n+i.height);let s=D.some(o),l=D.some(n),c=D.some(r),d=D.some(a),m=D.none();return Wd(t.direction,()=>Ks(e,s,l,m,m),()=>Ks(e,m,l,c,m),()=>Ks(e,s,m,m,d),()=>Ks(e,m,m,c,d),()=>Ks(e,s,l,m,m),()=>Ks(e,s,m,m,d),()=>Ks(e,s,l,m,m),()=>Ks(e,m,l,c,m))},Fm=(e,r)=>e.fold(()=>{var e=r.rect;return Ks("absolute",D.some(e.x),D.some(e.y),D.none(),D.none())},(e,t,o,n)=>Im("absolute",r,e,t,o,n),(e,t,o,n)=>Im("fixed",r,e,t,o,n)),Rm=(e,t)=>{var o=ie(Jn,t),e=e.fold(o,o,()=>{var e=Pn();return Jn(t).translate(-e.left,-e.top)}),o=qo(t),n=Lo(t);return er(e.left,e.top,o,n)},Nm=(o,e)=>e.fold(()=>o.fold(ar,ar,er),t=>o.fold(T(t),T(t),()=>{var e=zm(o,t.x,t.y);return er(e.left,e.top,t.width,t.height)})),zm=(e,t,o)=>{let n=Po(t,o);return e.fold(T(n),T(n),()=>{var e=Pn();return n.translate(-e.left,-e.top)})},Vm=(e,t,o,n)=>e.fold(t,o,n),Lm=(Bl.none,Bl.relative),Hm=Bl.fixed,Pm=(e,t)=>({anchorBox:e,origin:t}),Um=(e,t)=>Pm(e,t),Wm="data-alloy-placement",jm=(e,t)=>{A(e,Wm,t)},Gm=e=>So(e,Wm),$m=za([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),Ym=(e,t)=>{var{x:t,y:o,right:n,bottom:r}=t,{x:e,y:a,right:i,bottom:s,width:l,height:c}=e;return{originInBounds:t<=e&&e<=n&&(o<=a&&a<=r),sizeInBounds:i<=n&&t<=i&&(s<=r&&o<=s),visibleW:Math.min(l,t<=e?n-e:i-t),visibleH:Math.min(c,o<=a?r-a:s-o)}},Xm=(e,t)=>{var{x:t,y:o,right:n,bottom:r}=t,{x:e,y:a,width:i,height:s}=e,l=Math.max(t,n-i),c=Math.max(o,r-s),e=mc(e,t,l),t=mc(a,o,c),l=Math.min(e+i,n)-e,a=Math.min(t+s,r)-t;return er(e,t,l,a)},qm=(e,t,o)=>{var n=T(t.bottom-o.y),r=T(o.bottom-t.y),r=jd(e,r,r,n),n=T(t.right-o.x),o=T(o.right-t.x);return{maxWidth:Gd(e,o,o,n),maxHeight:r}},Km=(e,t,o,n)=>{var r=e.bubble,a=r.offset,i=om(n,e.restriction,a),s=e.x+a.left,a=e.y+a.top,s=er(s,a,t,o),{originInBounds:t,sizeInBounds:o,visibleW:l,visibleH:c}=Ym(s,i),t=t&&o,o=t?s:Xm(s,i),s=0<o.width&&0<o.height,{maxWidth:i,maxHeight:n}=qm(e.direction,o,n),o={rect:o,maxHeight:n,maxWidth:i,direction:e.direction,placement:e.placement,classes:{on:r.classesOn,off:r.classesOff},layout:e.label,testY:a};return t||e.alwaysFit?$m.fit(o):$m.nofit(o,l,c,s)},Jm=(t,e,o,n,c,d)=>{let m=n.width,u=n.height,r=(e,r,a,i,s)=>{e=e(o,n,c,t,d);let l=Km(e,m,u,d);return l.fold(T(l),(e,t,o,n)=>(s===n?i<o||a<t:!s&&n)?l:$m.nofit(r,a,i,s))};return Oe(e,(e,t)=>{t=ie(r,t);return e.fold(T(e),t)},$m.nofit({rect:o,maxHeight:n.height,maxWidth:n.width,direction:$d(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:o.y},-1,-1,!1)).fold(re,re)},Qm=me,Zm=(e,t,o)=>An(e,t,Qm,o),eu=(e,t,o)=>Mn(e,t,Qm,o),tu=Tn,ou=["top","bottom","right","left"],nu="data-alloy-transition-timer",ru=(e,t)=>Ys(e,t.classes),au=(o,n,e)=>e.exists(e=>{var t=o.mode;return"all"===t||e[t]!==n[t]}),iu=(o,e)=>{let n=e=>parseFloat(e).toFixed(3);return Qe(e,(e,t)=>{t=o[t].map(n),e=e.map(n);return!nt(t,e)}).isSome()},su=t=>{var e=e=>{e=Ao(t,e).split(/\s*,\s*/);return Ce(e,bt)};let n=e=>{var t;return y(e)&&/^[\d.]+/.test(e)?(t=parseFloat(e),ft(e,"ms")?t:1e3*t):0},r=e("transition-delay");e=e("transition-duration");return Oe(e,(e,t,o)=>{o=n(r[o])+n(t);return Math.max(e,o)},0)},lu=(o,t)=>{let n=sr(),r=sr(),a,i=e=>{var t=null!=(t=e.raw.pseudoElement)?t:"";return Gt(e.target,o)&&xt(t)&&ve(ou,e.raw.propertyName)},s=e=>{(K(e)||i(e))&&(n.clear(),r.clear(),e=null==e?void 0:e.raw.type,!K(e)&&e!==yi()||(clearTimeout(a),ko(o,nu),Gs(o,t.classes)))},l=Zm(o,wi(),e=>{i(e)&&(l.unbind(),n.set(Zm(o,yi(),s)),r.set(Zm(o,xi(),s)))}),e=su(o);requestAnimationFrame(()=>{a=setTimeout(s,e+17),A(o,nu,a)})},cu=(t,e)=>{js(t,e.classes),So(t,nu).each(e=>{clearTimeout(parseInt(e,10)),ko(t,nu)}),lu(t,e)},du=(e,o,n,r,a,i)=>{i=au(r,a,i);if(i||ru(e,r)){M(e,"position",n.position);var s=Rm(o,e);let t=Fm(o,{...a,rect:s});o=Fe(ou,e=>t[e]);iu(n,o)&&(Do(e,o),i&&cu(e,r),No(e))}else Gs(e,r.classes)},mu=e=>({width:qo(e),height:Lo(e)}),uu=(e,t,o,n)=>{Ro(t,"max-height"),Ro(t,"max-width");var r=mu(t);return Jm(t,n.preference,e,r,o,n.bounds)},gu=(e,t)=>{t=t.classes;Gs(e,t.off),js(e,t.on)},pu=(e,t,o)=>{(0,o.maxHeightFunction)(e,t.maxHeight)},hu=(e,t,o)=>{(0,o.maxWidthFunction)(e,t.maxWidth)},fu=(t,o,n)=>{let r=Fm(n.origin,o);n.transition.each(e=>{du(t,n.origin,r,e,o,n.lastPlacement)}),Qs(t,r)},vu=(e,t)=>{jm(e,t.placement)},bu=(e,t)=>{((e,t)=>{t=zo.max(e,t,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);M(e,"max-height",t+"px")})(e,Math.floor(t))},xu=T((e,t)=>{bu(e,t),Eo(e,{"overflow-x":"hidden","overflow-y":"auto"})}),yu=T((e,t)=>{bu(e,t)}),wu=(e,t,o)=>void 0===e[t]?o:e[t],Su=(e,t,o,n,r,a,i,s)=>{var l=wu(i,"maxHeightFunction",xu()),i=wu(i,"maxWidthFunction",S),c=e.anchorBox,e=e.origin,a={bounds:Nm(e,a),origin:e,preference:n,maxHeightFunction:l,maxWidthFunction:i,lastPlacement:r,transition:s};return Cu(c,t,o,a)},Cu=(e,t,o,n)=>{e=uu(e,t,o,n);return fu(t,e,n),vu(t,e),gu(t,e),pu(t,e,n),hu(t,e,n),{layout:e.layout,placement:e.placement}},ku=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],Ou=(e,t,o,n=1)=>{let r=e*n,a=t*n,i=e=>k(o,e).getOr([]),s=(e,t,o)=>{var n=Ie(ku,o);return{offset:Po(e,t),classesOn:Ae(o,i),classesOff:Ae(n,i)}};return{southeast:()=>s(-e,t,["top","alignLeft"]),southwest:()=>s(e,t,["top","alignRight"]),south:()=>s(-e/2,t,["top","alignCentre"]),northeast:()=>s(-e,-t,["bottom","alignLeft"]),northwest:()=>s(e,-t,["bottom","alignRight"]),north:()=>s(-e/2,-t,["bottom","alignCentre"]),east:()=>s(e,-t/2,["valignCentre","left"]),west:()=>s(-e,-t/2,["valignCentre","right"]),insetNortheast:()=>s(r,a,["top","alignLeft","inset"]),insetNorthwest:()=>s(-r,a,["top","alignRight","inset"]),insetNorth:()=>s(-r/2,a,["top","alignCentre","inset"]),insetSoutheast:()=>s(r,-a,["bottom","alignLeft","inset"]),insetSouthwest:()=>s(-r,-a,["bottom","alignRight","inset"]),insetSouth:()=>s(-r/2,-a,["bottom","alignCentre","inset"]),insetEast:()=>s(-r,-a/2,["valignCentre","right","inset"]),insetWest:()=>s(r,-a/2,["valignCentre","left","inset"])}},_u=()=>Ou(0,0,{}),Tu=re,Eu=(t,o)=>e=>"rtl"===Du(e)?o:t,Du=e=>"rtl"===Ao(e,"direction")?"rtl":"ltr",Au=((n=Bm=Bm||{}).TopToBottom="toptobottom",n.BottomToTop="bottomtotop","data-alloy-vertical-dir"),Mu=e=>Bd(e,e=>Nt(e)&&wo(e,"data-alloy-vertical-dir")===Bm.BottomToTop),Bu=(Bl=()=>Ta("layouts",[i("onLtr"),i("onRtl"),ya("onBottomLtr"),ya("onBottomRtl")]),(t,e,o,n,r,a,i)=>{var i=i.map(Mu).getOr(!1),s=e.layouts.map(e=>e.onLtr(t)),l=e.layouts.map(e=>e.onRtl(t)),r=i?e.layouts.bind(e=>e.onBottomLtr.map(e=>e(t))).or(s).getOr(r):s.getOr(o),s=i?e.layouts.bind(e=>e.onBottomRtl.map(e=>e(t))).or(l).getOr(a):l.getOr(n);return Eu(r,s)(t)});var n=[i("hotspot"),ya("bubble"),u("overrides",{}),Bl(),ic("placement",(e,t,o)=>{var n=t.hotspot,o=Rm(o,n.element),n=Bu(e.element,t,Cm(),km(),wm(),Sm(),D.some(t.hotspot.element));return D.some(Tu({anchorBox:o,bubble:t.bubble.getOr(_u()),overrides:t.overrides,layouts:n}))})],r=[i("x"),i("y"),u("height",0),u("width",0),u("bubble",_u()),u("overrides",{}),Bl(),ic("placement",(e,t,o)=>{o=zm(o,t.x,t.y),o=er(o.left,o.top,t.width,t.height),e=Bu(e.element,t,xm(),ym(),xm(),ym(),D.none());return D.some(Tu({anchorBox:o,bubble:t.bubble,overrides:t.overrides,layouts:e}))})],Iu=za([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]);let Fu=e=>e.fold(re,(e,t,o)=>e.translate(-t,-o)),Ru=e=>e.fold(re,re),Nu=e=>Oe(e,(e,t)=>e.translate(t.left,t.top),Po(0,0)),zu=e=>{e=C(e,Fu);return Nu(e)},Vu=e=>{e=C(e,Ru);return Nu(e)},Lu=Iu.screen,Hu=Iu.absolute,Pu=(o,e,t)=>{t=Kt(t.root).dom;return D.from(t.frameElement).map(O.fromDom).filter(e=>{var e=Yt(e),t=Yt(o.element);return Gt(e,t)}).map(jo)},Uu=(e,t,o)=>{var n=Yt(e.element),n=Pn(n),e=Pu(e,t,o).getOr(n);return Hu(e,n.left,n.top)},Wu=(e,t,o,n)=>{e=Lu(Po(e,t));return D.some(Qn(e,o,n))},ju=(e,r,a,i,s)=>e.map(e=>{let t=[r,e.point];var o=Vm(i,()=>Vu(t),()=>Vu(t),()=>zu(t)),o=Zn(o.left,o.top,e.width,e.height),e=(a.showAbove?wm:Cm)(),n=(a.showAbove?Sm:km)(),e=Bu(s,a,e,n,e,n,D.none());return Tu({anchorBox:o,bubble:a.bubble.getOr(_u()),overrides:a.overrides,layouts:e})}),Gu=(Iu=[i("node"),i("root"),ya("bubble"),Bl(),u("overrides",{}),u("showAbove",!1),ic("placement",(o,n,r)=>{let a=Uu(o,r,n);return n.node.filter(fo).bind(e=>{var e=e.dom.getBoundingClientRect(),e=Wu(e.left,e.top,e.width,e.height),t=n.node.getOr(o.element);return ju(e,a,n,r,t)})})]," "),$u={create:(e,t,o,n)=>({start:e,soffset:t,finish:o,foffset:n})},Yu={before:(zg=za([{before:["element"]},{on:["element","offset"]},{after:["element"]}])).before,on:zg.on,after:zg.after,cata:(e,t,o,n)=>e.fold(t,o,n),getStart:e=>e.fold(re,re,re)},Xu=za([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),qu={domRange:Xu.domRange,relative:Xu.relative,exact:Xu.exact,exactFromRange:e=>Xu.exact(e.start,e.soffset,e.finish,e.foffset),getWin:e=>{e=e.match({domRange:e=>O.fromDom(e.startContainer),relative:(e,t)=>Yu.getStart(e),exact:(e,t,o,n)=>e});return Kt(e)},range:$u.create},Ku=(o,e)=>{e.fold(e=>{o.setStartBefore(e.dom)},(e,t)=>{o.setStart(e.dom,t)},e=>{o.setStartAfter(e.dom)})},Ju=(o,e)=>{e.fold(e=>{o.setEndBefore(e.dom)},(e,t)=>{o.setEnd(e.dom,t)},e=>{o.setEndAfter(e.dom)})},Qu=(e,t,o)=>{e=e.document.createRange();return Ku(e,t),Ju(e,o),e},Zu=(e,t,o,n,r)=>{e=e.document.createRange();return e.setStart(t.dom,o),e.setEnd(n.dom,r),e},eg=e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}),tg=e=>{var t=e.getClientRects(),t=0<t.length?t[0]:e.getBoundingClientRect();return 0<t.width||0<t.height?D.some(t).map(eg):D.none()},og=e=>{e=e.getBoundingClientRect();return 0<e.width||0<e.height?D.some(e).map(eg):D.none()},ng=za([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),rg=(e,t,o)=>t(O.fromDom(o.startContainer),o.startOffset,O.fromDom(o.endContainer),o.endOffset),ag=(r,e)=>e.match({domRange:e=>({ltr:T(e),rtl:D.none}),relative:(e,t)=>({ltr:Ko(()=>Qu(r,e,t)),rtl:Ko(()=>D.some(Qu(r,t,e)))}),exact:(e,t,o,n)=>({ltr:Ko(()=>Zu(r,e,t,o,n)),rtl:Ko(()=>D.some(Zu(r,o,n,e,t)))})}),ig=(e,t)=>{let o=t.ltr();return o.collapsed?t.rtl().filter(e=>!1===e.collapsed).map(e=>ng.rtl(O.fromDom(e.endContainer),e.endOffset,O.fromDom(e.startContainer),e.startOffset)).getOrThunk(()=>rg(e,ng.ltr,o)):rg(e,ng.ltr,o)},sg=(e,t)=>{t=ag(e,t);return ig(e,t)},lg=(a,e)=>sg(a,e).match({ltr:(e,t,o,n)=>{var r=a.document.createRange();return r.setStart(e.dom,t),r.setEnd(o.dom,n),r},rtl:(e,t,o,n)=>{var r=a.document.createRange();return r.setStart(o.dom,n),r.setEnd(e.dom,t),r}}),cg=(ng.ltr,ng,(e,t,o)=>Ce(Zt(e,o),t)),dg=(e,t)=>Wt(t,e),mg=(e,t,o,n)=>{var r=Yt(e).dom.createRange();return r.setStart(e.dom,t),r.setEnd(o.dom,n),r},ug=(e,t,o,n)=>{var r=mg(e,t,o,n),e=Gt(e,o)&&t===n;return r.collapsed&&!e},gg=e=>D.from(e.getSelection()),pg=e=>{var t;return 0<e.rangeCount?(t=e.getRangeAt(0),e=e.getRangeAt(e.rangeCount-1),D.some($u.create(O.fromDom(t.startContainer),t.startOffset,O.fromDom(e.endContainer),e.endOffset))):D.none()},hg=e=>{var t,o;return null!==e.anchorNode&&null!==e.focusNode&&(t=O.fromDom(e.anchorNode),o=O.fromDom(e.focusNode),ug(t,e.anchorOffset,o,e.focusOffset))?D.some($u.create(t,e.anchorOffset,o,e.focusOffset)):pg(e)},fg=e=>gg(e).filter(e=>0<e.rangeCount).bind(hg),vg=(e,t)=>{e=lg(e,t);return tg(e)},bg=((o,n)=>{let t=e=>o(e)?D.from(e.dom.nodeValue):D.none();return{get:e=>{if(o(e))return t(e).getOr("");throw new Error("Can only get "+n+" value of a "+n+" node")},getOption:t,set:(e,t)=>{if(!o(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom.nodeValue=t}}})(zt,"text"),xg=e=>bg.get(e),yg=(e,t)=>({element:e,offset:t}),wg=(e,t)=>{var o=oo(e);return 0===o.length?yg(e,t):t<o.length?yg(o[t],0):(e=o[o.length-1],t=(zt(e)?xg:oo)(e).length,yg(e,t))},Sg=(e,t)=>(zt(e)?yg:wg)(e,t),Cg=e=>void 0!==e.foffset,kg=(e,t)=>t.getSelection.getOrThunk(()=>()=>fg(e))().map(e=>{var t,o;return Cg(e)?(t=Sg(e.start,e.soffset),o=Sg(e.finish,e.foffset),qu.range(t.element,t.offset,o.element,o.offset)):e}),Og=(zg=[ya("getSelection"),i("root"),ya("bubble"),Bl(),u("overrides",{}),u("showAbove",!1),ic("placement",(e,t,o)=>{let n=Kt(t.root).dom;var r=Uu(e,o,t),a=kg(n,t).bind(o=>{var e;return Cg(o)?((e,t)=>{e=lg(e,t);return og(e)})(n,qu.exactFromRange(o)).orThunk(()=>{var e=O.fromText("\ufeff"),t=(In(o.start,e),vg(n,qu.exact(e,0,e,1)));return Hn(e),t}).bind(e=>Wu(e.left,e.top,e.width,e.height)):(e=Ge(o,e=>e.dom.getBoundingClientRect()),e={left:Math.min(e.firstCell.left,e.lastCell.left),right:Math.max(e.firstCell.right,e.lastCell.right),top:Math.min(e.firstCell.top,e.lastCell.top),bottom:Math.max(e.firstCell.bottom,e.lastCell.bottom)},Wu(e.left,e.top,e.right-e.left,e.bottom-e.top))}),e=kg(n,t).bind(e=>Cg(e)?Nt(e.start)?D.some(e.start):Qt(e.start):D.some(e.firstCell)).getOr(e.element);return ju(a,r,t,o,e)})],"link-layout"),_g=e=>e.x+e.width,Tg=(e,t)=>e.x-t.width,Eg=(e,t)=>e.y-t.height+e.height,Dg=e=>e.y,Ag=(e,t,o)=>Ud(_g(e),Dg(e),o.southeast(),$d(),"southeast",tm(e,{left:0,top:2}),Og),Mg=(e,t,o)=>Ud(Tg(e,t),Dg(e),o.southwest(),Yd(),"southwest",tm(e,{right:1,top:2}),Og),Bg=(e,t,o)=>Ud(_g(e),Eg(e,t),o.northeast(),Xd(),"northeast",tm(e,{left:0,bottom:3}),Og),Ig=(e,t,o)=>Ud(Tg(e,t),Eg(e,t),o.northwest(),qd(),"northwest",tm(e,{right:1,bottom:3}),Og),Fg=()=>[Ag,Mg,Bg,Ig],Rg=()=>[Mg,Ag,Ig,Bg];var Ng=[i("item"),Bl(),u("overrides",{}),ic("placement",(e,t,o)=>{o=Rm(o,t.item.element),e=Bu(e.element,t,Fg(),Rg(),Fg(),Rg(),D.none());return D.some(Tu({anchorBox:o,bubble:_u(),overrides:t.overrides,layouts:e}))})],zg=la("type",{selection:zg,node:Iu,hotspot:n,submenu:Ng,makeshift:r}),Iu=[xa("classes",qr),Ba("mode","all",["all","layout","placement"])],n=[u("useFixed",de),ya("getBounds")];let Vg=[ga("anchor",zg),Ta("transition",Iu)],Lg=()=>{var e=document.documentElement;return Hm(0,0,e.clientWidth,e.clientHeight)},Hg=e=>{var t=jo(e.element),e=e.element.dom.getBoundingClientRect();return Lm(t.left,t.top,e.width,e.height)},Pg=(e,t,o,n,r,a)=>{e=Um(t.anchorBox,e);return Su(e,n.element,t.bubble,t.layouts,r,o,t.overrides,a)},Ug=(t,n,r,a,e,i)=>{let s=ia("placement.info",m(Vg),e),l=s.anchor,c=a.element,d=r.get(a.uid);Mm(()=>{M(c,"position","fixed");var e=Bo(c,"visibility");M(c,"visibility","hidden");let o=n.useFixed()?Lg():Hg(t);l.placement(t,l,o).each(e=>{var t=i.orThunk(()=>n.getBounds.map(ce)),e=Pg(o,e,t,a,d,s.transition);r.set(a.uid,e)}),e.fold(()=>{Ro(c,"visibility")},e=>{M(c,"visibility",e)}),Bo(c,"left").isNone()&&Bo(c,"top").isNone()&&Bo(c,"right").isNone()&&Bo(c,"bottom").isNone()&&ot(Bo(c,"position"),"fixed")&&Ro(c,"position")},c)},Wg=(Ng=Object.freeze({__proto__:null,position:(e,t,o,n,r)=>{var a=D.none();Ug(e,t,o,n,r,a)},positionWithinBounds:Ug,getMode:(e,t,o)=>t.useFixed()?"fixed":"absolute",reset:(e,t,o,n)=>{let r=n.element;var a;E(["position","left","right","top","bottom"],e=>Ro(r,e)),a=r,ko(a,Wm),o.clear(n.uid)}}),Es({fields:n,name:"positioning",active:t,apis:Ng,state:Object.freeze({__proto__:null,init:()=>{let o={};return _s({readState:()=>o,clear:e=>{J(e)?delete o[e]:o={}},set:(e,t)=>{o[e]=t},get:e=>k(o,e)})}})})),jg=e=>e.getSystem().isConnected(),Gg=e=>{b(e,Pi());e=e.components();E(e,Gg)},$g=e=>{var t=e.components();E(t,$g),b(e,Hi())},Yg=(e,t)=>{e.getSystem().addToWorld(t),fo(e.element)&&$g(t)},Xg=e=>{Gg(e),e.getSystem().removeFromWorld(e)},qg=(e,t)=>{Nn(e.element,t.element)},Kg=e=>{E(e.components(),e=>Hn(e.element)),Ln(e.element),e.syncComponents()},Jg=(t,e,o)=>{var n=t.components(),o=(Kg(t),o(e)),e=Ie(n,o);E(e,e=>{Gg(e),t.getSystem().removeFromWorld(e)}),E(o,e=>{jg(e)?qg(t,e):(t.getSystem().addToWorld(e),qg(t,e),fo(t.element)&&$g(e))}),t.syncComponents()},Qg=(t,e,o)=>{var n=t.components();let r=Ae(e,e=>_c(e).toArray());E(n,e=>{ve(r,e)||Xg(e)});o=o(e),e=Ie(n,o);E(e,e=>{jg(e)&&Xg(e)}),E(o,e=>{jg(e)||Yg(t,e)}),t.syncComponents()},Zg=(e,t)=>{ep(e,t,Nn)},ep=(e,t,o)=>{e.getSystem().addToWorld(t),o(e.element,t.element),fo(e.element)&&$g(t),e.syncComponents()},tp=e=>{Gg(e),Hn(e.element),e.getSystem().removeFromWorld(e)},op=t=>{var e=Jt(t.element).bind(e=>t.getSystem().getByDom(e).toOptional());tp(t),e.each(e=>{e.syncComponents()})},np=e=>{var t=e.components();E(t,tp),Ln(e.element),e.syncComponents()},rp=(e,t)=>{ip(e,t,Nn)},ap=(e,t)=>{ip(e,t,Fn)},ip=(e,t,o)=>{o(e,t.element);o=oo(t.element);E(o,e=>{t.getByDom(e).each($g)})},sp=t=>{var e=oo(t.element);E(e,e=>{t.getByDom(e).each(Gg)}),Hn(t.element)},lp=(t,e,o,n)=>{o.get().each(e=>{np(t)});e=e.getAttachPoint(t),Zg(e,t),e=t.getSystem().build(n);return Zg(t,e),o.set(e),e},cp=(e,t,o,n)=>{o=lp(e,t,o,n);return t.onOpen(e,o),o},dp=(t,o,n)=>{n.get().each(e=>{np(t),op(t),o.onClose(t,e),n.clear()})},mp=(e,t,o)=>o.isOpen(),up=(e,t,o)=>{var n,r,a=t.getAttachPoint(e);M(e.element,"position",Wg.getMode(a)),n=e,a="visibility",r=t.cloakVisibilityAttr,e="hidden",Bo(n.element,a).fold(()=>{ko(n.element,r)},e=>{A(n.element,r,e)}),M(n.element,a,e)},gp=(e,t,o)=>{var n,r,a;n=e.element,be(["top","left","right","bottom"],e=>Bo(n,e).isSome())||Ro(e.element,"position"),r=e,a="visibility",e=t.cloakVisibilityAttr,So(r.element,e).fold(()=>Ro(r.element,a),e=>M(r.element,a,e))},pp=Object.freeze({__proto__:null,cloak:up,decloak:gp,open:cp,openWhileCloaked:(e,t,o,n,r)=>{up(e,t),cp(e,t,o,n),r(),gp(e,t)},close:dp,isOpen:mp,isPartOf:(t,o,e,n)=>mp(0,0,e)&&e.get().exists(e=>o.isPartOf(t,e,n)),getState:(e,t,o)=>o.get(),setContent:(e,t,o,n)=>o.get().map(()=>lp(e,t,o,n))}),d=(r=Object.freeze({__proto__:null,events:(o,n)=>ts([F(Ii(),(e,t)=>{dp(e,o,n)})])}),zg=[o("onOpen"),o("onClose"),i("isPartOf"),i("getAttachPoint"),u("cloakVisibilityAttr","data-precloak-visibility")],Es({fields:zg,name:"sandboxing",active:r,apis:pp,state:Object.freeze({__proto__:null,init:()=>{var e=lr(),t=T("not-implemented");return _s({readState:t,isOpen:e.isSet,clear:e.clear,set:e.set,get:e.get})}})})),hp=T("dismiss.popups"),fp=T("reposition.popups"),vp=T("mouse.released"),bp=Wr([u("isExtraPart",de),Ta("fireEventInstead",[u("event",Ui())])]),xp=e=>{let o=ia("Dismissal",bp,e);return{[hp()]:{schema:Wr([i("target")]),onReceive:(t,e)=>{!d.isOpen(t)||d.isPartOf(t,e.target)||o.isExtraPart(t,e.target)||o.fireEventInstead.fold(()=>d.close(t),e=>b(t,e.event))}}}},yp=Wr([Ta("fireEventInstead",[u("event",ki())]),fa("doReposition")]),wp=e=>{let o=ia("Reposition",yp,e);return{[fp()]:{onReceive:t=>{d.isOpen(t)&&o.fireEventInstead.fold(()=>o.doReposition(t),e=>b(t,e.event))}}}},Sp=(e,t,o)=>{t.store.manager.onLoad(e,t,o)},Cp=(e,t,o)=>{t.store.manager.onUnload(e,t,o)},kp=(Iu=Object.freeze({__proto__:null,onLoad:Sp,onUnload:Cp,setValue:(e,t,o,n)=>{t.store.manager.setValue(e,t,o,n)},getValue:(e,t,o)=>t.store.manager.getValue(e,t,o),getState:(e,t,o)=>o}),n=Object.freeze({__proto__:null,events:(o,n)=>{var e=o.resetOnDom?[ds((e,t)=>{Sp(e,o,n)}),ms((e,t)=>{Cp(e,o,n)})]:[ys(o,n,Sp)];return ts(e)}}),t=()=>{let e=B(null);return _s({set:e.set,get:e.get,isNotSet:()=>null===e.get(),clear:()=>{e.set(null)},readState:()=>({mode:"memory",value:e.get()})})},Ng=()=>{let a=B({}),i=B({});return _s({readState:()=>({mode:"dataset",dataByValue:a.get(),dataByText:i.get()}),lookup:e=>k(a.get(),e).orThunk(()=>k(i.get(),e)),update:e=>{var t=a.get(),o=i.get();let n={},r={};E(e,t=>{n[t.value]=t,k(t,"meta").each(e=>{k(e,"text").each(e=>{r[e]=t})})}),a.set({...t,...n}),i.set({...o,...r})},clear:()=>{a.set({}),i.set({})}})},zg=Object.freeze({__proto__:null,memory:t,dataset:Ng,manual:()=>{var e=S;return _s({readState:e})},init:e=>e.store.manager.state(e)}),(e,t,o,n)=>{var r=t.store;o.update([n]),r.setValue(e,n),t.onSetValue(e,n)}),w=(r=[ya("initialValue"),i("getFallbackEntry"),i("getDataKey"),i("setValue"),ic("manager",{setValue:kp,getValue:(e,t,o)=>{let n=t.store,r=n.getDataKey(e);return o.lookup(r).getOrThunk(()=>n.getFallbackEntry(r))},onLoad:(t,o,n)=>{o.store.initialValue.each(e=>{kp(t,o,n,e)})},onUnload:(e,t,o)=>{o.clear()},state:Ng})],Ng=[i("getValue"),u("setValue",S),ya("initialValue"),ic("manager",{setValue:(e,t,o,n)=>{t.store.setValue(e,n),t.onSetValue(e,n)},getValue:(e,t,o)=>t.store.getValue(e),onLoad:(t,o,e)=>{o.store.initialValue.each(e=>{o.store.setValue(t,e)})},onUnload:S,state:Os.init})],t=[ya("initialValue"),ic("manager",{setValue:(e,t,o,n)=>{o.set(n),t.onSetValue(e,n)},getValue:(e,t,o)=>o.get(),onLoad:(e,t,o)=>{t.store.initialValue.each(e=>{o.isNotSet()&&o.set(e)})},onUnload:(e,t,o)=>{o.clear()},state:t})],t=[Da("store",{mode:"memory"},la("mode",{memory:t,manual:Ng,dataset:r})),o("onSetValue"),u("resetOnDom",!1)],Es({fields:t,name:"representing",active:n,apis:Iu,extra:{setValueFrom:(e,t)=>{t=w.getValue(t);w.setValue(e,t)}},state:zg})),Op=e=>e.dump,_p=(e,t)=>({...R(t),...e.dump}),Tp={field:Ng=(n,e)=>Na(n,{},C(e,e=>{return t=e.name(),o="Cannot configure "+e.name()+" for "+n,da(t,t,Sr(),Fr(e=>pr.serror("The field: "+t+" is forbidden. "+o)));var t,o}).concat([ma("dump",re)])),augment:_p,get:Op},Ep="placeholder",Dp=za([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Ap=e=>et(e,"uiType"),Mp=(e,t,o,n)=>e.exists(e=>e!==o.owner)?Dp.single(!0,T(o)):k(n,o.name).fold(()=>{throw new Error("Unknown placeholder component: "+o.name+"\nKnown: ["+Ue(n)+"]\nNamespace: "+e.getOr("none")+"\nSpec: "+JSON.stringify(o,null,2))},e=>e.replace()),Bp=(e,t,o,n)=>Ap(o)&&o.uiType===Ep?Mp(e,t,o,n):Dp.single(!1,T(o)),Ip=(n,r,a,i)=>Bp(n,r,a,i).fold((e,t)=>{var t=Ap(a)?t(r,a.config,a.validated):t(r),o=k(t,"components").getOr([]),o=Ae(o,e=>Ip(n,r,e,i));return[{...t,components:o}]},(e,t)=>{var o;return Ap(a)?(o=t(r,a.config,a.validated),a.validated.preprocess.getOr(re)(o)):t(r)}),Fp=(t,o,e,n)=>Ae(e,e=>Ip(t,o,e,n)),Rp=(e,t)=>{let o=!1;return{name:T(e),required:()=>t.fold((e,t)=>e,(e,t)=>e),used:()=>o,replace:()=>{if(o)throw new Error("Trying to use the same placeholder more than once: "+e);return o=!0,t}}},Np=(t,o,e,n)=>{n=Ge(n,(e,t)=>Rp(t,e)),e=Fp(t,o,e,n);return je(n,e=>{if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(o.components,null,2))}),e},zp=Dp.single,Vp=Dp.multiple,Lp=T(Ep);var Hp,r=za([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),t=u("factory",{sketch:re}),n=u("schema",[]),Iu=i("name"),zg=da("pname","pname",yr(e=>"<alloy."+N(e.name)+">"),Yr()),Pp=ma("schema",()=>[ya("preprocess")]),Up=u("defaults",T({})),Wp=u("overrides",T({})),jp=m([t,n,Iu,zg,Up,Wp]),Gp=m([t,n,Iu,Up,Wp]),n=m([t,n,Iu,zg,Up,Wp]),t=m([t,Pp,Iu,i("unit"),zg,Up,Wp]);let $p=e=>e.fold(D.some,D.none,D.some,D.some),Yp=e=>{var t=e=>e.name;return e.fold(t,t,t,t)},Xp=(Pp=(t,o)=>e=>{e=ia("Converting part type",o,e);return t(e)})(r.required,jp),qp=(Iu=Pp(r.external,Gp),Pp(r.optional,n)),Kp=(zg=Pp(r.group,t),T("entirety")),Jp=Object.freeze({__proto__:null,required:Xp,external:Iu,optional:qp,group:zg,asNamedPart:$p,name:Yp,asCommon:e=>e.fold(re,re,re,re),original:Kp}),Qp=(e,t,o,n)=>vr(t.defaults(e,o,n),o,{uid:e.partUids[t.name]},t.overrides(e,o,n)),Zp=(e,o,t)=>{let a={},n={};return E(t,e=>{e.fold(n=>{a[n.pname]=zp(!0,(e,t,o)=>n.factory.sketch(Qp(e,n,t,o)))},e=>{var t=o.parts[e.name];n[e.name]=T(e.factory.sketch(Qp(o,e,t[Kp()]),t))},n=>{a[n.pname]=zp(!1,(e,t,o)=>n.factory.sketch(Qp(e,n,t,o)))},r=>{a[r.pname]=Vp(!0,(t,e,o)=>{var n=t[r.name];return C(n,e=>r.factory.sketch(vr(r.defaults(t,e,o),e,r.overrides(t,e))))})})}),{internals:T(a),externals:T(n)}},eh=(r,e)=>{let a={};return E(e,e=>{$p(e).each(o=>{e=r,t=o.pname;let n={uiType:Lp(),owner:e,name:t};var e,t;a[o.name]=e=>{var t=ia("Part: "+o.name+" in "+r,m(o.schema),e);return{...n,config:e,validated:t}}})}),a},th=(e,t,o)=>({uiType:Lp(),owner:e,name:t,config:o,validated:{}}),oh=e=>Ae(e,e=>e.fold(D.none,D.some,D.none,D.none).map(e=>va(e.name,e.schema.concat([sc(Kp())]))).toArray()),nh=e=>C(e,Yp),rh=(e,t,o)=>Zp(0,t,o),ah=(e,t,o)=>Np(D.some(e),t,t.components,o),ih=(e,t,o)=>{t=t.partUids[o];return e.getSystem().getByUid(t).toOptional()},sh=(e,t,o)=>ih(e,t,o).getOrDie("Could not find part: "+o),lh=(e,t,o)=>{let n={},r=t.partUids,a=e.getSystem();return E(o,e=>{n[e]=T(a.getByUid(r[e]))}),n},ch=(e,t)=>{let o=e.getSystem();return Ge(t.partUids,(e,t)=>T(o.getByUid(e)))},dh=e=>Ue(e.partUids),mh=(e,t,o)=>{let n={},r=t.partUids,a=e.getSystem();return E(o,e=>{n[e]=T(a.getByUid(r[e]).getOrDie())}),n},uh=(t,e)=>{e=nh(e);return Wa(C(e,e=>({key:e,value:t+"-"+e})))},gh=t=>da("partUids","partUids",Cr(e=>uh(e.uid,t)),Yr()),ph=Object.freeze({__proto__:null,generate:eh,generateOne:th,schemas:oh,names:nh,substitutes:rh,components:ah,defaultUids:uh,defaultUidsSchema:gh,getAllParts:ch,getAllPartNames:dh,getPart:ih,getPartOrDie:sh,getParts:lh,getPartsOrDie:mh}),hh=(e,t)=>(0<e.length?[va("parts",e)]:[]).concat([i("uid"),u("dom",{}),u("components",[]),sc("originalSpec"),u("debug.sketcher",{})]).concat(t),fh=(e,t,o,n,r)=>{n=hh(n,r);return ia(e+" [SpecSchema]",Wr(n.concat(t)),o)},vh=(e,t,o,n)=>{n=yh(n);return o(fh(e,t,n,[],[]),n)},bh=(e,t,o,n,r)=>{var r=yh(r),a=oh(o),i=gh(o),t=fh(e,t,r,a,[i]),a=rh(e,t,o);return n(t,ah(e,t,a.internals()),r,a.externals())},xh=e=>et(e,"uid"),yh=e=>xh(e)?e:{...e,uid:xc("uid")},wh=e=>void 0!==e.uid,Sh=Wr([i("name"),i("factory"),i("configFields"),u("apis",{}),u("extraApis",{})]),Ch=Wr([i("name"),i("factory"),i("configFields"),i("partFields"),u("apis",{}),u("extraApis",{})]),kh=e=>{let t=ia("Sketcher for "+e.name,Sh,e);var e=Ge(t.apis,Tc),o=Ge(t.extraApis,(e,t)=>fs(e,t));return{name:t.name,configFields:t.configFields,sketch:e=>vh(t.name,t.configFields,t.factory,e),...e,...o}},Oh=(Up=e=>{let t=ia("Sketcher for "+e.name,Ch,e);var e=eh(t.name,t.partFields),o=Ge(t.apis,Tc),n=Ge(t.extraApis,(e,t)=>fs(e,t));return{name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:e=>bh(t.name,t.configFields,t.partFields,t.factory,e),parts:e,...o,...n}},e=>Ht("input")(e)&&"radio"!==wo(e,"type")||Ht("textarea")(e)),z=(Wp=Object.freeze({__proto__:null,getCurrent:(e,t,o)=>t.find(e)}),jp=[i("find")],Es({fields:jp,name:"composing",apis:Wp})),_h=["input","button","textarea","select"],Th=(e,t,o)=>{(t.disabled()?Ih:Fh)(e,t)},Eh=(e,t)=>!0===t.useNative&&ve(_h,Ft(e.element)),Dh=e=>{A(e.element,"disabled","disabled")},Ah=e=>{ko(e.element,"disabled")},Mh=e=>{A(e.element,"aria-disabled","true")},Bh=e=>{A(e.element,"aria-disabled","false")},Ih=(t,e,o)=>{e.disableClass.each(e=>{Ls(t.element,e)}),(Eh(t,e)?Dh:Mh)(t),e.onDisabled(t)},Fh=(t,e,o)=>{e.disableClass.each(e=>{Ps(t.element,e)}),(Eh(t,e)?Ah:Bh)(t),e.onEnabled(t)},Rh=(e,t)=>Eh(e,t)?(t=e,Co(t.element,"disabled")):(t=e,"true"===wo(t.element,"aria-disabled")),V=(Gp=Object.freeze({__proto__:null,enable:Fh,disable:Ih,isDisabled:Rh,onLoad:Th,set:(e,t,o,n)=>{(n?Ih:Fh)(e,t)}}),n=Object.freeze({__proto__:null,exhibit:(e,t)=>bs({classes:t.disabled()?t.disableClass.toArray():[]}),events:(o,e)=>ts([os(Di(),(e,t)=>Rh(e,o)),ys(o,e,Th)])}),Pp=[Fa("disabled",de),u("useNative",!0),ya("disableClass"),o("onDisabled"),o("onEnabled")],Es({fields:Pp,name:"disabling",active:n,apis:Gp})),Nh=(o,n,e,r)=>{var t=dg(o.element,"."+n.highlightClass);E(t,t=>{be(r,e=>Gt(e.element,t))||(Ps(t,n.highlightClass),o.getSystem().getByDom(t).each(e=>{n.onDehighlight(o,e),b(e,qi())}))})},zh=(e,t,o,n)=>{Nh(e,t,0,[n]),Vh(0,t,0,n)||(Ls(n.element,t.highlightClass),t.onHighlight(e,n),b(n,Xi()))},Vh=(e,t,o,n)=>Ws(n.element,t.highlightClass),Lh=(t,e,o)=>Rd(t.element,"."+e.itemClass).bind(e=>t.getSystem().getByDom(e).toOptional()),Hh=(t,e,o)=>{e=dg(t.element,"."+e.itemClass);return(0<e.length?D.some(e[e.length-1]):D.none()).bind(e=>t.getSystem().getByDom(e).toOptional())},Ph=(t,o,e,n)=>{let r=dg(t.element,"."+o.itemClass);return Ee(r,e=>Ws(e,o.highlightClass)).bind(e=>{e=dc(e,n,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()})},Uh=(t,e,o)=>{e=dg(t.element,"."+e.itemClass);return rt(C(e,e=>t.getSystem().getByDom(e).toOptional()))},Wh=Object.freeze({__proto__:null,dehighlightAll:(e,t,o)=>Nh(e,t,0,[]),dehighlight:(e,t,o,n)=>{Vh(0,t,0,n)&&(Ps(n.element,t.highlightClass),t.onDehighlight(e,n),b(n,qi()))},highlight:zh,highlightFirst:(t,o,e)=>{Lh(t,o).each(e=>{zh(t,o,0,e)})},highlightLast:(t,o,e)=>{Hh(t,o).each(e=>{zh(t,o,0,e)})},highlightAt:(t,o,e,n)=>{((e,t,o)=>{const n=dg(e.element,"."+t.itemClass);return D.from(n[o]).fold(()=>I.error(new Error("No element found with index "+o)),e.getSystem().getByDom)})(t,o,n).fold(e=>{throw e},e=>{zh(t,o,0,e)})},highlightBy:(t,o,e,n)=>{var r=Uh(t,o);Te(r,n).each(e=>{zh(t,o,0,e)})},isHighlighted:Vh,getHighlighted:(t,e,o)=>Rd(t.element,"."+e.highlightClass).bind(e=>t.getSystem().getByDom(e).toOptional()),getFirst:Lh,getLast:Hh,getPrevious:(e,t,o)=>Ph(e,t,0,-1),getNext:(e,t,o)=>Ph(e,t,0,1),getCandidates:Uh}),jh=[i("highlightClass"),i("itemClass"),o("onHighlight"),o("onDehighlight")],Gh=Es({fields:jh,name:"highlighting",apis:Wh}),$h=[8],Yh=[9],Xh=[13],qh=[27],Kh=[32],Jh=[37],Qh=[38],Zh=[39],ef=[40],tf=(e,t,o)=>{var n=Be(e.slice(0,t)),e=Be(e.slice(t+1));return Te(n.concat(e),o)},of=(e,t,o)=>{e=Be(e.slice(0,t));return Te(e,o)},nf=(e,t,o)=>{var n=e.slice(0,t),e=e.slice(t+1);return Te(e.concat(n),o)},rf=(e,t,o)=>{e=e.slice(t+1);return Te(e,o)},g=t=>e=>{e=e.raw;return ve(t,e.which)},af=e=>t=>Me(e,e=>e(t)),sf=e=>!0===e.raw.shiftKey,lf=e=>!0===e.raw.ctrlKey,cf=se(sf),p=(e,t)=>({matches:e,classification:t}),df=(e,t)=>Te(e,e=>e.matches(t)).map(e=>e.classification),mf=(e,t,o)=>{t.exists(t=>o.exists(e=>Gt(e,t)))||_(e,Wi(),{prevFocus:t,newFocus:o})},uf=()=>{let n=e=>Am(e.element);return{get:n,set:(e,t)=>{var o=n(e),t=(e.getSystem().triggerFocus(t,e.element),n(e));mf(e,o,t)}}},gf=((r=Hp=Hp||{}).OnFocusMode="onFocus",r.OnEnterOrSpaceMode="onEnterOrSpace",r.OnApiMode="onApi",(e,t,o,n,s)=>{let l=(t,o,e,n,r)=>{e=e(t,o,n,r);return df(e,o.event).bind(e=>e(t,o,n,r))};let r={schema:()=>e.concat([u("focusManager",uf()),Da("focusInside","onFocus",oa(e=>ve(["onFocus","onEnterOrSpace","onApi"],e)?I.value(e):I.error("Invalid value for focusInside"))),ic("handler",r),ic("state",t),ic("sendFocusIn",s)]),processKey:l,toEvents:(a,i)=>{var e=a.focusInside!==Hp.OnFocusMode?D.none():s(a).map(o=>F(Oi(),(e,t)=>{o(e,a,i),t.stop()}));var t=[F(pi(),(n,r)=>{l(n,r,o,a,i).fold(()=>{var t,o,e;t=n,o=r,e=g(Kh.concat(Xh))(o.event),a.focusInside===Hp.OnEnterOrSpaceMode&&e&&Ka(t,o)&&s(a).each(e=>{e(t,a,i),o.stop()})},e=>{r.stop()})}),F(hi(),(e,t)=>{l(e,t,n,a,i).each(e=>{t.stop()})})];return ts(e.toArray().concat(t))}};return r}),pf=(jp=(t=e=>{e=[ya("onEscape"),ya("onEnter"),u("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),u("firstTabstop",0),u("useTabstopAt",me),ya("visibilitySelector")].concat([e]);let n=(e,t)=>{e=e.visibilitySelector.bind(e=>Nd(t,e)).getOr(t);return 0<Vo(e)},a=(e,t)=>t.focusManager.get(e).bind(e=>Nd(e,t.selector)),i=(e,t)=>n(e,t)&&e.useTabstopAt(t),t=(t,o,e)=>{((e,t)=>{e=dg(e.element,t.selector),e=Ce(e,e=>n(t,e));return D.from(e[t.firstTabstop])})(t,o).each(e=>{o.focusManager.set(t,e)})},s=(t,e,o,n,r)=>r(e,o,e=>i(n,e)).fold(()=>n.cyclic?D.some(!0):D.none(),e=>(n.focusManager.set(t,e),D.some(!0))),r=(t,e,o,n)=>{let r=dg(t.element,o.selector);return a(t,o).bind(e=>Ee(r,ie(Gt,e)).bind(e=>s(t,r,e,o,n)))},l=(e,t,o)=>{var n=o.cyclic?tf:of;return r(e,0,o,n)},c=(e,t,o)=>{var n=o.cyclic?nf:rf;return r(e,0,o,n)},d=t=>{return e=t,Jt(e).bind(ro).exists(e=>Gt(e,t));var e};var o=T([p(af([sf,g(Yh)]),l),p(g(Yh),c),p(af([cf,g(Xh)]),(t,o,e)=>e.onEnter.bind(e=>e(t,o)))]),m=T([p(g(qh),(t,o,e)=>e.onEscape.bind(e=>e(t,o))),p(g(Yh),(t,o,n)=>a(t,n).filter(e=>!n.useTabstopAt(e)).bind(e=>(d(e)?l:c)(t,o,n)))]);return gf(e,Os.init,o,m,()=>D.some(t))})(ma("cyclic",de)),Wp=t(ma("cyclic",me)),Pp=(e,t,o)=>Oh(o)&&g(Kh)(t.event)?D.none():(t=e,e=o,Ji(t,e,Di()),D.some(!0)),(e,t)=>D.some(!0)),hf=(n=[u("execute",Pp),u("useSpace",!1),u("useEnter",!0),u("useControlEnter",!1),u("useDown",!1)],(e,t,o)=>o.execute(e,t,e.element)),ff=(Gp=gf(n,Os.init,(e,t,o,n)=>{var e=o.useSpace&&!Oh(e.element)?Kh:[],r=o.useEnter?Xh:[],a=o.useDown?ef:[],e=e.concat(r).concat(a);return[p(g(e),hf)].concat(o.useControlEnter?[p(af([lf,g(Xh)]),hf)]:[])},(e,t,o,n)=>o.useSpace&&!Oh(e.element)?[p(g(Kh),pf)]:[],()=>D.none()),r=()=>{let o=lr();return _s({readState:()=>o.get().map(e=>({numRows:String(e.numRows),numColumns:String(e.numColumns)})).getOr({numRows:"?",numColumns:"?"}),setGridSize:(e,t)=>{o.set({numRows:e,numColumns:t})},getNumRows:()=>o.get().map(e=>e.numRows),getNumColumns:()=>o.get().map(e=>e.numColumns)})},t=Object.freeze({__proto__:null,flatgrid:r,init:e=>e.state(e)}),a=>(e,t,o,n)=>{var r=a(e.element);return xf(r,e,t,o,n)}),vf=(e,t)=>{e=Eu(e,t);return ff(e)},bf=(e,t)=>{t=Eu(t,e);return ff(t)},xf=(t,o,e,n,r)=>n.focusManager.get(o).bind(e=>t(o.element,e,n,r)).map(e=>(n.focusManager.set(o,e),!0));var yf=n=r=>(e,t,o,n)=>xf(r,e,t,o,n),wf=n;let Sf=n,Cf=e=>e.offsetWidth<=0&&e.offsetHeight<=0,kf=e=>!Cf(e.dom),Of=(t,e)=>Ee(t,e).map(e=>({index:e,candidates:t})),_f=(e,t,o)=>{e=dg(e,o),o=Ce(e,kf);return Of(o,e=>Gt(e,t))},Tf=(e,t)=>Ee(e,e=>Gt(t,e)),Ef=(t,e,o,n)=>n(Math.floor(e/o),e%o).bind(e=>{e=e.row*o+e.column;return 0<=e&&e<t.length?D.some(t[e]):D.none()}),Df=(n,e,r,a,i)=>Ef(n,e,a,(e,t)=>{var o=e===r-1?n.length-e*a:a,t=dc(t,i,0,o-1);return D.some({row:e,column:t})}),Af=(n,e,r,a,i)=>Ef(n,e,a,(e,t)=>{var e=dc(e,i,0,r-1),o=e===r-1?n.length-e*a:a,t=mc(t,0,o-1);return D.some({row:e,column:t})}),Mf=(n=[i("selector"),u("execute",Pp),nc("onEscape"),u("captureTab",!1),Xl()],(t,o,e)=>{Rd(t.element,o.selector).each(e=>{o.focusManager.set(t,e)})});var Bf=(e,t,o)=>o.captureTab?D.some(!0):D.none(),If=(Nf=r=>(e,t,o,n)=>_f(e,t,o.selector).bind(e=>r(e.candidates,e.index,n.getNumRows().getOr(o.initSize.numRows),n.getNumColumns().getOr(o.initSize.numColumns))))((e,t,o,n)=>Df(e,t,o,n,-1)),Ff=Nf((e,t,o,n)=>Df(e,t,o,n,1)),Rf=Nf((e,t,o,n)=>Af(e,t,o,n,-1)),Nf=Nf((e,t,o,n)=>Af(e,t,o,n,1)),If=T([p(g(Jh),vf(If,Ff)),p(g(Zh),bf(If,Ff)),p(g(Qh),yf(Rf)),p(g(ef),wf(Nf)),p(af([sf,g(Yh)]),Bf),p(af([cf,g(Yh)]),Bf),p(g(Kh.concat(Xh)),(t,o,n,e)=>{return(r=n).focusManager.get(t).bind(e=>Nd(e,r.selector)).bind(e=>n.execute(t,o,e));var r})]),Ff=T([p(g(qh),(e,t,o)=>o.onEscape(e,t)),p(g(Kh),pf)]),Rf=gf(n,r,If,Ff,()=>D.some(Mf));let zf=(e,t,o,r,a)=>{let i=(o,e,n)=>a(o,e,r,0,n.length-1,n[e],e=>{return t=n[e],"button"===Ft(t)&&"disabled"===wo(t,"disabled")?i(o,e,n):D.from(n[e]);var t});return _f(e,o,t).bind(e=>{var t=e.index,e=e.candidates;return i(t,t,e)})},Vf=(e,t,o,n)=>zf(e,t,o,n,(e,t,o,n,r,a,i)=>{t=mc(t+o,n,r);return t===e?D.from(a):i(t)}),Lf=(e,t,o,n)=>zf(e,t,o,n,(e,t,o,n,r,a,i)=>{t=dc(t,o,n,r);return t===e?D.none():i(t)}),Hf=(Nf=[i("selector"),u("getInitial",D.none),u("execute",Pp),nc("onEscape"),u("executeOnMove",!1),u("allowVertical",!0),u("allowHorizontal",!0),u("cycles",!0)],(e,t)=>t.focusManager.get(e).bind(e=>Nd(e,t.selector))),Pf=(t,o,n)=>Hf(t,n).bind(e=>n.execute(t,o,e)),Uf=(t,o,e)=>{o.getInitial(t).orThunk(()=>Rd(t.element,o.selector)).each(e=>{o.focusManager.set(t,e)})},Wf=(e,t,o)=>(o.cycles?Lf:Vf)(e,o.selector,t,-1),jf=(e,t,o)=>(o.cycles?Lf:Vf)(e,o.selector,t,1),Gf=r=>(e,t,o,n)=>r(e,t,o,n).bind(()=>o.executeOnMove?Pf(e,t,o):D.some(!0)),$f=(Bf=T([p(g(Kh),pf),p(g(qh),(e,t,o)=>o.onEscape(e,t))]),n=gf(Nf,Os.init,(e,t,o,n)=>{var r=[...o.allowHorizontal?Jh:[]].concat(o.allowVertical?Qh:[]),o=[...o.allowHorizontal?Zh:[]].concat(o.allowVertical?ef:[]);return[p(g(r),Gf(vf(Wf,jf))),p(g(o),Gf(bf(Wf,jf))),p(g(Xh),Pf),p(g(Kh),Pf)]},Bf,()=>D.some(Uf)),(e,t,o)=>D.from(e[t]).bind(e=>D.from(e[o]).map(e=>({rowIndex:t,columnIndex:o,cell:e})))),Yf=(e,t,o,n)=>{var r=e[t].length,o=dc(o,n,0,r-1);return $f(e,t,o)},Xf=(e,t,o,n)=>{o=dc(o,n,0,e.length-1),n=e[o].length,t=mc(t,0,n-1);return $f(e,o,t)},qf=(e,t,o,n)=>{var r=e[t].length,o=mc(o+n,0,r-1);return $f(e,t,o)},Kf=(e,t,o,n)=>{o=mc(o+n,0,e.length-1),n=e[o].length,t=mc(t,0,n-1);return $f(e,o,t)},Jf=(r=[va("selectors",[i("row"),i("cell")]),u("cycles",!0),u("previousSelector",D.none),u("execute",Pp)],(t,o,e)=>{o.previousSelector(t).orThunk(()=>{var e=o.selectors;return Rd(t.element,e.cell)}).each(e=>{o.focusManager.set(t,e)})}),Qf=(Ff=(If=(e,t)=>(o,n,a)=>{let i=a.cycles?e:t;return Nd(n,a.selectors.row).bind(e=>{var t=dg(e,a.selectors.cell);return Tf(t,n).bind(n=>{let r=dg(o,a.selectors.row);return Tf(r,e).bind(e=>{o=r,t=a;var t,o=C(o,e=>dg(e,t.selectors.cell));return i(o,e,n).map(e=>e.cell)})})})})((e,t,o)=>Yf(e,t,o,-1),(e,t,o)=>qf(e,t,o,-1)),Nf=If((e,t,o)=>Yf(e,t,o,1),(e,t,o)=>qf(e,t,o,1)),Bf=If((e,t,o)=>Xf(e,o,t,-1),(e,t,o)=>Kf(e,o,t,-1)),If=If((e,t,o)=>Xf(e,o,t,1),(e,t,o)=>Kf(e,o,t,1)),Ff=T([p(g(Jh),vf(Ff,Nf)),p(g(Zh),bf(Ff,Nf)),p(g(Qh),yf(Bf)),p(g(ef),wf(If)),p(g(Kh.concat(Xh)),(t,o,n)=>Am(t.element).bind(e=>n.execute(t,o,e)))]),Nf=T([p(g(Kh),pf)]),yf=gf(r,Os.init,Ff,Nf,()=>D.some(Jf)),Bf=[i("selector"),u("execute",Pp),u("moveOnTab",!1)],wf=(t,o,n)=>n.focusManager.get(t).bind(e=>n.execute(t,o,e)),(t,o,e)=>{Rd(t.element,o.selector).each(e=>{o.focusManager.set(t,e)})}),Zf=(e,t,o)=>Lf(e,o.selector,t,-1),ev=(e,t,o)=>Lf(e,o.selector,t,1),L=(If=T([p(g(Qh),Sf(Zf)),p(g(ef),Sf(ev)),p(af([sf,g(Yh)]),(e,t,o,n)=>o.moveOnTab?Sf(Zf)(e,t,o,n):D.none()),p(af([cf,g(Yh)]),(e,t,o,n)=>o.moveOnTab?Sf(ev)(e,t,o,n):D.none()),p(g(Xh),wf),p(g(Kh),wf)]),r=T([p(g(Kh),pf)]),Ff=gf(Bf,Os.init,If,r,()=>D.some(Qf)),Nf=[nc("onSpace"),nc("onEnter"),nc("onShiftEnter"),nc("onLeft"),nc("onRight"),nc("onTab"),nc("onShiftTab"),nc("onUp"),nc("onDown"),nc("onEscape"),u("stopSpaceKeyup",!1),ya("focusIn")],Pp=gf(Nf,Os.init,(e,t,o)=>[p(g(Kh),o.onSpace),p(af([cf,g(Xh)]),o.onEnter),p(af([sf,g(Xh)]),o.onShiftEnter),p(af([sf,g(Yh)]),o.onShiftTab),p(af([cf,g(Yh)]),o.onTab),p(g(Qh),o.onUp),p(g(ef),o.onDown),p(g(Jh),o.onLeft),p(g(Zh),o.onRight),p(g(Kh),o.onSpace)],(e,t,o)=>[...o.stopSpaceKeyup?[p(g(Kh),pf)]:[],p(g(qh),o.onEscape)],e=>e.focusIn),wf=jp.schema(),Bf=Wp.schema(),If=n.schema(),r=Rf.schema(),Nf=yf.schema(),jp=Gp.schema(),Wp=Ff.schema(),n=Pp.schema(),e({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:wf,cyclic:Bf,flow:If,flatgrid:r,matrix:Nf,execution:jp,menu:Wp,special:n}),name:"keying",active:{events:(e,t)=>e.handler.toEvents(e,t)},apis:{focusIn:(t,o,n)=>{o.sendFocusIn(o).fold(()=>{t.getSystem().triggerFocus(t.element,t.element)},e=>{e(t,o,n)})},setGridSize:(e,t,o,n,r)=>{var a;a=o,tt(a,"setGridSize")?o.setGridSize(n,r):console.error("Layout does not support setGridSize")}},state:t})),tv=(e,t)=>{Mm(()=>{Jg(e,t,()=>C(t,e.getSystem().build))},e.element)},ov=(e,t)=>{Mm(()=>{Qg(e,t,()=>nd(e.element,t,e.getSystem().buildOrPatch))},e.element)},nv=(e,t,o,n)=>{Xg(t);t=od(e.element,o,n,e.getSystem().buildOrPatch);Yg(e,t),e.syncComponents()},rv=(e,t,o)=>{o=e.getSystem().build(o);ep(e,o,t)},av=(e,t,o,n)=>{op(t),rv(e,(e,t)=>zn(e,t,o),n)},iv=(e,t)=>e.components(),sv=(o,n,e,r,a)=>{var t=iv(o);return D.from(t[r]).map(t=>(a.fold(()=>op(t),e=>{(n.reuseDom?nv:av)(o,t,r,e)}),t))},H=(Rf=Object.freeze({__proto__:null,append:(e,t,o,n)=>{rv(e,Nn,n)},prepend:(e,t,o,n)=>{rv(e,Rn,n)},remove:(e,t,o,n)=>{e=iv(e);Te(e,e=>Gt(n.element,e.element)).each(op)},replaceAt:sv,replaceBy:(t,o,e,n,r)=>{var a=iv(t);return Ee(a,n).bind(e=>sv(t,o,0,e,r))},set:(e,t,o,n)=>(t.reuseDom?ov:tv)(e,n),contents:iv}),Es({fields:[Ia("reuseDom",!0)],name:"replacing",apis:Rf})),lv=(e,t)=>{t=ts(t);return Es({fields:[i("enabled")],name:e,active:{events:T(t)}})},P=(e,t)=>({key:e,value:{config:{},me:lv(e,t),configAsRaw:T({}),initialConfig:{},state:Os}}),cv=(e,t)=>{t.ignore||(_m(e.element),t.onFocus(e))},U=(yf=Object.freeze({__proto__:null,focus:cv,blur:(e,t)=>{t.ignore||Tm(e.element)},isFocused:e=>Em(e.element)}),Gp=Object.freeze({__proto__:null,exhibit:(e,t)=>{t=t.ignore?{}:{attributes:{tabindex:"-1"}};return bs(t)},events:o=>ts([F(Oi(),(e,t)=>{cv(e,o),t.stop()})].concat(o.stopMousedown?[F(si(),(e,t)=>{t.event.prevent()})]:[]))}),Ff=[o("onFocus"),u("stopMousedown",!1),u("ignore",!1)],Es({fields:Ff,name:"focusing",active:Gp,apis:yf})),dv=(e,t,o)=>{t=t.aria;t.update(e,t,o.get())},mv=(t,e,o)=>{e.toggleClass.each(e=>{(o.get()?Ls:Ps)(t.element,e)})},uv=(e,t,o,n)=>{var r=o.get();o.set(n),mv(e,t,o),dv(e,t,o),r!==n&&t.onToggled(e,n)},gv=(e,t,o)=>{uv(e,t,o,!o.get())},pv=(e,t,o)=>{uv(e,t,o,t.selected)},hv=Object.freeze({__proto__:null,onLoad:pv,toggle:gv,isOn:(e,t,o)=>o.get(),on:(e,t,o)=>{uv(e,t,o,!0)},off:(e,t,o)=>{uv(e,t,o,!1)},set:uv});var fv,vv,Pp=Object.freeze({__proto__:null,exhibit:()=>bs({}),events:(e,t)=>{o=e,n=t,r=gv;var o,n,r,a=gs(e=>{r(e,o,n)}),t=ys(e,t,pv);return ts(De([e.toggleOnExecute?[a]:[],[t]]))}});let bv=(e,t,o)=>{A(e.element,"aria-expanded",o)},xv=[u("selected",!1),ya("toggleClass"),u("toggleOnExecute",!0),o("onToggled"),Da("aria",{mode:"none"},la("mode",{pressed:[u("syncWithExpanded",!1),ic("update",(e,t,o)=>{A(e.element,"aria-pressed",o),t.syncWithExpanded&&bv(e,0,o)})],checked:[ic("update",(e,t,o)=>{A(e.element,"aria-checked",o)})],expanded:[ic("update",bv)],selected:[ic("update",(e,t,o)=>{A(e.element,"aria-selected",o)})],none:[ic("update",S)]}))],h=Es({fields:xv,name:"toggling",active:Pp,apis:hv,state:(fv=!1,{init:()=>{let t=B(fv);return{get:()=>t.get(),set:e=>t.set(e),clear:()=>t.set(fv),readState:()=>t.get()}}})}),yv=()=>{var e=(e,t)=>{t.stop(),Ki(e)};return[F(bi(),e),F(Mi(),e),ls(ni()),ls(si())]},wv=e=>ts(De([e.map(o=>gs((e,t)=>{o(e),t.stop()})).toArray(),yv()])),Sv="alloy.item-hover",Cv="alloy.item-focus",kv="alloy.item-toggled",Ov=e=>{(Am(e.element).isNone()||U.isFocused(e))&&(U.isFocused(e)||U.focus(e),_(e,Sv,{item:e}))},_v=e=>{_(e,Cv,{item:e})},Tv=(e,t)=>{_(e,kv,{item:e,state:t})},Ev=T(Sv),Dv=T(Cv),Av=T(kv),Mv=(wf=[i("data"),i("components"),i("dom"),u("hasSubmenu",!1),ya("toggling"),ya("role"),Tp.field("itemBehaviours",[h,U,L,w]),u("ignoreFocus",!1),u("domModification",{}),ic("builder",t=>{return{dom:t.dom,domModification:{...t.domModification,attributes:{role:(e=t).role.fold(()=>e.toggling.map(e=>e.exclusive?"menuitemradio":"menuitemcheckbox").getOr("menuitem"),re),...t.domModification.attributes,"aria-haspopup":t.hasSubmenu,...t.hasSubmenu?{"aria-expanded":!1}:{}}},behaviours:Tp.augment(t.itemBehaviours,[t.toggling.fold(h.revoke,e=>{return h.config((o=e,{aria:{mode:t.role.exists(e=>"option"===e)?"selected":"checked"},...Ke(o,(e,t)=>"exclusive"!==t),onToggled:(e,t)=>{Q(o.onToggled)&&o.onToggled(e,t),Tv(e,t)}}));var o}),U.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:e=>{_v(e)}}),L.config({mode:"execution"}),w.config({store:{mode:"memory",initialValue:t.data}}),P("item-type-events",[...yv(),F(mi(),Ov),F(Ai(),U.focus)])]),components:t.components,eventOrder:t.eventOrder};var e}),u("eventOrder",{})],Bf=[i("dom"),i("components"),ic("builder",e=>({dom:e.dom,components:e.components,events:ts([(e=Ai(),F(e,(e,t)=>{t.stop()}))])}))],T("item-widget")),Bv=T([Xp({name:"widget",overrides:t=>({behaviours:R([w.config({store:{mode:"manual",getValue:e=>t.data,setValue:S}})])})})]),Iv=(If=[i("uid"),i("data"),i("components"),i("dom"),u("autofocus",!1),u("ignoreFocus",!1),Tp.field("widgetBehaviours",[w,U,L]),u("domModification",{}),gh(Bv()),ic("builder",o=>{var e=rh(Mv(),o,Bv()),e=ah(Mv(),o,e.internals());let n=e=>ih(e,o,"widget").map(e=>(L.focusIn(e),e));var t=(e,t)=>(Oh(t.event.target)||o.autofocus&&t.setSource(e.element),D.none());return{dom:o.dom,components:e,domModification:o.domModification,events:ts([gs((e,t)=>{n(e).each(e=>{t.stop()})}),F(mi(),Ov),F(Ai(),(e,t)=>{o.autofocus?n(e):U.focus(e)})]),behaviours:Tp.augment(o.widgetBehaviours,[w.config({store:{mode:"memory",initialValue:o.data}}),U.config({ignore:o.ignoreFocus,onFocus:e=>{_v(e)}}),L.config({mode:"special",focusIn:o.autofocus?e=>{n(e)}:As(),onLeft:t,onRight:t,onEscape:(e,t)=>U.isFocused(e)||o.autofocus?(o.autofocus&&t.setSource(e.element),D.none()):(U.focus(e),D.some(!0))})])}})],la("type",{widget:If,item:wf,separator:Bf})),Fv=(r=T([zg({factory:{sketch:e=>{e=ia("menu.spec item",Iv,e);return e.builder(e)}},name:"items",unit:"item",defaults:(e,t)=>et(t,"uid")?t:{...t,uid:xc("item")},overrides:(e,t)=>({type:t.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}})})]),Nf=T([Ca("role"),i("value"),i("items"),i("dom"),i("components"),u("eventOrder",{}),Ng("menuBehaviours",[Gh,w,z,L]),Da("movement",{mode:"menu",moveOnTab:!0},la("mode",{grid:[Xl(),ic("config",(e,t)=>({mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:e.focusManager}))],matrix:[ic("config",(e,t)=>({mode:"matrix",selectors:{row:t.rowSelector,cell:"."+e.markers.item},previousSelector:t.previousSelector,focusManager:e.focusManager})),i("rowSelector"),u("previousSelector",D.none)],menu:[u("moveOnTab",!0),ic("config",(e,t)=>({mode:"menu",selector:"."+e.markers.item,moveOnTab:t.moveOnTab,focusManager:e.focusManager}))]})),ga("markers",Zl()),u("fakeFocus",!1),u("focusManager",uf()),o("onHighlight"),o("onDehighlight"),u("showMenuRole",!0)]),T("alloy.menu-focus")),Rv=Up({name:"Menu",configFields:Nf(),partFields:r(),factory:(e,t,o,n)=>({uid:e.uid,dom:e.dom,markers:e.markers,behaviours:_p(e.menuBehaviours,[Gh.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight,onDehighlight:e.onDehighlight}),w.config({store:{mode:"memory",initialValue:e.value}}),z.config({find:D.some}),L.config(e.movement.config(e,e.movement))]),events:ts([F(Dv(),(t,o)=>{var e=o.event;t.getSystem().getByDom(e.target).each(e=>{Gh.highlight(t,e),o.stop(),_(t,Fv(),{menu:t,item:e})})}),F(Ev(),(e,t)=>{t=t.event.item;Gh.highlight(e,t)}),F(Av(),(e,t)=>{var o,n,{item:t,state:r}=t.event;r&&"menuitemradio"===wo(t.element,"role")&&(o=e,n=t,r=dg(o.element,'[role="menuitemradio"][aria-checked="true"]'),E(r,e=>{Gt(e,n.element)||o.getSystem().getByDom(e).each(e=>{h.off(e)})}))})]),components:t,eventOrder:e.eventOrder,...e.showMenuRole?{domModification:{attributes:{role:e.role.getOr("menu")}}}:{}})}),Nv=e=>$e(e,(e,t)=>({k:e,v:t})),zv=(o,n,r,e)=>k(r,e).bind(e=>k(o,e).bind(e=>{var t=zv(o,n,r,e);return D.some([e].concat(t))})).getOr([]),Vv=e=>"prepared"===e.type?D.some(e.menu):D.none(),Lv={init:()=>{let r=B({}),a=B({}),s=B({}),l=lr(),i=B({});let c=o=>Qe(r.get(),(e,t)=>e===o);let d=e=>t(e).bind(Vv),t=e=>k(a.get(),e),o=e=>k(r.get(),e);return{setMenuBuilt:(e,t)=>{a.set({...a.get(),[e]:{type:"prepared",menu:t}})},setContents:(e,t,o,n)=>{l.set(e),r.set(o),a.set(t),i.set(n);e=((e,t)=>{let o={},n=(je(e,(e,t)=>{E(e,e=>{o[e]=t})}),t),r=Nv(t),a=Ge(r,(e,t)=>[t].concat(zv(o,n,r,t)));return Ge(o,e=>k(a,e).getOr([e]))})(n,o);s.set(e)},expand:o=>k(r.get(),o).map(e=>{var t=k(s.get(),o).getOr([]);return[e].concat(t)}),refresh:e=>k(s.get(),e),collapse:e=>k(s.get(),e).bind(e=>1<e.length?D.some(e.slice(1)):D.none()),lookupMenu:t,lookupItem:o,otherMenus:e=>{var t=i.get();return Ie(Ue(t),e)},getPrimary:()=>l.get().bind(d),getMenus:()=>a.get(),clear:()=>{r.set({}),a.set({}),s.set({}),l.clear()},isClear:()=>l.get().isNone(),getTriggeringPath:(e,i)=>{let t=Ce(o(e).toArray(),e=>d(e).isSome());return k(s.get(),e).bind(e=>{let a=Be(t.concat(e));return(t=>{var o=[];for(let e=0;e<t.length;e++){var n=t[e];if(!n.isSome())return D.none();o.push(n.getOrDie())}return D.some(o)})(Ae(a,(e,t)=>{return o=e,n=i,r=a.slice(0,t+1),d(o).bind(t=>c(o).bind(e=>n(e).map(e=>({triggeredMenu:t,triggeringItem:e,triggeringPath:r})))).fold(()=>ot(l.get(),e)?[]:[D.none()],e=>[D.some(e)]);var o,n,r}))})}}},extractPreparedMenu:Vv},Hv=N("tiered-menu-item-highlight"),Pv=N("tiered-menu-item-dehighlight"),Uv=((jp=vv=vv||{})[jp.HighlightMenuAndItem=0]="HighlightMenuAndItem",jp[jp.HighlightJustMenu=1]="HighlightJustMenu",jp[jp.HighlightNone=2]="HighlightNone",T("collapse-item")),Wv=kh({name:"TieredMenu",configFields:[ac("onExecute"),ac("onEscape"),rc("onOpenMenu"),rc("onOpenSubmenu"),o("onRepositionMenu"),o("onCollapseMenu"),u("highlightOnOpen",vv.HighlightMenuAndItem),va("data",[i("primary"),i("menus"),i("expansions")]),u("fakeFocus",!1),o("onHighlightItem"),o("onDehighlightItem"),o("onHover"),ec(),i("dom"),u("navigateOnHover",!0),u("stayInDom",!1),Ng("tmenuBehaviours",[L,Gh,z,H]),u("eventOrder",{})],apis:{collapseMenu:(e,t)=>{e.collapseMenu(t)},highlightPrimary:(e,t)=>{e.highlightPrimary(t)},repositionMenus:(e,t)=>{e.repositionMenus(t)}},factory:(l,e)=>{let n=lr(),o=(n,r,e)=>Ge(e,(e,t)=>{var o=()=>Rv.sketch({...e,value:t,markers:l.markers,fakeFocus:l.fakeFocus,onHighlight:(e,t)=>{t={menuComp:e,itemComp:t};_(e,Hv,t)},onDehighlight:(e,t)=>{t={menuComp:e,itemComp:t};_(e,Pv,t)},focusManager:(l.fakeFocus?()=>{let n=e=>Gh.getHighlighted(e).map(e=>e.element);return{get:n,set:(t,e)=>{var o=n(t),e=(t.getSystem().getByDom(e).fold(S,e=>{Gh.highlight(t,e)}),n(t));mf(t,o,e)}}}:uf)()});return t===r?{type:"prepared",menu:n.getSystem().build(o())}:{type:"notbuilt",nbMenu:o}}),c=Lv.init(),r=e=>{var e=o(e,l.data.primary,l.data.menus),t=Ge(l.data.menus,(e,t)=>Ae(e.items,e=>"separator"===e.type?[]:[e.data.value]));return c.setContents(l.data.primary,e,l.data.expansions,t),c.getPrimary()},d=e=>w.getValue(e).value,a=Gh.highlight,i=(t,o)=>{a(t,o),Gh.getHighlighted(o).orThunk(()=>Gh.getFirst(o)).each(e=>{l.fakeFocus?Gh.highlight(o,e):Ji(t,e.element,Ai())})},s=(t,e)=>rt(C(e,e=>t.lookupMenu(e).bind(e=>"prepared"===e.type?D.some(e.menu):D.none()))),m=(t,e,o)=>{e=s(e,e.otherMenus(o));E(e,e=>{Gs(e.element,[l.markers.backgroundMenu]),l.stayInDom||H.remove(t,e)})},t=t=>n.get().getOrThunk(()=>{let o={};var e=dg(t.element,"."+l.markers.item),e=Ce(e,e=>"true"===wo(e,"aria-haspopup"));return E(e,e=>{t.getSystem().getByDom(e).each(e=>{var t=d(e);o[t]=e})}),n.set(o),o}),u=(e,o)=>{e=t(e);je(e,(e,t)=>{t=ve(o,t);A(e.element,"aria-expanded",t)})},g=(o,n,r)=>D.from(r[0]).bind(e=>n.lookupMenu(e).bind(e=>{var t;return"notbuilt"===e.type?D.none():(e=e.menu,t=s(n,r.slice(1)),E(t,e=>{Ls(e.element,l.markers.backgroundMenu)}),fo(e.element)||H.append(o,Od(e)),Gs(e.element,[l.markers.backgroundMenu]),i(o,e),m(o,n,r),D.some(e))})),p;(v=p=p||{})[v.HighlightSubmenu=0]="HighlightSubmenu",v[v.HighlightParent=1]="HighlightParent";let h=(a,i,s=p.HighlightSubmenu)=>{var e;return i.hasConfigured(V)&&V.isDisabled(i)?D.some(i):(e=d(i),c.expand(e).bind(r=>(u(a,r),D.from(r[0]).bind(n=>c.lookupMenu(n).bind(e=>{t=a,o=n;var t,o="notbuilt"===(e=e).type?(t=t.getSystem().build(e.nbMenu()),c.setMenuBuilt(o,t),t):e.menu;return fo(o.element)||H.append(a,Od(o)),l.onOpenSubmenu(a,i,o,Be(r)),s===p.HighlightSubmenu?(Gh.highlightFirst(o),g(a,c,r)):(Gh.dehighlightAll(o),D.some(i))})))))},f=(t,o)=>{var e=d(o);return c.collapse(e).bind(e=>(u(t,e),g(t,c,e).map(e=>(l.onCollapseMenu(t,o,e),e))))};var v=o=>(t,e)=>Nd(e.getSource(),"."+l.markers.item).bind(e=>t.getSystem().getByDom(e).toOptional().bind(e=>o(t,e).map(me))),b=ts([F(Fv(),(t,o)=>{var e=o.event.item;c.lookupItem(d(e)).each(()=>{var e=o.event.menu,e=(Gh.highlight(t,e),d(o.event.item));c.refresh(e).each(e=>m(t,c,e))})}),gs((t,e)=>{e=e.event.target;t.getSystem().getByDom(e).each(e=>{0===d(e).indexOf("collapse-item")&&f(t,e),h(t,e,p.HighlightSubmenu).fold(()=>{l.onExecute(t,e)},S)})}),ds((t,e)=>{r(t).each(e=>{H.append(t,Od(e)),l.onOpenMenu(t,e),l.highlightOnOpen===vv.HighlightMenuAndItem?i(t,e):l.highlightOnOpen===vv.HighlightJustMenu&&a(t,e)})}),F(Hv,(e,t)=>{l.onHighlightItem(e,t.event.menuComp,t.event.itemComp)}),F(Pv,(e,t)=>{l.onDehighlightItem(e,t.event.menuComp,t.event.itemComp)}),...l.navigateOnHover?[F(Ev(),(e,t)=>{var t=t.event.item,o=e,n=t;n=d(n),c.refresh(n).bind(e=>(u(o,e),g(o,c,e))),h(e,t,p.HighlightParent),l.onHover(e,t)})]:[]]);let x=e=>Gh.getHighlighted(e).bind(Gh.getHighlighted);var y={collapseMenu:t=>{x(t).each(e=>{f(t,e)})},highlightPrimary:t=>{c.getPrimary().each(e=>{i(t,e)})},repositionMenus:o=>{c.getPrimary().bind(t=>x(o).bind(e=>{var e=d(e),t=Ze(c.getMenus());let n=rt(C(t,Lv.extractPreparedMenu));return c.getTriggeringPath(e,e=>{return t=n,o=e,Pe(t,e=>e.getSystem().isConnected()?(e=Gh.getCandidates(e),Te(e,e=>d(e)===o)):D.none());var t,o})}).map(e=>({primary:t,triggeringPath:e}))).fold(()=>{var e;e=o,D.from(e.components()[0]).filter(e=>"menu"===wo(e.element,"role")).each(e=>{l.onRepositionMenu(o,e,[])})},({primary:e,triggeringPath:t})=>{l.onRepositionMenu(o,e,t)})}};return{uid:l.uid,dom:l.dom,markers:l.markers,behaviours:_p(l.tmenuBehaviours,[L.config({mode:"special",onRight:v((e,t)=>Oh(t.element)?D.none():h(e,t,p.HighlightSubmenu)),onLeft:v((e,t)=>Oh(t.element)?D.none():f(e,t)),onEscape:v((e,t)=>f(e,t).orThunk(()=>l.onEscape(e,t).map(()=>e))),focusIn:(t,e)=>{c.getPrimary().each(e=>{Ji(t,e.element,Ai())})}}),Gh.config({highlightClass:l.markers.selectedMenu,itemClass:l.markers.menu}),z.config({find:e=>Gh.getHighlighted(e)}),H.config({})]),eventOrder:l.eventOrder,apis:y,events:b}},extraApis:{tieredData:(e,t,o)=>({primary:e,menus:t,expansions:o}),singleData:(e,t)=>({primary:e,menus:Ua(e,t),expansions:{}}),collapseItem:e=>({value:N(Uv()),meta:{text:e}})}}),jv=kh({name:"InlineView",configFields:[i("lazySink"),o("onShow"),o("onHide"),Oa("onEscape"),Ng("inlineBehaviours",[d,w,Om]),Ta("fireDismissalEventInstead",[u("event",Ui())]),Ta("fireRepositionEventInstead",[u("event",ki())]),u("getRelated",D.none),u("isExtraPart",de),u("eventOrder",D.none)],factory:(a,e)=>{let r=(e,t,o,n)=>{let r=a.lazySink(e).getOrDie();d.openWhileCloaked(e,t,()=>Wg.positionWithinBounds(r,e,o,n())),w.setValue(e,D.some({mode:"position",config:o,getBounds:n}))};let n=(e,t,o,n)=>{t=((e,t,r,o,a)=>{let i=()=>e.lazySink(t),n="horizontal"===o.type?{layouts:{onLtr:()=>Cm(),onRtl:()=>km()}}:{},s=e=>2===e.length?n:{};return Wv.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightOnOpen:o.menu.highlightOnOpen,fakeFocus:o.menu.fakeFocus,onEscape:()=>(d.close(t),e.onEscape.map(e=>e(t)),D.some(!0)),onExecute:()=>D.some(!0),onOpenMenu:(e,t)=>{Wg.positionWithinBounds(i().getOrDie(),t,r,a())},onOpenSubmenu:(e,t,o,n)=>{var r=i().getOrDie();Wg.position(r,o,{anchor:{type:"submenu",item:t,...s(n)}})},onRepositionMenu:(e,t,o)=>{let n=i().getOrDie();Wg.positionWithinBounds(n,t,r,a()),E(o,e=>{var t=s(e.triggeringPath);Wg.position(n,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem,...t}})})}})})(a,e,t,o,n);d.open(e,t),w.setValue(e,D.some({mode:"menu",menu:t}))};var t=o=>{d.isOpen(o)&&w.getValue(o).each(e=>{switch(e.mode){case"menu":d.getState(o).each(Wv.repositionMenus);break;case"position":var t=a.lazySink(o).getOrDie();Wg.positionWithinBounds(t,o,e.config,e.getBounds())}})},o={setContent:(e,t)=>{d.setContent(e,t)},showAt:(e,t,o)=>{var n=D.none;r(e,t,o,n)},showWithinBounds:r,showMenuAt:(e,t,o)=>{n(e,t,o,D.none)},showMenuWithinBounds:n,hide:e=>{d.isOpen(e)&&(w.setValue(e,D.none()),d.close(e))},getContent:e=>d.getState(e),reposition:t,isOpen:d.isOpen};return{uid:a.uid,dom:a.dom,behaviours:_p(a.inlineBehaviours,[d.config({isPartOf:(e,t,o)=>{return Pd(t,o)||(n=o,a.getRelated(e).exists(e=>Pd(e,n)));var n},getAttachPoint:e=>a.lazySink(e).getOrDie(),onOpen:e=>{a.onShow(e)},onClose:e=>{a.onHide(e)}}),w.config({store:{mode:"memory",initialValue:D.none()}}),Om.config({channels:{...xp({isExtraPart:e.isExtraPart,...a.fireDismissalEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({})}),...wp({...a.fireRepositionEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({}),doReposition:t})}})]),eventOrder:a.eventOrder,apis:o}},apis:{showAt:(e,t,o,n)=>{e.showAt(t,o,n)},showWithinBounds:(e,t,o,n,r)=>{e.showWithinBounds(t,o,n,r)},showMenuAt:(e,t,o,n)=>{e.showMenuAt(t,o,n)},showMenuWithinBounds:(e,t,o,n,r)=>{e.showMenuWithinBounds(t,o,n,r)},hide:(e,t)=>{e.hide(t)},isOpen:(e,t)=>e.isOpen(t),getContent:(e,t)=>e.getContent(t),setContent:(e,t,o)=>{e.setContent(t,o)},reposition:(e,t)=>{e.reposition(t)}}});var Gv,$v,Yv=tinymce.util.Tools.resolve("tinymce.util.Delay"),Xv=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),qv=tinymce.util.Tools.resolve("tinymce.EditorManager"),Kv=tinymce.util.Tools.resolve("tinymce.Env");(Wp=Gv=Gv||{}).default="wrap",Wp.floating="floating",Wp.sliding="sliding",Wp.scrolling="scrolling",(n=$v=$v||{}).auto="auto",n.top="top",n.bottom="bottom";var Rf=t=>e=>D.from(t(e));let Jv=e=>{var t=Kv.deviceType.isPhone(),o=Kv.deviceType.isTablet()||t;let n=e.options.register;var r=e=>y(e)||!1===e,a=e=>y(e)||Z(e);n("skin",{processor:e=>y(e)||!1===e,default:"oxide"}),n("skin_url",{processor:"string"}),n("height",{processor:a,default:Math.max(e.getElement().offsetHeight,400)}),n("width",{processor:a,default:Xv.DOM.getStyle(e.getElement(),"width")}),n("min_height",{processor:"number",default:100}),n("min_width",{processor:"number"}),n("max_height",{processor:"number"}),n("max_width",{processor:"number"}),n("style_formats",{processor:"object[]"}),n("style_formats_merge",{processor:"boolean",default:!1}),n("style_formats_autohide",{processor:"boolean",default:!1}),n("line_height_formats",{processor:"string",default:"1 1.1 1.2 1.3 1.4 1.5 2"}),n("font_family_formats",{processor:"string",default:"Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"}),n("font_size_formats",{processor:"string",default:"8pt 10pt 12pt 14pt 18pt 24pt 36pt"}),n("font_size_input_default_unit",{processor:"string",default:"pt"}),n("block_formats",{processor:"string",default:"Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre"}),n("content_langs",{processor:"object[]"}),n("removed_menuitems",{processor:"string",default:""}),n("menubar",{processor:e=>y(e)||X(e),default:!t}),n("menu",{processor:"object",default:{}}),n("toolbar",{processor:e=>X(e)||y(e)||$(e)?{value:e,valid:!0}:{valid:!1,message:"Must be a boolean, string or array."},default:!0}),xe(9,e=>{n("toolbar"+(e+1),{processor:"string"})}),n("toolbar_mode",{processor:"string",default:o?"scrolling":"floating"}),n("toolbar_groups",{processor:"object",default:{}}),n("toolbar_location",{processor:"string",default:$v.auto}),n("toolbar_persist",{processor:"boolean",default:!1}),n("toolbar_sticky",{processor:"boolean",default:e.inline}),n("toolbar_sticky_offset",{processor:"number",default:0}),n("fixed_toolbar_container",{processor:"string",default:""}),n("fixed_toolbar_container_target",{processor:"object"}),n("ui_mode",{processor:"string",default:"combined"}),n("file_picker_callback",{processor:"function"}),n("file_picker_validator_handler",{processor:"function"}),n("file_picker_types",{processor:"string"}),n("typeahead_urls",{processor:"boolean",default:!0}),n("anchor_top",{processor:r,default:"#top"}),n("anchor_bottom",{processor:r,default:"#bottom"}),n("draggable_modal",{processor:"boolean",default:!1}),n("statusbar",{processor:"boolean",default:!0}),n("elementpath",{processor:"boolean",default:!0}),n("branding",{processor:"boolean",default:!0}),n("promotion",{processor:"boolean",default:!0}),n("resize",{processor:e=>"both"===e||X(e),default:!Kv.deviceType.isTouch()}),n("sidebar_show",{processor:"string"}),n("help_accessibility",{processor:"boolean",default:e.hasPlugin("help")}),n("default_font_stack",{processor:"string[]",default:[]})},Qv=(t=t=>e=>e.options.get(t))("readonly"),Zv=t("disabled"),eb=t("height"),tb=t("width"),ob=Rf(t("min_width")),nb=Rf(t("min_height")),rb=Rf(t("max_width")),ab=Rf(t("max_height")),ib=Rf(t("style_formats")),sb=t("style_formats_merge"),lb=t("style_formats_autohide"),cb=t("content_langs"),db=t("removed_menuitems"),mb=t("toolbar_mode"),ub=t("toolbar_groups"),gb=t("toolbar_location"),pb=t("fixed_toolbar_container"),hb=t("fixed_toolbar_container_target"),fb=t("toolbar_persist"),vb=t("toolbar_sticky_offset"),bb=t("menubar"),xb=t("toolbar"),yb=t("file_picker_callback"),wb=t("file_picker_validator_handler"),Sb=t("font_size_input_default_unit"),Cb=t("file_picker_types"),kb=t("typeahead_urls"),Ob=t("anchor_top"),_b=t("anchor_bottom"),Tb=t("draggable_modal"),Eb=t("statusbar"),Db=t("elementpath"),Ab=t("branding"),Mb=t("resize"),Bb=t("paste_as_text"),Ib=t("sidebar_show"),Fb=t("promotion"),Rb=t("help_accessibility"),Nb=t("default_font_stack"),zb=t("skin"),Vb=e=>!1===e.options.get("skin"),Lb=e=>!1!==e.options.get("menubar"),Hb=e=>{var t=e.options.get("skin_url");return Vb(e)?t:t?e.documentBaseURI.toAbsolute(t):(t=e.options.get("skin"),qv.baseURL+"/skins/ui/"+t)},Pb=e=>e.options.get("line_height_formats").split(" "),Ub=e=>{var t=xb(e),o=y(t),n=$(t)&&0<t.length;return!jb(e)&&(n||o||!0===t)},Wb=t=>{var e=xe(9,e=>t.options.get("toolbar"+(e+1))),e=Ce(e,y);return lt(0<e.length,e)},jb=t=>Wb(t).fold(()=>{var e=xb(t);return ee(e,y)&&0<e.length},me),Gb=e=>gb(e)===$v.bottom,$b=e=>{var t;return e.inline?0<(t=null!=(t=pb(e))?t:"").length?Rd(vo(),t):(t=hb(e),J(t)?D.some(O.fromDom(t)):D.none()):D.none()},Yb=e=>e.inline&&$b(e).isSome(),Xb=e=>$b(e).getOrThunk(()=>co(lo(O.fromDom(e.getElement())))),qb=e=>e.inline&&!Lb(e)&&!Ub(e)&&!jb(e),Kb=e=>(e.options.get("toolbar_sticky")||e.inline)&&!Yb(e)&&!qb(e),Jb=e=>!Yb(e)&&"split"===e.options.get("ui_mode"),Qb=e=>{e=e.options.get("menu");return Ge(e,e=>({...e,items:e.items}))},Zb=Object.freeze({__proto__:null,get ToolbarMode(){return Gv},get ToolbarLocation(){return $v},register:Jv,getSkinUrl:Hb,getSkinUrlOption:e=>D.from(e.options.get("skin_url")),isReadOnly:Qv,isDisabled:Zv,getSkin:zb,isSkinDisabled:Vb,getHeightOption:eb,getWidthOption:tb,getMinWidthOption:ob,getMinHeightOption:nb,getMaxWidthOption:rb,getMaxHeightOption:ab,getUserStyleFormats:ib,shouldMergeStyleFormats:sb,shouldAutoHideStyleFormats:lb,getLineHeightFormats:Pb,getContentLanguages:cb,getRemovedMenuItems:db,isMenubarEnabled:Lb,isMultipleToolbars:jb,isToolbarEnabled:Ub,isToolbarPersist:fb,getMultipleToolbarsOption:Wb,getUiContainer:Xb,useFixedContainer:Yb,isSplitUiMode:Jb,getToolbarMode:mb,isDraggableModal:Tb,isDistractionFree:qb,isStickyToolbar:Kb,getStickyToolbarOffset:vb,getToolbarLocation:gb,isToolbarLocationBottom:Gb,getToolbarGroups:ub,getMenus:Qb,getMenubar:bb,getToolbar:xb,getFilePickerCallback:yb,getFilePickerTypes:Cb,useTypeaheadUrls:kb,getAnchorTop:Ob,getAnchorBottom:_b,getFilePickerValidatorHandler:wb,getFontSizeInputDefaultUnit:Sb,useStatusBar:Eb,useElementPath:Db,promotionEnabled:Fb,useBranding:Ab,getResize:Mb,getPasteAsText:Bb,getSidebarShow:Ib,useHelpAccessibility:Rb,getDefaultFontStack:Nb}),ex=["visible","hidden","clip"],tx=e=>0<vt(e).length&&!ve(ex,e),ox=e=>{var t;return!!Rt(e)&&(t=Ao(e,"overflow-x"),e=Ao(e,"overflow-y"),tx(t)||tx(e))},nx=e=>e.plugins.fullscreen&&e.plugins.fullscreen.isFullscreen(),rx=(t,e)=>{var o=cg(e,ox);let n=0===o.length?uo(e).map(go).map(e=>cg(e,ox)).getOr([]):o;return Ve(n).map(e=>({element:e,others:n.slice(1),isFullscreen:()=>nx(t)}))},ax=(e,t)=>Jb(e)?rx(e,t):D.none(),ix=e=>{var t=[...C(e.others,tr),ar()];return e.isFullscreen()?ar():rr(tr(e.element),t)},sx=kh({name:"Button",factory:e=>{var t=wv(e.action);let o=e.dom.tag,n=t=>k(e.dom,"attributes").bind(e=>k(e,t));return{uid:e.uid,dom:e.dom,components:e.components,events:t,behaviours:Tp.augment(e.buttonBehaviours,[U.config({}),L.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:"button"===o?{type:n("type").getOr("button"),...n("role").map(e=>({role:e})).getOr({})}:{role:e.role.getOr(n("role").getOr("button"))}},eventOrder:e.eventOrder}},configFields:[u("uid",void 0),i("dom"),u("components",[]),Tp.field("buttonBehaviours",[U,L]),ya("action"),ya("role"),u("eventOrder",{})]}),lx=e=>{e=void 0!==e.dom.attributes?e.dom.attributes:[];return Oe(e,(e,t)=>"class"===t.name?e:{...e,[t.name]:t.value},{})},cx=e=>Array.prototype.slice.call(e.dom.classList,0),dx=e=>{var e=O.fromHtml(e),t=oo(e),o=lx(e),n=cx(e),t=0===t.length?{}:{innerHtml:Fl(e)};return{tag:Ft(e),classes:n,attributes:o,...t}},mx=e=>{let t=wh(e)&&tt(e,"uid")?e.uid:xc("memento");return{get:e=>e.getSystem().getByUid(t).getOrDie(),getOpt:e=>e.getSystem().getByUid(t).toOptional(),asSpec:()=>({...e,uid:t})}},ux=(Ff=Object.freeze({__proto__:null,exhibit:(e,t)=>bs({attributes:Wa([{key:t.tabAttr,value:"true"}])})}),Gp=[u("tabAttr","data-alloy-tabstop")],Es({fields:Gp,name:"tabstopping",active:Ff})),gx=N("tooltip.exclusive"),px=N("tooltip.show"),hx=N("tooltip.hide"),fx=N("tooltip.immediateHide"),vx=N("tooltip.immediateShow"),bx=(e,t,o)=>{e.getSystem().broadcastOn([gx],{})};var xx,yf=Object.freeze({__proto__:null,hideAllExclusive:bx,immediateOpenClose:(e,t,o,n)=>b(e,n?vx:fx),isEnabled:(e,t,o)=>o.isEnabled(),setComponents:(e,t,o,n)=>{o.getTooltip().each(e=>{e.getSystem().isConnected()&&H.set(e,n)})},setEnabled:(e,t,o,n)=>o.setEnabled(n)}),Pp=Object.freeze({__proto__:null,events:(n,r)=>{let o=t=>{r.getTooltip().each(e=>{e.getSystem().isConnected()&&(op(e),n.onHide(t,e),r.clearTooltip())}),r.clearTimer()},t=t=>{var e,o;!r.isShowing()&&r.isEnabled()&&(bx(t),e=n.lazySink(t).getOrDie(),o=t.getSystem().build({dom:n.tooltipDom,components:n.tooltipComponents,events:ts("normal"===n.mode?[F(mi(),e=>{b(t,px)}),F(ci(),e=>{b(t,hx)})]:[]),behaviours:R([H.config({})])}),r.setTooltip(o),Zg(e,o),n.onShow(t,o),Wg.position(e,o,{anchor:n.anchor(t)}))},a=o=>{r.getTooltip().each(e=>{var t=n.lazySink(o).getOrDie();Wg.position(t,e,{anchor:n.anchor(o)})})};return ts(De([[us(e=>{n.onSetup(e)}),F(px,e=>{r.resetTimer(()=>{t(e)},n.delayForShow())}),F(hx,e=>{r.resetTimer(()=>{o(e)},n.delayForHide())}),F(vx,e=>{r.resetTimer(()=>{t(e)},0)}),F(fx,e=>{r.resetTimer(()=>{o(e)},0)}),F(Ei(),(e,t)=>{t.universal||ve(t.channels,gx)&&o(e)}),ms(e=>{o(e)})],(()=>{switch(n.mode){case"normal":return[F(ui(),e=>{b(e,vx)}),F(_i(),e=>{b(e,fx)}),F(mi(),e=>{b(e,px)}),F(ci(),e=>{b(e,hx)})];case"follow-highlight":return[F(Xi(),(e,t)=>{b(e,px)}),F(qi(),e=>{b(e,hx)})];case"children-normal":return[F(ui(),(t,o)=>{Am(t.element).each(e=>{Pt(o.event.target,"[data-mce-tooltip]")&&r.getTooltip().fold(()=>{b(t,vx)},e=>{r.isShowing()&&(n.onShow(t,e),a(t))})})}),F(_i(),e=>{Am(e.element).fold(()=>{b(e,fx)},S)}),F(mi(),t=>{Rd(t.element,"[data-mce-tooltip]:hover").each(e=>{r.getTooltip().fold(()=>{b(t,px)},e=>{r.isShowing()&&(n.onShow(t,e),a(t))})})}),F(ci(),e=>{Rd(e.element,"[data-mce-tooltip]:hover").fold(()=>{b(e,hx)},S)})];default:return[F(ui(),(t,o)=>{Am(t.element).each(e=>{Pt(o.event.target,"[data-mce-tooltip]")&&r.getTooltip().fold(()=>{b(t,vx)},e=>{r.isShowing()&&(n.onShow(t,e),a(t))})})}),F(_i(),e=>{Am(e.element).fold(()=>{b(e,fx)},S)})]}})()]))}}),If=[i("lazySink"),i("tooltipDom"),u("exclusive",!0),u("tooltipComponents",[]),Fa("delayForShow",T(300)),Fa("delayForHide",T(300)),Fa("onSetup",S),Ba("mode","normal",["normal","follow-highlight","children-keyboard-focus","children-normal"]),u("anchor",e=>({type:"hotspot",hotspot:e,layouts:{onLtr:T([fm,hm,mm,gm,um,pm]),onRtl:T([fm,hm,mm,gm,um,pm])},bubble:Ou(0,-2,{})})),o("onHide"),o("onShow")];let yx=Es({fields:If,name:"tooltipping",active:Pp,state:Object.freeze({__proto__:null,init:()=>{let t=B(!0),o=lr();var e=lr();let n=()=>{o.on(clearTimeout)};var r=T("not-implemented");return _s({getTooltip:e.get,isShowing:e.isSet,setTooltip:e.set,clearTooltip:e.clear,clearTimer:n,resetTimer:(e,t)=>{n(),o.set(setTimeout(e,t))},readState:r,isEnabled:()=>t.get(),setEnabled:e=>t.set(e)})}}),apis:yf}),{entries:wx,setPrototypeOf:Sx,isFrozen:Cx,getPrototypeOf:kx,getOwnPropertyDescriptor:Ox}=Object,{freeze:_x,seal:Tx,create:Ex}=Object,{apply:Dx,construct:Ax}="undefined"!=typeof Reflect&&Reflect,Mx=(_x=_x||function(e){return e},Tx=Tx||function(e){return e},Dx=Dx||function(e,t,o){return e.apply(t,o)},Ax=Ax||function(e,t){return new e(...t)},Wx(Array.prototype.forEach)),Bx=Wx(Array.prototype.pop),Ix=Wx(Array.prototype.push),Fx=Wx(String.prototype.toLowerCase),Rx=Wx(String.prototype.toString),Nx=Wx(String.prototype.match),zx=Wx(String.prototype.replace),Vx=Wx(String.prototype.indexOf),Lx=Wx(String.prototype.trim),Hx=Wx(Object.prototype.hasOwnProperty),Px=Wx(RegExp.prototype.test),Ux=(xx=TypeError,function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return Ax(xx,t)});/*! @license DOMPurify 3.1.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.1.7/LICENSE */function Wx(r){return function(e){for(var t=arguments.length,o=new Array(1<t?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];return Dx(r,e,o)}}function jx(t,o,e){var n,r=2<arguments.length&&void 0!==e?e:Fx;Sx&&Sx(t,null);let a=o.length;for(;a--;){let e=o[a];"string"==typeof e&&(n=r(e))!==e&&(Cx(o)||(o[a]=n),e=n),t[e]=!0}return t}function Gx(e){var t,o,n=Ex(null);for([t,o]of wx(e))Hx(e,t)&&(Array.isArray(o)?n[t]=(t=>{for(let e=0;e<t.length;e++)Hx(t,e)||(t[e]=null);return t})(o):o&&"object"==typeof o&&o.constructor===Object?n[t]=Gx(o):n[t]=o);return n}function $x(e,t){for(;null!==e;){var o=Ox(e,t);if(o){if(o.get)return Wx(o.get);if("function"==typeof o.value)return Wx(o.value)}e=kx(e)}return function(){return null}}let Yx=_x(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Xx=_x(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),qx=_x(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Kx=_x(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Jx=_x(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Qx=_x(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Zx=_x(["#text"]),ey=_x(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ty=_x(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),oy=_x(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ny=_x(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ry=(wf=Tx(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Bf=Tx(/<%[\w\W]*|[\w\W]*%>/gm),Xl=Tx(/\${[\w\W]*}/gm),Nf=Tx(/^data-[\-\w.\u00B7-\uFFFF]/),r=Tx(/^aria-[\-\w]+$/),Tx(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i)),ay=(jp=Tx(/^(?:\w+script|data):/i),ki=Tx(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Tx(/^html$/i));var Wp=Tx(/^[a-z][.\w]*(-[.\w]+)+$/i),iy=Object.freeze({__proto__:null,MUSTACHE_EXPR:wf,ERB_EXPR:Bf,TMPLIT_EXPR:Xl,DATA_ATTR:Nf,ARIA_ATTR:r,IS_ALLOWED_URI:ry,IS_SCRIPT_OR_DATA:jp,ATTR_WHITESPACE:ki,DOCTYPE_NAME:ay,CUSTOM_ELEMENT:Wp});let sy={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12};var ly=function N(e){e=0<arguments.length&&void 0!==e?e:"undefined"==typeof window?null:window;let d=e=>N(e);if(d.version="3.1.7",d.removed=[],!e||!e.document||e.document.nodeType!==sy.document)return d.isSupported=!1,d;let r=e.document,s=r,z=s.currentScript,{DocumentFragment:V,HTMLTemplateElement:L,Node:l,Element:H,NodeFilter:t,NamedNodeMap:P=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:U,DOMParser:W,trustedTypes:m}=e;e=H.prototype;let j=$x(e,"cloneNode"),G=$x(e,"remove"),$=$x(e,"nextSibling"),Y=$x(e,"childNodes"),i=$x(e,"parentNode");"function"==typeof L&&(e=r.createElement("template")).content&&e.content.ownerDocument&&(r=e.content.ownerDocument);function X(e){return e instanceof RegExp||e instanceof Function}function c(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(!B||B!==e){if(e=Gx(e=e&&"object"==typeof e?e:{}),A=-1===Ne.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,M="application/xhtml+xml"===A?Rx:Fx,h=Hx(e,"ALLOWED_TAGS")?jx({},e.ALLOWED_TAGS,M):pe,f=Hx(e,"ALLOWED_ATTR")?jx({},e.ALLOWED_ATTR,M):he,Fe=Hx(e,"ALLOWED_NAMESPACES")?jx({},e.ALLOWED_NAMESPACES,Rx):Re,Me=Hx(e,"ADD_URI_SAFE_ATTR")?jx(Gx(Be),e.ADD_URI_SAFE_ATTR,M):Be,De=Hx(e,"ADD_DATA_URI_TAGS")?jx(Gx(Ae),e.ADD_DATA_URI_TAGS,M):Ae,O=Hx(e,"FORBID_CONTENTS")?jx({},e.FORBID_CONTENTS,M):Ee,b=Hx(e,"FORBID_TAGS")?jx({},e.FORBID_TAGS,M):{},fe=Hx(e,"FORBID_ATTR")?jx({},e.FORBID_ATTR,M):{},o=!!Hx(e,"USE_PROFILES")&&e.USE_PROFILES,ve=!1!==e.ALLOW_ARIA_ATTR,be=!1!==e.ALLOW_DATA_ATTR,xe=e.ALLOW_UNKNOWN_PROTOCOLS||!1,ye=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,x=e.SAFE_FOR_TEMPLATES||!1,we=!1!==e.SAFE_FOR_XML,y=e.WHOLE_DOCUMENT||!1,w=e.RETURN_DOM||!1,S=e.RETURN_DOM_FRAGMENT||!1,C=e.RETURN_TRUSTED_TYPE||!1,Ce=e.FORCE_BODY||!1,ke=!1!==e.SANITIZE_DOM,Oe=e.SANITIZE_NAMED_PROPS||!1,Te=!1!==e.KEEP_CONTENT,k=e.IN_PLACE||!1,ge=e.ALLOWED_URI_REGEXP||ry,D=e.NAMESPACE||E,v=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&X(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(v.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&X(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(v.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(v.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),x&&(be=!1),S&&(w=!0),o&&(h=jx({},Zx),f=[],!0===o.html&&(jx(h,Yx),jx(f,ey)),!0===o.svg&&(jx(h,Xx),jx(f,ty),jx(f,ny)),!0===o.svgFilters&&(jx(h,qx),jx(f,ty),jx(f,ny)),!0===o.mathMl)&&(jx(h,Jx),jx(f,oy),jx(f,ny)),e.ADD_TAGS&&jx(h=h===pe?Gx(h):h,e.ADD_TAGS,M),e.ADD_ATTR&&jx(f=f===he?Gx(f):f,e.ADD_ATTR,M),e.ADD_URI_SAFE_ATTR&&jx(Me,e.ADD_URI_SAFE_ATTR,M),e.FORBID_CONTENTS&&jx(O=O===Ee?Gx(O):O,e.FORBID_CONTENTS,M),Te&&(h["#text"]=!0),y&&jx(h,["html","head","body"]),h.table&&(jx(h,["tbody"]),delete b.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw Ux('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw Ux('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');u=e.TRUSTED_TYPES_POLICY,g=u.createHTML("")}else null!==(u=void 0===u?((e,t)=>{if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let o=null;var n="data-tt-policy-suffix",t="dompurify"+((o=t&&t.hasAttribute(n)?t.getAttribute(n):o)?"#"+o:"");try{return e.createPolicy(t,{createHTML(e){return e},createScriptURL(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+t+" could not be created."),null}})(m,z):u)&&"string"==typeof g&&(g=u.createHTML(""));_x&&_x(e),B=e}}function q(e){let t=null,o=null;Ce?e="<remove></remove>"+e:(n=Nx(e,/^[\r\n\t ]+/),o=n&&n[0]),"application/xhtml+xml"===A&&D===E&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var n=u?u.createHTML(e):e;if(D===E)try{t=(new W).parseFromString(n,A)}catch(e){}if(!t||!t.documentElement){t=a.createDocument(D,"template",null);try{t.documentElement.innerHTML=Ie?g:n}catch(e){}}return n=t.body||t.documentElement,e&&o&&n.insertBefore(r.createTextNode(o),n.childNodes[0]||null),D===E?re.call(t,y?"html":"body")[0]:y?t.documentElement:n}function K(e){return oe.call(e.ownerDocument||e,e,t.SHOW_ELEMENT|t.SHOW_COMMENT|t.SHOW_TEXT|t.SHOW_PROCESSING_INSTRUCTION|t.SHOW_CDATA_SECTION,null)}function J(e){return"function"==typeof l&&e instanceof l}function Q(t){let o=null;if(R("beforeSanitizeElements",t,null),!We(t)){var e=M(t.nodeName);if(R("uponSanitizeElement",t,{tagName:e,allowedTags:h}),(!t.hasChildNodes()||J(t.firstElementChild)||!Px(/<[/\w]/g,t.innerHTML)||!Px(/<[/\w]/g,t.textContent))&&!(t.nodeType===sy.progressingInstruction||we&&t.nodeType===sy.comment&&Px(/<[/\w]/g,t.data))){if(h[e]&&!b[e])return t instanceof H&&!(e=>{let t=i(e);t&&t.tagName||(t={namespaceURI:D,tagName:"template"});var o=Fx(e.tagName),n=Fx(t.tagName);return!!Fe[e.namespaceURI]&&(e.namespaceURI===T?t.namespaceURI===E?"svg"===o:t.namespaceURI===_?"svg"===o&&("annotation-xml"===n||Ve[n]):Boolean(Pe[o]):e.namespaceURI===_?t.namespaceURI===E?"math"===o:t.namespaceURI===T?"math"===o&&Le[n]:Boolean(Ue[o]):e.namespaceURI===E?!(t.namespaceURI===T&&!Le[n]||t.namespaceURI===_&&!Ve[n]||Ue[o])&&(He[o]||!Pe[o]):!("application/xhtml+xml"!==A||!Fe[e.namespaceURI]))})(t)||("noscript"===e||"noembed"===e||"noframes"===e)&&Px(/<\/no(script|embed|frames)/i,t.innerHTML)?(I(t),!0):(x&&t.nodeType===sy.text&&(o=t.textContent,Mx([p,ie,se],e=>{o=zx(o,e," ")}),t.textContent!==o)&&(Ix(d.removed,{element:t.cloneNode()}),t.textContent=o),R("afterSanitizeElements",t,null),!1);if(!b[e]&&Z(e)){if(v.tagNameCheck instanceof RegExp&&Px(v.tagNameCheck,e))return;if(v.tagNameCheck instanceof Function&&v.tagNameCheck(e))return}if(Te&&!O[e]){var n=i(t)||t.parentNode,r=Y(t)||t.childNodes;if(r&&n)for(let e=r.length-1;0<=e;--e){var a=j(r[e],!0);a.__removalCount=(t.__removalCount||0)+1,n.insertBefore(a,$(t))}}}}return I(t),1}function Z(e){return"annotation-xml"!==e&&Nx(e,ue)}function ee(o){R("beforeSanitizeAttributes",o,null);var n=o.attributes;if(n){var r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:f};let e=n.length;for(;e--;){var{name:a,namespaceURI:i,value:s}=n[e],l=M(a);let t="value"===a?s:Lx(s);if(s=t,r.attrName=l,r.attrValue=t,r.keepAttr=!0,r.forceKeepAttr=void 0,R("uponSanitizeAttribute",o,r),t=r.attrValue,!r.forceKeepAttr)if(r.keepAttr)if(!ye&&Px(/\/>/i,t))F(a,o);else{x&&Mx([p,ie,se],e=>{t=zx(t,e," ")});var c=M(o.nodeName);if(je(c,l,t))if(!Oe||"id"!==l&&"name"!==l||(F(a,o),t=_e+t),we&&Px(/((--!?|])>)|<\/(style|title)/i,t))F(a,o);else{if(u&&"object"==typeof m&&"function"==typeof m.getAttributeType&&!i)switch(m.getAttributeType(c,l)){case"TrustedHTML":t=u.createHTML(t);break;case"TrustedScriptURL":t=u.createScriptURL(t)}if(t!==s)try{i?o.setAttributeNS(i,a,t):o.setAttribute(a,t),We(o)?I(o):Bx(d.removed)}catch(e){}}else F(a,o)}else F(a,o)}R("afterSanitizeAttributes",o,null)}}function te(e){var t,o=K(e);for(R("beforeSanitizeShadowDOM",e,null);t=o.nextNode();)R("uponSanitizeShadowNode",t,null),Q(t)||(t.content instanceof V&&te(t.content),ee(t));R("afterSanitizeShadowDOM",e,null)}let u,g="",{implementation:a,createNodeIterator:oe,createDocumentFragment:ne,getElementsByTagName:re}=r,ae=s.importNode,n={},{MUSTACHE_EXPR:p,ERB_EXPR:ie,TMPLIT_EXPR:se,DATA_ATTR:le,ARIA_ATTR:ce,IS_SCRIPT_OR_DATA:de,ATTR_WHITESPACE:me,CUSTOM_ELEMENT:ue}=(d.isSupported="function"==typeof wx&&"function"==typeof i&&a&&void 0!==a.createHTMLDocument,iy),ge=iy.IS_ALLOWED_URI,h=null,pe=jx({},[...Yx,...Xx,...qx,...Jx,...Zx]),f=null,he=jx({},[...ey,...ty,...oy,...ny]),v=Object.seal(Ex(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),b=null,fe=null,ve=!0,be=!0,xe=!1,ye=!0,x=!1,we=!0,y=!1,Se=!1,Ce=!1,w=!1,S=!1,C=!1,ke=!0,Oe=!1,_e="user-content-",Te=!0,k=!1,o={},O=null,Ee=jx({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),De=null,Ae=jx({},["audio","video","img","source","image","track"]),Me=null,Be=jx({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),_="http://www.w3.org/1998/Math/MathML",T="http://www.w3.org/2000/svg",E="http://www.w3.org/1999/xhtml",D=E,Ie,Fe=null,Re=jx({},[_,T,E],Rx),A=null,Ne=["application/xhtml+xml","text/html"],M=null,B=null,ze=r.createElement("form"),Ve=jx({},["mi","mo","mn","ms","mtext"]),Le=jx({},["annotation-xml"]),He=jx({},["title","style","font","a","script"]),Pe=jx({},[...Xx,...qx,...Kx]),Ue=jx({},[...Jx,...Qx]),I=function(t){Ix(d.removed,{element:t});try{i(t).removeChild(t)}catch(e){G(t)}},F=function(e,t){try{Ix(d.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){Ix(d.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!f[e])if(w||S)try{I(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},We=function(e){return e instanceof U&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof P)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},R=function(e,t,o){n[e]&&Mx(n[e],e=>{e.call(d,t,o,B)})},je=function(e,t,o){if(ke&&("id"===t||"name"===t)&&(o in r||o in ze))return!1;if((!be||fe[t]||!Px(le,t))&&(!ve||!Px(ce,t)))if(!f[t]||fe[t]){if(!(Z(e)&&(v.tagNameCheck instanceof RegExp&&Px(v.tagNameCheck,e)||v.tagNameCheck instanceof Function&&v.tagNameCheck(e))&&(v.attributeNameCheck instanceof RegExp&&Px(v.attributeNameCheck,t)||v.attributeNameCheck instanceof Function&&v.attributeNameCheck(t))||"is"===t&&v.allowCustomizedBuiltInElements&&(v.tagNameCheck instanceof RegExp&&Px(v.tagNameCheck,o)||v.tagNameCheck instanceof Function&&v.tagNameCheck(o))))return!1}else if(!Me[t]&&!Px(ge,zx(o,me,""))&&("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==Vx(o,"data:")||!De[e])&&(!xe||Px(de,zx(o,me,"")))&&o)return!1;return!0};return d.sanitize=function(e){var t,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};let n=null,r=null;if("string"!=typeof(e=(Ie=!e)?"\x3c!--\x3e":e)&&!J(e)){if("function"!=typeof e.toString)throw Ux("toString is not a function");if("string"!=typeof(e=e.toString()))throw Ux("dirty is not a string, aborting")}if(!d.isSupported)return e;if(Se||c(o),d.removed=[],k="string"!=typeof e&&k){if(e.nodeName){o=M(e.nodeName);if(!h[o]||b[o])throw Ux("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof l)(o=(n=q("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType===sy.element&&"BODY"===o.nodeName||"HTML"===o.nodeName?n=o:n.appendChild(o);else{if(!w&&!x&&!y&&-1===e.indexOf("<"))return u&&C?u.createHTML(e):e;if(!(n=q(e)))return w?null:C?g:""}n&&Ce&&I(n.firstChild);for(var a=K(k?e:n);t=a.nextNode();)Q(t)||(t.content instanceof V&&te(t.content),ee(t));if(k)return e;if(w){if(S)for(r=ne.call(n.ownerDocument);n.firstChild;)r.appendChild(n.firstChild);else r=n;return r=f.shadowroot||f.shadowrootmode?ae.call(s,r,!0):r}let i=y?n.outerHTML:n.innerHTML;return y&&h["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&Px(ay,n.ownerDocument.doctype.name)&&(i="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+i),x&&Mx([p,ie,se],e=>{i=zx(i,e," ")}),u&&C?u.createHTML(i):i},d.setConfig=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};c(e),Se=!0},d.clearConfig=function(){B=null,Se=!1},d.isValidAttribute=function(e,t,o){return B||c({}),e=M(e),t=M(t),je(e,t,o)},d.addHook=function(e,t){"function"==typeof t&&(n[e]=n[e]||[],Ix(n[e],t))},d.removeHook=function(e){if(n[e])return Bx(n[e])},d.removeHooks=function(e){n[e]&&(n[e]=[])},d.removeAllHooks=function(){n={}},d}();let cy=e=>ly().sanitize(e);var dy=tinymce.util.Tools.resolve("tinymce.util.I18n");let my={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},uy="temporary-placeholder",gy=e=>()=>k(e,uy).getOr("!not found!"),py=(e,t)=>{var o,e=e.toLowerCase();return dy.isRtl()&&(o=gt(e,"-rtl"),et(t,o))?o:e},hy=(e,t)=>k(t,py(e,t)),fy=(e,t)=>{t=t();return hy(e,t).getOrThunk(gy(t))},vy=(e,t,o)=>{t=t();return hy(e,t).or(o).getOrThunk(gy(t))},by=e=>!!dy.isRtl()&&et(my,e),xy=()=>P("add-focusable",[ds(e=>{Fd(e.element,"svg").each(e=>A(e,"focusable","false"))})]),yy=(e,t,o,n)=>{var r=by(t)?["tox-icon--flip"]:[],t=k(o,py(t,o)).or(n).getOrThunk(gy(o));return{dom:{tag:e.tag,attributes:null!=(n=e.attributes)?n:{},classes:e.classes.concat(r),innerHtml:t},behaviours:R([...null!=(o=e.behaviours)?o:[],xy()])}},wy=(e,t,o,n=D.none())=>yy(t,e,o(),n),Sy={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Cy=kh({name:"Notification",factory:t=>{var e=N("notification-text");let o=mx({dom:dx(`<p id=${e}>${cy(t.backstageProvider.translate(t.text))}</p>`),behaviours:R([H.config({})])}),n=e=>({dom:{tag:"div",classes:["tox-bar"],styles:{width:e+"%"}}}),r=e=>({dom:{tag:"div",classes:["tox-text"],innerHtml:e+"%"}}),a=mx({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[n(0)]},r(0)],behaviours:R([H.config({})])});var i={updateProgress:(e,t)=>{e.getSystem().isConnected()&&a.getOpt(e).each(e=>{H.set(e,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[n(t)]},r(t)])})},updateText:(e,t)=>{e.getSystem().isConnected()&&(e=o.get(e),H.set(e,[xd(t)]))}},s=De([t.icon.toArray(),t.level.toArray(),t.level.bind(e=>D.from(Sy[e])).toArray()]),l=mx(sx.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"],attributes:{"aria-label":t.backstageProvider.translate("Close")}},components:[wy("close",{tag:"span",classes:["tox-icon"]},t.iconProvider)],buttonBehaviours:R([ux.config({}),yx.config({...t.backstageProvider.tooltips.getConfig({tooltipText:t.backstageProvider.translate("Close")})})]),action:e=>{t.onAction(e)}})),s=[((e,t,o)=>{let n=o();o=Te(e,e=>et(n,py(e,n)));return yy(t,o.getOr(uy),n,D.none())})(s,{tag:"div",classes:["tox-notification__icon"]},t.iconProvider),{dom:{tag:"div",classes:["tox-notification__body"]},components:[o.asSpec()],behaviours:R([H.config({})])}];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert","aria-labelledby":e},classes:t.level.map(e=>["tox-notification","tox-notification--in","tox-notification--"+e]).getOr(["tox-notification","tox-notification--in"])},behaviours:R([ux.config({}),U.config({}),L.config({mode:"special",onEscape:e=>(t.onAction(e),D.some(!0))})]),components:s.concat(t.progress?[a.asSpec()]:[]).concat([l.asSpec()]),apis:i}},configFields:[ya("level"),i("progress"),ya("icon"),i("onAction"),i("text"),i("iconProvider"),i("backstageProvider")],apis:{updateProgress:(e,t,o)=>{e.updateProgress(t,o)},updateText:(e,t,o)=>{e.updateText(t,o)}}});var ky=(c,e,d,m)=>{let u=e.backstage.shared,g=()=>O.fromDom(""===c.queryCommandValue("ToggleView")?c.getContentAreaContainer():c.getContainer()),p=()=>{var e=tr(g());return D.some(e)},h=e=>{p().each(t=>{E(e,e=>{Ro(e.element,"width"),Xo(e.element)>t.width&&M(e.element,"width",t.width+"px")})})};return{open:(e,r,a)=>{let t=()=>{let n=(e,t)=>{(0===oo(e.element).length?(e,t)=>{if(jv.hide(e),m.clear(),t)c.focus()}:(e,t)=>{if(t)L.focusIn(e)})(e,t)};m.on(e=>{r();var t,o=a();t=e,H.remove(t,i),l(),n(e,o)})},i=kd(Cy.sketch({text:e.text,level:ve(["success","error","warning","warn","info"],e.type)?e.type:void 0,progress:!0===e.progressBar,icon:e.icon,onAction:t,iconProvider:u.providers.icons,backstageProvider:u.providers}));if(m.isSet()){let t=Od(i);m.on(e=>{H.append(e,t),jv.reposition(e),lc.refresh(e),h(e.components())})}else{var o=kd(jv.sketch({dom:{tag:"div",classes:["tox-notifications-container"],attributes:{"aria-label":"Notifications",role:"region"}},lazySink:u.getSink,fireDismissalEventInstead:{},...u.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}},inlineBehaviours:R([L.config({mode:"cyclic",selector:".tox-notification, .tox-notification a, .tox-notification button"}),H.config({}),...Kb(c)&&!u.header.isPositionedAtTop()?[]:[lc.config({contextual:{lazyContext:()=>D.some(tr(g())),fadeInClass:"tox-notification-container-dock-fadein",fadeOutClass:"tox-notification-container-dock-fadeout",transitionClass:"tox-notification-container-dock-transition"},modes:["top"],lazyViewport:e=>ax(c,e.element).map(e=>({bounds:ix(e),optScrollEnv:D.some({currentScrollTop:e.element.dom.scrollTop,scrollElmTop:jo(e.element).top})})).getOrThunk(()=>({bounds:ar(),optScrollEnv:D.none()}))})]])})),n=Od(i),s={maxHeightFunction:yu()},s={...u.anchors.banner(),overrides:s};m.set(o),d.add(o),jv.showWithinBounds(o,n,{anchor:s},p)}Z(e.timeout)&&0<e.timeout&&Yv.setEditorTimeout(c,()=>{t()},e.timeout);let l=()=>{m.on(e=>{jv.reposition(e),lc.refresh(e),h(e.components())})};return{close:t,reposition:l,text:e=>{Cy.updateText(i,e)},settings:e,getEl:()=>i.element.dom,progressBar:{value:e=>{Cy.updateProgress(i,e)}}}},close:e=>{e.close()},getArgs:e=>e.settings}};let Oy={setup:(o,e)=>{let n=(e,t)=>{_(e,pi(),{raw:t})},r=()=>o.getMenu().bind(Gh.getHighlighted);e.on("keydown",t=>{var e=t.which;o.isActive()&&(o.isMenuOpen()?13===e?(r().each(Ki),t.preventDefault()):40===e?(r().fold(()=>{o.getMenu().each(Gh.highlightFirst)},e=>{n(e,t)}),t.preventDefault(),t.stopImmediatePropagation()):37!==e&&38!==e&&39!==e||r().each(e=>{n(e,t),t.preventDefault(),t.stopImmediatePropagation()}):13!==e&&38!==e&&40!==e||o.cancelIfNecessary())}),e.on("NodeChange",()=>{!o.isActive()||o.isProcessingAction()||e.queryCommandState("mceAutoCompleterInRange")||o.cancelIfNecessary()})}};(n=Ew=Ew||{})[n.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",n[n.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var _y=Ew;let Ty="tox-menu-nav__js",Ey="tox-collection__item",Dy="tox-swatch",Ay={normal:Ty,color:Dy},My="tox-collection__item--enabled",By="tox-collection__item-icon",Iy="tox-collection__item-label",Fy="tox-collection__item-accessory",Ry="tox-collection__item-caret",Ny="tox-collection__item-checkmark",zy="tox-collection__item--active",Vy="tox-collection__item-container",Ly="tox-collection__item-container--column",Hy="tox-collection__item-container--row",Py="tox-collection__item-container--align-right",Uy="tox-collection__item-container--align-left",Wy="tox-collection__item-container--valign-top",jy="tox-collection__item-container--valign-middle",Gy="tox-collection__item-container--valign-bottom",$y=e=>k(Ay,e).getOr(Ty),Yy=e=>"color"===e?"tox-swatches":"tox-menu",Xy=e=>({backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:Yy(e),tieredMenu:"tox-tiered-menu"}),qy=e=>{var t=Xy(e);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:$y(e)}},Ky=(e,t,o)=>{o=Xy(o);return{tag:"div",classes:De([[o.menu,`tox-menu-${t}-column`],e?[o.hasIcons]:[]])}},Jy=[Rv.parts.items({})],Qy=(e,t,o)=>{var n=Xy(o);return{dom:{tag:"div",classes:De([[n.tieredMenu]])},markers:qy(o)}},Zy=(Rf=T([Ma("type","text"),ya("data"),u("inputAttributes",{}),u("inputStyles",{}),u("tag","input"),u("inputClasses",[]),o("onSetValue"),Fa("fromInputValue",re),Fa("toInputValue",re),u("styles",{}),u("eventOrder",{}),Ng("inputBehaviours",[w,U]),u("selectOnFocus",!0)]),o=>R([U.config({onFocus:o.selectOnFocus?e=>{var e=e.element,t=Jc(e);"range"!==o.type&&e.dom.setSelectionRange(0,t.length)}:S})])),ew=e=>({tag:e.tag,attributes:{type:e.type,...e.inputAttributes},styles:e.inputStyles,classes:e.inputClasses}),tw=kh({name:"Input",configFields:Rf(),factory:(e,t)=>{return{uid:e.uid,dom:ew(e),components:[],behaviours:(o=e,{...Zy(o),..._p(o.inputBehaviours,[w.config({store:{mode:"manual",...o.data.map(e=>({initialValue:e})).getOr({}),getValue:e=>o.fromInputValue(Jc(e.element)),setValue:(e,t)=>{Jc(e.element)!==t&&Qc(e.element,o.toInputValue(t))}},onSetValue:o.onSetValue})])}),eventOrder:e.eventOrder};var o}}),ow=N("refetch-trigger-event"),nw=N("redirect-menu-item-interaction"),rw="tox-menu__searcher",aw=t=>Rd(t.element,"."+rw).bind(e=>t.getSystem().getByDom(e).toOptional()),iw=aw,sw=(e,t)=>{w.setValue(e,t.fetchPattern),e.element.dom.selectionStart=t.selectionStart,e.element.dom.selectionEnd=t.selectionEnd},lw=e=>({fetchPattern:w.getValue(e),selectionStart:e.element.dom.selectionStart,selectionEnd:e.element.dom.selectionEnd}),cw=(t,e)=>{So(e.element,"id").each(e=>A(t.element,"aria-activedescendant",e))},dw=t=>{var e=(e,t)=>(t.cut(),D.none()),o=(e,t)=>{t={interactionEvent:t.event,eventType:t.event.raw.type};return _(e,nw,t),D.some(!0)},n="searcher-events";return{dom:{tag:"div",classes:[Ey]},components:[tw.sketch({inputClasses:[rw,"tox-textfield"],inputAttributes:{...t.placeholder.map(e=>({placeholder:t.i18n(e)})).getOr({}),type:"search","aria-autocomplete":"list"},inputBehaviours:R([P(n,[F(fi(),e=>{b(e,ow)}),F(pi(),(e,t)=>{"Escape"===t.event.raw.key&&t.stop()})]),L.config({mode:"special",onLeft:e,onRight:e,onSpace:e,onEnter:o,onEscape:o,onUp:o,onDown:o})]),eventOrder:{keydown:[n,L.name()]}})]}},mw="tox-collection--results__js",uw=e=>{var t;return e.dom?{...e,dom:{...e.dom,attributes:{...null!=(t=e.dom.attributes)?t:{},id:N("aria-item-search-result-id"),"aria-selected":"false"}}}:e},gw=(t,o)=>e=>{e=ye(e,o);return C(e,e=>({dom:t,components:e}))},pw=e=>({dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Rv.parts.items({preprocess:"auto"!==e?gw({tag:"div",classes:["tox-swatches__row"]},e):re})]}]}),hw=e=>({dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Rv.parts.items({preprocess:gw({tag:"div",classes:["tox-collection__group"]},e)})]}),fw=(e,o)=>{let n=[],r=[];return E(e,(e,t)=>{(!o(e,t)||(0<r.length&&n.push(r),r=[],et(e.dom,"innerHtml"))||e.components&&0<e.components.length)&&r.push(e)}),0<r.length&&n.push(r),C(n,e=>({dom:{tag:"div",classes:["tox-collection__group"]},components:e}))},vw=(t,o,n)=>Rv.parts.items({preprocess:e=>{e=C(e,n);return"auto"!==t&&1<t?gw({tag:"div",classes:["tox-collection__group"]},t)(e):fw(e,(e,t)=>"separator"===o[t].type)}}),bw=(e,t,o=0)=>({dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[vw(e,t,re)]}),xw=(e,t,o=0)=>{var n=N("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection",mw].concat(1===e?["tox-collection--list"]:["tox-collection--grid"]),attributes:{id:n}},components:[vw(e,t,uw)]}},yw=(e,t,o)=>{var n=N("aria-controls-search-results");return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===e?["tox-collection--list"]:["tox-collection--grid"])},components:[dw({i18n:dy.translate,placeholder:o.placeholder}),{dom:{tag:"div",classes:[...1===e?["tox-collection--list"]:["tox-collection--grid"],mw],attributes:{id:n}},components:[vw(e,t,uw)]}]}},ww=(o,e=0)=>({dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Rv.parts.items({preprocess:e=>fw(e,(e,t)=>"separator"===o[t].type)})]}),Sw=e=>be(e,e=>"icon"in e&&void 0!==e.icon),Cw=e=>(console.error(sa(e)),console.log(e),D.none()),kw=(e,t,o,n,r)=>{var a=ww(o);return{value:e,dom:a.dom,components:a.components,items:o}},Ow=(e,t,o,n,r)=>{var a;return"color"===r.menuType?{value:e,dom:(a=pw(n)).dom,components:a.components,items:o}:"normal"===r.menuType&&"auto"===n?{value:e,dom:(a=bw(n,o)).dom,components:a.components,items:o}:"normal"===r.menuType||"searchable"===r.menuType?{value:e,dom:(a="searchable"!==r.menuType?bw(n,o):"search-with-field"===r.searchMode.searchMode?yw(n,o,r.searchMode):xw(n,o)).dom,components:a.components,items:o}:"listpreview"===r.menuType&&"auto"!==n?{value:e,dom:(a=hw(n)).dom,components:a.components,items:o}:{value:e,dom:Ky(t,n,r.menuType),components:Jy,items:o}},_w=pa("type"),Tw=(t=pa("name"),pa("label"));var Gp=pa("text"),Ff=pa("title"),If=pa("icon"),Pp=pa("value"),yf=fa("fetch"),wf=fa("getSubmenuItems"),Bf=fa("onAction"),Xl=fa("onItemAction"),Nf=Fa("onSetup",()=>S),r=Ca("name"),jp=Ca("text"),ki=Ca("role"),Wp=Ca("icon"),n=Ca("tooltip"),Ew=Ca("label"),Dw=Ca("shortcut"),Aw=Oa("select"),Mw=Ia("active",!1),Bw=Ia("borderless",!1),Iw=Ia("enabled",!0),Fw=Ia("primary",!1),Rw=e=>u("columns",e),Nw=u("meta",{}),zw=Fa("onAction",S),Vw=e=>Ma("type",e),Lw=e=>da("name","name",yr(()=>N(e+"-name")),qr);let Hw=m([_w,jp]),Pw=e=>ra("separatormenuitem",Hw,e),Uw=m([Vw("autocompleteitem"),Mw,Iw,Nw,Pp,jp,Wp]),Ww=e=>ra("Autocompleter.Separator",Hw,e),jw=e=>ra("Autocompleter.Item",Uw,e);var Gw=[Iw,n,Wp,jp,Nf,Ma("context","mode:design")];let $w=m([_w,Bf,Dw].concat(Gw)),Yw=e=>ra("toolbarbutton",$w,e);var Xw=[Mw].concat(Gw);let qw=m(Xw.concat([_w,Bf,Dw])),Kw=e=>ra("ToggleButton",qw,e);var Jw=[Fa("predicate",de),Ba("scope","node",["node","editor"]),Ba("position","selection",["node","selection","line"])],Qw=Gw.concat([Vw("contextformbutton"),Ma("align","end"),Fw,Bf,ma("original",re)]),Zw=Xw.concat([Vw("contextformbutton"),Ma("align","end"),Fw,Bf,ma("original",re)]),e0=Gw.concat([Vw("contextformbutton")]),Xw=Xw.concat([Vw("contextformtogglebutton")]),Qw=[Ew,xa("commands",la("type",{contextformbutton:Qw,contextformtogglebutton:Zw})),wa("launch",la("type",{contextformbutton:e0,contextformtogglebutton:Xw})),Fa("onInput",S),Fa("onSetup",S)],Zw=[...Jw,...Qw,ha("type",["contextform"]),Fa("initValue",T("")),Ca("placeholder")],e0=[...Jw,...Qw,ha("type",["contextsliderform"]),Fa("initValue",T(0)),Fa("min",T(0)),Fa("max",T(100))],Xw=[...Jw,...Qw,ha("type",["contextsizeinputform"]),Fa("initValue",T({width:"",height:""}))];let t0=la("type",{contextform:Zw,contextsliderform:e0,contextsizeinputform:Xw}),o0=e=>ra("ContextForm",t0,e),n0=m([Vw("contexttoolbar"),ga("items",f([qr,$r([Ca("name"),Ca("label"),xa("items",qr)])]))].concat(Jw)),r0=e=>({name:e.name.getOrUndefined(),label:e.label.getOrUndefined(),items:e.items}),a0=e=>({...e,items:y(e.items)?e.items:C(e.items,r0)}),i0=e=>ra("ContextToolbar",n0,e),s0=(Qw=[_w,pa("src"),Ca("alt"),Ra("classes",[],qr)],m(Qw)),l0=(Zw=[_w,Gp,r,Ra("classes",["tox-collection__item-label"],qr)],m(Zw)),c0=(e0=v(()=>ta("type",{cardimage:s0,cardtext:l0,cardcontainer:c0})),m([_w,Ma("direction","horizontal"),Ma("align","left"),Ma("valign","middle"),xa("items",e0)]));var d0,Xw=[Iw,jp,ki,Dw,(d0="menuitem",da("value","value",yr(()=>N(d0+"-value")),Yr())),Nw,Ma("context","mode:design")];let m0=m([_w,Ew,xa("items",e0),Nf,zw].concat(Xw)),u0=e=>ra("cardmenuitem",m0,e),g0=m([_w,Mw,Wp].concat(Xw)),p0=e=>ra("choicemenuitem",g0,e),h0=(Vw=[_w,pa("fancytype"),zw],Jw=[u("initData",{})].concat(Vw),Qw=[Oa("select"),Na("initData",{},[Ia("allowCustomColors",!0),Ma("storageKey","default"),_a("colors",Yr())])].concat(Vw),la("fancytype",{inserttable:Jw,colorswatch:Qw})),f0=e=>ra("fancymenuitem",h0,e),v0=m([_w,Nf,zw,Wp].concat(Xw)),b0=e=>ra("menuitem",v0,e),x0=m([_w,wf,Nf,Wp].concat(Xw)),y0=e=>ra("nestedmenuitem",x0,e),w0=m([_w,Wp,Mw,Nf,Bf].concat(Xw)),S0=e=>ra("togglemenuitem",w0,e),C0=(e,o,t)=>{let n=dg(e.element,"."+t);return 0<n.length?(e=Ee(n,e=>{var e=e.dom.getBoundingClientRect().top,t=n[0].dom.getBoundingClientRect().top;return Math.abs(e-t)>o}).getOr(n.length),D.some({numColumns:e,numRows:Math.ceil(n.length/e)})):D.none()},k0=(e,t)=>R([P(e,t)]),O0={namedEvents:k0,unnamedEvents:e=>k0(N("unnamed-events"),e)},_0=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),T0={item:e=>V.config({disabled:e,disableClass:"tox-collection__item--state-disabled"}),button:e=>V.config({disabled:e}),splitButton:e=>V.config({disabled:e,disableClass:"tox-tbtn--disabled"}),toolbarButton:e=>V.config({disabled:e,disableClass:"tox-tbtn--disabled",useNative:!1})},E0=(e,t)=>{let o=e.getApi(t);return e=>{e(o)}},D0=(t,o)=>ds(e=>{Q(t.onBeforeSetup)&&t.onBeforeSetup(e),E0(t,e)(e=>{e=t.onSetup(e);Q(e)&&o.set(e)})}),A0=(t,o)=>ms(e=>E0(t,e)(o.get())),M0="silver.uistate",B0="setDisabled",I0="setEnabled",F0="init",R0=["switchmode",F0],N0=(e,t)=>{let o=e.mainUi.outerContainer;e=[e.mainUi.mothership,...e.uiMotherships];t===B0&&E(e,e=>{e.broadcastOn([hp()],{target:o.element})}),E(e,e=>{e.broadcastOn([M0],t)})},z0=(o,n)=>{o.on("init SwitchMode",e=>{N0(n,e.type)}),o.on("DisabledStateChange",e=>{var t;e.isDefaultPrevented()||(t=e.state?B0:F0,N0(n,t),e.state)||o.nodeChanged()}),o.on("NodeChange",e=>{e=o.ui.isEnabled()?e.type:B0;N0(n,e)}),Qv(o)&&o.mode.set("readonly")},V0=r=>Om.config({channels:{[M0]:{onReceive:(e,t)=>{var o,n;t===B0||t===I0?V.set(e,t===B0):({contextType:o,shouldDisable:n}=r(),"mode"===o&&!ve(R0,t)||V.set(e,n))}}}}),L0=(o,n)=>gs((e,t)=>{E0(o,e)(o.onAction),o.triggersSubmenu||n!==_y.CLOSE_ON_EXECUTE||(e.getSystem().isConnected()&&b(e,Ii()),t.stop())}),H0={[Di()]:["disabling","alloy.base.behaviour","toggling","item-events"]},P0=rt,U0=(e,t,o,n)=>{var r=B(S);return{type:"item",dom:t.dom,components:P0(t.optComponents),data:e.data,eventOrder:H0,hasSubmenu:e.triggersSubmenu,itemBehaviours:R([P("item-events",[L0(e,o),D0(e,r),A0(e,r)]),T0.item(()=>!e.enabled||n.checkUiComponentContext(e.context).shouldDisable),V0(()=>n.checkUiComponentContext(e.context)),H.config({})].concat(e.itemBehaviours))}},W0=e=>({value:e.value,meta:{text:e.text.getOr(""),...e.meta}}),j0=e=>{var t=Kv.os.isMacOS()||Kv.os.isiOS();let o=t?{alt:"⌥",ctrl:"⌃",shift:"⇧",meta:"⌘",access:"⌃⌥"}:{meta:"Ctrl",access:"Shift+Alt"};e=e.split("+"),e=C(e,e=>{var t=e.toLowerCase().trim();return et(o,t)?o[t]:e});return t?e.join(""):e.join("+")},G0=(e,t,o=[By])=>wy(e,{tag:"div",classes:o},t),$0=e=>({dom:{tag:"div",classes:[Iy]},components:[xd(dy.translate(e))]}),Y0=(e,t)=>({dom:{tag:"div",classes:t,innerHtml:e}}),X0=(e,t)=>({dom:{tag:"div",classes:[Iy]},components:[{dom:{tag:e.tag,styles:e.styles},components:[xd(dy.translate(t))]}]}),q0=e=>({dom:{tag:"div",classes:[Fy]},components:[xd(j0(e))]}),K0=e=>G0("checkmark",e,[Ny]),J0=(e,t)=>{var o="vertical"===e.direction?Ly:Hy,n="left"===e.align?Uy:Py;return{dom:{tag:"div",classes:[Vy,o,n,(()=>{switch(e.valign){case"top":return Wy;case"middle":return jy;case"bottom":return Gy}})()]},components:t}},Q0=(e,t,o)=>({dom:{tag:"img",classes:t,attributes:{src:e,alt:o.getOr("")}}}),Z0=(e,t,o)=>{let n=e.value,r=e.iconContent.map(e=>vy(e,t.icons,o)),a=e.ariaLabel.map(e=>({"aria-label":t.translate(e),"data-mce-name":e})).getOr({});var i;return{dom:(e=Dy,i=r.getOr(""),e={tag:"div",attributes:a,classes:[e]},"custom"===n?{...e,tag:"button",classes:[...e.classes,"tox-swatches__picker-btn"],innerHtml:i}:"remove"===n?{...e,classes:[...e.classes,"tox-swatch--remove"],innerHtml:i}:J(n)?{...e,attributes:{...e.attributes,"data-mce-color":n},styles:{"background-color":n},innerHtml:i}:e),optComponents:[]}},eS=e=>{e=e.map(e=>({attributes:{id:N("menu-item"),"aria-label":dy.translate(e)}})).getOr({});return{tag:"div",classes:[Ty,Ey],...e}},tS=(e,t,o,n)=>{let r={tag:"div",classes:[By]};var o=o?e.iconContent.map(e=>wy(e,r,t.icons,n)).orThunk(()=>D.some({dom:r})):D.none(),a=e.checkMark;let i=D.from(e.meta).fold(()=>$0,e=>et(e,"style")?ie(X0,e.style):$0);var s=e.htmlContent.fold(()=>e.textContent.map(i),e=>D.some(Y0(e,[Iy])));return{dom:eS(e.ariaLabel),optComponents:[o,s,e.shortcutContent.map(q0),a,e.caret]}},oS=(e,t,o,n=D.none())=>"color"===e.presets?Z0(e,t,n):tS(e,t,o,n),nS=(e,t,o)=>k(e,"tooltipWorker").map(o=>[yx.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:e=>({type:"submenu",item:e,overrides:{maxHeightFunction:yu}}),mode:"follow-highlight",onShow:(t,e)=>{o(e=>{yx.setComponents(t,[yd({element:O.fromDom(e)})])})}})]).getOrThunk(()=>o.map(e=>[yx.config({...t.providers.tooltips.getConfig({tooltipText:e}),mode:"follow-highlight"})]).getOr([])),rS=e=>Xv.DOM.encode(e),aS=(e,t)=>{e=dy.translate(e),e=rS(e);return 0<t.length?(t=new RegExp(_0(t),"gi"),e.replace(t,e=>`<span class="tox-autocompleter-highlight">${e}</span>`)):e},iS=(e,o)=>C(e,e=>{switch(e.type){case"cardcontainer":return J0(e,iS(e.items,o));case"cardimage":return Q0(e.src,e.classes,e.alt);case"cardtext":var t=e.name.exists(e=>ve(o.cardText.highlightOn,e))?D.from(o.cardText.matchText).getOr(""):"";return Y0(aS(e.text,t),e.classes)}}),sS=(t,e,o,n,r,a,i,s=!0)=>{o=oS({presets:o,textContent:e?t.text:D.none(),htmlContent:D.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:e?t.shortcut:D.none(),checkMark:e?D.some(K0(i.icons)):D.none(),caret:D.none(),value:t.value},i,s),s=t.text.filter(T(!e)).map(e=>yx.config(i.tooltips.getConfig({tooltipText:i.translate(e)})));return vr(U0({context:t.context,data:W0(t),enabled:t.enabled,getApi:t=>({setActive:e=>{h.set(t,e)},isActive:()=>h.isOn(t),isEnabled:()=>!V.isDisabled(t),setEnabled:e=>V.set(t,!e)}),onAction:e=>n(t.value),onSetup:e=>(e.setActive(r),S),triggersSubmenu:!1,itemBehaviours:[...s.toArray()]},o,a,i),{toggling:{toggleClass:My,toggleOnExecute:!1,selected:t.active,exclusive:!0}})},lS=eh(Mv(),Bv()),cS=e=>({value:gS(e)}),dS=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,mS=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,uS=e=>dS.test(e)||mS.test(e),gS=e=>ut(e,"#").toUpperCase(),pS=e=>uS(e)?D.some({value:gS(e)}):D.none(),hS=e=>({value:e.value.replace(dS,(e,t,o,n)=>t+t+o+o+n+n)}),fS=e=>{e=hS(e),e=mS.exec(e.value);return null===e?["FFFFFF","FF","FF","FF"]:e},vS=e=>{e=e.toString(16);return(1===e.length?"0"+e:e).toUpperCase()},bS=e=>{e=vS(e.red)+vS(e.green)+vS(e.blue);return cS(e)},xS=Math.min,yS=Math.max,wS=Math.round,SS=/^\s*rgb\s*\(\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*(\d+)\s*\)\s*$/i,CS=/^\s*rgba\s*\(\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*((?:\d?\.\d+|\d+)%?)\s*\)\s*$/i,kS=(e,t,o,n)=>({red:e,green:t,blue:o,alpha:n}),OS=e=>{var t=parseInt(e,10);return t.toString()===e&&0<=t&&t<=255},_S=e=>{let t,o,n;var r=(e.hue||0)%360,a=e.saturation/100,e=e.value/100,a=yS(0,xS(a,1)),e=yS(0,xS(e,1));if(0===a)t=o=n=wS(255*e);else{var r=r/60,i=e*a,s=i*(1-Math.abs(r%2-1)),a=e-i;switch(Math.floor(r)){case 0:t=i,o=s,n=0;break;case 1:t=s,o=i,n=0;break;case 2:t=0,o=i,n=s;break;case 3:t=0,o=s,n=i;break;case 4:t=s,o=0,n=i;break;case 5:t=i,o=0,n=s;break;default:t=o=n=0}t=wS(255*(t+a)),o=wS(255*(o+a)),n=wS(255*(n+a))}return kS(t,o,n,1)},TS=e=>{var e=fS(e),t=parseInt(e[1],16),o=parseInt(e[2],16),e=parseInt(e[3],16);return kS(t,o,e,1)},ES=(e,t,o,n)=>{e=parseInt(e,10),t=parseInt(t,10),o=parseInt(o,10),n=parseFloat(n);return kS(e,t,o,n)},DS=e=>{var t=SS.exec(e);return null!==t?D.some(ES(t[1],t[2],t[3],"1")):null!==(t=CS.exec(e))?D.some(ES(t[1],t[2],t[3],t[4])):D.none()},AS=e=>`rgba(${e.red},${e.green},${e.blue},${e.alpha})`,MS=kS(255,0,0,1),BS=e=>{e.dispatch("SkinLoaded")},IS=(e,t)=>{e.dispatch("SkinLoadError",t)},FS=e=>{e.dispatch("ResizeEditor")},RS=(e,t)=>{e.dispatch("ResizeContent",t)},NS=(e,t)=>{e.dispatch("ScrollContent",t)},zS=(e,t)=>{e.dispatch("TextColorChange",t)},VS=(e,t)=>{e.dispatch("AfterProgressState",{state:t})},LS=(e,t)=>e.dispatch("ResolveName",{name:t.nodeName.toLowerCase(),target:t}),HS=(e,t)=>{e.dispatch("ToggleToolbarDrawer",{state:t})},PS=(e,t)=>{e.dispatch("StylesTextUpdate",t)},US=(e,t)=>{e.dispatch("AlignTextUpdate",t)},WS=(e,t)=>{e.dispatch("FontSizeTextUpdate",t)},jS=(e,t)=>{e.dispatch("FontSizeInputTextUpdate",t)},GS=(e,t)=>{e.dispatch("BlocksTextUpdate",t)},$S=(e,t)=>{e.dispatch("FontFamilyTextUpdate",t)},YS=e=>{e.dispatch("ContextToolbarClose")},XS=e=>{e.dispatch("ContextFormSlideBack")},qS=(e,t)=>()=>{e(),t()},KS=t=>ZS(t,"NodeChange",e=>{e.setEnabled(t.selection.isEditable())}),JS=(n,r)=>t=>{let o=sr(),e=()=>{t.setActive(n.formatter.match(r));var e=n.formatter.formatChanged(r,t.setActive);o.set(e)};return n.initialized?e():n.once("init",e),()=>{n.off("init",e),o.clear()}},QS=(n,r)=>e=>{let t=KS(n)(e),o=JS(n,r)(e);return()=>{t(),o()}},ZS=(n,r,a)=>e=>{let t=()=>a(e),o=()=>{a(e),n.on(r,t)};return n.initialized?o():n.once("init",o),()=>{n.off("init",o),n.off(r,t)}},eC=t=>e=>()=>{t.undoManager.transact(()=>{t.focus(),t.execCommand("mceToggleFormat",!1,e.format)})},tC=(e,t)=>()=>e.execCommand(t);var oC=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");let nC={},rC=(t,o=10)=>{var e=oC.getItem(t),e=y(e)?JSON.parse(e):[];let n=o-(e=e).length<0?e.slice(0,o):e;let r=e=>{n.splice(e,1)};return{add:e=>{fe(n,e).each(r),n.unshift(e),n.length>o&&n.pop(),oC.setItem(t,JSON.stringify(n))},state:()=>n.slice(0)}},aC=o=>k(nC,o).getOrThunk(()=>{var e="tinymce-custom-colors-"+o,t=oC.getItem(e),t=(K(t)&&(t=oC.getItem("tinymce-custom-colors"),oC.setItem(e,J(t)?t:"[]")),rC(e,10));return nC[o]=t}),iC=e=>C(aC(e).state(),e=>({type:"choiceitem",text:e,icon:"checkmark",value:e})),sC=(e,t)=>{aC(e).add(t)},lC=(e,t,o)=>({hue:e,saturation:t,value:o}),cC=e=>{let t=0;var o=e.red/255,n=e.green/255,e=e.blue/255,r=Math.min(o,Math.min(n,e)),a=Math.max(o,Math.max(n,e));return r===a?(t=r,lC(0,0,100*t)):(n=60*((o===r?3:e===r?1:5)-(o===r?n-e:e===r?o-n:e-o)/(a-r)),e=(a-r)/a,t=a,lC(Math.round(n),Math.round(100*e),Math.round(100*t)))},dC=e=>cC(TS(e)),mC=e=>bS(_S(e)),uC=r=>pS(r).orThunk(()=>DS(r).map(bS)).getOrThunk(()=>{var e=document.createElement("canvas"),t=(e.height=1,e.width=1,e.getContext("2d")),e=(t.clearRect(0,0,e.width,e.height),t.fillStyle="#FFFFFF",t.fillStyle=r,t.fillRect(0,0,1,1),t.getImageData(0,0,1,1).data),t=e[0],o=e[1],n=e[2],e=e[3];return bS(kS(t,o,n,e))}),gC="forecolor",pC="hilitecolor",hC=5,fC=e=>vC(e.map((e,t)=>t%2==0?"#"+uC(e).value:e)),vC=t=>{var o=[];for(let e=0;e<t.length;e+=2)o.push({text:t[e+1],value:t[e],icon:"checkmark",type:"choiceitem"});return o},bC=t=>e=>e.options.get(t),xC="#000000",yC=e=>{var t=e.options.register,o=e=>ee(e,y)?{value:fC(e),valid:!0}:{valid:!1,message:"Must be an array of strings."},n=e=>Z(e)&&0<e?{value:e,valid:!0}:{valid:!1,message:"Must be a positive number."};t("color_map",{processor:o,default:["#BFEDD2","Light Green","#FBEEB8","Light Yellow","#F8CAC6","Light Red","#ECCAFA","Light Purple","#C2E0F4","Light Blue","#2DC26B","Green","#F1C40F","Yellow","#E03E2D","Red","#B96AD9","Purple","#3598DB","Blue","#169179","Dark Turquoise","#E67E23","Orange","#BA372A","Dark Red","#843FA1","Dark Purple","#236FA1","Dark Blue","#ECF0F1","Light Gray","#CED4D9","Medium Gray","#95A5A6","Gray","#7E8C8D","Dark Gray","#34495E","Navy Blue","#000000","Black","#ffffff","White"]}),t("color_map_raw",{processor:e=>ee(e,y)?{value:vC(e),valid:!0}:{valid:!1,message:"Must be an array of strings."}}),t("color_map_background",{processor:o}),t("color_map_foreground",{processor:o}),t("color_cols",{processor:n,default:SC(e)}),t("color_cols_foreground",{processor:n,default:CC(e,gC)}),t("color_cols_background",{processor:n,default:CC(e,pC)}),t("custom_colors",{processor:"boolean",default:!0}),t("color_default_foreground",{processor:"string",default:xC}),t("color_default_background",{processor:"string",default:xC})},wC=(e,t)=>(t===gC&&e.options.isSet("color_map_foreground")?bC("color_map_foreground"):t===pC&&e.options.isSet("color_map_background")?bC("color_map_background"):e.options.isSet("color_map_raw")?bC("color_map_raw"):bC("color_map"))(e),SC=(e,t="default")=>Math.max(hC,Math.ceil(Math.sqrt(wC(e,t).length))),CC=(e,t)=>{var o=bC("color_cols")(e),t=SC(e,t);return o===SC(e)?t:o},kC=(e,t="default")=>Math.round((t===gC?bC("color_cols_foreground"):t===pC?bC("color_cols_background"):bC("color_cols"))(e)),OC=bC("custom_colors"),_C=bC("color_default_foreground"),TC=bC("color_default_background"),EC="rgba(0, 0, 0, 0)",DC=e=>DS(e).exists(e=>0!==e.alpha),AC=e=>qa(e,e=>Nt(e)?(e=Ao(e,"background-color"),lt(DC(e),e)):D.none()).getOr(EC),MC=(e,t)=>{e=O.fromDom(e.selection.getStart()),t="hilitecolor"===t?AC(e):Ao(e,"color");return DS(t).map(e=>"#"+bS(e).value)},BC=(e,t,o)=>{e.undoManager.transact(()=>{e.focus(),e.formatter.apply(t,{value:o}),e.nodeChanged()})},IC=(e,t)=>{e.undoManager.transact(()=>{e.focus(),e.formatter.remove(t,{value:null},void 0,!0),e.nodeChanged()})},FC=o=>{o.addCommand("mceApplyTextcolor",(e,t)=>{BC(o,e,t)}),o.addCommand("mceRemoveTextcolor",e=>{IC(o,e)})},RC=e=>{var t="choiceitem",o={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return e?[o,{type:t,text:"Custom color",icon:"color-picker",value:"custom"}]:[o]},NC=(t,o,e,n)=>{"custom"===e?GC(t)(e=>{e.each(e=>{sC(o,e),t.execCommand("mceApplyTextcolor",o,e),n(e)})},MC(t,o).getOr(xC)):"remove"===e?(n(""),t.execCommand("mceRemoveTextcolor",o)):(n(e),t.execCommand("mceApplyTextcolor",o,e))},zC=(e,t,o)=>e.concat(iC(t).concat(RC(o))),VC=(t,o,n)=>e=>{e(zC(t,o,n))},LC=(e,t,o)=>{e.setIconFill("forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",o)},HC=(e,t)=>{e.setTooltip(t)},PC=(o,n)=>e=>{var t=MC(o,n);return ot(t,e.toUpperCase())},UC=(e,t,o)=>{var n;return xt(o)?"forecolor"===t?"Text color":"Background color":(n="forecolor"===t?"Text color {0}":"Background color {0}",t=zC(wC(e,t),t,!1),t=Te(t,e=>e.value===o).getOr({text:""}).text,e.translate([n,e.translate(t)]))},WC=(o,n,r,a)=>{o.ui.registry.addSplitButton(n,{tooltip:UC(o,r,a.get()),presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:PC(o,r),columns:kC(o,r),fetch:VC(wC(o,r),r,OC(o)),onAction:e=>{NC(o,r,a.get(),S)},onItemAction:(e,t)=>{NC(o,r,t,e=>{a.set(e),zS(o,{name:n,color:e})})},onSetup:t=>{LC(t,n,a.get());let e=e=>{e.name===n&&(LC(t,e.name,e.color),HC(t,UC(o,r,e.color)))};return o.on("TextColorChange",e),qS(KS(o)(t),()=>{o.off("TextColorChange",e)})}})},jC=(t,o,n,e,r)=>{t.ui.registry.addNestedMenuItem(o,{text:e,icon:"forecolor"===o?"text-color":"highlight-bg-color",onSetup:e=>(HC(e,UC(t,n,r.get())),LC(e,o,r.get()),KS(t)(e)),getSubmenuItems:()=>[{type:"fancymenuitem",fancytype:"colorswatch",select:PC(t,n),initData:{storageKey:n},onAction:e=>{NC(t,n,e.value,e=>{r.set(e),zS(t,{name:o,color:e})})}}]})},GC=r=>(o,e)=>{let n=!1;r.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:e},onAction:(e,t)=>{"hex-valid"===t.name&&(n=t.value)},onSubmit:e=>{var t=e.getData().colorpicker;n?(o(D.from(t)),e.close()):r.windowManager.alert(r.translate(["Invalid hex color code: {0}",t]))},onClose:S,onCancel:()=>{o(D.none())}})},$C=e=>{FC(e);var t=_C(e),o=TC(e),t=B(t),o=B(o);WC(e,"forecolor","forecolor",t),WC(e,"backcolor","hilitecolor",o),jC(e,"forecolor","forecolor","Text color",t),jC(e,"backcolor","hilitecolor","Background color",o)},YC=(e,t,o,n,r,a,i,s)=>{var l=Sw(t),c="color"!==r?"normal":"color",t=XC(t,o,n,c,a,i,s),o={menuType:r};return Ow(e,l,t,n,o)},XC=(t,o,n,r,a,i,s)=>rt(C(t,e=>"choiceitem"===e.type?p0(e).fold(Cw,e=>D.some(sS(e,1===n,r,o,i(e.value),a,s,Sw(t)))):D.none())),qC=(e,t)=>{var o=qy(t);return 1===e?{mode:"menu",moveOnTab:!0}:"auto"===e?{mode:"grid",selector:"."+o.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===t?"tox-swatches__row":"tox-collection__group"),previousSelector:e=>"color"===t?Rd(e.element,"[aria-checked=true]"):D.none()}},KC=N("cell-over"),JC=N("cell-execute"),QC=(t,o,e)=>{let n=e=>_(e,JC,{row:t,col:o});var r=(e,t)=>{t.stop(),n(e)};return kd({dom:{tag:"div",attributes:{role:"button","aria-label":e}},behaviours:R([P("insert-table-picker-cell",[F(mi(),U.focus),F(Di(),n),F(bi(),r),F(Mi(),r)]),h.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),U.config({onFocus:e=>_(e,KC,{row:t,col:o})})])})},ZC=(e,t)=>xd(t+"x"+e),ek={inserttable:(r,e)=>{var o;o=e;let a=((o,e,n)=>{var r=[];for(let t=0;t<e;t++){var a=[];for(let e=0;e<n;e++){var i=o(t+1,e+1);a.push(QC(t,e,i))}r.push(a)}return r})((e,t)=>o.shared.providers.translate(["{0} columns, {1} rows",t,e]),10,10),t=ZC(0,0),i=mx({dom:{tag:"span",classes:["tox-insert-table-picker__label"]},components:[t],behaviours:R([H.config({})])});return{type:"widget",data:{value:N("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[lS.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:(e=a,Ae(e,e=>C(e,Od)).concat(i.asSpec())),behaviours:R([P("insert-table-picker",[ds(e=>{H.set(i.get(e),[t])}),ss(KC,(e,t,o)=>{var{row:o,col:n}=o.event;((o,n,r,e,a)=>{for(let t=0;t<e;t++)for(let e=0;e<a;e++)h.set(o[t][e],t<=n&&e<=r)})(a,o,n,10,10),H.set(i.get(e),[ZC(o+1,n+1)])}),ss(JC,(e,t,o)=>{var{row:o,col:n}=o.event;b(e,Ii()),r.onAction({numRows:o+1,numColumns:n+1})})]),L.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:(t,e)=>{var o=((e,t)=>{const o=e.initData.allowCustomColors&&t.colorinput.hasCustomColors();return e.initData.colors.fold(()=>zC(t.colorinput.getColors(e.initData.storageKey),e.initData.storageKey,o),e=>e.concat(RC(o)))})(t,e),n=e.colorinput.getColorCols(t.initData.storageKey),o={...YC(N("menu-value"),o,e=>{t.onAction({value:e})},n,"color",_y.CLOSE_ON_EXECUTE,t.select.getOr(de),e.shared.providers),markers:qy("color"),movement:qC(n,"color"),showMenuRole:!1};return{type:"widget",data:{value:N("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[lS.widget(Rv.sketch(o))]}}},tk=(t,o,n,e,r,a,i,s=!0)=>{e=oS({presets:e,textContent:D.none(),htmlContent:n?t.text.map(e=>aS(e,o)):D.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:D.none(),checkMark:D.none(),caret:D.none(),value:t.value},i.providers,s,t.icon),s=t.text.filter(e=>!n&&""!==e);return U0({context:"mode:design",data:W0(t),enabled:t.enabled,getApi:T({}),onAction:e=>r(t.value,t.meta),onSetup:T(S),triggersSubmenu:!1,itemBehaviours:nS(t,i,s)},e,a,i.providers)},ok=e=>({type:"separator",dom:{tag:"div",classes:[Ey,"tox-collection__group-heading"]},components:e.text.map(xd).toArray()}),nk=(e,t,o,n=!0)=>{n=oS({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:D.none(),ariaLabel:e.text,caret:D.none(),checkMark:D.none(),shortcutContent:e.shortcut},o,n);return U0({context:e.context,data:W0(e),getApi:t=>({isEnabled:()=>!V.isDisabled(t),setEnabled:e=>V.set(t,!e)}),enabled:e.enabled,onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},n,t,o)},rk=(e,t,n,o=!0,r=!1)=>{r=r?(r=n.icons,G0("chevron-down",r,[Ry])):(r=n.icons,G0("chevron-right",r,[Ry])),r=oS({presets:"normal",iconContent:e.icon,textContent:e.text,htmlContent:D.none(),ariaLabel:e.text,caret:D.some(r),checkMark:D.none(),shortcutContent:e.shortcut},n,o);return U0({context:e.context,data:W0(e),getApi:o=>({isEnabled:()=>!V.isDisabled(o),setEnabled:e=>V.set(o,!e),setIconFill:(e,t)=>{Rd(o.element,`svg path[class="${e}"], rect[class="${e}"]`).each(e=>{A(e,"fill",t)})},setTooltip:e=>{e=n.translate(e);A(o.element,"aria-label",e)}}),enabled:e.enabled,onAction:S,onSetup:e.onSetup,triggersSubmenu:!0,itemBehaviours:[]},r,t,n)},ak=(e,t,o,n=!0)=>{n=oS({iconContent:e.icon,textContent:e.text,htmlContent:D.none(),ariaLabel:e.text,checkMark:D.some(K0(o.icons)),caret:D.none(),shortcutContent:e.shortcut,presets:"normal",meta:e.meta},o,n);return vr(U0({context:e.context,data:W0(e),enabled:e.enabled,getApi:t=>({setActive:e=>{h.set(t,e)},isActive:()=>h.isOn(t),isEnabled:()=>!V.isDisabled(t),setEnabled:e=>V.set(t,!e)}),onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:[]},n,t,o),{toggling:{toggleClass:My,toggleOnExecute:!1,selected:e.active},role:e.role.getOrUndefined()})},ik=(t,o)=>k(ek,t.fancytype).map(e=>e(t,o)),sk=(e,t,o,n)=>{var r={dom:eS(e.label),optComponents:[D.some({dom:{tag:"div",classes:[Vy,Hy]},components:iS(e.items,n)})]};return U0({context:"mode:design",data:W0({text:D.none(),...e}),enabled:e.enabled,getApi:o=>({isEnabled:()=>!V.isDisabled(o),setEnabled:t=>{V.set(o,!t),E(dg(o.element,"*"),e=>{o.getSystem().getByDom(e).each(e=>{e.hasConfigured(V)&&V.set(e,!t)})})}}),onAction:e.onAction,onSetup:e.onSetup,triggersSubmenu:!1,itemBehaviours:D.from(n.itemBehaviours).getOr([])},r,t,o.providers)},lk=(r=Object.freeze({__proto__:null,getCoupled:(e,t,o,n)=>o.getOrCreate(e,t,n),getExistingCoupled:(e,t,o,n)=>o.getExisting(e,t,n)}),Zw=[ga("others",hB(I.value,Yr()))],Es({fields:Zw,name:"coupling",apis:r,state:Object.freeze({__proto__:null,init:()=>{let r={},a=(e,t)=>{if(0===Ue(e.others).length)throw new Error("Cannot find any known coupled components");return k(r,t)};var e=T({});return _s({readState:e,getExisting:(e,t,o)=>a(t,o).orThunk(()=>(k(t.others,o).getOrDie("No information found for coupled component: "+o),D.none())),getOrCreate:(t,o,n)=>a(o,n).getOrThunk(()=>{var e=k(o.others,n).getOrDie("No information found for coupled component: "+n)(t),e=t.getSystem().build(e);return r[n]=e})})}})})),ck=e=>{let o=D.none(),t=[];let n=e=>{r()?a(e):t.push(e)};let r=()=>o.isSome(),a=t=>{o.each(e=>{setTimeout(()=>{t(e)},0)})};return e(e=>{r()||(o=D.some(e),e=t,E(e,a),t=[])}),{get:n,map:o=>ck(t=>{n(e=>{t(o(e))})}),isReady:r}},dk={nu:ck,pure:t=>ck(e=>{e(t)})},mk=e=>{setTimeout(()=>{throw e},0)},uk=o=>{let e=e=>{o().then(e,mk)};return{map:e=>uk(()=>o().then(e)),bind:t=>uk(()=>o().then(e=>t(e).toPromise())),anonBind:e=>uk(()=>o().then(()=>e.toPromise())),toLazy:()=>dk.nu(e),toCached:()=>{let e=null;return uk(()=>e=null===e?o():e)},toPromise:o,get:e}},gk={nu:e=>uk(()=>new Promise(e)),pure:e=>uk(()=>Promise.resolve(e))},pk=T("sink"),hk=(ki=T(qp({name:pk(),overrides:T({dom:{tag:"div"},behaviours:R([Wg.config({useFixed:me})]),events:ts([ls(pi()),ls(si()),ls(bi())])})})),(e,t)=>{let o=e.getHotspot(t).getOr(t),n=e.getAnchorOverrides();return e.layouts.fold(()=>({type:"hotspot",hotspot:o,overrides:n}),e=>({type:"hotspot",hotspot:o,overrides:n,layouts:e}))}),fk=(e,t,o)=>(0,e.fetch)(o).map(t),vk=(o,e,r,n,a,i,s)=>{e=fk(o,e,n);let l=Sk(n,o);return e.map(e=>e.bind(e=>{var t=e.menus[e.primary];return D.from(t).each(t=>{o.listRole.each(e=>{t.role=e})}),D.from(Wv.sketch({...i.menu(),uid:xc(""),data:e,highlightOnOpen:s,onOpenMenu:(e,t)=>{var o=l().getOrDie();Wg.position(o,t,{anchor:r}),d.decloak(a)},onOpenSubmenu:(e,t,o)=>{var n=l().getOrDie();Wg.position(n,o,{anchor:{type:"submenu",item:t}}),d.decloak(a)},onRepositionMenu:(e,t,o)=>{let n=l().getOrDie();Wg.position(n,t,{anchor:r}),E(o,e=>{Wg.position(n,e.triggeredMenu,{anchor:{type:"submenu",item:e.triggeringItem}})})},onEscape:()=>(U.focus(n),d.close(a),D.some(!0))}))}))},bk=(e,t,o,n,r,a,i)=>{var s=hk(e,o);return vk(e,t,s,o,n,r,i).map(e=>(e.fold(()=>{d.isOpen(n)&&d.close(n)},e=>{d.cloak(n),d.open(n,e),a(n)}),n))},xk=(e,t,o,n,r,a,i)=>(d.close(n),gk.pure(n)),yk=(e,t,o,n,r,a)=>{var i=lk.getCoupled(o,"sandbox");return(d.isOpen(i)?xk:bk)(e,t,o,i,n,r,a)},wk=(e,t,o)=>{t=z.getCurrent(t).getOr(t),e=Xo(e.element);o?M(t.element,"min-width",e+"px"):Yo(t.element,e)},Sk=(t,e)=>t.getSystem().getByUid(e.uid+"-"+pk()).map(e=>()=>I.value(e)).getOrThunk(()=>e.lazySink.fold(()=>()=>I.error(new Error("No internal sink is specified, nor could an external sink be found")),e=>()=>e(t))),Ck=e=>{d.getState(e).each(e=>{Wv.repositionMenus(e)})},kk=(n,r,a)=>{let i=Ld();let o=Sk(r,n);return{dom:{tag:"div",classes:n.sandboxClasses,attributes:{id:i.id}},behaviours:Tp.augment(n.sandboxBehaviours,[w.config({store:{mode:"memory",initialValue:r}}),d.config({onOpen:(e,t)=>{var o=hk(n,r);i.link(r.element),n.matchWidth&&wk(o.hotspot,t,n.useMinWidth),n.onOpen(o,e,t),void 0!==a&&void 0!==a.onOpen&&a.onOpen(e,t)},onClose:(e,t)=>{i.unlink(r.element),o().getOr(t).element.dom.dispatchEvent(new window.FocusEvent("focusout")),void 0!==a&&void 0!==a.onClose&&a.onClose(e,t)},isPartOf:(e,t,o)=>Pd(t,o)||Pd(r,o),getAttachPoint:()=>o().getOrDie()}),z.config({find:e=>d.getState(e).bind(e=>z.getCurrent(e))}),Om.config({channels:{...xp({isExtraPart:de}),...wp({doReposition:Ck})}})])}},Ok=e=>{e=lk.getCoupled(e,"sandbox");Ck(e)};var _k,Dw=()=>[u("sandboxClasses",[]),Tp.field("sandboxBehaviours",[z,Om,d,w])],e0=T([i("dom"),i("fetch"),o("onOpen"),nc("onExecute"),u("getHotspot",D.some),u("getAnchorOverrides",T({})),Bl(),Ng("dropdownBehaviours",[h,lk,L,U]),i("toggleClass"),u("eventOrder",{}),ya("lazySink"),u("matchWidth",!1),u("useMinWidth",!1),ya("role"),ya("listRole")].concat(Dw())),Vw=T([Iu({schema:[ec(),u("fakeFocus",!1)],name:"menu",defaults:e=>({onExecute:e.onExecute})}),ki()]);let Tk=Up({name:"Dropdown",configFields:e0(),partFields:Vw(),factory:(n,e,t,r)=>{let a=e=>{d.getState(e).each(e=>{Wv.highlightPrimary(e)})},o=(e,t,o)=>yk(n,re,e,r,t,o);var i,s={expand:e=>{h.isOn(e)||o(e,S,vv.HighlightNone).get(S)},open:e=>{h.isOn(e)||o(e,S,vv.HighlightMenuAndItem).get(S)},refetch:t=>lk.getExistingCoupled(t,"sandbox").fold(()=>o(t,S,vv.HighlightMenuAndItem).map(S),e=>bk(n,re,t,e,r,S,vv.HighlightMenuAndItem).map(S)),isOpen:h.isOn,close:e=>{h.isOn(e)&&o(e,S,vv.HighlightMenuAndItem).get(S)},repositionMenus:e=>{h.isOn(e)&&Ok(e)}},l=(e,t)=>(Ki(e),D.some(!0));return{uid:n.uid,dom:n.dom,components:e,behaviours:_p(n.dropdownBehaviours,[h.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),lk.config({others:{sandbox:e=>kk(n,e,{onOpen:()=>h.on(e),onClose:()=>h.off(e)})}}),L.config({mode:"special",onSpace:l,onEnter:l,onDown:(e,t)=>{var o;return Tk.isOpen(e)?(o=lk.getCoupled(e,"sandbox"),a(o)):Tk.open(e),D.some(!0)},onEscape:(e,t)=>Tk.isOpen(e)?(Tk.close(e),D.some(!0)):D.none()}),U.config({})]),events:wv(D.some(e=>{var t=a;o(e,t,vv.HighlightMenuAndItem).get(S)})),eventOrder:{...n.eventOrder,[Di()]:["disabling","toggling","alloy.base.behaviour"]},apis:s,domModification:{attributes:{"aria-haspopup":n.listRole.getOr("true"),...n.role.fold(()=>({}),e=>({role:e})),..."button"===n.dom.tag?{type:(i="type",k(n.dom,"attributes").bind(e=>k(e,i)).getOr("button"))}:{}}}}},apis:{open:(e,t)=>e.open(t),refetch:(e,t)=>e.refetch(t),expand:(e,t)=>e.expand(t),close:(e,t)=>e.close(t),isOpen:(e,t)=>e.isOpen(t),repositionMenus:(e,t)=>e.repositionMenus(t)}}),Ek=e=>"no-search"!==e.searchMode?{menuType:"searchable",searchMode:e}:{menuType:"normal"},Dk=e=>{let t=w.getValue(e),o=aw(e).map(lw);Tk.refetch(t).get(()=>{let e=lk.getCoupled(t,"sandbox");o.each(t=>aw(e).each(e=>sw(e,t)))})},Ak=(t,o)=>{Mk(t).each(e=>{Zi(t,e.element,o.event.eventType,o.event.interactionEvent)})},Mk=e=>d.getState(e).bind(Gh.getHighlighted).bind(Gh.getHighlighted),Bk=e=>Ws(e.element,mw)?D.some(e.element):Rd(e.element,"."+mw),Ik=(e,o,n)=>{iw(e).each(t=>{cw(t,n),Bk(o).each(e=>{So(e,"id").each(e=>A(t.element,"aria-controls",e))})}),A(n.element,"aria-selected","true")},Fk=(e,t,o)=>{A(o.element,"aria-selected","false")},Rk=e=>{iw(e).each(e=>U.focus(e))},Nk=e=>lk.getExistingCoupled(e,"sandbox").bind(aw).map(lw).map(e=>e.fetchPattern).getOr(""),zk=((Jw=_k=_k||{})[Jw.ContentFocus=0]="ContentFocus",Jw[Jw.UiFocus=1]="UiFocus",(e,t,o,n,r)=>{let a=o.shared.providers,i=e=>r?{...e,shortcut:D.none(),icon:e.text.isSome()?D.none():e.icon}:e;switch(e.type){case"menuitem":return b0(e).fold(Cw,e=>D.some(nk(i(e),t,a,n)));case"nestedmenuitem":return y0(e).fold(Cw,e=>D.some(rk(i(e),t,a,n,r)));case"togglemenuitem":return S0(e).fold(Cw,e=>D.some(ak(i(e),t,a,n)));case"separator":return Pw(e).fold(Cw,e=>D.some(ok(e)));case"fancymenuitem":return f0(e).fold(Cw,e=>ik(e,o));default:return console.error("Unknown item in general menu",e),D.none()}}),Vk=(e,t,n,r,a,o)=>{let i=Sw(t);t=rt(C(t,e=>{let t=e=>a?!et(e,"text"):i;var o=e=>zk(e,n,r,t(e),a);return"nestedmenuitem"===e.type&&e.getSubmenuItems().length<=0?o({...e,enabled:!1}):o(e)})),o=Ek(o);return(a?kw:Ow)(e,i,t,1,o)},Lk=e=>Wv.singleData(e.value,e),Hk=e=>$u.create(O.fromDom(e.startContainer),e.startOffset,O.fromDom(e.endContainer),e.endOffset),Pk={register:(a,o)=>{let n=N("autocompleter"),i=B(!1),t=B(!1),s=lr(),r=kd(jv.sketch({dom:{tag:"div",classes:["tox-autocompleter"],attributes:{id:n}},components:[],fireDismissalEventInstead:{},inlineBehaviours:R([P("dismissAutocompleter",[F(Ui(),()=>m()),F(Xi(),(e,t)=>{So(t.event.target,"id").each(e=>A(O.fromDom(a.getBody()),"aria-activedescendant",e))})])]),lazySink:o.getSink})),e=()=>jv.isOpen(r);var l=t.get;let c=()=>{if(e()){jv.hide(r),a.dom.remove(n,!1);let e=O.fromDom(a.getBody());So(e,"aria-owns").filter(e=>e===n).each(()=>{ko(e,"aria-owns"),ko(e,"aria-activedescendant")})}},d=()=>jv.getContent(r).bind(e=>ze(e.components(),0)),m=()=>a.execCommand("mceAutocompleterClose"),u=e=>{let t=Pe(e,e=>D.from(e.columns)).getOr(1);return Ae(e,r=>((e,o,n,t,r,a,i)=>{let s=1===t,l=!s||Sw(e);return rt(C(e,e=>{switch(e.type){case"separator":return Ww(e).fold(Cw,e=>D.some(ok(e)));case"cardmenuitem":return u0(e).fold(Cw,t=>D.some(sk({...t,onAction:e=>{t.onAction(e),n(t.value,t.meta)}},r,a,{itemBehaviours:nS(t.meta,a,D.none()),cardText:{matchText:o,highlightOn:i}})));default:return jw(e).fold(Cw,e=>D.some(tk(e,o,s,"normal",n,r,a,l)))}}))})(r.items,r.matchText,(t,o)=>{let n={hide:()=>m(),reload:e=>{c(),a.execCommand("mceAutocompleterReload",!1,{fetchOptions:e})}};a.execCommand("mceAutocompleterRefreshActiveRange"),s.get().each(e=>{i.set(!0),r.onAction(n,e,t,o),i.set(!1)})},t,_y.BUBBLE_TO_SANDBOX,o,r.highlightOn))},g=(e,t)=>{e=Pe(e,e=>D.from(e.columns)).getOr(1);jv.showMenuAt(r,{anchor:{type:"selection",getSelection:()=>s.get().map(Hk),root:O.fromDom(a.getBody())}},((e,t,o,n)=>{var r=qC(t,n);let a=qy(n);return{data:Lk({...e,movement:r,menuBehaviours:O0.unnamedEvents("auto"!==t?[]:[ds((o,e)=>{C0(o,4,a.item).each(({numColumns:e,numRows:t})=>{L.setGridSize(o,t,e)})})])}),menu:{markers:qy(n),fakeFocus:o===_k.ContentFocus}}})(Ow("autocompleter-value",!0,t,e,{menuType:"normal"}),e,_k.ContentFocus,"normal")),d().each(Gh.highlightFirst)},p=e=>{var t=u(e);0<t.length?(g(e,t),A(O.fromDom(a.getBody()),"aria-owns",n),a.inline||(()=>{if(a.dom.get(n))a.dom.remove(n,false);const e=a.getDoc().documentElement,t=a.selection.getNode(),o=Ll(r.element);Eo(o,{border:"0",clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0",position:"absolute",width:"1px",top:`${t.offsetTop}px`,left:`${t.offsetLeft}px`}),a.dom.add(e,o.dom),Rd(o,'[role="menu"]').each(e=>{Ro(e,"position");Ro(e,"max-height")})})()):c()};a.on("AutocompleterStart",({lookupData:e})=>{t.set(!0),i.set(!1),p(e)}),a.on("AutocompleterUpdate",({lookupData:e})=>p(e)),a.on("AutocompleterUpdateActiveRange",({range:e})=>s.set(e)),a.on("AutocompleterEnd",()=>{c(),t.set(!1),i.set(!1),s.clear()});l={cancelIfNecessary:m,isMenuOpen:e,isActive:l,isProcessingAction:i.get,getMenu:d};Oy.setup(l,a)}},Uk=(e,t,o)=>Nd(e,t,o).isSome(),Wk=(t,o)=>{let n=null;return{cancel:()=>{null!==n&&(clearTimeout(n),n=null)},schedule:(...e)=>{n=setTimeout(()=>{t.apply(null,e),n=null},o)}}},jk=5,Gk=400,$k=e=>{e=e.raw;return void 0===e.touches||1!==e.touches.length?D.none():D.some(e.touches[0])},Yk=(e,t)=>{var o=Math.abs(e.clientX-t.x),e=Math.abs(e.clientY-t.y);return o>jk||e>jk},Xk=o=>{let n=lr(),r=B(!1),a=Wk(e=>{o.triggerEvent(Bi(),e),r.set(!0)},Gk);let i=Wa([{key:ni(),value:t=>($k(t).each(e=>{a.cancel();e={x:e.clientX,y:e.clientY,target:t.target};a.schedule(t),r.set(!1),n.set(e)}),D.none())},{key:ri(),value:e=>(a.cancel(),$k(e).each(t=>{n.on(e=>{Yk(t,e)&&n.clear()})}),D.none())},{key:ai(),value:t=>{a.cancel();return n.get().filter(e=>Gt(e.target,t.target)).map(e=>r.get()?(t.prevent(),!1):o.triggerEvent(Mi(),t))}}]);return{fireIfReady:(t,e)=>k(i,e).bind(e=>e(t))}},qk=e=>e.raw.which===$h[0]&&!ve(["input","textarea"],Ft(e.target))&&!Uk(e.target,'[contenteditable="true"]'),Kk=(t,e)=>{let o={stopBackspace:!0,...e};let n=Xk(o),r=C(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),e=>Zm(t,e,t=>{n.fireIfReady(t,e).each(e=>{e&&t.kill()}),o.triggerEvent(e,t)&&t.kill()})),a=lr(),i=Zm(t,"paste",t=>{n.fireIfReady(t,"paste").each(e=>{e&&t.kill()}),o.triggerEvent("paste",t)&&t.kill(),a.set(setTimeout(()=>{o.triggerEvent(Ti(),t)},0))}),s=Zm(t,"keydown",e=>{o.triggerEvent("keydown",e)?e.kill():o.stopBackspace&&qk(e)&&e.prevent()}),l=Zm(t,"focusin",e=>{o.triggerEvent("focusin",e)&&e.kill()}),c=lr(),d=Zm(t,"focusout",e=>{o.triggerEvent("focusout",e)&&e.kill(),c.set(setTimeout(()=>{o.triggerEvent(_i(),e)},0))});return{unbind:()=>{E(r,e=>{e.unbind()}),s.unbind(),l.unbind(),d.unbind(),i.unbind(),a.on(clearTimeout),c.on(clearTimeout)}}},Jk=(e,t)=>{e=k(e,"target").getOr(t);return B(e)},Qk=(e,t)=>{let o=B(!1),n=B(!1);return{stop:()=>{o.set(!0)},cut:()=>{n.set(!0)},isStopped:o.get,isCut:n.get,event:e,setSource:t.set,getSource:t.get}},Zk=e=>{let t=B(!1);return{stop:()=>{t.set(!0)},cut:S,isStopped:t.get,isCut:de,event:e,setSource:le("Cannot set source of a broadcasted event"),getSource:le("Cannot get source of a broadcasted event")}},eO=za([{stopped:[]},{resume:["element"]},{complete:[]}]),tO=(e,n,t,o,r,a)=>{e=e(n,o);let i=Qk(t,r);return e.fold(()=>(a.logEventNoHandlers(n,o),eO.complete()),t=>{let o=t.descHandler;return zc(o)(i),i.isStopped()?(a.logEventStopped(n,t.element,o.purpose),eO.stopped()):i.isCut()?(a.logEventCut(n,t.element,o.purpose),eO.complete()):Jt(t.element).fold(()=>(a.logNoParent(n,t.element,o.purpose),eO.complete()),e=>(a.logEventResponse(n,t.element,o.purpose),eO.resume(e)))})},oO=(t,o,n,e,r,a)=>tO(t,o,n,e,r,a).fold(me,e=>oO(t,o,n,e,r,a),de),nO=(e,t,o,n,r)=>{var a=Jk(o,n);return tO(e,t,o,n,a,r)},rO=(e,t,o)=>{let n=Zk(t);return E(e,e=>{e=e.descHandler;zc(e)(n)}),n.isStopped()},aO=(e,t,o,n)=>iO(e,t,o,o.target,n),iO=(e,t,o,n,r)=>{var a=Jk(o,n);return oO(e,t,o,n,a,r)},sO=(e,t)=>({element:e,descHandler:t}),lO=(e,t)=>({id:e,descHandler:t}),cO=()=>{let a={};return{registerId:(n,r,e)=>{je(e,(e,t)=>{var o=void 0!==a[t]?a[t]:{};o[r]=Nc(e,n),a[t]=o})},unregisterId:o=>{je(a,(e,t)=>{et(e,o)&&delete e[o]})},filterByType:e=>k(a,e).map(e=>Je(e,(e,t)=>lO(t,e))).getOr([]),find:(e,t,o)=>k(a,t).bind(n=>qa(o,e=>{return t=n,o=e,bc(o).bind(e=>k(t,e)).map(e=>sO(o,e));var t,o},e))}},dO=()=>{let r=cO(),a={};let i=e=>{bc(e.element).each(e=>{delete a[e],r.unregisterId(e)})};return{find:(e,t,o)=>r.find(e,t,o),filter:e=>r.filterByType(e),register:e=>{o=(t=e).element;var t,o=bc(o).getOrThunk(()=>fc("uid-",t.element)),n=(tt(a,o)&&((e,t)=>{var o=a[t];if(o!==e)throw new Error('The tagId "'+t+'" is already used by: '+Pl(o.element)+"\nCannot use it for: "+Pl(e.element)+"\nThe conflicting element is"+(fo(o.element)?" ":" not ")+"already in the DOM");i(e)})(e,o),[e]);r.registerId(n,o,e.events),a[o]=e},unregister:i,getById:e=>k(a,e)}},mO=kh({name:"Container",factory:e=>{let{attributes:t,...o}=e.dom;return{uid:e.uid,dom:{tag:"div",attributes:{role:"presentation",...t},...o},components:e.components,behaviours:Op(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},configFields:[u("components",[]),Ng("containerBehaviours",[]),u("events",{}),u("domModification",{}),u("eventOrder",{})]}),uO=o=>{let n=t=>Jt(o.element).fold(me,e=>Gt(t,e)),r=dO(),a=(e,t)=>r.find(n,e,t),e=Kk(o.element,{triggerEvent:(t,o)=>ql(t,o.target,e=>aO(a,t,o,e))}),i={debugInfo:T("real"),triggerEvent:(t,o,n)=>{ql(t,o,e=>iO(a,t,n,o,e))},triggerFocus:(t,o)=>{bc(t).fold(()=>{_m(t)},e=>{ql(Oi(),t,e=>(nO(a,Oi(),{originator:o,kill:S,prevent:S,target:t},t,e),!1))})},triggerEscape:(e,t)=>{i.triggerEvent("keydown",e.element,t.event)},getByUid:e=>p(e),getByDom:e=>h(e),build:kd,buildOrPatch:Cd,addToGui:e=>{l(e)},removeFromGui:e=>{c(e)},addToWorld:e=>{t(e)},removeFromWorld:e=>{s(e)},broadcast:e=>{m(e)},broadcastOn:(e,t)=>{u(e,t)},broadcastEvent:(e,t)=>{g(e,t)},isConnected:me},t=e=>{e.connect(i),zt(e.element)||(r.register(e),E(e.components(),t),i.triggerEvent(Ri(),e.element,{target:e.element}))},s=e=>{zt(e.element)||(E(e.components(),s),r.unregister(e)),e.disconnect()},l=e=>{Zg(o,e)},c=e=>{op(e)};let d=t=>{var e=r.filter(Ei());E(e,e=>{e=e.descHandler;zc(e)(t)})},m=e=>{d({universal:!0,data:e})},u=(e,t)=>{d({universal:!1,channels:e,data:t})},g=(e,t)=>{e=r.filter(e);return rO(e,t)},p=e=>r.getById(e).fold(()=>I.error(new Error('Could not find component with uid: "'+e+'" in system.')),I.value),h=e=>{e=bc(e).getOr("not found");return p(e)};return t(o),{root:o,element:o.element,destroy:()=>{e.unbind(),Hn(o.element)},add:l,remove:c,getByUid:p,getByDom:h,addToWorld:t,removeFromWorld:s,broadcast:m,broadcastOn:u,broadcastEvent:g}},W=(Qw=T([u("prefix","form-field"),Ng("fieldBehaviours",[z,w])]),zw=T([qp({schema:[i("dom")],name:"label"}),qp({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[i("text")],name:"aria-descriptor"}),Xp({factory:{sketch:e=>{var t=Pa(e,["factory"]);return e.factory.sketch(t)}},schema:[i("factory")],name:"field"})]),Up({name:"FormField",configFields:Qw(),partFields:zw(),factory:(r,e,t,o)=>{var n=_p(r.fieldBehaviours,[z.config({find:e=>ih(e,r,"field")}),w.config({store:{mode:"manual",getValue:e=>z.getCurrent(e).bind(w.getValue),setValue:(e,t)=>{z.getCurrent(e).each(e=>{w.setValue(e,t)})}}})]),a=ts([ds((e,t)=>{let n=lh(e,r,["label","field","aria-descriptor"]);n.field().each(o=>{let t=N(r.prefix);n.label().each(e=>{A(e.element,"for",t),A(o.element,"id",t)}),n["aria-descriptor"]().each(e=>{var t=N(r.prefix);A(e.element,"id",t),A(o.element,"aria-describedby",t)})})})]);return{uid:r.uid,dom:r.dom,components:e,behaviours:n,events:a,apis:{getField:e=>ih(e,r,"field"),getLabel:e=>ih(e,r,"label")}}},apis:{getField:(e,t)=>e.getField(t),getLabel:(e,t)=>e.getLabel(t)}}));var gO=tinymce.util.Tools.resolve("tinymce.html.Entities");let pO=(e,t,o,n)=>{e=hO(e,t,o,n);return W.sketch(e)},hO=(e,t,o,n)=>({dom:fO(o),components:e.toArray().concat([t]),fieldBehaviours:R(n)}),fO=e=>({tag:"div",classes:["tox-form__group"].concat(e)}),vO=(e,t)=>W.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[xd(t.translate(e))]}),bO=N("form-component-change"),xO=N("form-component-input"),yO=N("form-close"),wO=N("form-cancel"),SO=N("form-action"),CO=N("form-submit"),kO=N("form-block"),OO=N("form-unblock"),_O=N("form-tabchange"),TO=N("form-resize"),EO=(s,r,e)=>{var t=s.label.map(e=>vO(e,r));let l=r.icons();var o=n=>(t,o)=>{Nd(o.event.target,"[data-collection-item-value]").each(e=>{n(t,o,e,wo(e,"data-collection-item-value"))})};let n=(e,t)=>{let i=r.checkUiComponentContext("mode:design").shouldDisable||r.isDisabled()?" tox-collection__item--state-disabled":"";t=C(t,e=>{var t=dy.translate(e.text),o=1===s.columns?`<div class="tox-collection__item-label">${t}</div>`:"",n=`<div class="tox-collection__item-icon">${a=e.icon,null!=(n=l[a])?n:a}</div>`;let r={_:" "," - ":" ","-":" "};var a=t.replace(/\_| \- |\-/g,e=>r[e]);return`<div data-mce-tooltip="${a}" class="tox-collection__item${i}" tabindex="-1" data-collection-item-value="${gO.encodeAllRaw(e.value)}" aria-label="${a}">${n}${o}</div>`}),t="auto"!==s.columns&&1<s.columns?ye(t,s.columns):[t],t=C(t,e=>`<div class="tox-collection__group">${e.join("")}</div>`);Rl(e.element,t.join(""))};var a=o((e,t,o,n)=>{t.stop(),r.checkUiComponentContext("mode:design").shouldDisable||r.isDisabled()||_(e,SO,{name:s.name,value:n})}),a=[F(mi(),o((e,t,o)=>{_m(o,!0)})),F(bi(),a),F(Mi(),a),F(ui(),o((e,t,o)=>{Rd(e.element,"."+zy).each(e=>{Ps(e,zy)}),Ls(o,zy)})),F(gi(),o(e=>{Rd(e.element,"."+zy).each(e=>{Ps(e,zy),Tm(e)})})),gs(o((e,t,o,n)=>{_(e,SO,{name:s.name,value:n})}))];let i=(e,t)=>C(dg(e.element,".tox-collection__item"),t);o=W.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==s.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:re},behaviours:R([V.config({disabled:()=>r.checkUiComponentContext(s.context).shouldDisable,onDisabled:e=>{i(e,e=>{Ls(e,"tox-collection__item--state-disabled"),A(e,"aria-disabled",!0)})},onEnabled:e=>{i(e,e=>{Ps(e,"tox-collection__item--state-disabled"),ko(e,"aria-disabled")})}}),V0(()=>r.checkUiComponentContext(s.context)),H.config({}),yx.config({...r.tooltips.getConfig({tooltipText:"",onShow:t=>{Rd(t.element,"."+zy+"[data-mce-tooltip]").each(e=>{So(e,"data-mce-tooltip").each(e=>{yx.setComponents(t,r.tooltips.getComponents({tooltipText:e}))})})}}),mode:"children-keyboard-focus",anchor:e=>({type:"node",node:Rd(e.element,"."+zy).orThunk(()=>jt(".tox-collection__item")),root:e.element,layouts:{onLtr:T([fm,hm,mm,gm,um,pm]),onRtl:T([fm,hm,mm,gm,um,pm])},bubble:Ou(0,-2,{})})}),w.config({store:{mode:"memory",initialValue:e.getOr([])},onSetValue:(o,e)=>{n(o,e),"auto"===s.columns&&C0(o,5,"tox-collection__item").each(({numRows:e,numColumns:t})=>{L.setGridSize(o,e,t)}),b(o,TO)}}),ux.config({}),L.config((o=s.columns,e="normal",1===o?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===o?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===e?".tox-swatches__row":".tox-collection__group",cell:"color"===e?"."+Dy:"."+Ey}})),P("collection-events",a)]),eventOrder:{[Di()]:["disabling","alloy.base.behaviour","collection-events"],[ui()]:["collection-events","tooltipping"]}});return pO(t,o,["tox-form__group--collection"],[])},DO=["input","textarea"],AO=e=>{e=Ft(e);return ve(DO,e)},MO=(e,t)=>{var o=t.getRoot(e).getOr(e.element);Ps(o,t.invalidClass),t.notify.each(t=>{AO(e.element)&&A(e.element,"aria-invalid",!1),t.getContainer(e).each(e=>{Rl(e,t.validHtml)}),t.onValid(e)})},BO=(t,e,o,n)=>{var r=e.getRoot(t).getOr(t.element);Ls(r,e.invalidClass),e.notify.each(e=>{AO(t.element)&&A(t.element,"aria-invalid",!0),e.getContainer(t).each(e=>{Rl(e,n)}),e.onInvalid(t,n)})},IO=(t,e,o)=>e.validator.fold(()=>gk.pure(I.value(!0)),e=>e.validate(t)),FO=(t,o,e)=>(o.notify.each(e=>{e.onValidate(t)}),IO(t,o).map(e=>t.getSystem().isConnected()?e.fold(e=>(BO(t,o,0,e),I.error(e)),e=>(MO(t,o),I.value(e))):I.error("No longer in system"))),RO=(wf=Object.freeze({__proto__:null,markValid:MO,markInvalid:BO,query:IO,run:FO,isInvalid:(e,t)=>{e=t.getRoot(e).getOr(e.element);return Ws(e,t.invalidClass)}}),Mw=Object.freeze({__proto__:null,events:(t,e)=>t.validator.map(e=>ts([F(e.onEvent,e=>{FO(e,t).get(re)})].concat(e.validateOnLoad?[ds(e=>{FO(e,t).get(S)})]:[]))).getOr({})}),hB=[i("invalidClass"),u("getRoot",D.none),Ta("notify",[u("aria","alert"),u("getContainer",D.none),u("validHtml",""),o("onValid"),o("onInvalid"),o("onValidate")]),Ta("validator",[i("validate"),u("onEvent","input"),u("validateOnLoad",!0)])],Es({fields:hB,name:"invalidating",active:Mw,apis:wf,extra:{validation:t=>e=>{e=w.getValue(e);return gk.pure(t(e))}}})),NO=Es({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:()=>ts([os(Si(),me)]),exhibit:()=>bs({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})})}),zO=N("color-input-change"),VO=N("color-swatch-change"),LO=N("color-picker-cancel"),HO=(n,t,r,e)=>{var e=W.parts.field({factory:tw,inputClasses:["tox-textfield"],data:e,onSetValue:e=>RO.run(e).get(S),inputBehaviours:R([V.config({disabled:()=>t.providers.isDisabled()||t.providers.checkUiComponentContext(n.context).shouldDisable}),V0(()=>t.providers.checkUiComponentContext(n.context)),ux.config({}),RO.config({invalidClass:"tox-textbox-field-invalid",getRoot:e=>Qt(e.element),notify:{onValid:e=>{var t=w.getValue(e);_(e,zO,{color:t})}},validator:{validateOnLoad:!1,validate:e=>{let t=w.getValue(e);return 0===t.length?gk.pure(I.value(!0)):(e=O.fromTag("span"),M(e,"background-color",t),e=Bo(e,"background-color").fold(()=>I.error("blah"),e=>I.value(t)),gk.pure(e))}}})]),selectOnFocus:!1}),o=n.label.map(e=>vO(e,t.providers));let a=(e,t)=>{_(e,VO,{value:t})};var i,s;let l=mx((i={dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:()=>[um,mm,fm],onLtr:()=>[mm,um,fm]},components:[],fetch:VC(r.getColors(n.storageKey),n.storageKey,r.hasCustomColors()),columns:r.getColorCols(n.storageKey),presets:"color",onItemAction:(e,o)=>{l.getOpt(e).each(t=>{"custom"===o?r.colorPicker(e=>{e.fold(()=>b(t,LO),e=>{a(t,e),sC(n.storageKey,e)})},"#ffffff"):"remove"===o?a(t,""):a(t,o)})},context:n.context},s=t,Tk.sketch({dom:i.dom,components:i.components,toggleClass:"mce-active",dropdownBehaviours:R([T0.button(()=>s.providers.isDisabled()||s.providers.checkUiComponentContext(i.context).shouldDisable),V0(()=>s.providers.checkUiComponentContext(i.context)),NO.config({}),ux.config({})]),layouts:i.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:s.getSink,fetch:t=>gk.nu(e=>i.fetch(e)).map(e=>D.from(Lk(vr(YC(N("menu-value"),e,e=>{i.onItemAction(t,e)},i.columns,i.presets,_y.CLOSE_ON_EXECUTE,de,s.providers),{movement:qC(i.columns,i.presets)})))),parts:{menu:Qy(!1,1,i.presets)}})));return W.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:o.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[e,l.asSpec()]}]),fieldBehaviours:R([P("form-field-events",[F(zO,(e,t)=>{l.getOpt(e).each(e=>{M(e.element,"background-color",t.event.color)}),_(e,bO,{name:n.name})}),F(VO,(t,o)=>{W.getField(t).each(e=>{w.setValue(e,o.event.value),z.getCurrent(t).each(U.focus)})}),F(LO,(t,e)=>{W.getField(t).each(e=>{z.getCurrent(t).each(U.focus)})})])])})},PO=(Zw=qp({schema:[i("dom")],name:"label"}),e0=(r=t=>qp({name:t+"-edge",overrides:e=>e.model.manager.edgeActions[t].fold(()=>({}),n=>({events:ts([rs(ni(),(e,t,o)=>n(e,o),[e]),rs(si(),(e,t,o)=>n(e,o),[e]),rs(li(),(e,t,o)=>{o.mouseIsDown.get()&&n(e,o)},[e])])}))}))("top-left"),Vw=r("top"),Jw=r("top-right"),Qw=r("right"),zw=r("bottom-right"),hB=r("bottom"),Mw=r("bottom-left"),wf=r("left"),r=Xp({name:"thumb",defaults:T({dom:{styles:{position:"absolute"}}}),overrides:e=>({events:ts([is(ni(),e,"spectrum"),is(ri(),e,"spectrum"),is(ai(),e,"spectrum"),is(si(),e,"spectrum"),is(li(),e,"spectrum"),is(di(),e,"spectrum")])})}),e=>sf(e.event)),UO=(Zw=[Zw,wf,Qw,Vw,hB,e0,Jw,Mw,zw,r,Xp({schema:[ma("mouseIsDown",()=>B(!1))],name:"spectrum",overrides:o=>{let n=o.model.manager,r=(t,e)=>n.getValueFromEvent(e).map(e=>n.setValueFrom(t,o,e));return{behaviours:R([L.config({mode:"special",onLeft:(e,t)=>n.onLeft(e,o,PO(t)),onRight:(e,t)=>n.onRight(e,o,PO(t)),onUp:(e,t)=>n.onUp(e,o,PO(t)),onDown:(e,t)=>n.onDown(e,o,PO(t))}),ux.config({}),U.config({})]),events:ts([F(ni(),r),F(ri(),r),F(si(),r),F(li(),(e,t)=>{o.mouseIsDown.get()&&r(e,t)})])}}})],T("slider.change.value")),WO=e=>-1!==e.type.indexOf("touch"),jO=e=>{var t,e=e.event.raw;return WO(e)?void 0!==(t=e).touches&&1===t.touches.length?D.some(t.touches[0]).map(e=>Po(e.clientX,e.clientY)):D.none():void 0!==(t=e).clientX?D.some(t).map(e=>Po(e.clientX,e.clientY)):D.none()},GO="top",$O="right",YO="bottom",XO="left",qO=e=>e.model.minX,KO=e=>e.model.minY,JO=e=>e.model.minX-1,QO=e=>e.model.minY-1,ZO=e=>e.model.maxX,e_=e=>e.model.maxY,t_=e=>e.model.maxX+1,o_=e=>e.model.maxY+1,n_=(e,t,o)=>t(e)-o(e),r_=e=>n_(e,ZO,qO),a_=e=>n_(e,e_,KO),i_=e=>r_(e)/2,s_=e=>a_(e)/2,l_=(e,t)=>t?e.stepSize*e.speedMultiplier:e.stepSize,c_=e=>e.snapToGrid,d_=e=>e.snapStart,m_=e=>e.rounded,u_=(e,t)=>void 0!==e[t+"-edge"],g_=e=>u_(e,XO),p_=e=>u_(e,$O),h_=e=>u_(e,GO),f_=e=>u_(e,YO),v_=e=>e.model.value.get(),b_=(e,t)=>({x:e,y:t}),x_=(e,t)=>{_(e,UO(),{value:t})},y_=(e,t,o,n)=>e<t?e:o<e?o:e===t?t-1:Math.max(t,e-n),w_=(e,t,o,n)=>o<e?e:e<t?t:e===o?o+1:Math.min(o,e+n),S_=(e,t,o)=>Math.max(t,Math.min(o,e)),C_=(r,t,a,i,e)=>e.fold(()=>{var e=Math.round((r-t)/i)*i;return S_(t+e,t-1,a+1)},e=>{var t=Math.round((r-e)%i/i),o=Math.floor((r-e)/i),n=Math.floor((a-e)/i),n=Math.min(n,o+t);return Math.max(e,e+n*i)}),k_=(e,t,o)=>Math.min(o,Math.max(e,t))-t,O_=e=>{var{min:e,max:t,range:o,value:n,step:r,snap:a,snapStart:i,rounded:s,hasMinEdge:l,hasMaxEdge:c,minBound:d,maxBound:m,screenRange:u}=e,l=l?e-1:e,c=c?t+1:t;return n<d?l:m<n?c:(n=k_(n,d,m),d=S_(n/u*o+e,l,c),a&&e<=d&&d<=t?C_(d,e,t,r,i):s?Math.round(d):d)},__=e=>{var{min:e,max:t,range:o,value:n,hasMinEdge:r,hasMaxEdge:a,maxBound:i,maxOffset:s,centerMinEdge:l,centerMaxEdge:c}=e;return n<e?r?0:l:t<n?a?i:c:(n-e)/o*s},T_="top",E_="right",D_="bottom",A_="left",M_="width",B_="height",I_=e=>e.element.dom.getBoundingClientRect(),F_=(e,t)=>e[t],R_=e=>{e=I_(e);return F_(e,A_)},N_=e=>{e=I_(e);return F_(e,E_)},z_=e=>{e=I_(e);return F_(e,T_)},V_=e=>{e=I_(e);return F_(e,D_)},L_=e=>{e=I_(e);return F_(e,M_)},H_=e=>{e=I_(e);return F_(e,B_)},P_=(e,t,o)=>(e+t)/2-o,U_=(e,t)=>{var e=I_(e),t=I_(t),o=F_(e,A_),e=F_(e,E_),t=F_(t,A_);return P_(o,e,t)},W_=(e,t)=>{var e=I_(e),t=I_(t),o=F_(e,T_),e=F_(e,D_),t=F_(t,T_);return P_(o,e,t)},j_=(e,t)=>{_(e,UO(),{value:t})},G_=(e,t,o)=>{o={min:qO(t),max:ZO(t),range:r_(t),value:o,step:l_(t),snap:c_(t),snapStart:d_(t),rounded:m_(t),hasMinEdge:g_(t),hasMaxEdge:p_(t),minBound:R_(e),maxBound:N_(e),screenRange:L_(e)};return O_(o)},$_=(e,t,o,n,r,a)=>{i=t,a=a,o=o,n=n,r=r,s=L_(i),n=n.bind(e=>D.some(U_(e,i))).getOr(0),r=r.bind(e=>D.some(U_(e,i))).getOr(s),o={min:qO(a),max:ZO(a),range:r_(a),value:o,hasMinEdge:g_(a),hasMaxEdge:p_(a),minBound:R_(i),minOffset:0,maxBound:N_(i),maxOffset:s,centerMinEdge:n,centerMaxEdge:r};var i,s,a=__(o);return R_(t)-R_(e)+a},Y_=(Qw=(wf=n=>(e,t,o)=>((e,t,o,n)=>{e=(0<e?w_:y_)(v_(o),qO(o),ZO(o),l_(o,n));return j_(t,e),D.some(e)})(n,e,t,o).map(me))(-1),Vw=wf(1),hB=D.none,e0=D.none,Jw={"top-left":D.none(),top:D.none(),"top-right":D.none(),right:D.some((e,t)=>{x_(e,t_(t))}),"bottom-right":D.none(),bottom:D.none(),"bottom-left":D.none(),left:D.some((e,t)=>{x_(e,JO(t))})},Mw=Object.freeze({__proto__:null,setValueFrom:(e,t,o)=>{t=G_(e,t,o),o=t;return j_(e,o),t},setToMin:(e,t)=>{t=qO(t);j_(e,t)},setToMax:(e,t)=>{t=ZO(t);j_(e,t)},findValueOfOffset:G_,getValueFromEvent:e=>jO(e).map(e=>e.left),findPositionOfValue:$_,setPositionFromValue:(e,t,o,n)=>{var r=v_(o),r=$_(e,n.getSpectrum(e),r,n.getLeftEdge(e),n.getRightEdge(e),o),n=Xo(t.element)/2;M(t.element,"left",r-n+"px")},onLeft:Qw,onRight:Vw,onUp:hB,onDown:e0,edgeActions:Jw}),(e,t)=>{_(e,UO(),{value:t})}),X_=(e,t,o)=>{o={min:KO(t),max:e_(t),range:a_(t),value:o,step:l_(t),snap:c_(t),snapStart:d_(t),rounded:m_(t),hasMinEdge:h_(t),hasMaxEdge:f_(t),minBound:z_(e),maxBound:V_(e),screenRange:H_(e)};return O_(o)},q_=(zw=n=>(e,t,o)=>((e,t,o,n)=>{e=(0<e?w_:y_)(v_(o),KO(o),e_(o),l_(o,n));return Y_(t,e),D.some(e)})(n,e,t,o).map(me),(e,t,o,n,r,a)=>{i=t,a=a,o=o,n=n,r=r,s=H_(i),n=n.bind(e=>D.some(W_(e,i))).getOr(0),r=r.bind(e=>D.some(W_(e,i))).getOr(s),o={min:KO(a),max:e_(a),range:a_(a),value:o,hasMinEdge:h_(a),hasMaxEdge:f_(a),minBound:z_(i),minOffset:0,maxBound:V_(i),maxOffset:s,centerMinEdge:n,centerMaxEdge:r};var i,s,a=__(o);return z_(t)-z_(e)+a}),K_=(r=D.none,wf=D.none,Qw=zw(-1),Vw=zw(1),hB={"top-left":D.none(),top:D.some((e,t)=>{x_(e,QO(t))}),"top-right":D.none(),right:D.none(),"bottom-right":D.none(),bottom:D.some((e,t)=>{x_(e,o_(t))}),"bottom-left":D.none(),left:D.none()},e0=Object.freeze({__proto__:null,setValueFrom:(e,t,o)=>{t=X_(e,t,o),o=t;return Y_(e,o),t},setToMin:(e,t)=>{t=KO(t);Y_(e,t)},setToMax:(e,t)=>{t=e_(t);Y_(e,t)},findValueOfOffset:X_,getValueFromEvent:e=>jO(e).map(e=>e.top),findPositionOfValue:q_,setPositionFromValue:(e,t,o,n)=>{var r=v_(o),r=q_(e,n.getSpectrum(e),r,n.getTopEdge(e),n.getBottomEdge(e),o),n=Vo(t.element)/2;M(t.element,"top",r-n+"px")},onLeft:r,onRight:wf,onUp:Qw,onDown:Vw,edgeActions:hB}),(e,t)=>{_(e,UO(),{value:t})}),J_=(e,t)=>({x:e,y:t}),Q_=(zw=(Jw=(i,s)=>(e,t,o)=>{return r=s,e=e,t=t,o=o,n=0<(n=i)?w_:y_,a=r?v_(t).x:n(v_(t).x,qO(t),ZO(t),l_(t,o)),r=r?n(v_(t).y,KO(t),e_(t),l_(t,o)):v_(t).y,K_(e,J_(a,r)),D.some(a).map(me);var n,r,a})(-1,!1),r=Jw(1,!1),wf=Jw(-1,!0),Qw=Jw(1,!0),Vw={"top-left":D.some((e,t)=>{x_(e,b_(JO(t),QO(t)))}),top:D.some((e,t)=>{x_(e,b_(i_(t),QO(t)))}),"top-right":D.some((e,t)=>{x_(e,b_(t_(t),QO(t)))}),right:D.some((e,t)=>{x_(e,b_(t_(t),s_(t)))}),"bottom-right":D.some((e,t)=>{x_(e,b_(t_(t),o_(t)))}),bottom:D.some((e,t)=>{x_(e,b_(i_(t),o_(t)))}),"bottom-left":D.some((e,t)=>{x_(e,b_(JO(t),o_(t)))}),left:D.some((e,t)=>{x_(e,b_(JO(t),s_(t)))})},hB=Object.freeze({__proto__:null,setValueFrom:(e,t,o)=>{var n=G_(e,t,o.left),t=X_(e,t,o.top),o=J_(n,t);return K_(e,o),o},setToMin:(e,t)=>{var o=qO(t),t=KO(t);K_(e,J_(o,t))},setToMax:(e,t)=>{var o=ZO(t),t=e_(t);K_(e,J_(o,t))},getValueFromEvent:e=>jO(e),setPositionFromValue:(e,t,o,n)=>{var r=v_(o),a=$_(e,n.getSpectrum(e),r.x,n.getLeftEdge(e),n.getRightEdge(e),o),r=q_(e,n.getSpectrum(e),r.y,n.getTopEdge(e),n.getBottomEdge(e),o),n=Xo(t.element)/2,e=Vo(t.element)/2;M(t.element,"left",a-n+"px"),M(t.element,"top",r-e+"px")},onLeft:zw,onRight:r,onUp:wf,onDown:Qw,edgeActions:Vw}),Up({name:"Slider",configFields:[u("stepSize",1),u("speedMultiplier",10),u("onChange",S),u("onChoose",S),u("onInit",S),u("onDragStart",S),u("onDragEnd",S),u("snapToGrid",!1),u("rounded",!0),ya("snapStart"),ga("model",la("mode",{x:[u("minX",0),u("maxX",100),ma("value",e=>B(e.mode.minX)),i("getInitialValue"),ic("manager",Mw)],y:[u("minY",0),u("maxY",100),ma("value",e=>B(e.mode.minY)),i("getInitialValue"),ic("manager",e0)],xy:[u("minX",0),u("maxX",100),u("minY",0),u("maxY",100),ma("value",e=>B({x:e.mode.minX,y:e.mode.minY})),i("getInitialValue"),ic("manager",hB)]})),Ng("sliderBehaviours",[L,w]),ma("mouseIsDown",()=>B(!1))],partFields:Zw,factory:(r,e,t,o)=>{let a=e=>sh(e,r,"thumb"),i=e=>sh(e,r,"spectrum"),n=e=>ih(e,r,"left-edge"),s=e=>ih(e,r,"right-edge"),l=e=>ih(e,r,"top-edge"),c=e=>ih(e,r,"bottom-edge"),d=r.model,m=d.manager,u=(e,t)=>{m.setPositionFromValue(e,t,r,{getLeftEdge:n,getRightEdge:s,getTopEdge:l,getBottomEdge:c,getSpectrum:i})},g=(e,t)=>{d.value.set(t);t=a(e);u(e,t)};let p=o=>{var e=r.mouseIsDown.get();r.mouseIsDown.set(!1),e&&ih(o,r,"thumb").each(e=>{var t=d.value.get();r.onChoose(o,e,t)})},h=(e,t)=>{t.stop(),r.mouseIsDown.set(!0),r.onDragStart(e,a(e))};var f=(e,t)=>{t.stop(),r.onDragEnd(e,a(e)),p(e)};let v=e=>{ih(e,r,"spectrum").map(L.focusIn)};return{uid:r.uid,dom:r.dom,components:e,behaviours:_p(r.sliderBehaviours,[L.config({mode:"special",focusIn:v}),w.config({store:{mode:"manual",getValue:e=>d.value.get(),setValue:g}}),Om.config({channels:{[vp()]:{onReceive:p}}})]),events:ts([F(UO(),(e,t)=>{var o;e=e,t=t.event.value,g(e,t),o=a(e),r.onChange(e,o,t),D.some(!0)}),ds((e,t)=>{var o=d.getInitialValue(),o=(d.value.set(o),a(e)),n=(u(e,o),i(e));r.onInit(e,o,n,d.value.get())}),F(ni(),h),F(ai(),f),F(si(),(e,t)=>{v(e),h(e,t)}),F(di(),f)]),apis:{resetToMin:e=>{m.setToMin(e,r)},resetToMax:e=>{m.setToMax(e,r)},setValue:g,refresh:u},domModification:{styles:{position:"relative"}}}},apis:{setValue:(e,t,o)=>{e.setValue(t,o)},resetToMin:(e,t)=>{e.resetToMin(t)},resetToMax:(e,t)=>{e.resetToMax(t)},refresh:(e,t)=>{e.refresh(t)}}})),Z_=N("rgb-hex-update"),eT=N("slider-update"),tT=N("palette-update"),oT=(e,t)=>{var o=Q_.parts.spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),n=Q_.parts.thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}});return Q_.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"slider","aria-valuemin":0,"aria-valuemax":360,"aria-valuenow":120}},rounded:!1,model:{mode:"y",getInitialValue:T(0)},components:[o,n],sliderBehaviours:R([U.config({})]),onChange:(e,t,o)=>{A(e.element,"aria-valuenow",Math.floor(360-3.6*o)),_(e,eT,{value:o})}})},nT=[Ng("formBehaviours",[w])],rT=e=>"<alloy.field."+e+">",aT=(e,t)=>e.fold(()=>I.error(t),I.value),iT=(n,e)=>({uid:n.uid,dom:n.dom,components:e,behaviours:_p(n.formBehaviours,[w.config({store:{mode:"manual",getValue:e=>{e=ch(e,n);return Ge(e,(e,o)=>e().bind(e=>{var t=z.getCurrent(e);return aT(t,new Error(`Cannot find a current component to extract the value from for form part '${o}': `+Pl(e.element)))}).map(w.getValue))},setValue:(o,e)=>{je(e,(t,e)=>{ih(o,n,e).each(e=>{z.getCurrent(e).each(e=>{w.setValue(e,t)})})})}}})]),apis:{getField:(e,t)=>ih(e,n,t).bind(z.getCurrent)}}),sT={getField:Tc((e,t,o)=>e.getField(t,o)),sketch:e=>{var t=(()=>{let o=[];return{field:(e,t)=>(o.push(e),th("form",rT(e),t)),record:T(o)}})(),e=e(t),t=t.record(),t=C(t,e=>Xp({name:e,pname:rT(e)}));return bh("form",nT,t,iT,e)}},lT=N("valid-input"),cT=N("invalid-input"),dT=N("validating-input"),mT="colorcustom.rgb.",uT={isEnabled:me,setEnabled:S,immediatelyShow:S,immediatelyHide:S},gT=(g,p,h,f,s,l)=>{let r=(e,t)=>{t=t.get();e!==t.isEnabled()&&(t.setEnabled(e),e?t.immediatelyShow():t.immediatelyHide())},c=(t,o,n)=>RO.config({invalidClass:p("invalid"),notify:{onValidate:e=>{_(e,dT,{type:t})},onValid:e=>{r(!1,n),_(e,lT,{type:t,value:w.getValue(e)})},onInvalid:e=>{r(!0,n),_(e,cT,{type:t,value:w.getValue(e)})}},validator:{validate:e=>{e=w.getValue(e),e=o(e)?I.value(!0):I.error(g("aria.input.invalid"));return gk.pure(e)},validateOnLoad:!1}}),v=(e,o,t,n,r)=>{let a=B(uT);var i=g(mT+"range"),t=W.parts.label({dom:{tag:"label"},components:[xd(t)]}),r=W.parts.field({data:r,factory:tw,inputAttributes:{type:"text","aria-label":n,..."hex"===o?{"aria-live":"polite"}:{}},inputClasses:[p("textfield")],inputBehaviours:R([c(o,e,a),ux.config({}),yx.config({...s({tooltipText:"",onSetup:t=>{a.set({isEnabled:()=>yx.isEnabled(t),setEnabled:e=>yx.setEnabled(t,e),immediatelyShow:()=>yx.immediateOpenClose(t,!0),immediatelyHide:()=>yx.immediateOpenClose(t,!1)}),yx.setEnabled(t,!1)},onShow:(e,t)=>{yx.setComponents(e,[{dom:{tag:"p",classes:[p("rgb-warning-note")]},components:[xd(g("hex"===o?"colorcustom.rgb.invalidHex":"colorcustom.rgb.invalid"))]}])}})})]),onSetValue:e=>{RO.isInvalid(e)&&RO.run(e).get(S)}}),n=N("aria-invalid"),e=mx(l("invalid",D.some(n),"warning")),n=[t,r,mx({dom:{tag:"div",classes:[p("invalid-icon")]},components:[e.asSpec()]}).asSpec()],t="hex"!==o?[W.parts["aria-descriptor"]({text:i})]:[],r=n.concat(t);return{dom:{tag:"div",attributes:{role:"presentation"},classes:[p("rgb-container")]},components:r}},b=(e,t)=>{var o=t.red,n=t.green,t=t.blue;w.setValue(e,{red:o,green:n,blue:t})},x=mx({dom:{tag:"div",classes:[p("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),y=(e,t)=>{x.getOpt(e).each(e=>{M(e.element,"background-color","#"+t.value)})};return kh({factory:()=>{let o={red:B(D.some(255)),green:B(D.some(255)),blue:B(D.some(255)),hex:B(D.some("ffffff"))},e=e=>o[e].get(),a=(e,t)=>{o[e].set(t)},n=()=>e("red").bind(o=>e("green").bind(t=>e("blue").map(e=>kS(o,t,e,1)))),i=e=>{var t=e.red,o=e.green,e=e.blue;a("red",D.some(t)),a("green",D.some(o)),a("blue",D.some(e))},t=(e,t)=>{t=t.event;"hex"!==t.type?a(t.type,D.none()):f(e)},s=(t,e,o)=>{o=parseInt(o,10);a(e,D.some(o)),n().each(e=>{e=((t,e)=>{let o=bS(e);return sT.getField(t,"hex").each(e=>{U.isFocused(e)||w.setValue(t,{hex:o.value})}),o})(t,e);_(t,Z_,{hex:e}),y(t,e)})},r=(e,t)=>{var o,n,r,t=t.event;"hex"===t.type?(o=e,n=t.value,h(o),n=cS(n),a("hex",D.some(n.value)),r=TS(n),b(o,r),i(r),_(o,Z_,{hex:n}),y(o,n)):s(e,t.type,t.value)};var l=e=>({label:g(mT+e+".label"),description:g(mT+e+".description")});let c=l("red"),d=l("green"),m=l("blue"),u=l("hex");return vr(sT.sketch(e=>({dom:{tag:"form",classes:[p("rgb-form")],attributes:{"aria-label":g("aria.color.picker")}},components:[e.field("red",W.sketch(v(OS,"red",c.label,c.description,255))),e.field("green",W.sketch(v(OS,"green",d.label,d.description,255))),e.field("blue",W.sketch(v(OS,"blue",m.label,m.description,255))),e.field("hex",W.sketch(v(uS,"hex",u.label,u.description,"ffffff"))),x.asSpec()],formBehaviours:R([RO.config({invalidClass:p("form-invalid")}),P("rgb-form-events",[F(lT,r),F(cT,t),F(dT,t)])])})),{apis:{updateHex:(e,t)=>{w.setValue(e,{hex:t.value}),((e,t)=>{t=TS(t);b(e,t),i(t)})(e,t),y(e,t)}}})},name:"RgbForm",configFields:[],apis:{updateHex:(e,t,o)=>{e.updateHex(t,o)}},extraApis:{}})},pT=(n,r)=>{let a=Q_.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[r("sv-palette-spectrum")]}}),i=Q_.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[r("sv-palette-thumb")],innerHtml:`<div class=${r("sv-palette-inner-thumb")} role="presentation"></div>`}}),s=(e,t)=>{var{width:o,height:n}=e,e=e.getContext("2d");null!==e&&(e.fillStyle=t,e.fillRect(0,0,o,n),(t=e.createLinearGradient(0,0,o,0)).addColorStop(0,"rgba(255,255,255,1)"),t.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=t,e.fillRect(0,0,o,n),(t=e.createLinearGradient(0,0,0,n)).addColorStop(0,"rgba(0,0,0,0)"),t.addColorStop(1,"rgba(0,0,0,1)"),e.fillStyle=t,e.fillRect(0,0,o,n))};return kh({factory:e=>{var t=T({x:0,y:0}),o=R([z.config({find:D.some}),U.config({})]);return Q_.sketch({dom:{tag:"div",attributes:{role:"slider","aria-valuetext":n(["Saturation {0}%, Brightness {1}%",0,0])},classes:[r("sv-palette")]},model:{mode:"xy",getInitialValue:t},rounded:!1,components:[a,i],onChange:(e,t,o)=>{Z(o)||A(e.element,"aria-valuetext",n(["Saturation {0}%, Brightness {1}%",Math.floor(o.x),Math.floor(100-o.y)])),_(e,tT,{value:o})},onInit:(e,t,o,n)=>{s(o.element.dom,AS(MS))},sliderBehaviours:o})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:(e,t,o)=>{((e,t)=>{e=e.components()[0].element.dom,t=lC(t,100,100),t=_S(t);s(e,AS(t))})(t,o)},setThumb:(e,t,o)=>{((e,t)=>{t=cC(TS(t));Q_.setValue(e,{x:t.saturation,y:100-t.value}),A(e.element,"aria-valuetext",n(["Saturation {0}%, Brightness {1}%",t.saturation,t.value]))})(t,o)}},extraApis:{}})},hT={self:()=>z.config({find:D.some}),memento:e=>z.config({find:e.getOpt}),childAt:e=>z.config({find:t=>no(t.element,e).bind(e=>t.getSystem().getByDom(e).toOptional())})},fT=m([u("preprocess",re),u("postprocess",re)]),vT=(o,e)=>{let n=ia("RepresentingConfigs.memento processors",fT,e);return w.config({store:{mode:"manual",getValue:e=>{e=o.get(e),e=w.getValue(e);return n.postprocess(e)},setValue:(e,t)=>{t=n.preprocess(t),e=o.get(e);w.setValue(e,t)}}})},bT=(e,t,o)=>w.config({store:{mode:"manual",...e.map(e=>({initialValue:e})).getOr({}),getValue:t,setValue:o}}),xT=(e,t,o)=>bT(e,e=>t(e.element),(e,t)=>o(e.element,t)),yT=e=>w.config({store:{mode:"memory",initialValue:e}}),wT={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red channel","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green channel","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue channel","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.rgb.invalid":"Numbers only, 0 to 255","colorcustom.rgb.invalidHex":"Hexadecimal only, 000000 to FFFFFF","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},ST=(e,r,t)=>{var p,h,f,v,o,n=e=>"tox-"+e,n=(p=e=>y(e)?o.translate(wT[e]):o.translate(e),h=n,f=(o=r).tooltips.getConfig,v=(e,t,o=e,n=e)=>wy(o,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+e],attributes:{title:r.translate(n),"aria-live":"polite",...t.fold(()=>({}),e=>({id:e}))}},r.icons),kh({name:"ColourPicker",configFields:[i("dom"),u("onValidHex",S),u("onInvalidHex",S)],factory:e=>{let o=gT(p,h,e.onValidHex,e.onInvalidHex,f,v),n=pT(p,h),r=e=>100-e/360*100,a={paletteRgba:B(MS),paletteHue:B(0)},i=mx(oT(p,h)),s=mx(n.sketch({})),l=mx(o.sketch({})),t=(e,t,o)=>{s.getOpt(e).each(e=>{n.setHue(e,o)})},c=(e,t)=>{l.getOpt(e).each(e=>{o.updateHex(e,t)})},d=(e,t,o)=>{i.getOpt(e).each(e=>{Q_.setValue(e,r(o))})},m=(e,t)=>{s.getOpt(e).each(e=>{n.setThumb(e,t)})},u=(e,t)=>{e=TS(e);a.paletteRgba.set(e),a.paletteHue.set(t)},g=(t,o,n,e)=>{u(o,n),E(e,e=>{e(t,o,n)})};return{uid:e.uid,dom:e.dom,components:[s.asSpec(),i.asSpec(),l.asSpec()],behaviours:R([P("colour-picker-events",[F(Z_,(()=>{let n=[t,d,m];return(e,t)=>{var t=t.event.hex,o=dC(t);g(e,t,o.hue,n)}})()),F(tT,(()=>{let n=[c];return(e,t)=>{var t=t.event.value,o=a.paletteHue.get(),t=lC(o,t.x,100-t.y),t=mC(t);g(e,t,o,n)}})()),F(eT,(()=>{let n=[t,c];return(e,t)=>{var t=(100-t.event.value)/100*360,o=a.paletteRgba.get(),o=cC(o),o=lC(t,o.saturation,o.value),o=mC(o);g(e,o,t,n)}})())]),z.config({find:e=>l.getOpt(e)}),L.config({mode:"acyclic"})])}}}));let a=mx(n.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:e=>{_(e,SO,{name:"hex-valid",value:!0})},onInvalidHex:e=>{_(e,SO,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[a.asSpec()],behaviours:R([bT(t,e=>{e=a.get(e);return z.getCurrent(e).bind(e=>w.getValue(e).hex).map(e=>"#"+ut(e,"#")).getOr("")},(e,t)=>{let o=D.from(/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(t)).bind(e=>ze(e,1));t=a.get(e);z.getCurrent(t).fold(()=>{console.log("Can not find form")},e=>{w.setValue(e,{hex:o.getOr("")}),sT.getField(e,"hex").each(e=>{b(e,fi())})})}),hT.self()])}};var CT=tinymce.util.Tools.resolve("tinymce.Resource");let kT=e=>et(e,"init");var OT,_T=tinymce.util.Tools.resolve("tinymce.util.Tools");let TT=N("browse.files.event"),ET=(o,n,e)=>{var t=(e,t)=>{t.stop()},r=e=>(t,o)=>{E(e,e=>{e(t,o)})};let a=(e,t)=>{t&&(w.setValue(e,((e,t)=>{let o=_T.explode(t.getOption("images_file_types"));return Ce(He(e),t=>be(o,e=>ft(t.name.toLowerCase(),"."+e.toLowerCase())))})(t,n)),_(e,bO,{name:o.name}))},i=mx({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:R([P("input-file-events",[ls(bi()),ls(Mi())])])});var s=o.label.map(e=>vO(e,n)),e=W.parts.field({factory:sx,dom:{tag:"button",styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[xd(n.translate("Browse for an image")),i.asSpec()],action:e=>{i.get(e).element.dom.click()},buttonBehaviours:R([hT.self(),yT(e.getOr([])),ux.config({}),T0.button(()=>n.checkUiComponentContext(o.context).shouldDisable),V0(()=>n.checkUiComponentContext(o.context))])}),r={dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:R([V.config({disabled:()=>n.checkUiComponentContext(o.context).shouldDisable}),V0(()=>n.checkUiComponentContext(o.context)),h.config({toggleClass:"dragenter",toggleOnExecute:!1}),P("dropzone-events",[F("dragenter",r([t,h.toggle])),F("dragleave",r([t,h.toggle])),F("dragover",t),F("drop",r([t,(e,t)=>{V.isDisabled(e)||(t=t.event.raw,_(e,TT,{files:null==(e=t.dataTransfer)?void 0:e.files}))}])),F(vi(),(e,t)=>{t=t.event.raw.target;_(e,TT,{files:t.files})})])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p"},components:[xd(n.translate("Drop an image here"))]},e]}]};return pO(s,r,["tox-form__group--stretched"],[P("handle-files",[F(TT,(e,t)=>{W.getField(e).each(e=>{a(e,t.event.files)})})])])},DT=(t,o)=>{let n=null,r=()=>{Y(n)||(clearTimeout(n),n=null)};return{cancel:r,throttle:(...e)=>{r(),n=setTimeout(()=>{n=null,t.apply(null,e)},o)}}},AT=N("alloy-fake-before-tabstop"),MT=N("alloy-fake-after-tabstop"),BT=e=>({dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:e},behaviours:R([U.config({ignore:!0}),ux.config({})])}),IT=(e,t)=>({dom:{tag:"div",classes:["tox-navobj",...e.getOr([])]},components:[BT([AT]),t,BT([MT])],behaviours:R([hT.childAt(1)])}),FT=(e,t)=>{_(e,pi(),{raw:{which:9,shiftKey:t}})},RT=(e,t)=>{t=t.element;Ws(t,AT)?FT(e,!0):Ws(t,MT)&&FT(e,!1)},NT=e=>Uk(e,["."+AT,"."+MT].join(","),de),zT=N("update-dialog"),VT=N("update-title"),LT=N("update-body"),HT=N("update-footer"),PT=N("body-send-message"),UT=N("dialog-focus-shifted"),WT=(Jw=On().browser).isSafari(),jT=(zw=Jw.isFirefox(),WT||zw),GT=Jw.isChromium(),$T=({scrollTop:e,scrollHeight:t,clientHeight:o})=>Math.ceil(e)+o>=t,YT=(e,t)=>e.scrollTo(0,"bottom"===t?99999999:t),XT=(e,t)=>{var o=e.body;return D.from(!/^<!DOCTYPE (html|HTML)/.test(t)&&(!GT&&!WT||J(o)&&(0!==o.scrollTop||1<Math.abs(o.scrollHeight-o.clientHeight)))?o:e.documentElement)},qT=(e,r,t)=>{let a=e.dom;D.from(a.contentDocument).fold(t,e=>{let t=0,o=XT(e,r).map(e=>(t=e.scrollTop,e)).forall($T);var n=()=>{var e=a.contentWindow;J(e)&&(o?YT(e,"bottom"):!o&&jT&&0!==t&&YT(e,t))};WT&&a.addEventListener("load",n,{once:!0}),e.open(),e.write(r),e.close(),WT||n()})},KT=lt(jT,WT?500:200).map(e=>((t,o)=>{let n=null,r=null;return{cancel:()=>{Y(n)||(clearTimeout(n),n=null,r=null)},throttle:(...e)=>{r=e,Y(n)&&(n=setTimeout(()=>{var e=r;n=null,r=null,t.apply(null,e)},o))}}})(qT,e)),JT=(e,t,o)=>{let n="tox-dialog__iframe",r=e.transparent?[]:[n+"--opaque"],a=e.border?["tox-navobj-bordered"]:[],i={...e.label.map(e=>({title:e})).getOr({}),...o.map(e=>({srcdoc:e})).getOr({}),...e.sandboxed?{sandbox:"allow-scripts allow-same-origin"}:{}},s=((e,n)=>{let r=B(e.getOr(""));return{getValue:e=>r.get(),setValue:(t,o)=>{if(r.get()!==o){let e=t.element;t=()=>A(e,"srcdoc",o);n?KT.fold(T(qT),e=>e.throttle)(e,o,t):t()}r.set(o)}}})(o,e.streamContent);var e=e.label.map(e=>vO(e,t)),l=W.parts.field({factory:{sketch:e=>IT(D.from(a),{uid:e.uid,dom:{tag:"iframe",attributes:i,classes:[n,...r]},behaviours:R([ux.config({}),U.config({}),bT(o,s.getValue,s.setValue),Om.config({channels:{[UT]:{onReceive:(o,e)=>{e.newFocus.each(t=>{Qt(o.element).each(e=>{(Gt(o.element,t)?Ls:Ps)(e,"tox-navobj-bordered-focus")})})}}}})])})}});return pO(e,l,["tox-form__group--stretched"],[])},QT=(e,t)=>{let n=B(t.getOr({url:""})),r=mx({dom:{tag:"img",classes:["tox-imagepreview__image"],attributes:t.map(e=>({src:e.url})).getOr({})}}),c=mx({dom:{tag:"div",classes:["tox-imagepreview__container"],attributes:{role:"presentation"}},components:[r.asSpec()]});let o={};e.height.each(e=>o.height=e);e=t.map(e=>({url:e.url,zoom:D.from(e.zoom),cachedWidth:D.from(e.cachedWidth),cachedHeight:D.from(e.cachedHeight)}));return{dom:{tag:"div",classes:["tox-imagepreview"],styles:o,attributes:{role:"presentation"}},components:[c.asSpec()],behaviours:R([hT.self(),bT(e,()=>n.get(),(s,t)=>{let l={url:t.url},o=(t.zoom.each(e=>l.zoom=e),t.cachedWidth.each(e=>l.cachedWidth=e),t.cachedHeight.each(e=>l.cachedHeight=e),n.set(l),()=>{var e,o,n,{cachedWidth:r,cachedHeight:a,zoom:i}=l;if(!q(r)&&!q(a)){q(i)&&(i=s.element,e=r,o=a,n=Xo(i),i=Vo(i),n=Math.min(n/e,i/o,1),l.zoom=n);let t=((e,t,o,n,r)=>{o*=r,n*=r,r=Math.max(0,e/2-o/2),e=Math.max(0,t/2-n/2);return{left:r.toString()+"px",top:e.toString()+"px",width:o.toString()+"px",height:n.toString()+"px"}})(Xo(s.element),Vo(s.element),r,a,l.zoom);c.getOpt(s).each(e=>{Eo(e.element,t)})}});r.getOpt(s).each(e=>{var a,e=e.element;t.url!==wo(e,"src")&&(A(e,"src",t.url),Ps(s.element,"tox-imagepreview__loaded")),o(),a=e,new Promise((e,t)=>{var o=()=>{r(),e(a)};let n=[Zm(a,"load",o),Zm(a,"error",()=>{r(),t("Unable to load data from image: "+a.dom.src)})],r=()=>E(n,e=>e.unbind());a.dom.complete&&o()}).then(e=>{s.getSystem().isConnected()&&(Ls(s.element,"tox-imagepreview__loaded"),l.cachedWidth=e.dom.naturalWidth,l.cachedHeight=e.dom.naturalHeight,o())})})})])}},ZT=(e,t,o)=>{var n="tox-label",r="center"===e.align?[n+"--center"]:[],a="end"===e.align?[n+"--end"]:[];let i=mx({dom:{tag:"label",classes:[n,...r,...a]},components:[xd(t.providers.translate(e.label))]});n=C(e.items,t.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[i.asSpec(),...n],behaviours:R([hT.self(),H.config({}),(r=D.none(),xT(r,Fl,Rl)),L.config({mode:"acyclic"}),P("label",[ds(t=>{e.for.each(e=>{o(e).each(o=>{i.getOpt(t).each(e=>{var t=null!=(t=wo(o.element,"id"))?t:N("form-field");A(o.element,"id",t),A(e.element,"for",t)})})})})])])}},e1=N("toolbar.button.execute"),t1=o=>gs((t,e)=>{E0(o,t)(e=>{_(t,e1,{buttonApi:e}),o.onAction(e)})}),o1=N("common-button-display-events"),n1={[Di()]:["disabling","alloy.base.behaviour","toggling","toolbar-button-events","tooltipping"],[Hi()]:["toolbar-button-events",o1],[Pi()]:["toolbar-button-events","dropdown-events","tooltipping"],[si()]:["focusing","alloy.base.behaviour",o1]},r1=e=>M(e.element,"width",Ao(e.element,"width")),a1=(e,t,o)=>wy(e,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:o},t),i1=(e,t)=>a1(e,t,[]),s1=(e,t)=>a1(e,t,[H.config({})]),l1=(e,t,o)=>({dom:{tag:"span",classes:[t+"__select-label"]},components:[xd(o.translate(e))],behaviours:R([H.config({})])}),c1=N("update-menu-text"),d1=N("update-menu-icon"),m1=(n,t,r,e)=>{var o=B(S);let a=n.text.map(e=>mx(l1(e,t,r.providers))),i=n.icon.map(e=>mx(s1(e,r.providers.icons)));var s=(e,t)=>{e=w.getValue(e);return U.focus(e),_(e,"keydown",{raw:t.event.raw}),Tk.close(e),D.some(!0)},l=n.role.fold(()=>({}),e=>({role:e})),c=D.from(n.listRole).map(e=>({listRole:e})).getOr({}),d=n.ariaLabel.fold(()=>({}),e=>({"aria-label":r.providers.translate(e)})),m=wy("chevron-down",{tag:"div",classes:[t+"__select-chevron"]},r.providers.icons),u=N("common-button-display-events"),g="dropdown-events";return mx(Tk.sketch({...n.uid?{uid:n.uid}:{},...l,...c,dom:{tag:"button",classes:[t,t+"--select"].concat(C(n.classes,e=>t+"--"+e)),attributes:{...d,...J(e)?{"data-mce-name":e}:{}}},components:P0([i.map(e=>e.asSpec()),a.map(e=>e.asSpec()),D.some(m)]),matchWidth:!0,useMinWidth:!0,onOpen:(e,t,o)=>{n.searchable&&Rk(o)},dropdownBehaviours:R([...n.dropdownBehaviours,T0.button(()=>n.disabled||r.providers.checkUiComponentContext(n.context).shouldDisable),V0(()=>r.providers.checkUiComponentContext(n.context)),NO.config({}),H.config({}),...n.tooltip.map(e=>yx.config(r.providers.tooltips.getConfig({tooltipText:r.providers.translate(e)}))).toArray(),P(g,[D0(n,o),A0(n,o)]),P(u,[ds((e,t)=>{"listbox"!==n.listRole&&r1(e)})]),P("update-dropdown-width-variable",[F(Li(),(e,t)=>Tk.close(e))]),P("menubutton-update-display-text",[F(c1,(t,o)=>{a.bind(e=>e.getOpt(t)).each(e=>{H.set(e,[xd(r.providers.translate(o.event.text))])})}),F(d1,(t,o)=>{i.bind(e=>e.getOpt(t)).each(e=>{H.set(e,[s1(o.event.icon,r.providers.icons)])})})])]),eventOrder:vr(n1,{[si()]:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"],[Hi()]:["toolbar-button-events",yx.name(),g,u]}),sandboxBehaviours:R([L.config({mode:"special",onLeft:s,onRight:s}),P("dropdown-sandbox-events",[F(ow,(e,t)=>{Dk(e),t.stop()}),F(nw,(e,t)=>{Ak(e,t),t.stop()})])]),lazySink:r.getSink,toggleClass:t+"--active",parts:{menu:{...Qy(!1,n.columns,n.presets),fakeFocus:n.searchable,..."listbox"===n.listRole?{}:{onHighlightItem:Ik,onCollapseMenu:(t,e,o)=>{Gh.getHighlighted(o).each(e=>{Ik(t,o,e)})},onDehighlightItem:Fk}}},getAnchorOverrides:()=>({maxHeightFunction:(e,t)=>{xu()(e,t-10)}}),fetch:e=>gk.nu(ie(n.fetch,e))})).asSpec()},u1=e=>y(e),g1=e=>"separator"===e.type,p1=e=>et(e,"getSubmenuItems"),h1={type:"separator"},f1=(e,o)=>{e=Oe(e,(e,t)=>u1(t)?""===t?e:"|"===t?0<e.length&&!g1(e[e.length-1])?e.concat([h1]):e:et(o,t.toLowerCase())?e.concat([o[t.toLowerCase()]]):e:e.concat([t]),[]);return 0<e.length&&g1(e[e.length-1])&&e.pop(),e},v1=(e,t)=>{var o=e.getSubmenuItems(),o=x1(o,t);return{item:e,menus:vr(o.menus,{[e.value]:o.items}),expansions:vr(o.expansions,{[e.value]:e.value})}},b1=e=>{var t=k(e,"value").getOrThunk(()=>N("generated-menu-item"));return vr({value:t},e)},x1=(e,n)=>{e=f1(y(e)?e.split(" "):e,n);return ke(e,(e,t)=>{var o;return p1(t)?(o=b1(t),o=v1(o,n),{menus:vr(e.menus,o.menus),items:[o.item,...e.items],expansions:vr(e.expansions,o.expansions)}):{...e,items:[t,...e.items]}},{menus:{},expansions:{},items:[]})},y1=e=>e.search.fold(()=>({searchMode:"no-search"}),e=>({searchMode:"search-with-field",placeholder:e.placeholder})),w1=e=>e.search.fold(()=>({searchMode:"no-search"}),e=>({searchMode:"search-with-results"})),S1=(e,o,n,t)=>{var r=N("primary-menu"),e=x1(e,n.shared.providers.menuItems());if(0===e.items.length)return D.none();var a=y1(t),a=Vk(r,e.items,o,n,t.isHorizontalMenu,a);let i=w1(t);t=Ge(e.menus,(e,t)=>Vk(t,e,o,n,!1,i)),t=vr(t,Ua(r,a));return D.from(Wv.tieredData(r,t,e.expansions))},C1=e=>!et(e,"items"),k1="data-value",O1=(t,o,e,n,r)=>C(e,e=>C1(e)?{type:"togglemenuitem",...r?{}:{role:"option"},text:e.text,value:e.value,active:e.value===n,onAction:()=>{w.setValue(t,e.value),_(t,bO,{name:o}),U.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:()=>O1(t,o,e.items,n,r)}),_1=(e,t)=>Pe(e,e=>C1(e)?lt(e.value===t,e):_1(e.items,t)),T1=kh({name:"HtmlSelect",configFields:[i("options"),Ng("selectBehaviours",[U,w]),u("selectClasses",[]),u("selectAttributes",{}),ya("data")],factory:(n,e)=>{var t=C(n.options,e=>({dom:{tag:"option",value:e.value,innerHtml:e.text}})),o=n.data.map(e=>Ua("initialValue",e)).getOr({});return{uid:n.uid,dom:{tag:"select",classes:n.selectClasses,attributes:n.selectAttributes},components:t,behaviours:_p(n.selectBehaviours,[U.config({}),w.config({store:{mode:"manual",getValue:e=>Jc(e.element),setValue:(t,o)=>{var e=Ve(n.options);Te(n.options,e=>e.value===o).isSome()?Qc(t.element,o):-1===t.element.dom.selectedIndex&&""===o&&e.each(e=>Qc(t.element,e.value))},...o}})])}}}),E1=(r=T([u("field1Name","field1"),u("field2Name","field2"),rc("onLockedChange"),tc(["lockClass"]),u("locked",!1),Tp.field("coupledFieldBehaviours",[z,w]),Fa("onInput",S)]),wf=(e,a)=>Xp({factory:W,name:e,overrides:r=>({fieldBehaviours:R([P("coupled-input-behaviour",[F(fi(),o=>{var e,t,n;e=o,t=r,n=a,ih(e,t,n).bind(z.getCurrent).each(t=>{ih(o,r,"lock").each(e=>{h.isOn(e)&&r.onLockedChange(o,t,e),r.onInput(o)})})})])])})}),Qw=T([wf("field1","field2"),wf("field2","field1"),Xp({factory:sx,schema:[i("dom")],name:"lock",overrides:e=>({buttonBehaviours:R([h.config({selected:e.locked,toggleClass:e.markers.lockClass,aria:{mode:"pressed"}})])})})]),Up({name:"FormCoupledInputs",configFields:r(),partFields:Qw(),factory:(o,e,t,n)=>({uid:o.uid,dom:o.dom,components:e,behaviours:Tp.augment(o.coupledFieldBehaviours,[z.config({find:D.some}),w.config({store:{mode:"manual",getValue:e=>{e=mh(e,o,["field1","field2"]);return{[o.field1Name]:w.getValue(e.field1()),[o.field2Name]:w.getValue(e.field2())}},setValue:(e,t)=>{e=mh(e,o,["field1","field2"]);tt(t,o.field1Name)&&w.setValue(e.field1(),t[o.field1Name]),tt(t,o.field2Name)&&w.setValue(e.field2(),t[o.field2Name])}}})]),apis:{getField1:e=>ih(e,o,"field1"),getField2:e=>ih(e,o,"field2"),getLock:e=>ih(e,o,"lock")}}),apis:{getField1:(e,t)=>e.getField1(t),getField2:(e,t)=>e.getField2(t),getLock:(e,t)=>e.getLock(t)}})),D1=e=>{let t={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4};var o;let n=e.value.toFixed((o=e.unit)in t?t[o]:1);return(n=-1!==n.indexOf(".")?n.replace(/\.?0*$/,""):n)+e.unit},A1=e=>{var t,o=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(e);return null!==o?(t=parseFloat(o[1]),o=o[2],I.value({value:t,unit:o})):I.error(e)},M1=(e,t)=>{let o={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1};var n=e=>et(o,e);return e.unit===t?D.some(e.value):n(e.unit)&&n(t)?o[e.unit]===o[t]?D.some(e.value):D.some(e.value/o[e.unit]*o[t]):D.none()},B1=e=>D.none(),I1=(t,o)=>e=>M1(e,o).map(e=>({value:e*t,unit:o})),F1=(e,t)=>{e=A1(e).toOptional(),t=A1(t).toOptional();return at(e,t,(e,t)=>M1(e,t.unit).map(e=>t.value/e).map(e=>I1(e,t.unit)).getOr(B1)).getOr(B1)},R1=(n,t)=>{let r=B1,a=N("ratio-event");var e=e=>wy(e,{tag:"span",classes:["tox-icon","tox-lock-icon__"+e]},t.icons);let i=()=>!n.enabled||n.context.exists(e=>t.checkUiComponentContext(e).shouldDisable),s=n.context.map(e=>V0(()=>t.checkUiComponentContext(e)));var o=n.label.getOr("Constrain proportions"),l=t.translate(o),o=E1.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{"aria-label":l,"data-mce-name":o}},components:[e("lock"),e("unlock")],buttonBehaviours:R([V.config({disabled:i}),...s.toArray(),ux.config({}),yx.config(t.tooltips.getConfig({tooltipText:l}))])}),e=e=>({dom:{tag:"div",classes:[n.inDialog?"tox-form__group":"tox-context-form__group"]},components:e}),l=o=>W.parts.field({factory:tw,inputClasses:n.inDialog?["tox-textfield"]:["tox-textfield","tox-toolbar-textfield","tox-textfield-size"],data:o?n.width:n.height,inputBehaviours:R([V.config({disabled:i}),...s.toArray(),ux.config({}),P("size-input-events",[F(ui(),(e,t)=>{_(e,a,{isField1:o})}),F(vi(),(t,e)=>{n.name.each(e=>_(t,bO,{name:e}))})]),...n.onEnter.map(e=>L.config({mode:"special",onEnter:e})).toArray()]),selectOnFocus:!1}),c=e=>({dom:{tag:"label",classes:["tox-label"]},components:[xd(t.translate(e))]}),d=E1.parts.field1(e([W.parts.label(c("Width")),l(!0)])),l=E1.parts.field2(e([W.parts.label(c("Height")),l(!1)]));let m=B(S);var u=at(n.onSetup,n.getApi,(e,t)=>[D0({onSetup:e,getApi:t},m),A0({getApi:t},m)]).getOr([]);return E1.sketch({dom:{tag:"div",classes:[n.inDialog?"tox-form__group":"tox-context-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[d,l,e([c(Gu),o])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:(e,t,o)=>{A1(w.getValue(e)).each(e=>{r(e).each(e=>{w.setValue(t,D1(e))})})},onInput:e=>b(e,xO),coupledFieldBehaviours:R([V.config({disabled:i,onDisabled:e=>{E1.getField1(e).bind(W.getField).each(V.disable),E1.getField2(e).bind(W.getField).each(V.disable),E1.getLock(e).each(V.disable)},onEnabled:e=>{E1.getField1(e).bind(W.getField).each(V.enable),E1.getField2(e).bind(W.getField).each(V.enable),E1.getLock(e).each(V.enable)}}),V0(()=>t.checkUiComponentContext("mode:design")),P("size-input-events",[F(a,(e,t)=>{var t=t.event.isField1,o=t?E1.getField1(e):E1.getField2(e),t=t?E1.getField2(e):E1.getField1(e),e=o.map(w.getValue).getOr(""),o=t.map(w.getValue).getOr("");r=F1(e,o)}),F(xO,t=>{n.onInput.each(e=>e(t))}),...u])])})},N1=(o,t)=>{var e=o.label.map(e=>vO(e,t)),n=[V.config({disabled:()=>o.disabled||t.checkUiComponentContext(o.context).shouldDisable}),V0(()=>t.checkUiComponentContext(o.context)),L.config({mode:"execution",useEnter:!0!==o.multiline,useControlEnter:!0===o.multiline,execute:e=>(b(e,CO),D.some(!0))}),P("textfield-change",[F(fi(),(e,t)=>{_(e,bO,{name:o.name})}),F(Ti(),(e,t)=>{_(e,bO,{name:o.name})})]),ux.config({})],r=o.validation.map(o=>RO.config({getRoot:e=>Qt(e.element),invalidClass:"tox-invalid",validator:{validate:e=>{var e=w.getValue(e),t=o.validator(e);return gk.pure(!0===t?I.value(e):I.error(t))},validateOnLoad:o.validateOnLoad}})).toArray(),a=o.placeholder.fold(T({}),e=>({placeholder:t.translate(e)})),i=o.inputMode.fold(T({}),e=>({inputmode:e})),a={...a,...i,"data-mce-name":o.name},i=W.parts.field({tag:!0===o.multiline?"textarea":"input",...o.data.map(e=>({data:e})).getOr({}),inputAttributes:a,inputClasses:[o.classname],inputBehaviours:R(De([n,r])),selectOnFocus:!1,factory:tw}),a=o.multiline?{dom:{tag:"div",classes:["tox-textarea-wrap"]},components:[i]}:i,n=(o.flex?["tox-form__group--stretched"]:[]).concat(o.maximized?["tox-form-group--maximize"]:[]),r=[V.config({disabled:()=>o.disabled||t.checkUiComponentContext(o.context).shouldDisable,onDisabled:e=>{W.getField(e).each(V.disable)},onEnabled:e=>{W.getField(e).each(V.enable)}}),V0(()=>t.checkUiComponentContext(o.context))];return pO(e,a,n,r)},z1=(t,e)=>e.getAnimationRoot.fold(()=>t.element,e=>e(t)),V1=e=>e.dimension.property,L1=(e,t)=>e.dimension.getDimension(t),H1=(e,t)=>{e=z1(e,t);Gs(e,[t.shrinkingClass,t.growingClass])},P1=(e,t)=>{Ps(e.element,t.openClass),Ls(e.element,t.closedClass),M(e.element,V1(t),"0px"),No(e.element)},U1=(e,t)=>{Ps(e.element,t.closedClass),Ls(e.element,t.openClass),Ro(e.element,V1(t))},W1=(e,t,o,n)=>{o.setCollapsed(),M(e.element,V1(t),L1(t,e.element)),H1(e,t),P1(e,t),t.onStartShrink(e),t.onShrunk(e)},j1=(e,t,o,n)=>{n=n.getOrThunk(()=>L1(t,e.element)),o.setCollapsed(),M(e.element,V1(t),n),No(e.element),o=z1(e,t);Ps(o,t.growingClass),Ls(o,t.shrinkingClass),P1(e,t),t.onStartShrink(e)},G1=(e,t,o)=>{var n=L1(t,e.element);("0px"===n?W1:j1)(e,t,o,D.some(n))},$1=(e,t,o)=>{var n=z1(e,t),r=Ws(n,t.shrinkingClass);let a=L1(t,e.element);U1(e,t);var i=L1(t,e.element);(r?()=>{M(e.element,V1(t),a),No(e.element)}:()=>{P1(e,t)})(),Ps(n,t.shrinkingClass),Ls(n,t.growingClass),U1(e,t),M(e.element,V1(t),i),o.setExpanded(),t.onStartGrow(e)},Y1=(e,t,o)=>{e=z1(e,t);return!0===Ws(e,t.growingClass)},X1=(e,t,o)=>{e=z1(e,t);return!0===Ws(e,t.shrinkingClass)},q1=(Vw=Object.freeze({__proto__:null,refresh:(e,t,o)=>{o.isExpanded()&&(Ro(e.element,V1(t)),o=L1(t,e.element),M(e.element,V1(t),o))},grow:(e,t,o)=>{o.isExpanded()||$1(e,t,o)},shrink:(e,t,o)=>{o.isExpanded()&&G1(e,t,o)},immediateShrink:(e,t,o)=>{o.isExpanded()&&W1(e,t,o)},hasGrown:(e,t,o)=>o.isExpanded(),hasShrunk:(e,t,o)=>o.isCollapsed(),isGrowing:Y1,isShrinking:X1,isTransitioning:(e,t,o)=>Y1(e,t)||X1(e,t),toggleGrow:(e,t,o)=>{(o.isExpanded()?G1:$1)(e,t,o)},disableTransitions:H1,immediateGrow:(e,t,o)=>{o.isExpanded()||(U1(e,t),M(e.element,V1(t),L1(t,e.element)),H1(e,t),o.setExpanded(),t.onStartGrow(e),t.onGrown(e))}}),Mw=Object.freeze({__proto__:null,exhibit:(e,t,o)=>t.expanded?bs({classes:[t.openClass],styles:{}}):bs({classes:[t.closedClass],styles:Ua(t.dimension.property,"0px")}),events:(o,n)=>ts([cs(yi(),(e,t)=>{t.event.raw.propertyName===o.dimension.property&&(H1(e,o),n.isExpanded()&&Ro(e.element,o.dimension.property),(n.isExpanded()?o.onGrown:o.onShrunk)(e))})])}),e0=[i("closedClass"),i("openClass"),i("shrinkingClass"),i("growingClass"),ya("getAnimationRoot"),o("onShrunk"),o("onStartShrink"),o("onGrown"),o("onStartGrow"),u("expanded",!1),ga("dimension",la("property",{width:[ic("property","width"),ic("getDimension",e=>Xo(e)+"px")],height:[ic("property","height"),ic("getDimension",e=>Vo(e)+"px")]}))],Es({fields:e0,name:"sliding",active:Mw,apis:Vw,state:Object.freeze({__proto__:null,init:e=>{let t=B(e.expanded);return _s({isExpanded:()=>!0===t.get(),isCollapsed:()=>!1===t.get(),setCollapsed:ie(t.set,!1),setExpanded:ie(t.set,!0),readState:()=>"expanded: "+t.get()})}})})),K1=o=>({isEnabled:()=>!V.isDisabled(o),setEnabled:e=>V.set(o,!e),setActive:e=>{var t=o.element;e?(Ls(t,"tox-tbtn--enabled"),A(t,"aria-pressed",!0)):(Ps(t,"tox-tbtn--enabled"),ko(t,"aria-pressed"))},isActive:()=>Ws(o.element,"tox-tbtn--enabled"),setText:e=>{_(o,c1,{text:e})},setIcon:e=>_(o,d1,{icon:e})}),J1=(n,e,r,t,o=!0,a)=>m1({text:n.text,icon:n.icon,tooltip:n.tooltip,ariaLabel:n.tooltip,searchable:n.search.isSome(),role:t,fetch:(e,t)=>{var o={pattern:n.search.isSome()?Nk(e):""};n.fetch(e=>{t(S1(e,_y.CLOSE_ON_EXECUTE,r,{isHorizontalMenu:!1,search:n.search}))},o,K1(e))},onSetup:n.onSetup,getApi:K1,columns:1,presets:"normal",classes:[],dropdownBehaviours:[...o?[ux.config({})]:[]],context:n.context},e,r.shared,a),Q1=(t,r,a)=>e=>{e(C(t,e=>{var t,o,n=e.text.fold(()=>({}),e=>({text:e}));return{type:e.type,active:!1,...n,context:e.context,onAction:e=>{var t=!e.isActive();e.setActive(t),o.storage.set(t),a.shared.getSink().each(e=>{r().getOpt(e).each(e=>{_m(e.element),_(e,SO,{name:o.name,value:o.storage.get()})})})},onSetup:(t=o=e,e=>{e.setActive(t.storage.get())})}}))},Z1=e=>({dom:{tag:"span",classes:["tox-tree__label"],attributes:{"aria-label":e}},components:[xd(e)]}),eE=(t,o,n)=>{t.customStateIcon.each(e=>o.push(nE(e,n.shared.providers.icons,t.customStateIconTooltip.fold(()=>[],e=>[yx.config(n.shared.providers.tooltips.getConfig({tooltipText:e}))]),["tox-icon-custom-state"])))},tE=N("leaf-label-event-id"),oE=({leaf:o,onLeafAction:t,visible:n,treeId:r,selectedId:a,backstage:i})=>{var e=o.menu.map(e=>J1(e,"tox-mbtn",i,D.none(),n));let s=[Z1(o.title)];return eE(o,s,i),e.each(e=>s.push(e)),sx.sketch({dom:{tag:"div",classes:["tox-tree--leaf__label","tox-trbtn"].concat(n?["tox-tree--leaf__label--visible"]:[])},components:s,role:"treeitem",action:e=>{t(o.id),e.getSystem().broadcastOn(["update-active-item-"+r],{value:o.id})},eventOrder:{[pi()]:[tE,"keying"]},buttonBehaviours:R([...n?[ux.config({})]:[],h.config({toggleClass:"tox-trbtn--enabled",toggleOnExecute:!1,aria:{mode:"selected"}}),Om.config({channels:{["update-active-item-"+r]:{onReceive:(e,t)=>{(t.value===o.id?h.on:h.off)(e)}}}}),P(tE,[ds((t,e)=>{a.each(e=>{(e===o.id?h.on:h.off)(t)})}),F(pi(),(t,e)=>{var o="ArrowLeft"===e.event.raw.code,n="ArrowRight"===e.event.raw.code;o?(Id(t.element,".tox-tree--directory").each(e=>{t.getSystem().getByDom(e).each(t=>{Fd(e,".tox-tree--directory__label").each(e=>{t.getSystem().getByDom(e).each(U.focus)})})}),e.stop()):n&&e.stop()})])])})},nE=(e,t,o,n,r)=>wy(e,{tag:"span",classes:["tox-tree__icon-wrap","tox-icon"].concat(n||[]),behaviours:o,attributes:r},t),rE=(e,t)=>nE(e,t,[]),aE=N("directory-label-event-id"),iE=({directory:n,visible:e,noChildren:t,backstage:o})=>{var r=n.menu.map(e=>J1(e,"tox-mbtn",o,D.none()));let a=[{dom:{tag:"div",classes:["tox-chevron"]},components:[rE("chevron-right",o.shared.providers.icons)]},Z1(n.title)],i=(eE(n,a,o),r.each(e=>{a.push(e)}),o=>{Id(o.element,".tox-tree--directory").each(e=>{o.getSystem().getByDom(e).each(e=>{var t=!h.isOn(e);h.toggle(e),_(o,"expand-tree-node",{expanded:t,node:n.id})})})});return sx.sketch({dom:{tag:"div",classes:["tox-tree--directory__label","tox-trbtn"].concat(e?["tox-tree--directory__label--visible"]:[])},components:a,action:i,eventOrder:{[pi()]:[aE,"keying"]},buttonBehaviours:R([...e?[ux.config({})]:[],P(aE,[F(pi(),(o,n)=>{let r="ArrowRight"===n.event.raw.code,a="ArrowLeft"===n.event.raw.code;r&&t&&n.stop(),(r||a)&&Id(o.element,".tox-tree--directory").each(e=>{o.getSystem().getByDom(e).each(t=>{!h.isOn(t)&&r||h.isOn(t)&&a?(i(o),n.stop()):a&&!h.isOn(t)&&(Id(t.element,".tox-tree--directory").each(e=>{Fd(e,".tox-tree--directory__label").each(e=>{t.getSystem().getByDom(e).each(U.focus)})}),n.stop())})})})])])})},sE=({children:e,onLeafAction:t,visible:o,treeId:n,expandedIds:r,selectedId:a,backstage:i})=>({dom:{tag:"div",classes:["tox-tree--directory__children"]},components:e.map(e=>"leaf"===e.type?oE({leaf:e,selectedId:a,onLeafAction:t,visible:o,treeId:n,backstage:i}):cE({directory:e,expandedIds:r,selectedId:a,onLeafAction:t,labelTabstopping:o,treeId:n,backstage:i})),behaviours:R([q1.config({dimension:{property:"height"},closedClass:"tox-tree--directory__children--closed",openClass:"tox-tree--directory__children--open",growingClass:"tox-tree--directory__children--growing",shrinkingClass:"tox-tree--directory__children--shrinking",expanded:o}),H.config({})])}),lE=N("directory-event-id"),cE=({directory:e,onLeafAction:r,labelTabstopping:t,treeId:a,backstage:i,expandedIds:o,selectedId:s})=>{let l=e.children,c=B(o),n=o.includes(e.id);return{dom:{tag:"div",classes:["tox-tree--directory"],attributes:{role:"treeitem"}},components:[iE({directory:e,visible:t,noChildren:0===e.children.length,backstage:i}),sE({children:l,expandedIds:o,selectedId:s,onLeafAction:r,visible:n,treeId:a,backstage:i})],behaviours:R([P(lE,[ds((e,t)=>{h.set(e,n)}),F("expand-tree-node",(e,t)=>{let{expanded:o,node:n}=t.event;c.set(o?[...c.get(),n]:c.get().filter(e=>e!==n))})]),h.config({...0<e.children.length?{aria:{mode:"expanded"}}:{},toggleClass:"tox-tree--directory--expanded",onToggled:(e,t)=>{var o,e=e.components()[1],n=(o=t,l.map(e=>"leaf"===e.type?oE({leaf:e,selectedId:s,onLeafAction:r,visible:o,treeId:a,backstage:i}):cE({directory:e,expandedIds:c.get(),selectedId:s,onLeafAction:r,labelTabstopping:o,treeId:a,backstage:i})));t?q1.grow(e):q1.shrink(e),H.set(e,n)}})])}},dE=N("tree-event-id"),mE=(hB=Object.freeze({__proto__:null,events:(e,t)=>{var o=e.stream.streams.setup(e,t);return ts([F(e.event,o),ms(()=>t.cancel())].concat(e.cancelEvent.map(e=>[F(e,()=>t.cancel())]).getOr([])))}}),Zw=e=>{let t=B(null);return _s({readState:()=>({timer:null!==t.get()?"set":"unset"}),setTimer:e=>{t.set(e)},cancel:()=>{var e=t.get();null!==e&&e.cancel()}})},zw=Object.freeze({__proto__:null,throttle:Zw,init:e=>e.stream.streams.state(e)}),Jw=[ga("stream",la("mode",{throttle:[i("delay"),u("stopEvent",!0),ic("streams",{setup:(e,t)=>{let o=e.stream,n=DT(e.onStream,o.delay);return t.setTimer(n),(e,t)=>{n.throttle(e,t),o.stopEvent&&t.stop()}},state:Zw})]})),u("event","input"),ya("cancelEvent"),rc("onStream")],Es({fields:Jw,name:"streaming",active:hB,state:zw})),uE=(e,t,o)=>{o=w.getValue(o);w.setValue(t,o),pE(t)},gE=(e,t)=>{var e=e.element,o=Jc(e),n=e.dom;"number"!==wo(e,"type")&&t(n,o)},pE=e=>{gE(e,(e,t)=>e.setSelectionRange(t.length,t.length))},hE=(e,n,r)=>{if(e.selectsOver){var o=w.getValue(n);let t=e.getDisplayText(o);o=w.getValue(r);return 0===e.getDisplayText(o).indexOf(t)?D.some(()=>{var e,o;uE(0,n,r),e=n,o=t.length,gE(e,(e,t)=>e.setSelectionRange(o,t.length))}):D.none()}return D.none()},fE=T("alloy.typeahead.itemexecute"),vE=(wf=T([ya("lazySink"),i("fetch"),u("minChars",5),u("responseTime",1e3),o("onOpen"),u("getHotspot",D.some),u("getAnchorOverrides",T({})),u("layouts",D.none()),u("eventOrder",{}),Na("model",{},[u("getDisplayText",e=>void 0!==e.meta&&void 0!==e.meta.text?e.meta.text:e.value),u("selectsOver",!0),u("populateFromBrowse",!0)]),o("onSetValue"),nc("onExecute"),o("onItemExecute"),u("inputClasses",[]),u("inputAttributes",{}),u("inputStyles",{}),u("matchWidth",!0),u("useMinWidth",!1),u("dismissOnBlur",!0),tc(["openClass"]),ya("initialData"),ya("listRole"),Ng("typeaheadBehaviours",[U,w,mE,L,h,lk]),ma("lazyTypeaheadComp",()=>B(D.none)),ma("previewing",()=>B(!0))].concat(Rf()).concat(Dw())),r=T([Iu({schema:[ec()],name:"menu",overrides:n=>({fakeFocus:!0,onHighlightItem:(e,t,o)=>{n.previewing.get()?n.lazyTypeaheadComp.get().each(e=>{hE(n.model,e,o).fold(()=>{n.model.selectsOver?(Gh.dehighlight(t,o),n.previewing.set(!0)):n.previewing.set(!1)},e=>{e(),n.previewing.set(!1)})}):n.lazyTypeaheadComp.get().each(t=>{n.model.populateFromBrowse&&uE(n.model,t,o),So(o.element,"id").each(e=>A(t.element,"aria-activedescendant",e))})},onExecute:(e,t)=>n.lazyTypeaheadComp.get().map(e=>(_(e,fE(),{item:t}),!0)),onHover:(e,t)=>{n.previewing.set(!1),n.lazyTypeaheadComp.get().each(e=>{n.model.populateFromBrowse&&uE(n.model,e,t)})}})})]),Up({name:"Typeahead",configFields:wf(),partFields:r(),factory:(r,e,t,a)=>{let o=(e,t,o)=>{r.previewing.set(!1);let n=lk.getCoupled(e,"sandbox");d.isOpen(n)?z.getCurrent(n).each(e=>{Gh.getHighlighted(e).fold(()=>{o(e)},()=>{es(n,e.element,"keydown",t)})}):bk(r,i(e),e,n,a,e=>{z.getCurrent(e).each(o)},vv.HighlightMenuAndItem).get(S)};var n=Zy(r);let i=o=>e=>e.map(e=>{var t=Ze(e.menus),t=Ae(t,e=>Ce(e.items,e=>"item"===e.type));return w.getState(o).update(C(t,e=>e.data)),e}),s=e=>z.getCurrent(e);var l="typeaheadevents",c=[U.config({}),w.config({onSetValue:r.onSetValue,store:{mode:"dataset",getDataKey:e=>Jc(e.element),getFallbackEntry:e=>({value:e,meta:{}}),setValue:(e,t)=>{Qc(e.element,r.model.getDisplayText(t))},...r.initialData.map(e=>Ua("initialValue",e)).getOr({})}}),mE.config({stream:{mode:"throttle",delay:r.responseTime,stopEvent:!1},onStream:(e,t)=>{let o=lk.getCoupled(e,"sandbox");var n=U.isFocused(e);if(n&&Jc(e.element).length>=r.minChars){let t=s(o).bind(e=>Gh.getHighlighted(e).map(w.getValue));r.previewing.set(!0);bk(r,i(e),e,o,a,e=>{s(o).each(e=>{t.fold(()=>{r.model.selectsOver&&Gh.highlightFirst(e)},t=>{Gh.highlightBy(e,e=>w.getValue(e).value===t.value),Gh.getHighlighted(e).orThunk(()=>(Gh.highlightFirst(e),D.none()))})})},vv.HighlightJustMenu).get(S)}},cancelEvent:Fi()}),L.config({mode:"special",onDown:(e,t)=>(o(e,t,Gh.highlightFirst),D.some(!0)),onEscape:e=>{e=lk.getCoupled(e,"sandbox");return d.isOpen(e)?(d.close(e),D.some(!0)):D.none()},onUp:(e,t)=>(o(e,t,Gh.highlightLast),D.some(!0)),onEnter:t=>{var e,o=lk.getCoupled(t,"sandbox"),n=d.isOpen(o);return n&&!r.previewing.get()?s(o).bind(e=>Gh.getHighlighted(e)).map(e=>(_(t,fE(),{item:e}),!0)):(e=w.getValue(t),b(t,Fi()),r.onExecute(o,t,e),n&&d.close(o),D.some(!0))}}),h.config({toggleClass:r.markers.openClass,aria:{mode:"expanded"}}),lk.config({others:{sandbox:e=>kk(r,e,{onOpen:()=>h.on(e),onClose:()=>{r.lazyTypeaheadComp.get().each(e=>ko(e.element,"aria-activedescendant")),h.off(e)}})}}),P(l,[ds(e=>{r.lazyTypeaheadComp.set(D.some(e))}),ms(e=>{r.lazyTypeaheadComp.set(D.none())}),gs(e=>{var t=S;yk(r,i(e),e,a,t,vv.HighlightMenuAndItem).get(S)}),F(fE(),(e,t)=>{var o=lk.getCoupled(e,"sandbox");uE(r.model,e,t.event.item),b(e,Fi()),r.onItemExecute(e,o,t.event.item,w.getValue(e)),d.close(o),pE(e)})].concat(r.dismissOnBlur?[F(_i(),e=>{e=lk.getCoupled(e,"sandbox");Am(e.element).isNone()&&d.close(e)})]:[]))],l={[Pi()]:[w.name(),mE.name(),l],...r.eventOrder};return{uid:r.uid,dom:ew(vr(r,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:{...n,..._p(r.typeaheadBehaviours,c)},eventOrder:l}}})),bE=a=>({...a,toCached:()=>bE(a.toCached()),bindFuture:t=>bE(a.bind(e=>e.fold(e=>gk.pure(I.error(e)),e=>t(e)))),bindResult:t=>bE(a.map(e=>e.bind(t))),mapResult:t=>bE(a.map(e=>e.map(t))),mapError:t=>bE(a.map(e=>e.mapError(t))),foldResult:(t,o)=>a.map(e=>e.fold(t,o)),withTimeout:(e,r)=>bE(gk.nu(t=>{let o=!1,n=setTimeout(()=>{o=!0,t(I.error(r()))},e);a.get(e=>{o||(clearTimeout(n),t(e))})}))}),xE=e=>bE(gk.nu(e)),yE=(Qw=e=>bE(gk.pure(I.value(e))),{nu:xE,wrap:bE,pure:Qw,value:Qw,error:e=>bE(gk.pure(I.error(e))),fromResult:e=>bE(gk.pure(e)),fromFuture:e=>bE(e.map(I.value)),fromPromise:e=>xE(t=>{e.then(e=>{t(I.value(e))},e=>{t(I.error(e))})})}),wE=(e,t,o=[],n,r,a,i)=>{t=t.fold(()=>({}),e=>({action:e})),a={buttonBehaviours:R([T0.item(()=>!e.enabled||i.checkUiComponentContext(e.context).shouldDisable),V0(()=>i.checkUiComponentContext(e.context)),ux.config({}),...a.map(e=>yx.config(i.tooltips.getConfig({tooltipText:i.translate(e)}))).toArray(),P("button press",[ns("click")])].concat(o)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]},...t},o=vr(a,{dom:n});return vr(o,{components:r})},SE=(e,t,o,n=[],r)=>{var r={tag:"button",classes:["tox-tbtn"],attributes:{...e.tooltip.map(e=>({"aria-label":o.translate(e)})).getOr({}),"data-mce-name":r}},a=e.icon.map(e=>i1(e,o.icons)),a=P0([a]);return wE(e,t,n,r,a,e.tooltip,o)},CE=e=>{switch(e){case"primary":return["tox-button"];case"toolbar":return["tox-tbtn"];default:return["tox-button","tox-button--secondary"]}},kE=(e,t,o,n=[],r=[])=>{let a=o.translate(e.text);var i=e.icon.map(e=>i1(e,o.icons)),s=[i.getOrThunk(()=>xd(a))],l=e.buttonType.getOr(e.primary||e.borderless?"primary":"secondary"),l={tag:"button",classes:[...CE(l),...i.isSome()?["tox-button--icon"]:[],...e.borderless?["tox-button--naked"]:[],...r],attributes:{"aria-label":a,"data-mce-name":e.text}},i=e.icon.map(T(a));return wE(e,t,n,l,s,i,o)},OE=(e,t,o,n=[],r=[])=>{e=kE(e,D.some(t),o,n,r);return sx.sketch(e)},_E=(t,o)=>e=>{"custom"===o?_(e,SO,{name:t,value:{}}):"submit"===o?b(e,CO):"cancel"===o?b(e,wO):console.error("Unknown button type: ",o)},TE=(e,t)=>"menu"===t,EE=(e,t)=>"custom"===t||"cancel"===t||"submit"===t,DE=(e,t)=>"togglebutton"===t,AE=(e,n,t)=>{let o,r,a=e.icon.map(e=>s1(e,n.icons)).map(mx);var i=e.buttonType.getOr(e.primary?"primary":"secondary"),s={...e,name:null!=(o=e.name)?o:"",primary:"primary"===i,tooltip:e.tooltip,enabled:null!=(r=e.enabled)&&r,borderless:!1},l=s.tooltip.or(e.text).map(e=>({"aria-label":n.translate(e)})).getOr({}),i=CE(null!=i?i:"secondary"),c=e.icon.isSome()&&e.text.isSome(),i={tag:"button",classes:[...i.concat(e.icon.isSome()?["tox-button--icon"]:[]),...e.active?["tox-button--enabled"]:[],...c?["tox-button--icon-and-text"]:[]],attributes:{...l,...J(t)?{"data-mce-name":t}:{}}},c=n.translate(e.text.getOr("")),l=xd(c),t=[...P0([a.map(e=>e.asSpec())]),...e.text.isSome()?[l]:[]],c=wE(s,D.some(o=>{_(o,SO,{name:e.name,value:{setIcon:t=>{a.map(e=>e.getOpt(o).each(e=>{H.set(e,[s1(t,n.icons)])}))}}})}),[],i,t,e.tooltip,n);return sx.sketch(c)},ME=(t,e,o)=>{if(TE(t,e)){var n=t,n={...t,type:"menubutton",search:D.none(),onSetup:e=>(e.setEnabled(t.enabled),S),fetch:Q1(n.items,()=>e,o)};let e=mx(J1(n,"tox-tbtn",o,D.none(),!0,t.text.or(t.tooltip).getOrUndefined()));return e.asSpec()}var r;if(EE(t,e))return n=_E(t.name,e),r={...t,context:"cancel"===e?"any":t.context,borderless:!1},OE(r,n,o.shared.providers,[]);if(DE(t,e))return AE(t,o.shared.providers,t.text.or(t.tooltip).getOrUndefined());throw console.error("Unknown footer button type: ",e),new Error("Unknown footer button type")},BE=(e,t)=>{var o,n=_E(e.name,"custom");return o=D.none(),e=W.parts.field({factory:sx,...kE(e,D.some(n),t,[yT(""),hT.self()])}),pO(o,e,[],[])},IE={type:"separator"},FE=e=>({type:"menuitem",value:e.url,text:e.title,meta:{attach:e.attach},onAction:S}),RE=(e,t)=>({type:"menuitem",value:t,text:e,meta:{attach:void 0},onAction:S}),NE=e=>C(e,FE),zE=(t,e)=>Ce(e,e=>e.type===t),VE=(e,t)=>NE(zE(e,t)),LE=e=>VE("header",e.targets),HE=e=>VE("anchor",e.targets),PE=e=>D.from(e.anchorTop).map(e=>RE("<top>",e)).toArray(),UE=e=>D.from(e.anchorBottom).map(e=>RE("<bottom>",e)).toArray(),WE=e=>C(e,e=>RE(e,e)),jE=e=>Oe(e,(e,t)=>0===e.length||0===t.length?e.concat(t):e.concat(IE,t),[]),GE=(e,t)=>{let o=e.toLowerCase();return Ce(t,e=>{var t=(void 0!==e.meta&&void 0!==e.meta.text?e.meta:e).text,e=null!=(e=e.value)?e:"";return pt(t.toLowerCase(),o)||pt(e.toLowerCase(),o)})},$E=N("aria-invalid"),YE=(r,t,o,e)=>{let a=t.shared.providers,i=e=>{e=w.getValue(e);o.addToHistory(e.value,r.filetype)};var e={...e.map(e=>({initialData:e})).getOr({}),dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":$E,type:"url"},minChars:0,responseTime:0,fetch:e=>{e=((o,e,n)=>{var t,e=w.getValue(e);let r=null!=(t=null==(t=null==e?void 0:e.meta)?void 0:t.text)?t:e.value;return n.getLinkInformation().fold(()=>[],e=>{var t=GE(r,WE(n.getHistory(o)));return"file"===o?jE([t,GE(r,LE(e)),GE(r,De([PE(e),HE(e),UE(e)]))]):t})})(r.filetype,e,o),e=S1(e,_y.BUBBLE_TO_SANDBOX,t,{isHorizontalMenu:!1,search:D.none()});return gk.pure(e)},getHotspot:e=>m.getOpt(e),onSetValue:(e,t)=>{e.hasConfigured(RO)&&RO.run(e).get(S)},typeaheadBehaviours:R([...o.getValidationHandler().map(n=>RO.config({getRoot:e=>Qt(e.element),invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:(e,t)=>{s.getOpt(e).each(e=>{A(e.element,"title",a.translate(t))})}},validator:{validate:e=>{let t=w.getValue(e);return yE.nu(o=>{n({type:r.filetype,url:t.value},e=>{var t;"invalid"===e.status?(t=I.error(e.message),o(t)):(t=I.value(e.message),o(t))})})},validateOnLoad:!1}})).toArray(),V.config({disabled:()=>!r.enabled||a.checkUiComponentContext(r.context).shouldDisable}),ux.config({}),P("urlinput-events",[F(fi(),e=>{var t=Jc(e.element),o=t.trim();o!==t&&Qc(e.element,o),"file"===r.filetype&&_(e,bO,{name:r.name})}),F(vi(),e=>{_(e,bO,{name:r.name}),i(e)}),F(Ti(),e=>{_(e,bO,{name:r.name}),i(e)})])]),eventOrder:{[fi()]:["streaming","urlinput-events","invalidating"]},model:{getDisplayText:e=>e.value,selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:t.shared.getSink,parts:{menu:Qy(!1,1,"normal")},onExecute:(e,t,o)=>{_(t,CO,{})},onItemExecute:(e,t,o,n)=>{i(e),_(e,bO,{name:r.name})}},e=W.parts.field({...e,factory:vE}),n=r.label.map(e=>vO(e,a));let s=mx(((e,t,o,n=e)=>wy(o,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+e],attributes:{title:a.translate(n),"aria-live":"polite",...t.fold(()=>({}),e=>({id:e}))}},a.icons))("invalid",D.some($E),"warning"));var l=mx({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[s.asSpec()]});let c=o.getUrlPicker(r.filetype),d=N("browser.url.event"),m=mx({dom:{tag:"div",classes:["tox-control-wrap"]},components:[e,l.asSpec()],behaviours:R([V.config({disabled:()=>!r.enabled||a.checkUiComponentContext(r.context).shouldDisable})])}),u=mx(OE({context:r.context,name:r.name,icon:D.some("browse"),text:r.picker_text.or(r.label).getOr(""),enabled:r.enabled,primary:!1,buttonType:D.none(),borderless:!0},e=>b(e,d),a,[],["tox-browse-url"]));return W.sketch({dom:fO([]),components:n.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:De([[m.asSpec()],c.map(()=>u.asSpec()).toArray()])}]),fieldBehaviours:R([V.config({disabled:()=>!r.enabled||a.checkUiComponentContext(r.context).shouldDisable,onDisabled:e=>{W.getField(e).each(V.disable),u.getOpt(e).each(V.disable)},onEnabled:e=>{W.getField(e).each(V.enable),u.getOpt(e).each(V.enable)}}),V0(()=>a.checkUiComponentContext(r.context)),P("url-input-events",[F(d,n=>{z.getCurrent(n).each(t=>{var e=w.getValue(t);let o={fieldname:r.name,...e};c.each(e=>{e(o).get(e=>{w.setValue(t,e),_(n,bO,{name:r.name})})})})})])])})},XE=(e,t)=>{e.dom.checked=t},qE=e=>e.dom.checked,KE=i=>(t,o,n,r,a)=>k(o,"name").fold(()=>i(o,r,D.none(),a),e=>t.field(e,i(o,r,k(n,e),a))),JE={bar:KE((e,t)=>(e=e,t=t.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:C(e.items,t.interpreter)})),collection:KE((e,t,o)=>EO(e,t.shared.providers,o)),alertbanner:KE((e,t)=>{return o=e,e=t.shared.providers,t=fy(o.icon,e.icons),mO.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+o.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:o.url?void 0:t},components:o.url?[sx.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:t,attributes:{title:e.translate(o.iconTooltip)}},action:e=>_(e,SO,{name:"alert-banner",value:o.url}),buttonBehaviours:R([xy()])})]:void 0},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:e.translate(o.text)}}]});var o}),input:KE((e,t,o)=>(e=e,t=t.shared.providers,o=o,N1({name:e.name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:!e.enabled,classname:"tox-textfield",validation:D.none(),maximized:e.maximized,data:o,context:e.context},t))),textarea:KE((e,t,o)=>(e=e,t=t.shared.providers,o=o,N1({name:e.name,multiline:!0,label:e.label,inputMode:D.none(),placeholder:e.placeholder,flex:!0,disabled:!e.enabled,classname:"tox-textarea",validation:D.none(),maximized:e.maximized,data:o,context:e.context},t))),label:KE((e,t,o,n)=>ZT(e,t.shared,n)),iframe:(OT=(e,t,o)=>JT(e,t.shared.providers,o),(e,t,o,n,r)=>{t=vr(t,{source:"dynamic"});return KE(OT)(e,t,o,n,r)}),button:KE((e,t)=>BE(e,t.shared.providers)),checkbox:KE((e,t,o)=>{return n=e,r=t.shared.providers,e=o,t=e=>(e.element.dom.click(),D.some(!0)),e=W.parts.field({factory:{sketch:re},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:R([hT.self(),V.config({disabled:()=>!n.enabled||r.checkUiComponentContext(n.context).shouldDisable,onDisabled:e=>{Qt(e.element).each(e=>Ls(e,"tox-checkbox--disabled"))},onEnabled:e=>{Qt(e.element).each(e=>Ps(e,"tox-checkbox--disabled"))}}),ux.config({}),U.config({}),xT(e,qE,XE),L.config({mode:"special",onEnter:t,onSpace:t,stopSpaceKeyup:!0}),P("checkbox-events",[F(vi(),(e,t)=>{_(e,bO,{name:n.name})})])])}),t=W.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"]},components:[xd(r.translate(n.label))],behaviours:R([NO.config({})])}),o=e=>{var t="checked"===e?"selected":"unselected";return wy(t,{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+e]},r.icons)},o=mx({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[o("checked"),o("unchecked")]}),W.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[e,o.asSpec(),t],fieldBehaviours:R([V.config({disabled:()=>!n.enabled||r.checkUiComponentContext(n.context).shouldDisable}),V0(()=>r.checkUiComponentContext(n.context))])});var n,r}),colorinput:KE((e,t,o)=>HO(e,t.shared,t.colorinput,o)),colorpicker:KE((e,t,o)=>ST(0,t.shared.providers,o)),dropzone:KE((e,t,o)=>ET(e,t.shared.providers,o)),grid:KE((e,t)=>(e=e,t=t.shared,{dom:{tag:"div",classes:["tox-form__grid",`tox-form__grid--${e.columns}col`]},components:C(e.items,t.interpreter)})),listbox:KE((e,t,o)=>((o,n,e)=>{let r=be(o.items,e=>!C1(e)),t=n.shared.providers,a=e.bind(e=>_1(o.items,e)).orThunk(()=>Ve(o.items).filter(C1));var e=o.label.map(e=>vO(e,t)),i={dom:{tag:"div",classes:["tox-listboxfield"]},components:[W.parts.field({dom:{},factory:{sketch:e=>m1({context:o.context,uid:e.uid,text:a.map(e=>e.text),icon:D.none(),tooltip:D.none(),role:lt(!r,"combobox"),...r?{}:{listRole:"listbox"},ariaLabel:o.label,fetch:(e,t)=>{e=O1(e,o.name,o.items,w.getValue(e),r);t(S1(e,_y.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!1,search:D.none()}))},onSetup:T(S),getApi:T({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[ux.config({}),bT(a.map(e=>e.value),e=>wo(e.element,k1),(t,e)=>{_1(o.items,e).each(e=>{A(t.element,k1,e.value),_(t,c1,{text:e.text})})})]},"tox-listbox",n.shared)}})]};return W.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:De([e.toArray(),[i]]),fieldBehaviours:R([V.config({disabled:()=>!o.enabled||t.checkUiComponentContext(o.context).shouldDisable,onDisabled:e=>{W.getField(e).each(V.disable)},onEnabled:e=>{W.getField(e).each(V.enable)}})])})})(e,t,o)),selectbox:KE((e,t,o)=>{return n=e,r=t.shared.providers,e=o,t=C(n.items,e=>({text:r.translate(e.text),value:e.value})),o=n.label.map(e=>vO(e,r)),e=W.parts.field({dom:{},...e.map(e=>({data:e})).getOr({}),selectAttributes:{size:n.size},options:t,factory:T1,selectBehaviours:R([V.config({disabled:()=>!n.enabled||r.checkUiComponentContext(n.context).shouldDisable}),ux.config({}),P("selectbox-change",[F(vi(),(e,t)=>{_(e,bO,{name:n.name})})])])}),t=1<n.size?D.none():D.some(wy("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},r.icons)),e={dom:{tag:"div",classes:["tox-selectfield"]},components:De([[e],t.toArray()])},W.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:De([o.toArray(),[e]]),fieldBehaviours:R([V.config({disabled:()=>!n.enabled||r.checkUiComponentContext(n.context).shouldDisable,onDisabled:e=>{W.getField(e).each(V.disable)},onEnabled:e=>{W.getField(e).each(V.enable)}}),V0(()=>r.checkUiComponentContext(n.context))])});var n,r}),sizeinput:KE((e,t)=>(e=e,t=t.shared.providers,R1({inDialog:!0,label:e.label,enabled:e.enabled,context:D.some(e.context),name:D.some(e.name),width:"",height:"",onEnter:D.none(),onInput:D.none(),onSetup:D.none(),getApi:D.none()},t))),slider:KE((e,t,o)=>{return n=e,e=t.shared.providers,t=o,e=Q_.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[xd(e.translate(n.label))]}),o=Q_.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),r=Q_.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}}),Q_.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:n.min,maxX:n.max,getInitialValue:T(t.getOrThunk(()=>(Math.abs(n.max)-Math.abs(n.min))/2))},components:[e,o,r],sliderBehaviours:R([hT.self(),U.config({})]),onChoose:(e,t,o)=>{_(e,bO,{name:n.name,value:o})},onChange:(e,t,o)=>{_(e,bO,{name:n.name,value:o})}});var n,r}),urlinput:KE((e,t,o)=>YE(e,t,t.urlinput,o)),customeditor:KE(o=>{let n=lr(),t=mx({dom:{tag:o.tag}}),r=lr();var e=!kT(o)&&o.onFocus.isSome()?[U.config({onFocus:t=>{o.onFocus.each(e=>{e(t.element.dom)})}}),ux.config({})]:[];return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:R([P("custom-editor-events",[ds(e=>{t.getOpt(e).each(t=>{(kT(o)?o.init(t.element.dom):CT.load(o.scriptId,o.scriptUrl).then(e=>e(t.element.dom,o.settings))).then(t=>{r.on(e=>{t.setValue(e)}),r.clear(),n.set(t)})})})]),bT(D.none(),()=>n.get().fold(()=>r.get().getOr(""),e=>e.getValue()),(e,t)=>{n.get().fold(()=>r.set(t),e=>e.setValue(t))}),hT.self()].concat(e)),components:[t.asSpec()]}}),htmlpanel:KE((e,t)=>{return o=e,n=t.shared.providers,e=["tox-form__group",...o.stretched?["tox-form__group--stretched"]:[]],t=P("htmlpanel",[ds(e=>{o.onInit(e.element.dom)})]),"presentation"===o.presets?mO.sketch({dom:{tag:"div",classes:e,innerHtml:o.html},containerBehaviours:R([yx.config({...n.tooltips.getConfig({tooltipText:"",onShow:t=>{Rd(t.element,"[data-mce-tooltip]:hover").orThunk(()=>Am(t.element)).each(e=>{So(e,"data-mce-tooltip").each(e=>{yx.setComponents(t,n.tooltips.getComponents({tooltipText:e}))})})}}),mode:"children-normal",anchor:e=>({type:"node",node:Rd(e.element,"[data-mce-tooltip]:hover").orThunk(()=>Am(e.element).filter(e=>So(e,"data-mce-tooltip").isSome())),root:e.element,layouts:{onLtr:T([fm,hm,mm,gm,um,pm]),onRtl:T([fm,hm,mm,gm,um,pm])},bubble:Ou(0,-2,{})})}),t])}):mO.sketch({dom:{tag:"div",classes:e,innerHtml:o.html,attributes:{role:"document"}},containerBehaviours:R([ux.config({}),U.config({}),t])});var o,n}),imagepreview:KE((e,t,o)=>QT(e,o)),table:KE((e,t)=>((e,t)=>{let o=e=>({dom:{tag:"th",innerHtml:t.translate(e)}});let n=e=>({dom:{tag:"td",innerHtml:t.translate(e)}}),r=e=>({dom:{tag:"tr"},components:C(e,n)});var a;return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(a=e.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:C(a,o)}]}),(a=e.cells,{dom:{tag:"tbody"},components:C(a,r)})],behaviours:R([ux.config({}),U.config({})])}})(e,t.shared.providers)),tree:KE((e,t)=>((e,n)=>{let r=e.onLeafAction.getOr(S),a=e.onToggleExpand.getOr(S);var t=e.defaultExpandedIds;let i=B(t),o=B(e.defaultSelectedId),s=N("tree-id"),l=(t,o)=>e.items.map(e=>"leaf"===e.type?oE({leaf:e,selectedId:t,onLeafAction:r,visible:!0,treeId:s,backstage:n}):cE({directory:e,selectedId:t,onLeafAction:r,expandedIds:o,labelTabstopping:!0,treeId:s,backstage:n}));return{dom:{tag:"div",classes:["tox-tree"],attributes:{role:"tree"}},components:l(o.get(),i.get()),behaviours:R([L.config({mode:"flow",selector:".tox-tree--leaf__label--visible, .tox-tree--directory__label--visible",cycles:!1}),P(dE,[F("expand-tree-node",(e,t)=>{let{expanded:o,node:n}=t.event;i.set(o?[...i.get(),n]:i.get().filter(e=>e!==n)),a(i.get(),{expanded:o,node:n})})]),Om.config({channels:{["update-active-item-"+s]:{onReceive:(e,t)=>{o.set(D.some(t.value)),H.set(e,l(D.some(t.value),i.get()))}}}}),H.config({})])}})(e,t)),panel:KE((e,t)=>(t=t,{dom:{tag:"div",classes:(e=e).classes},components:C(e.items,t.shared.interpreter)}))},QE={field:(e,t)=>t,record:T([])},ZE=(t,e,o,n,r)=>{let a=vr(n,{shared:{interpreter:e=>eD(t,e,o,a,r)}});return eD(t,e,o,a,r)},eD=(t,o,n,r,a)=>k(JE,o.type).fold(()=>(console.error(`Unknown factory type "${o.type}", defaulting to container: `,o),o),e=>e(t,o,n,r,a)),tD=(e,t,o,n)=>eD(QE,e,t,o,n),oD="layout-inset",nD=e=>e.x,rD=(e,t)=>e.x+e.width/2-t.width/2,aD=(e,t)=>e.x+e.width-t.width,iD=(e,t)=>e.y+e.height-t.height,sD=(e,t)=>e.y+e.height/2-t.height/2,lD=(e,t,o)=>Ud(aD(e,t),iD(e,t),o.insetSouthwest(),qd(),"southwest",tm(e,{right:0,bottom:3}),oD),cD=(e,t,o)=>Ud(nD(e),iD(e,t),o.insetSoutheast(),Xd(),"southeast",tm(e,{left:1,bottom:3}),oD),dD=(e,t,o)=>Ud(aD(e,t),e.y,o.insetNorthwest(),Yd(),"northwest",tm(e,{right:0,top:2}),oD),mD=(e,t,o)=>Ud(nD(e),e.y,o.insetNortheast(),$d(),"northeast",tm(e,{left:1,top:2}),oD),uD=(e,t,o)=>Ud(rD(e,t),e.y,o.insetNorth(),Kd(),"north",tm(e,{top:2}),oD),gD=(e,t,o)=>Ud(rD(e,t),iD(e,t),o.insetSouth(),Jd(),"south",tm(e,{bottom:3}),oD),pD=(e,t,o)=>Ud(aD(e,t),sD(e,t),o.insetEast(),Zd(),"east",tm(e,{right:0}),oD),hD=(e,t,o)=>Ud(nD(e),sD(e,t),o.insetWest(),Qd(),"west",tm(e,{left:1}),oD),fD=e=>{switch(e){case"north":return uD;case"northeast":return mD;case"northwest":return dD;case"south":return gD;case"southeast":return cD;case"southwest":return lD;case"east":return pD;case"west":return hD}},vD=(e,t,o,n,r)=>Gm(n).map(fD).getOr(uD)(e,t,o,n,r),bD=e=>{switch(e){case"north":return gD;case"northeast":return cD;case"northwest":return lD;case"south":return uD;case"southeast":return mD;case"southwest":return dD;case"east":return hD;case"west":return pD}},xD=(e,t,o,n,r)=>Gm(n).map(bD).getOr(uD)(e,t,o,n,r),yD={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},wD=(e,t,o)=>{let n={maxHeightFunction:yu()};return()=>o()?{type:"node",root:co(lo(e())),node:D.from(e()),bubble:Ou(12,12,yD),layouts:{onRtl:()=>[mD],onLtr:()=>[dD]},overrides:n}:{type:"hotspot",hotspot:t(),bubble:Ou(-12,12,yD),layouts:{onRtl:()=>[mm,um,fm],onLtr:()=>[um,mm,fm]},overrides:n}},SD=(e,t,o,n)=>{let r={maxHeightFunction:yu()};return()=>n()?{type:"node",root:co(lo(t())),node:D.from(t()),bubble:Ou(12,12,yD),layouts:{onRtl:()=>[uD],onLtr:()=>[uD]},overrides:r}:e?{type:"node",root:co(lo(t())),node:D.from(t()),bubble:Ou(0,-Lo(t()),yD),layouts:{onRtl:()=>[hm],onLtr:()=>[hm]},overrides:r}:{type:"hotspot",hotspot:o(),bubble:Ou(0,0,yD),layouts:{onRtl:()=>[hm],onLtr:()=>[hm]},overrides:r}},CD=(e,t,o)=>()=>o()?{type:"node",root:co(lo(e())),node:D.from(e()),layouts:{onRtl:()=>[uD],onLtr:()=>[uD]}}:{type:"hotspot",hotspot:t(),layouts:{onRtl:()=>[fm],onLtr:()=>[fm]}},kD=(n,e)=>()=>({type:"selection",root:e(),getSelection:()=>{var e,t=n.selection.getRng(),o=n.model.table.getSelectedCells();return 1<o.length?(e=o[0],o=o[o.length-1],e={firstCell:O.fromDom(e),lastCell:O.fromDom(o)},D.some(e)):D.some(qu.range(O.fromDom(t.startContainer),t.startOffset,O.fromDom(t.endContainer),t.endOffset))}}),OD=t=>e=>({type:"node",root:t(),node:e}),_D=(e,t,o,n)=>{let r=Yb(e);var a=()=>O.fromDom(e.getBody()),i=()=>O.fromDom(e.getContentAreaContainer()),s=()=>r||!n();return{inlineDialog:wD(i,t,s),inlineBottomDialog:SD(e.inline,i,o,s),banner:CD(i,t,s),cursor:kD(e,a),node:OD(a)}},TD=o=>(e,t)=>{GC(o)(e,t)},ED=e=>()=>OC(e),DD=t=>e=>wC(t,e),AD=t=>e=>kC(t,e),MD=e=>({colorPicker:TD(e),hasCustomColors:ED(e),getColors:DD(e),getColorCols:AD(e)}),BD=e=>()=>Tb(e),ID=e=>({isDraggableModal:BD(e)}),FD=e=>{let t=B(Gb(e)?"bottom":"top");return{isPositionedAtTop:()=>"top"===t.get(),getDockingMode:t.get,setDockingMode:t.set}},RD=e=>tt(e,"items"),ND=e=>tt(e,"format"),zD=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],VD=e=>et(e,"items"),LD=e=>et(e,"block"),HD=e=>et(e,"inline"),PD=e=>et(e,"selector"),UD=e=>Oe(e,(e,t)=>{var o;return VD(t)?(o=UD(t.items),{customFormats:e.customFormats.concat(o.customFormats),formats:e.formats.concat([{title:t.title,items:o.formats}])}):HD(t)||LD(t)||PD(t)?(o="custom-"+(y(t.name)?t.name:t.title.toLowerCase()),{customFormats:e.customFormats.concat([{name:o,format:t}]),formats:e.formats.concat([{title:t.title,format:o,icon:t.icon}])}):{...e,formats:e.formats.concat(t)}},{customFormats:[],formats:[]}),WD=(t,e)=>{let o=UD(e),n=e=>{E(e,e=>{t.formatter.has(e.name)||t.formatter.register(e.name,e.format)})};return t.formatter?n(o.customFormats):t.on("init",()=>{n(o.customFormats)}),o.formats},jD=t=>ib(t).map(e=>{e=WD(t,e);return sb(t)?zD.concat(e):e}).getOr(zD),GD=e=>{e=Ue(e);return 1===e.length&&ve(e,"title")},$D=(e,t,o)=>({...e,type:"formatter",isSelected:t(e.format),getStylePreview:o(e.format)}),YD=(n,e,r,a)=>{let t=e=>$D(e,r,a),o=e=>{var t=s(e.items);return{...e,type:"submenu",getStyleItems:T(t)}},i=e=>{var t=y(e.name)?e.name:N(e.title),o="custom-"+t,e={...e,type:"formatter",format:o,isSelected:r(o),getStylePreview:a(o)};return n.formatter.register(t,e),e},s=e=>C(e,e=>RD(e)?o(e):ND(e)?t(e):GD(e)?{...e,type:"separator"}:i(e));return s(e)},XD=o=>{let n=e=>()=>o.formatter.match(e),r=t=>()=>{var e=o.formatter.get(t);return void 0!==e?D.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:o.dom.parseStyle(o.formatter.getCssText(t))}):D.none()},a=B([]),i=B([]),s=B(!1);o.on("PreInit",e=>{var t=jD(o),t=YD(o,t,n,r);a.set(t)}),o.on("addStyleModifications",e=>{var t=YD(o,e.items,n,r);i.set(t),s.set(e.replace)});return{getData:()=>{var e=s.get()?[]:a.get(),t=i.get();return e.concat(t)}}},qD=e=>{let n=0,t=e=>[{dom:{tag:"div",classes:["tox-tooltip__body"]},components:[xd(e.tooltipText)]}];return{getConfig:o=>({delayForShow:()=>0<n?60:300,delayForHide:T(300),exclusive:!0,lazySink:e,tooltipDom:{tag:"div",classes:["tox-tooltip","tox-tooltip--up"]},tooltipComponents:t(o),onShow:(e,t)=>{n++,o.onShow&&o.onShow(e,t)},onHide:(e,t)=>{n--,o.onHide&&o.onHide(e,t)},onSetup:o.onSetup}),getComponents:t}},KD=_T.trim,JD=(e0=o=>e=>{if(t=e,J(t)&&1===t.nodeType){if(e.contentEditable===o)return!0;if(e.getAttribute("data-mce-contenteditable")===o)return!0}var t;return!1})("true"),QD=e0("false"),ZD=(e,t,o,n,r)=>({type:e,title:t,url:o,level:n,attach:r}),eA=e=>{let t=e;for(;t=t.parentNode;){var o=t.contentEditable;if(o&&"inherit"!==o)return JD(t)}return!1},tA=(e,t)=>C(dg(O.fromDom(t),e),e=>e.dom),oA=e=>e.innerText||e.textContent,nA=e=>e.id||N("h"),rA=e=>e&&"A"===e.nodeName&&void 0!==(e.id||e.name),aA=e=>rA(e)&&sA(e),iA=e=>e&&/^(H[1-6])$/.test(e.nodeName),sA=e=>eA(e)&&!QD(e),lA=e=>iA(e)&&sA(e),cA=e=>iA(e)?parseInt(e.nodeName.substr(1),10):0,dA=e=>{let t,o=nA(e);return ZD("header",null!=(t=oA(e))?t:"","#"+o,cA(e),()=>{e.id=o})},mA=e=>{var t=e.id||e.name,e=oA(e);return ZD("anchor",e||"#"+t,"#"+t,0,S)},uA=e=>0<KD(e.title).length,gA={find:e=>{e=e;var t,e=tA("h1,h2,h3,h4,h5,h6,a:not([href])",e);return Ce((t=e,C(Ce(t,lA),dA).concat((t=e,C(Ce(t,aA),mA)))),uA)}},pA="tinymce-url-history",hA=5,fA=e=>y(e)&&/^https?/.test(e),vA=e=>$(e)&&e.length<=hA&&Me(e,fA),bA=e=>j(e)&&Qe(e,e=>!vA(e)).isNone(),xA=()=>{var e=oC.getItem(pA);if(null===e)return{};let t;try{t=JSON.parse(e)}catch(e){if(e instanceof SyntaxError)return console.log("Local storage "+pA+" was not valid JSON",e),{};throw e}return bA(t)?t:(console.log("Local storage "+pA+" was not valid format",t),{})},yA=e=>{if(!bA(e))throw new Error("Bad format for history:\n"+JSON.stringify(e));oC.setItem(pA,JSON.stringify(e))},wA=e=>{var t=xA();return k(t,e).getOr([])},SA=(t,e)=>{var o,n;fA(t)&&(o=xA(),n=k(o,e).getOr([]),n=Ce(n,e=>e!==t),o[e]=[t].concat(n).slice(0,hA),yA(o))},CA=e=>!!e,kA=e=>Ge(_T.makeMap(e,/[, ]/),CA),OA=e=>D.from(yb(e)),_A=e=>{let t=D.from(Cb(e)).filter(CA).map(kA);return OA(e).fold(de,e=>t.fold(me,e=>0<Ue(e).length&&e))},TA=(e,t)=>{var o=_A(e);return X(o)?o?OA(e):D.none():o[t]?OA(e):D.none()},EA=(r,a)=>TA(r,a).map(n=>t=>gk.nu(o=>{var e={filetype:a,fieldname:t.fieldname,...D.from(t.meta).getOr({})};n.call(r,(e,t)=>{if(!y(e))throw new Error("Expected value to be string");if(void 0!==t&&!j(t))throw new Error("Expected meta to be a object");o({value:e,meta:t})},t.value,e)})),DA=e=>D.from(e).filter(y).getOrUndefined(),AA=e=>kb(e)?D.some({targets:gA.find(e.getBody()),anchorTop:DA(Ob(e)),anchorBottom:DA(_b(e))}):D.none(),MA=e=>D.from(wb(e)),BA=t=>({getHistory:wA,addToHistory:SA,getLinkInformation:()=>AA(t),getValidationHandler:()=>MA(t),getUrlPicker:e=>EA(t,e)}),IA=(e,r,t,o)=>{let n=B(!1);var a=FD(r),i={icons:()=>r.ui.registry.getAll().icons,menuItems:()=>r.ui.registry.getAll().menuItems,translate:dy.translate,isDisabled:()=>!r.ui.isEnabled(),getOption:r.options.get,tooltips:qD(e.dialog),checkUiComponentContext:e=>{if(Zv(r))return{contextType:"disabled",shouldDisable:!0};let[t,o=""]=e.split(":"),n=r.ui.registry.getAll().contexts;return{contextType:t,shouldDisable:!k(n,t).fold(()=>k(n,"mode").map(e=>e("design")).getOr(!1),e=>"!"===o.charAt(0)?!e(o.slice(1)):e(o))}}},s=BA(r),l=XD(r),c=MD(r),d=ID(r),i={shared:{providers:i,anchors:_D(r,t,o,a.isPositionedAtTop),header:a},urlinput:s,styles:l,colorinput:c,dialog:d,isContextMenuOpen:()=>n.get(),setContextMenuState:e=>n.set(e)};let m=e=>D.none(),u={...i,shared:{...i.shared,interpreter:e=>tD(e,{},u,m),getSink:e.popup}},g={...i,shared:{...i.shared,interpreter:e=>tD(e,{},g,m),getSink:e.dialog}};return{popup:u,dialog:g}},FA=(o,n,e)=>{let r=(t,o)=>{E([n,...e],e=>{e.broadcastEvent(t,o)})},t=(t,o)=>{E([n,...e],e=>{e.broadcastOn([t],o)})};var a=e=>t(hp(),{target:e.target}),i=$n();let s=Zm(i,"touchstart",a),l=Zm(i,"touchmove",e=>r(Ni(),e)),c=Zm(i,"touchend",e=>r(zi(),e)),d=Zm(i,"mousedown",a),m=Zm(i,"mouseup",e=>{0===e.raw.button&&t(vp(),{target:e.target})}),u=e=>t(hp(),{target:O.fromDom(e.target)}),g=e=>{0===e.button&&t(vp(),{target:O.fromDom(e.target)})},p=()=>{E(o.editorManager.get(),e=>{o!==e&&e.dispatch("DismissPopups",{relatedTarget:o})})},h=e=>r(Vi(),tu(e)),f=e=>{t(fp(),{}),r(Li(),tu(e))};a=lo(O.fromDom(o.getElement()));let v=eu(a,"scroll",t=>{requestAnimationFrame(()=>{var e=o.getContainer();null!=e&&(e=ax(o,n.element).map(e=>[e.element,...e.others]).getOr([]),be(e,e=>Gt(e,t.target)))&&(o.dispatch("ElementScroll",{target:t.target.dom}),r(Gi(),t))})}),b=()=>t(fp(),{}),x=e=>{e.state&&t(hp(),{target:O.fromDom(o.getContainer())})},y=e=>{t(hp(),{target:O.fromDom(e.relatedTarget.getContainer())})},w=e=>o.dispatch("focusin",e),S=e=>o.dispatch("focusout",e);o.on("PostRender",()=>{o.on("click",u),o.on("tap",u),o.on("mouseup",g),o.on("mousedown",p),o.on("ScrollWindow",h),o.on("ResizeWindow",f),o.on("ResizeEditor",b),o.on("AfterProgressState",x),o.on("DismissPopups",y),E([n,...e],e=>{e.element.dom.addEventListener("focusin",w),e.element.dom.addEventListener("focusout",S)})}),o.on("remove",()=>{o.off("click",u),o.off("tap",u),o.off("mouseup",g),o.off("mousedown",p),o.off("ScrollWindow",h),o.off("ResizeWindow",f),o.off("ResizeEditor",b),o.off("AfterProgressState",x),o.off("DismissPopups",y),E([n,...e],e=>{e.element.dom.removeEventListener("focusin",w),e.element.dom.removeEventListener("focusout",S)}),d.unbind(),s.unbind(),l.unbind(),c.unbind(),m.unbind(),v.unbind()}),o.on("detach",()=>{E([n,...e],sp),E([n,...e],e=>e.destroy())})},RA=ph,NA=(Mw=Jp,Vw=T([u("shell",!1),i("makeItem"),u("setupItem",S),Tp.field("listBehaviours",[H])]),Zw=qp({name:"items",overrides:()=>({behaviours:R([H.config({})])})}),Jw=T([Zw]),Up({name:T("CustomList")(),configFields:Vw(),partFields:Jw(),factory:(i,e,t,o)=>{e=i.shell?{behaviours:[H.config({})],components:[]}:{behaviours:[],components:e};return{uid:i.uid,dom:i.dom,components:e.components,behaviours:_p(i.listBehaviours,e.behaviours),apis:{setItems:(r,a)=>{var e;e=r,(i.shell?D.some(e):ih(e,i,"items")).fold(()=>{throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},t=>{var e=H.contents(t),o=a.length,n=o-e.length,n=0<n?xe(n,()=>i.makeItem()):[],e=e.slice(o),o=(E(e,e=>H.remove(t,e)),E(n,e=>H.append(t,e)),H.contents(t));E(o,(e,t)=>{i.setupItem(r,e,a[t],t)})})}}}},apis:{setItems:(e,t,o)=>{e.setItems(t,o)}}})),zA=(hB=T([i("dom"),u("shell",!0),Ng("toolbarBehaviours",[H])]),zw=T([qp({name:"groups",overrides:()=>({behaviours:R([H.config({})])})})]),Up({name:"Toolbar",configFields:hB(),partFields:zw(),factory:(o,e,t,n)=>{e=o.shell?{behaviours:[H.config({})],components:[]}:{behaviours:[],components:e};return{uid:o.uid,dom:o.dom,components:e.components,behaviours:_p(o.toolbarBehaviours,e.behaviours),apis:{setGroups:(e,t)=>{e=e,(o.shell?D.some(e):ih(e,o,"groups")).fold(()=>{throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},e=>{H.set(e,t)})},refresh:S},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)}}})),VA=(Rf=S,wf=de,T([]));var LA=Object.freeze({__proto__:null,setup:Rf,isDocked:wf,getBehaviours:VA});let HA=T(N("toolbar-height-change")),PA={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},UA="tox-tinymce--toolbar-sticky-on",WA="tox-tinymce--toolbar-sticky-off",jA=(e,t)=>ve(lc.getModes(e),t),GA=n=>{let r=n.element;Qt(r).each(e=>{var t,o="padding-"+lc.getModes(n)[0];lc.isDocked(n)?(t=Xo(e),M(r,"width",t+"px"),M(e,o,(t=r,Lo(t)+(parseInt(Ao(t,"margin-top"),10)||0)+(parseInt(Ao(t,"margin-bottom"),10)||0)+"px"))):(Ro(r,"width"),Ro(e,o))})},$A=(e,t)=>{t?(Ps(e,PA.fadeOutClass),js(e,[PA.transitionClass,PA.fadeInClass])):(Ps(e,PA.fadeInClass),js(e,[PA.fadeOutClass,PA.transitionClass]))},YA=(e,t)=>{e=O.fromDom(e.getContainer());t?(Ls(e,UA),Ps(e,WA)):(Ls(e,WA),Ps(e,UA))},XA=(a,e)=>{let o=lr(),n=e.getSink,r=t=>{n().each(e=>t(e.element))};var t=e=>{a.inline||GA(e),YA(a,lc.isDocked(e)),e.getSystem().broadcastOn([fp()],{}),n().each(e=>e.getSystem().broadcastOn([fp()],{}))},i=a.inline?[]:[Om.config({channels:{[HA()]:{onReceive:GA}}})];return[U.config({}),lc.config({contextual:{lazyContext:n=>{let r=Lo(n.element);var e=a.inline?a.getContentAreaContainer():a.getContainer();return D.from(e).map(e=>{let o=tr(O.fromDom(e));return ax(a,n.element).fold(()=>{var e=o.height-r,t=o.y+(jA(n,"top")?0:r);return er(o.x,t,o.width,e)},e=>{var e=nr(o,ix(e)),t=jA(n,"top")?e.y:e.y+r;return er(e.x,t,e.width,e.height-r)})})},onShow:()=>{r(e=>$A(e,!0))},onShown:t=>{r(e=>Gs(e,[PA.transitionClass,PA.fadeInClass])),o.get().each(e=>{((t,o)=>{let n=Yt(o);Dm(n).filter(e=>!Gt(o,e)).filter(e=>Gt(e,O.fromDom(n.dom.body))||$t(t,e)).each(()=>_m(o))})(t.element,e),o.clear()})},onHide:e=>{var t;e=e.element,t=n,Am(e).orThunk(()=>t().toOptional().bind(e=>Am(e.element))).fold(o.clear,o.set),r(e=>$A(e,!1))},onHidden:()=>{r(e=>Gs(e,[PA.transitionClass]))},...PA},lazyViewport:n=>ax(a,n.element).fold(()=>{var e=ar(),t=vb(a),o=e.y+(jA(n,"top")&&!nx(a)?t:0),t=e.height-(jA(n,"bottom")?t:0);return{bounds:er(e.x,o,e.width,t),optScrollEnv:D.none()}},e=>({bounds:ix(e),optScrollEnv:D.some({currentScrollTop:e.element.dom.scrollTop,scrollElmTop:jo(e.element).top})})),modes:[e.header.getDockingMode()],onDocked:t,onUndocked:t}),...i]};var qA=Object.freeze({__proto__:null,setup:(e,t,o)=>{e.inline||(t.header.isPositionedAtTop()||e.on("ResizeEditor",()=>{o().each(lc.reset)}),e.on("ResizeWindow ResizeEditor",()=>{o().each(GA)}),e.on("SkinLoaded",()=>{o().each(e=>{lc.isDocked(e)?lc.reset(e):lc.refresh(e)})}),e.on("FullscreenStateChanged",()=>{o().each(lc.reset)})),e.on("AfterScrollIntoView",m=>{o().each(e=>{lc.refresh(e);var t,o,n,r,a,i,s,l,c,d,e=e.element;kf(e)&&(t=m,e=e,o=Yt(e),n=Kt(e).dom.innerHeight,r=Pn(o),t=O.fromDom(t.elm),a=or(t),t=Vo(t),a=a.y,i=a+t,s=jo(e),e=Vo(e),s=s.top,l=s+e,c=Math.abs(s-r.top)<2,d=Math.abs(l-(r.top+n))<2,c&&a<l?Un(r.left,a-e,o):d&&s<i&&(c=a-n+t+e,Un(r.left,c,o)))})}),e.on("PostRender",()=>{YA(e,!1)})},isDocked:e=>e().map(lc.isDocked).getOr(!1),getBehaviours:XA});let KA=m([_w,ga("items",f([$r([t,xa("items",qr)]),qr]))].concat(Gw)),JA=(r=[Ca("text"),Ca("tooltip"),Ca("icon"),Da("search",!1,f([Kr,m([Ca("placeholder")])],e=>X(e)?e?D.some({placeholder:D.none()}):D.none():D.some(e))),fa("fetch"),Fa("onSetup",()=>S),Ma("context","mode:design")],m([_w,...r])),QA=e=>ra("menubutton",JA,e),ZA=m([_w,n,Wp,jp,Aw,yf,Nf,Ba("presets","normal",["normal","color","listpreview"]),Rw(1),Bf,Xl,Ma("context","mode:design")]);var eM=kh({factory:(t,o)=>{var e={focus:L.focusIn,setMenus:(e,t)=>{t=C(t,t=>{var e={type:"menubutton",text:t.text,fetch:e=>{e(t.getItems())},context:"any"},e=QA(e).mapError(e=>sa(e)).getOrDie();return J1(e,"tox-mbtn",o.backstage,D.some("menuitem"))});H.set(e,t)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:R([H.config({}),P("menubar-events",[ds(e=>{t.onSetup(e)}),F(mi(),(o,e)=>{Rd(o.element,".tox-mbtn--active").each(t=>{Nd(e.event.target,".tox-mbtn").each(e=>{Gt(t,e)||o.getSystem().getByDom(t).each(t=>{o.getSystem().getByDom(e).each(e=>{Tk.expand(e),Tk.close(t),U.focus(e)})})})})}),F(Wi(),(o,e)=>{e.event.prevFocus.bind(e=>o.getSystem().getByDom(e).toOptional()).each(t=>{e.event.newFocus.bind(e=>o.getSystem().getByDom(e).toOptional()).each(e=>{Tk.isOpen(t)&&(Tk.expand(e),Tk.close(t))})})})]),L.config({mode:"flow",selector:".tox-mbtn",onEscape:e=>(t.onEscape(e),D.some(!0))}),ux.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[i("dom"),i("uid"),i("onEscape"),i("backstage"),u("onSetup",S)],apis:{focus:(e,t)=>{e.focus(t)},setMenus:(e,t,o)=>{e.setMenus(t,o)}}});let tM="container",oM=[Ng("slotBehaviours",[])],nM=e=>"<alloy.field."+e+">",rM=(r,e)=>{let t=e=>dh(r);var o=(o,n)=>(e,t)=>ih(e,r,t).map(e=>o(e,t)).getOr(n);let n=(e,t)=>"true"!==wo(e.element,"aria-hidden");var a,i=o(n,!1),s=o((e,t)=>{var o;n(e)&&(o=e.element,M(o,"display","none"),A(o,"aria-hidden","true"),_(e,ji(),{name:t,visible:!1}))});let l=(t,e)=>{E(e,e=>a(t,e))};o=o((e,t)=>{var o;n(e)||(o=e.element,Ro(o,"display"),ko(o,"aria-hidden"),_(e,ji(),{name:t,visible:!0}))}),i={getSlotNames:t,getSlot:(e,t)=>ih(e,r,t),isShowing:i,hideSlot:a=s,hideAllSlots:e=>l(e,t()),showSlot:o};return{uid:r.uid,dom:r.dom,components:e,behaviours:Op(r.slotBehaviours),apis:i}},aM={...Ge({getSlotNames:(e,t)=>e.getSlotNames(t),getSlot:(e,t,o)=>e.getSlot(t,o),isShowing:(e,t,o)=>e.isShowing(t,o),hideSlot:(e,t,o)=>e.hideSlot(t,o),hideAllSlots:(e,t)=>e.hideAllSlots(t),showSlot:(e,t,o)=>e.showSlot(t,o)},e=>Tc(e)),sketch:e=>{var t=(()=>{let o=[];return{slot:(e,t)=>(o.push(e),th(tM,nM(e),t)),record:T(o)}})(),e=e(t),t=t.record(),t=C(t,e=>Xp({name:e,pname:nM(e)}));return bh(tM,oM,t,rM,e)}},iM=m([Wp,n,Fa("onShow",S),Fa("onHide",S),Nf]),sM=e=>ra("sidebar",iM,e),lM=n=>{let r=n.ui.registry.getAll().sidebars;E(Ue(r),t=>{var e=r[t];let o=()=>ot(D.from(n.queryCommandValue("ToggleSidebar")),t);n.ui.registry.addToggleButton(t,{icon:e.icon,tooltip:e.tooltip,onAction:e=>{n.execCommand("ToggleSidebar",!1,t),e.setActive(o())},onSetup:e=>{e.setActive(o());let t=()=>e.setActive(o());return n.on("ToggleSidebar",t),()=>{n.off("ToggleSidebar",t)}},context:"any"})})},cM=e=>({element:()=>e.element.dom}),dM=(o,n)=>{let r=C(Ue(n),e=>{var t=n[e],t=aa(sM(t));return{name:e,getApi:cM,onSetup:t.onSetup,onShow:t.onShow,onHide:t.onHide}});return C(r,e=>{var t=B(S);return o.slot(e.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:O0.unnamedEvents([D0(e,t),A0(e,t),F(ji(),(t,e)=>{let o=e.event;Te(r,e=>e.name===o.name).each(e=>{(o.visible?e.onShow:e.onHide)(e.getApi(t))})})])})})},mM=t=>aM.sketch(e=>({dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:dM(e,t),slotBehaviours:O0.unnamedEvents([ds(e=>aM.hideAllSlots(e))])})),uM=(e,t)=>{A(e,"role",t)},gM=e=>z.getCurrent(e).bind(e=>q1.isGrowing(e)||q1.hasGrown(e)?z.getCurrent(e).bind(t=>Te(aM.getSlotNames(t),e=>aM.isShowing(t,e))):D.none()),pM=N("FixSizeEvent"),hM=N("AutoSizeEvent"),fM=(Qw=Object.freeze({__proto__:null,block:(e,t,o,n)=>{A(e.element,"aria-busy",!0);let r=t.getRoot(e).getOr(e);var a=R([L.config({mode:"special",onTab:()=>D.some(!0),onShiftTab:()=>D.some(!0)}),U.config({})]),n=n(r,a);let i=r.getSystem().build(n);H.append(r,Od(i)),i.hasConfigured(L)&&t.focus&&L.focusIn(i),o.isBlocked()||t.onBlock(e),o.blockWith(()=>H.remove(r,i))},unblock:(e,t,o)=>{ko(e.element,"aria-busy"),o.isBlocked()&&t.onUnblock(e),o.clear()},isBlocked:(e,t,o)=>o.isBlocked()}),e0=[Fa("getRoot",D.none),Ia("focus",!0),o("onBlock"),o("onUnblock")],Es({fields:e0,name:"blocking",apis:Qw,state:Object.freeze({__proto__:null,init:()=>{let t=ir(e=>e.destroy());return _s({readState:t.isSet,blockWith:e=>{t.set({destroy:e})},clear:t.clear,isBlocked:t.isSet})}})})),vM=o=>(e,t)=>({dom:{tag:"div",attributes:{"aria-label":o.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:dx('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),bM=e=>z.getCurrent(e).each(e=>_m(e.element,!0)),xM=(e,o)=>{let n="tabindex",r="data-mce-"+n;D.from(e.iframeElement).map(O.fromDom).each(t=>{o?(So(t,n).each(e=>A(t,r,e)),A(t,n,-1)):(ko(t,n),So(t,r).each(e=>{A(t,n,e),ko(t,r)}))})},yM=(e,t,o,n)=>{var r=t.element;xM(e,o),o?(fM.block(t,vM(n)),Ro(r,"display"),ko(r,"aria-hidden"),e.hasFocus()&&bM(t)):(o=z.getCurrent(t).exists(e=>Em(e.element)),fM.unblock(t),M(r,"display","none"),A(r,"aria-hidden","true"),o&&e.focus())},wM=e=>"focusin"===e.type,SM=e=>!!wM(e)&&(e.composed?Ve(e.composedPath()):D.from(e.target)).map(O.fromDom).filter(Nt).exists(e=>Ws(e,"mce-pastebin")),CM=(o,t,n)=>{let r=B(!1),a=lr(),i=e=>{r.get()&&!SM(e)&&(e.preventDefault(),bM(t()),o.editorManager.setActive(o))},s=(o.inline||o.on("PreInit",()=>{o.dom.bind(o.getWin(),"focusin",i),o.on("BeforeExecCommand",e=>{"mcefocus"===e.command.toLowerCase()&&!0!==e.value&&i(e)})}),e=>{e!==r.get()&&(r.set(e),yM(o,t(),e,n.providers),VS(o,e))});o.on("ProgressState",e=>{var t;a.on(clearTimeout),Z(e.time)?(t=Yv.setEditorTimeout(o,()=>s(e.state),e.time),a.set(t)):(s(e.state),a.clear())})},kM=(e,o)=>Oe(e,(t,e)=>o(e,t.len).fold(T(t),e=>({len:e.finish,list:t.list.concat([e])})),{len:0,list:[]}).list,OM=(e,t,o)=>({within:e,extra:t,withinWidth:o}),_M=(e,t,n)=>{var e=kM(e,(e,t)=>{var o=n(e);return D.some({element:e,start:t,finish:t+o,width:o})}),o=Ce(e,e=>e.finish<=t),r=ke(o,(e,t)=>e+t.width,0);return{within:o,extra:e.slice(o.length),withinWidth:r}},TM=e=>C(e,e=>e.element),EM=(e,t,o)=>{e=TM(e.concat(t));return OM(e,[],o)},DM=(e,t,o,n)=>{e=TM(e).concat([o]);return OM(e,TM(t),n)},AM=(e,t,o)=>OM(TM(e),[],o),MM=(e,t,o)=>{t=_M(t,e,o);return 0===t.extra.length?D.some(t):D.none()},BM=(e,t,o,n)=>{var r=MM(e,t,o).getOrThunk(()=>_M(t,e-o(n),o)),a=r.within,i=r.extra,r=r.withinWidth;return 1===i.length&&i[0].width<=o(n)?EM(a,i,r):1<=i.length?DM(a,i,n,r):AM(a,i,r)},IM=(e,t)=>{t=C(t,e=>Od(e));zA.setGroups(e,t)},FM=e=>Pe(e,t=>Am(t.element).bind(e=>t.getSystem().getByDom(e).toOptional())),RM=(e,t,o)=>{var n,r,a=t.builtGroups.get();0!==a.length&&(n=sh(e,t,"primary"),e=lk.getCoupled(e,"overflowGroup"),M(n.element,"visibility","hidden"),a=a.concat([e]),r=FM(a),o([]),IM(n,a),a=Xo(n.element),0===(a=BM(a,t.builtGroups.get(),e=>Math.ceil(e.element.dom.getBoundingClientRect().width),e)).extra.length?(H.remove(n,e),o([])):(IM(n,a.within),o(a.extra)),Ro(n.element,"visibility"),No(n.element),r.each(U.focus))},NM=(Zw=T([Ng("splitToolbarBehaviours",[lk]),ma("builtGroups",()=>B([]))]),Vw=T([tc(["overflowToggledClass"]),Oa("getOverflowBounds"),i("lazySink"),ma("overflowGroups",()=>B([])),o("onOpened"),o("onClosed")].concat(Zw())),Jw=T([Xp({factory:zA,schema:hB(),name:"primary"}),Iu({schema:hB(),name:"overflow"}),Iu({name:"overflow-button"}),Iu({name:"overflow-group"})]),T((e,t)=>{((e,t)=>{t=$o.max(e,t,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);M(e,"max-width",t+"px")})(e,Math.floor(t))})),zM=(zw=T([tc(["toggledClass"]),i("lazySink"),fa("fetch"),Oa("getBounds"),Ta("fireDismissalEventInstead",[u("event",Ui())]),Bl(),o("onToggled")]),Rf=T([Iu({name:"button",overrides:e=>({dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:R([h.config({toggleClass:e.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1,onToggled:e.onToggled})])})}),Iu({factory:zA,schema:hB(),name:"toolbar",overrides:t=>({toolbarBehaviours:R([L.config({mode:"cyclic",onEscape:e=>(ih(e,t,"button").each(U.focus),D.none())})])})})]),lr()),VM=(e,t)=>{e=lk.getCoupled(e,"toolbarSandbox");d.isOpen(e)?d.close(e):d.open(e,t.toolbar())},LM=(e,t,o,n)=>{var r=o.getBounds.map(e=>e()),o=o.lazySink(e).getOrDie();Wg.positionWithinBounds(o,t,{anchor:{type:"hotspot",hotspot:e,layouts:n,overrides:{maxWidthFunction:NM()}}},r)},HM=(e,t,o,n,r)=>{zA.setGroups(t,r),LM(e,t,o,n),h.on(e)},PM=Up({name:"FloatingToolbarButton",factory:(n,e,r,o)=>({...sx.sketch({...o.button(),action:e=>{VM(e,o)},buttonBehaviours:Tp.augment({dump:o.button().buttonBehaviours},[lk.config({others:{toolbarSandbox:e=>((n,r,a)=>{let i=Ld();return{dom:{tag:"div",attributes:{id:i.id}},behaviours:R([L.config({mode:"special",onEscape:e=>(d.close(e),D.some(!0))}),d.config({onOpen:(e,t)=>{let o=zM.get().getOr(!1);a.fetch().get(e=>{HM(n,t,a,r.layouts,e),i.link(n.element),o||L.focusIn(t)})},onClose:()=>{h.off(n),zM.get().getOr(!1)||U.focus(n),i.unlink(n.element)},isPartOf:(e,t,o)=>Pd(t,o)||Pd(n,o),getAttachPoint:()=>a.lazySink(n).getOrDie()}),Om.config({channels:{...xp({isExtraPart:de,...a.fireDismissalEventInstead.map(e=>({fireEventInstead:{event:e.event}})).getOr({})}),...wp({doReposition:()=>{d.getState(lk.getCoupled(n,"toolbarSandbox")).each(e=>{LM(n,e,a,r.layouts)})}})}})])}})(e,r,n)}})])}),apis:{setGroups:(t,o)=>{d.getState(lk.getCoupled(t,"toolbarSandbox")).each(e=>{HM(t,e,n,r.layouts,o)})},reposition:t=>{d.getState(lk.getCoupled(t,"toolbarSandbox")).each(e=>{LM(t,e,n,r.layouts)})},toggle:e=>{VM(e,o)},toggleWithoutFocusing:e=>{var t;e=e,t=o,zM.set(!0),VM(e,t),zM.clear()},getToolbar:e=>d.getState(lk.getCoupled(e,"toolbarSandbox")),isOpen:e=>d.isOpen(lk.getCoupled(e,"toolbarSandbox"))}}),configFields:zw(),partFields:Rf(),apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},toggleWithoutFocusing:(e,t)=>{e.toggleWithoutFocusing(t)},getToolbar:(e,t)=>e.getToolbar(t),isOpen:(e,t)=>e.isOpen(t)}}),UM=(wf=T([i("items"),tc(["itemSelector"]),Ng("tgroupBehaviours",[L])]),Gw=T([zg({name:"items",unit:"item"})]),Up({name:"ToolbarGroup",configFields:wf(),partFields:Gw(),factory:(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,behaviours:_p(e.tgroupBehaviours,[L.config({mode:"flow",selector:e.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}})})),WM=e=>C(e,e=>Od(e)),jM=(e,o,n)=>{RM(e,n,t=>{n.overflowGroups.set(t),o.getOpt(e).each(e=>{PM.setGroups(e,WM(t))})})},GM=Up({name:"SplitFloatingToolbar",configFields:Vw(),partFields:Jw(),factory:(o,e,t,n)=>{let r=mx(PM.sketch({fetch:()=>gk.nu(e=>{e(WM(o.overflowGroups.get()))}),layouts:{onLtr:()=>[um,mm],onRtl:()=>[mm,um],onBottomLtr:()=>[pm,gm],onBottomRtl:()=>[gm,pm]},getBounds:t.getOverflowBounds,lazySink:o.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:o.markers.overflowToggledClass},parts:{button:n["overflow-button"](),toolbar:n.overflow()},onToggled:(e,t)=>o[t?"onOpened":"onClosed"](e)}));return{uid:o.uid,dom:o.dom,components:e,behaviours:_p(o.splitToolbarBehaviours,[lk.config({others:{overflowGroup:()=>UM.sketch({...n["overflow-group"](),items:[r.asSpec()]})}})]),apis:{setGroups:(e,t)=>{o.builtGroups.set(C(t,e.getSystem().build)),jM(e,r,o)},refresh:e=>jM(e,r,o),toggle:e=>{r.getOpt(e).each(e=>{PM.toggle(e)})},toggleWithoutFocusing:e=>{r.getOpt(e).each(PM.toggleWithoutFocusing)},isOpen:e=>r.getOpt(e).map(PM.isOpen).getOr(!1),reposition:e=>{r.getOpt(e).each(e=>{PM.reposition(e)})},getOverflow:e=>r.getOpt(e).bind(PM.getToolbar)},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},refresh:(e,t)=>{e.refresh(t)},reposition:(e,t)=>{e.reposition(t)},toggle:(e,t)=>{e.toggle(t)},toggleWithoutFocusing:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t),getOverflow:(e,t)=>e.getOverflow(t)}}),$M=(r=T([tc(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),o("onOpened"),o("onClosed")].concat(Zw())),Aw=T([Xp({factory:zA,schema:hB(),name:"primary"}),Xp({factory:zA,schema:hB(),name:"overflow",overrides:t=>({toolbarBehaviours:R([q1.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:e=>{ih(e,t,"overflow-button").each(e=>{h.off(e)}),t.onClosed(e)},onGrown:e=>{t.onOpened(e)},onStartGrow:e=>{ih(e,t,"overflow-button").each(h.on)}}),L.config({mode:"acyclic",onEscape:e=>(ih(e,t,"overflow-button").each(U.focus),D.some(!0))})])})}),Iu({name:"overflow-button",overrides:e=>({buttonBehaviours:R([h.config({toggleClass:e.markers.overflowToggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])})}),Iu({name:"overflow-group"})]),(e,r,a)=>{ih(e,r,"overflow-button").each(n=>{ih(e,r,"overflow").each(o=>{if(YM(e,r),q1.hasShrunk(o)){let t=r.onOpened;r.onOpened=e=>{a||L.focusIn(o),t(e),r.onOpened=t}}else{let t=r.onClosed;r.onClosed=e=>{a||U.focus(n),t(e),r.onClosed=t}}q1.toggleGrow(o)})})}),YM=(e,o)=>{ih(e,o,"overflow").each(t=>{RM(e,o,e=>{e=C(e,e=>Od(e));zA.setGroups(t,e)}),ih(e,o,"overflow-button").each(e=>{q1.hasGrown(t)&&h.on(e)}),q1.refresh(t)})},XM=Up({name:"SplitSlidingToolbar",configFields:r(),partFields:Aw(),factory:(o,e,t,n)=>{let r="alloy.toolbar.toggle";return{uid:o.uid,dom:o.dom,components:e,behaviours:_p(o.splitToolbarBehaviours,[lk.config({others:{overflowGroup:t=>UM.sketch({...n["overflow-group"](),items:[sx.sketch({...n["overflow-button"](),action:e=>{b(t,r)}})]})}}),P("toolbar-toggle-events",[F(r,e=>{$M(e,o,!1)})])]),apis:{setGroups:(e,t)=>{((e,t)=>{t=C(t,e.getSystem().build);o.builtGroups.set(t)})(e,t),YM(e,o)},refresh:e=>YM(e,o),toggle:e=>{$M(e,o,!1)},toggleWithoutFocusing:e=>{$M(e,o,!0)},isOpen:e=>{return e=e,t=o,ih(e,t,"overflow").map(q1.hasGrown).getOr(!1);var t}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:(e,t,o)=>{e.setGroups(t,o)},refresh:(e,t)=>{e.refresh(t)},toggle:(e,t)=>{e.toggle(t)},isOpen:(e,t)=>e.isOpen(t)}}),qM=e=>{var t=e.label.isNone()?e.title.fold(()=>({}),e=>({attributes:{title:e}})):e.label.fold(()=>({}),e=>({attributes:{"aria-label":e}}));return{dom:{tag:"div",classes:["tox-toolbar__group"].concat(e.label.isSome()?["tox-toolbar__group_with_label"]:[]),...t},components:[...e.label.map(e=>({dom:{tag:"span",classes:["tox-label","tox-label--context-toolbar"]},components:[xd(e)]})).toArray(),UM.parts.items({})],items:e.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled]), .tox-number-input:not([disabled])"},tgroupBehaviours:R([ux.config({}),U.config({})])}},KM=e=>UM.sketch(qM(e)),JM=(o,e)=>{var t=ds(e=>{var t=C(o.initGroups,KM);zA.setGroups(e,t)});return R([T0.toolbarButton(()=>o.providers.checkUiComponentContext("any").shouldDisable),V0(()=>o.providers.checkUiComponentContext("any")),L.config({mode:e,onEscape:o.onEscape,selector:".tox-toolbar__group"}),P("toolbar-events",[t])])},QM=e=>{var t=e.cyclicKeying?"cyclic":"acyclic";return{uid:e.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":qM({title:D.none(),label:D.none(),items:[]}),"overflow-button":SE({context:"any",name:"more",icon:D.some("more-drawer"),enabled:!0,tooltip:D.some("Reveal or hide additional toolbar items"),primary:!1,buttonType:D.none(),borderless:!1},D.none(),e.providers,[],"overflow-button")},splitToolbarBehaviours:JM(e,t)}},ZM=n=>{var e=QM(n);var t=GM.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return GM.sketch({...e,lazySink:n.getSink,getOverflowBounds:()=>{var e=n.moreDrawerData.lazyHeader().element,t=or(e),e=qt(e),o=or(e),e=Math.max(e.dom.scrollHeight,o.height);return er(t.x+4,o.y,t.width-8,e)},parts:{...e.parts,overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:n.attributes}}},components:[t],markers:{overflowToggledClass:"tox-tbtn--enabled"},onOpened:e=>n.onToggled(e,!0),onClosed:e=>n.onToggled(e,!1)})},eB=t=>{var e=XM.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),o=XM.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),n=QM(t);return XM.sketch({...n,components:[e,o],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:e=>{e.getSystem().broadcastOn([HA()],{type:"opened"}),t.onToggled(e,!0)},onClosed:e=>{e.getSystem().broadcastOn([HA()],{type:"closed"}),t.onToggled(e,!1)}})},tB=e=>{var t=e.cyclicKeying?"cyclic":"acyclic";return zA.sketch({uid:e.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(e.type===Gv.scrolling?["tox-toolbar--scrolling"]:[])},components:[zA.parts.groups({})],toolbarBehaviours:JM(e,t)})},oB=(yf=[jp,Wp,Ca("tooltip"),Ba("buttonType","secondary",["primary","secondary"]),Ia("borderless",!1),fa("onAction"),Ma("context","mode:design")],Bf={button:[...yf,Gp,ha("type",["button"])],togglebutton:[...yf,Ia("active",!1),ha("type",["togglebutton"])]},Xl=[ha("type",["group"]),Ra("buttons",[],la("type",Bf))],Nf=la("type",{...Bf,group:Xl}),m([Ra("buttons",[],Nf),fa("onShow"),fa("onHide")])),nB=e=>ra("view",oB,e),rB=(t,n)=>{let e,o,r="togglebutton"===t.type,a=t.icon.map(e=>s1(e,n.icons)).map(mx);var i=o=>{var e=t=>{a.map(e=>e.getOpt(o).each(e=>{H.set(e,[s1(t,n.icons)])}))};return r?t.onAction({setIcon:e,setActive:e=>{var t=o.element;e?(Ls(t,"tox-button--enabled"),A(t,"aria-pressed",!0)):(Ps(t,"tox-button--enabled"),ko(t,"aria-pressed"))},isActive:()=>Ws(o.element,"tox-button--enabled"),focus:()=>_m(o.element)}):"button"===t.type?t.onAction({setIcon:e}):void 0},s={...t,name:r?t.text.getOr(t.icon.getOr("")):null!=(e=t.text)?e:t.icon.getOr(""),primary:"primary"===t.buttonType,buttonType:D.from(t.buttonType),tooltip:t.tooltip,icon:t.icon,enabled:!0,borderless:t.borderless},l=CE(null!=(o=t.buttonType)?o:"secondary"),c=r?t.text.map(n.translate):D.some(n.translate(t.text)),d=c.map(xd),c=s.tooltip.or(c).map(e=>({"aria-label":n.translate(e)})).getOr({}),m=a.map(e=>e.asSpec()),m=P0([m,d]),d=t.icon.isSome()&&d.isSome(),l={tag:"button",classes:l.concat(...t.icon.isSome()&&!d?["tox-button--icon"]:[]).concat(...d?["tox-button--icon-and-text"]:[]).concat(...t.borderless?["tox-button--naked"]:[]).concat(..."togglebutton"===t.type&&t.active?["tox-button--enabled"]:[]),attributes:c},d=wE(s,D.some(i),[],l,m,t.tooltip,n);return sx.sketch(d)},aB=(e,t)=>rB(e,t),iB=(e0=On().deviceType).isPhone(),sB=e0.isTablet();var lB=Up({name:"silver.View",configFields:[i("viewConfig")],partFields:[qp({factory:{sketch:n=>{let r=!1;var e=C(n.buttons,e=>{return"group"===e.type?(r=!0,t=e,o=n.providers,{dom:{tag:"div",classes:["tox-view__toolbar__group"]},components:C(t.buttons,e=>aB(e,o))}):aB(e,n.providers);var t,o});return{uid:n.uid,dom:{tag:"div",classes:[r?"tox-view__toolbar":"tox-view__header",...iB||sB?["tox-view--mobile","tox-view--scrolling"]:[]]},behaviours:R([U.config({}),L.config({mode:"flow",selector:"button, .tox-button",focusInside:Hp.OnEnterOrSpaceMode})]),components:r?e:[mO.sketch({dom:{tag:"div",classes:["tox-view__header-start"]},components:[]}),mO.sketch({dom:{tag:"div",classes:["tox-view__header-end"]},components:e})]}}},schema:[i("buttons"),i("providers")],name:"header"}),qp({factory:{sketch:e=>({uid:e.uid,behaviours:R([U.config({}),ux.config({})]),dom:{tag:"div",classes:["tox-view__pane"]}})},schema:[],name:"pane"})],factory:(t,e,o,n)=>{var r={getPane:e=>RA.getPart(e,t,"pane"),getOnShow:e=>t.viewConfig.onShow,getOnHide:e=>t.viewConfig.onHide};return{uid:t.uid,dom:t.dom,components:e,behaviours:R([U.config({}),L.config({mode:"cyclic",focusInside:Hp.OnEnterOrSpaceMode})]),apis:r}},apis:{getPane:(e,t)=>e.getPane(t),getOnShow:(e,t)=>e.getOnShow(t),getOnHide:(e,t)=>e.getOnHide(t)}});let cB=(o,e,n)=>Je(e,(e,t)=>{e=aa(nB(e));return o.slot(t,lB.sketch({dom:{tag:"div",classes:["tox-view"]},viewConfig:e,components:[...0<e.buttons.length?[lB.parts.header({buttons:e.buttons,providers:n})]:[],lB.parts.pane({})]}))}),dB=t=>Te(aM.getSlotNames(t),e=>aM.isShowing(t,e)),mB=e=>({getContainer:T(e)}),uB=(e,t,o)=>{aM.getSlot(e,t).each(t=>{lB.getPane(t).each(e=>{o(t)(mB(e.element.dom))})})};var gB,pB=kh({factory:(e,r)=>{var t={setViews:(e,t)=>{var o,n;H.set(e,[(o=t,n=r.backstage.shared.providers,aM.sketch(e=>({dom:{tag:"div",classes:["tox-view-wrap__slot-container"]},components:cB(e,o,n),slotBehaviours:O0.unnamedEvents([ds(e=>aM.hideAllSlots(e))])})))])},whichView:e=>z.getCurrent(e).bind(dB),toggleView:(a,i,s,l)=>z.getCurrent(a).exists(o=>{var e,t=dB(o),n=t.exists(e=>l===e),r=aM.getSlot(o,l).isSome();return r&&(aM.hideAllSlots(o),n?((e=>{e=e.element;M(e,"display","none"),A(e,"aria-hidden","true")})(a),i()):(s(),(e=>{e=e.element;Ro(e,"display"),ko(e,"aria-hidden")})(a),aM.showSlot(o,l),n=o,e=l,uB(n,e,lB.getOnShow)),t.each(e=>{return t=o,e=e,uB(t,e,lB.getOnHide);var t})),r})};return{uid:e.uid,dom:{tag:"div",classes:["tox-view-wrap"],attributes:{"aria-hidden":"true"},styles:{display:"none"}},components:[],behaviours:R([H.config({}),z.config({find:e=>{e=H.contents(e);return Ve(e)}})]),apis:t}},name:"silver.ViewWrapper",configFields:[i("backstage")],apis:{setViews:(e,t,o)=>e.setViews(t,o),toggleView:(e,t,o,n,r)=>e.toggleView(t,o,n,r),whichView:(e,t)=>e.whichView(t)}}),Qw=Mw.optional({factory:eM,name:"menubar",schema:[i("backstage")]}),zw=Mw.optional({factory:{sketch:e=>NA.sketch({uid:e.uid,dom:e.dom,listBehaviours:R([L.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:()=>tB({type:e.type,uid:N("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:e.providers,onEscape:()=>(e.onEscape(),D.some(!0))}),setupItem:(e,t,o,n)=>{zA.setGroups(t,o)},shell:!0})},name:"multiple-toolbar",schema:[i("dom"),i("onEscape")]}),Rf=Mw.optional({factory:{sketch:o=>{var e;return((e=o).type===Gv.sliding?eB:e.type===Gv.floating?ZM:tB)({type:o.type,uid:o.uid,onEscape:()=>(o.onEscape(),D.some(!0)),onToggled:(e,t)=>o.onToolbarToggled(t),cyclicKeying:!1,initGroups:[],getSink:o.getSink,providers:o.providers,moreDrawerData:{lazyToolbar:o.lazyToolbar,lazyMoreButton:o.lazyMoreButton,lazyHeader:o.lazyHeader},attributes:o.attributes})}},name:"toolbar",schema:[i("dom"),i("onEscape"),i("getSink")]}),wf=Mw.optional({factory:{sketch:e=>{var t=e.editor,o=e.sticky?XA:VA;return{uid:e.uid,dom:e.dom,components:e.components,behaviours:R(o(t,e.sharedBackstage))}}},name:"header",schema:[i("dom")]}),Gw=Mw.optional({factory:{sketch:e=>({uid:e.uid,dom:e.dom,components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/tinymce-self-hosted-premium-features/?utm_campaign=self_hosted_upgrade_promo&utm_source=tiny&utm_medium=referral",rel:"noopener",target:"_blank","aria-hidden":"true"},classes:["tox-promotion-link"],innerHtml:"⚡️Upgrade"}}]})},name:"promotion",schema:[i("dom")]}),Vw=Mw.optional({name:"socket",schema:[i("dom")]}),Jw=Mw.optional({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"presentation"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:R([ux.config({}),U.config({}),q1.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:e=>{z.getCurrent(e).each(aM.hideAllSlots),b(e,hM)},onGrown:e=>{b(e,hM)},onStartGrow:e=>{_(e,pM,{width:Bo(e.element,"width").getOr("")})},onStartShrink:e=>{_(e,pM,{width:Xo(e.element)+"px"})}}),H.config({}),z.config({find:e=>{e=H.contents(e);return Ve(e)}})])}],behaviours:R([hT.childAt(0),P("sidebar-sliding-events",[F(pM,(e,t)=>{M(e.element,"width",t.event.width)}),F(hM,(e,t)=>{Ro(e.element,"width")})])])})},name:"sidebar",schema:[i("dom")]}),Zw=Mw.optional({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:R([H.config({}),fM.config({focus:!1}),z.config({find:e=>Ve(e.components())})]),components:[]})},name:"throbber",schema:[i("dom")]}),hB=Mw.optional({factory:pB,name:"viewWrapper",schema:[i("backstage")]}),r=Mw.optional({factory:{sketch:e=>({uid:e.uid,dom:{tag:"div",classes:["tox-editor-container"]},components:e.components})},name:"editorContainer",schema:[]}),fB=Up({name:"OuterContainer",factory:(n,e,t)=>{let o=!1,r=e=>{var t;e=e,t=".tox-statusbar",Dd(e,e=>Pt(e,t)).each(e=>{"none"===Ao(e,"display")&&"true"===wo(e,"aria-hidden")?(Ro(e,"display"),ko(e,"aria-hidden")):(M(e,"display","none"),A(e,"aria-hidden","true"))})},a={getSocket:e=>RA.getPart(e,n,"socket"),setSidebar:(e,t,o)=>{RA.getPart(e,n,"sidebar").each(e=>{var n,r,a;n=e,r=t,a=o,z.getCurrent(n).each(t=>{H.set(t,[mM(r)]);let o=null==a?void 0:a.toLowerCase();y(o)&&et(r,o)&&z.getCurrent(t).each(e=>{aM.showSlot(e,o),q1.immediateGrow(t),Ro(t.element,"width"),uM(n.element,"region")})})})},toggleSidebar:(e,t)=>{RA.getPart(e,n,"sidebar").each(e=>{var o,n;o=e,n=t,z.getCurrent(o).each(t=>{z.getCurrent(t).each(e=>{q1.hasGrown(t)?aM.isShowing(e,n)?(q1.shrink(t),uM(o.element,"presentation")):(aM.hideAllSlots(e),aM.showSlot(e,n),uM(o.element,"region")):(aM.hideAllSlots(e),aM.showSlot(e,n),q1.grow(t),uM(o.element,"region"))})})})},whichSidebar:e=>RA.getPart(e,n,"sidebar").bind(gM).getOrNull(),getHeader:e=>RA.getPart(e,n,"header"),getToolbar:e=>RA.getPart(e,n,"toolbar"),setToolbar:(e,o)=>{RA.getPart(e,n,"toolbar").each(e=>{var t=C(o,KM);e.getApis().setGroups(e,t)})},setToolbars:(e,o)=>{RA.getPart(e,n,"multiple-toolbar").each(e=>{var t=C(o,e=>C(e,KM));NA.setItems(e,t)})},refreshToolbar:e=>{RA.getPart(e,n,"toolbar").each(e=>e.getApis().refresh(e))},toggleToolbarDrawer:e=>{RA.getPart(e,n,"toolbar").each(t=>{st(t.getApis().toggle,e=>e(t))})},toggleToolbarDrawerWithoutFocusing:e=>{RA.getPart(e,n,"toolbar").each(t=>{st(t.getApis().toggleWithoutFocusing,e=>e(t))})},isToolbarDrawerToggled:e=>RA.getPart(e,n,"toolbar").bind(t=>D.from(t.getApis().isOpen).map(e=>e(t))).getOr(!1),getThrobber:e=>RA.getPart(e,n,"throbber"),focusToolbar:e=>{RA.getPart(e,n,"toolbar").orThunk(()=>RA.getPart(e,n,"multiple-toolbar")).each(e=>{L.focusIn(e)})},setMenubar:(e,t)=>{RA.getPart(e,n,"menubar").each(e=>{eM.setMenus(e,t)})},focusMenubar:e=>{RA.getPart(e,n,"menubar").each(e=>{eM.focus(e)})},setViews:(e,t)=>{RA.getPart(e,n,"viewWrapper").each(e=>{pB.setViews(e,t)})},toggleView:(t,o)=>RA.getPart(t,n,"viewWrapper").exists(e=>pB.toggleView(e,()=>a.showMainView(t),()=>a.hideMainView(t),o)),whichView:e=>RA.getPart(e,n,"viewWrapper").bind(pB.whichView).getOrNull(),hideMainView:e=>{(o=a.isToolbarDrawerToggled(e))&&a.toggleToolbarDrawer(e),RA.getPart(e,n,"editorContainer").each(e=>{e=e.element;r(e),M(e,"display","none"),A(e,"aria-hidden","true")})},showMainView:e=>{o&&a.toggleToolbarDrawer(e),RA.getPart(e,n,"editorContainer").each(e=>{e=e.element;r(e),Ro(e,"display"),ko(e,"aria-hidden")})}};return{uid:n.uid,dom:n.dom,components:e,apis:a,behaviours:n.behaviours}},configFields:[i("dom"),i("behaviours")],partFields:[wf,Qw,Rf,zw,Vw,Jw,Gw,Zw,hB,r],apis:{getSocket:(e,t)=>e.getSocket(t),setSidebar:(e,t,o,n)=>{e.setSidebar(t,o,n)},toggleSidebar:(e,t,o)=>{e.toggleSidebar(t,o)},whichSidebar:(e,t)=>e.whichSidebar(t),getHeader:(e,t)=>e.getHeader(t),getToolbar:(e,t)=>e.getToolbar(t),setToolbar:(e,t,o)=>{e.setToolbar(t,o)},setToolbars:(e,t,o)=>{e.setToolbars(t,o)},refreshToolbar:(e,t)=>e.refreshToolbar(t),toggleToolbarDrawer:(e,t)=>{e.toggleToolbarDrawer(t)},toggleToolbarDrawerWithoutFocusing:(e,t)=>{e.toggleToolbarDrawerWithoutFocusing(t)},isToolbarDrawerToggled:(e,t)=>e.isToolbarDrawerToggled(t),getThrobber:(e,t)=>e.getThrobber(t),setMenubar:(e,t,o)=>{e.setMenubar(t,o)},focusMenubar:(e,t)=>{e.focusMenubar(t)},focusToolbar:(e,t)=>{e.focusToolbar(t)},setViews:(e,t,o)=>{e.setViews(t,o)},toggleView:(e,t,o)=>e.toggleView(t,o),whichView:(e,t)=>e.whichView(t)}});let vB="file edit view insert format tools table help",bB={file:{title:"File",items:"newdocument restoredraft | preview | importword exportpdf exportword | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code revisionhistory | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed inserttemplate codesample inserttable accordion math | charmap emoticons hr | pagebreak nonbreaking anchor tableofcontents footnotes | mergetags | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | styles blocks fontfamily fontsize align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"aidialog aishortcuts | spellchecker spellcheckerlanguage | autocorrect capitalization | a11ycheck code typography wordcount addtemplate"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},xB=(e,o,t)=>{let n=db(t).split(/[ ,]/);return{text:e.title,getItems:()=>Ae(e.items,e=>{let t=e.toLowerCase();return 0===t.trim().length||be(n,e=>e===t)?[]:"separator"===t||"|"===t?[{type:"separator"}]:o.menuItems[t]?[o.menuItems[t]]:[]})}},yB=e=>e.split(" "),wB=(t,o)=>{let n={...bB,...o.menus},r=0<Ue(o.menus).length;var e=void 0===o.menubar||!0===o.menubar?yB(vB):yB(!1===o.menubar?"":o.menubar),e=Ce(e,e=>{var t=et(bB,e);return r?t||k(o.menus,e).exists(e=>et(e,"items")):t}),e=C(e,e=>{e=n[e];return xB({title:e.title,items:yB(e.items)},o,t)});return Ce(e,e=>0<e.getItems().length&&be(e.getItems(),e=>y(e)||"separator"!==e.type))},SB=e=>{e=zb(e);return e?D.from(e):D.none()},CB=(e,t,o)=>(e.on("remove",()=>o.unload(t)),o.load(t)),kB=(e,t,o,n)=>(e.on("remove",()=>n.unloadRawCss(t)),n.loadRawCss(t,o)),OB=(e,t)=>"ui/"+e+"/"+t,_B=e=>D.from(tinymce.Resource.get(e)).filter(y),TB=(t,o,n="")=>{var e=SB(t).map(e=>OB(e,o+".css")),r=e.bind(_B);return at(e,r,(e,t)=>({_kind:"load-raw",key:e,css:t})).getOrThunk(()=>{var e=t.editorManager.suffix;return{_kind:"load-stylesheet",url:n+`/${o}${e}.css`}})},EB=(e,t)=>{var o=e.ui.styleSheetLoader,n=TB(e,"skin",t);switch(n._kind){case"load-raw":var{key:r,css:a}=n;return kB(e,r,a,o),Promise.resolve();case"load-stylesheet":r=n.url;return CB(e,r,o);default:return Promise.resolve()}},DB=(e,t)=>{if(!mo(O.fromDom(e.getElement())))return Promise.resolve();var o=Xv.DOM.styleSheetLoader,n=TB(e,"skin.shadowdom",t);switch(n._kind){case"load-raw":var{key:r,css:a}=n;return kB(e,r,a,o),Promise.resolve();case"load-stylesheet":r=n.url;return CB(e,r,o);default:return Promise.resolve()}},AB=(o,n,r)=>{var e=n?"content.inline":"content",a=TB(o,e,r);switch(a._kind){case"load-raw":let{key:e,css:t}=a;return n?kB(o,e,t,o.ui.styleSheetLoader):o.on("PostRender",()=>{kB(o,e,t,o.dom.styleSheetLoader)}),Promise.resolve();case"load-stylesheet":var i=a.url;return r&&o.contentCSS.push(i),Promise.resolve();default:return Promise.resolve()}},MB=ie(Aw=(e,t)=>{return(async(e,t)=>{var o=Hb(t);if(await AB(t,e,o),!Vb(t)&&y(o))return Promise.all([EB(t,o),DB(t,o)]).then()})(e,t).then((e=>{let t=()=>{e._skinLoaded=!0,BS(e)};return()=>{e.initialized?t():e.on("init",t)}})(t),(o=t,n="Skin could not be loaded",()=>IS(o,{message:n})));var o,n},!1),BB=ie(Aw,!0),IB=(e,t,o)=>xt(o)?e.translate(t):e.translate([t,e.translate(o)]),FB=(i,s)=>{let r=(e,t,o,n)=>{var r,a=i.shared.providers.translate(e.title);return"separator"===e.type?D.some({type:"separator",text:a}):"submenu"===e.type?(r=Ae(e.getStyleItems(),e=>l(e,t,n)),0===t&&r.length<=0?D.none():D.some({type:"nestedmenuitem",text:a,enabled:0<r.length,getSubmenuItems:()=>Ae(e.getStyleItems(),e=>l(e,t,n))})):D.some({type:"togglemenuitem",text:a,icon:e.icon,active:e.isSelected(n),enabled:!o,onAction:s.onAction(e),...e.getStylePreview().fold(()=>({}),e=>({meta:{style:e}}))})},l=(e,t,o)=>{var n="formatter"===e.type&&s.isInvalid(e);return 0===t?n?[]:r(e,t,!1,o).toArray():r(e,t,n,o).toArray()},a=e=>{let t=s.getCurrentValue(),o=s.shouldHide?0:1;return Ae(e,e=>l(e,o,t))};return{validateItems:a,getFetch:(n,r)=>(e,t)=>{var o=r(),o=a(o);t(S1(o,_y.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!1,search:D.none()}))}}},RB=(e,t)=>{let o=t.dataset;var n="basic"===o.type?()=>C(o.data,e=>$D(e,t.isSelectedFor,t.getPreviewFor)):o.getData;return{items:FB(e,t),getStyleItems:n}},NB=(o,n,r,a,i,e)=>{var{items:t,getStyleItems:s}=RB(n,r);let l=B(r.tooltip);return m1({context:"mode:design",text:r.icon.isSome()?D.none():r.text,icon:r.icon,ariaLabel:D.some(r.tooltip),tooltip:D.none(),role:D.none(),fetch:t.getFetch(n,s),onSetup:t=>{let e=e=>t.setTooltip(IB(o,a(e.value),e.value));return o.on(i,e),qS(ZS(o,"NodeChange",e=>{var t=e.getComponent();r.updateText(t),V.set(e.getComponent(),!o.selection.isEditable())})(t),()=>o.off(i,e))},getApi:o=>({getComponent:T(o),setTooltip:e=>{var t=n.shared.providers.translate(e);A(o.element,"aria-label",t),l.set(e)}}),columns:1,presets:"normal",classes:r.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[yx.config({...n.shared.providers.tooltips.getConfig({tooltipText:n.shared.providers.translate(r.tooltip),onShow:e=>{var t;r.tooltip!==l.get()&&(t=n.shared.providers.translate(l.get()),yx.setComponents(e,n.shared.providers.tooltips.getComponents({tooltipText:t})))}})})]},"tox-tbtn",n.shared,e)},zB=e=>C(e,e=>{let t=e,o=e;e=e.split("=");return 1<e.length&&(t=e[0],o=e[1]),{title:t,format:o}}),VB=e=>({type:"basic",data:e}),LB=((yf=gB=gB||{})[yf.SemiColon=0]="SemiColon",yf[yf.Space=1]="Space",(e,t)=>t===gB.SemiColon?e.replace(/;$/,"").split(";"):e.split(" ")),HB=(e,t,o)=>{e=e.options.get(t);return{type:"basic",data:zB(LB(e,o))}},PB="Align",UB=T("Alignment {0}"),WB="left",jB=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],GB=o=>{var e=VB(jB);return{tooltip:IB(o,UB(),WB),text:D.none(),icon:D.some("align-left"),isSelectedFor:e=>()=>o.formatter.match(e),getCurrentValue:D.none,getPreviewFor:e=>D.none,onAction:t=>()=>Te(jB,e=>e.format===t.format).each(e=>o.execCommand(e.command)),updateText:e=>{var t=Te(jB,e=>o.formatter.match(e.format)).fold(T(WB),e=>e.title.toLowerCase());_(e,d1,{icon:"align-"+t}),US(o,{value:t})},dataset:e,shouldHide:!1,isInvalid:e=>!o.formatter.canApply(e.format)}},$B=(e,t)=>{let o=RB(t,GB(e));e.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate(PB),onSetup:KS(e),getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},YB=(e,t)=>{let o=t();t=C(o,e=>e.format);return D.from(e.formatter.closest(t)).bind(t=>Te(o,e=>e.format===t))},XB="Blocks",qB=T("Block {0}"),KB="Paragraph",JB=o=>{let n=HB(o,"block_formats",gB.SemiColon);return{tooltip:IB(o,qB(),KB),text:D.some(KB),icon:D.none(),isSelectedFor:e=>()=>o.formatter.match(e),getCurrentValue:D.none,getPreviewFor:t=>()=>{var e=o.formatter.get(t);return e?D.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:o.dom.parseStyle(o.formatter.getCssText(t))}):D.none()},onAction:eC(o),updateText:e=>{var t=YB(o,()=>n.data).fold(T(KB),e=>e.title);_(e,c1,{text:t}),GS(o,{value:t})},dataset:n,shouldHide:!1,isInvalid:e=>!o.formatter.canApply(e.format)}},QB=(e,t)=>{let o=RB(t,JB(e));e.ui.registry.addNestedMenuItem("blocks",{text:XB,onSetup:KS(e),getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},ZB="Fonts",eI=T("Font {0}"),tI="System Font",oI=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],nI=e=>{e=e.split(/\s*,\s*/);return C(e,e=>e.replace(/^['"]+|['"]+$/g,""))},rI=(t,e)=>0<e.length&&Me(e,e=>-1<t.indexOf(e.toLowerCase())),aI=(e,t)=>(0===e.indexOf("-apple-system")||0<t.length)&&(e=nI(e.toLowerCase()),rI(e,oI)||rI(e,t)),iI=a=>{let n=()=>{let t=e=>e?nI(e)[0]:"";var e=a.queryCommandValue("FontName"),o=i.data;let n=e?e.toLowerCase():"",r=Nb(a);return{matchOpt:Te(o,e=>{e=e.format;return e.toLowerCase()===n||t(e).toLowerCase()===t(n).toLowerCase()}).orThunk(()=>lt(aI(n,r),{title:tI,format:n})),font:e}};let i=HB(a,"font_family_formats",gB.SemiColon);return{tooltip:IB(a,eI(),tI),text:D.some(tI),icon:D.none(),isSelectedFor:t=>e=>e.exists(e=>e.format===t),getCurrentValue:()=>{var e=n().matchOpt;return e},getPreviewFor:e=>()=>D.some({tag:"div",styles:-1===e.indexOf("dings")?{"font-family":e}:{}}),onAction:e=>()=>{a.undoManager.transact(()=>{a.focus(),a.execCommand("FontName",!1,e.format)})},updateText:e=>{var{matchOpt:t,font:o}=n(),t=t.fold(T(o),e=>e.title);_(e,c1,{text:t}),$S(a,{value:t})},dataset:i,shouldHide:!1,isInvalid:de}},sI=(e,t)=>{let o=RB(t,iI(e));e.ui.registry.addNestedMenuItem("fontfamily",{text:t.shared.providers.translate(ZB),onSetup:KS(e),getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},lI={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},cI=(Bf="[eE][+-]?[0-9]+",Xl=["Infinity",(Xl="[0-9]+")+"\\."+(Nf=e=>`(?:${e})?`)(Xl)+Nf(Bf),"\\."+Xl+Nf(Bf),Xl+Nf(Bf)].join("|"),new RegExp(`^(${`[+-]?(?:${Xl})`})(.*)$`)),dI=(t,e)=>be(e,e=>be(lI[e],e=>t===e)),mI=(e,o)=>D.from(cI.exec(e)).bind(e=>{var t=Number(e[1]),e=e[2];return dI(e,o)?D.some({value:t,unit:e}):D.none()}),uI=(e,t)=>mI(e,t).map(({value:e,unit:t})=>e+t),gI={tab:T(9),escape:T(27),enter:T(13),backspace:T(8),delete:T(46),left:T(37),up:T(38),right:T(39),down:T(40),space:T(32),home:T(36),end:T(35),pageUp:T(33),pageDown:T(34)},pI="Font sizes",hI=T("Font size {0}"),fI="12pt",vI={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},bI={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},xI=(e,t)=>{t=Math.pow(10,t);return Math.round(e*t)/t},yI=(e,t)=>/[0-9.]+px$/.test(e)?xI(72*parseInt(e,10)/96,t||0)+"pt":k(bI,e).getOr(e),wI=e=>k(vI,e).getOr(""),SI=i=>{let n=()=>{let n=D.none();var r=t.data;let a=i.queryCommandValue("FontSize");if(a)for(let e=3;n.isNone()&&0<=e;e--){let t=yI(a,e),o=wI(t);n=Te(r,e=>e.format===a||e.format===t||e.format===o)}return{matchOpt:n,size:a}};var e=T(D.none);let t=HB(i,"font_size_formats",gB.Space);return{tooltip:IB(i,hI(),fI),text:D.some(fI),icon:D.none(),isSelectedFor:t=>e=>e.exists(e=>e.format===t),getPreviewFor:e,getCurrentValue:()=>{var e=n().matchOpt;return e},onAction:e=>()=>{i.undoManager.transact(()=>{i.focus(),i.execCommand("FontSize",!1,e.format)})},updateText:e=>{var{matchOpt:t,size:o}=n(),t=t.fold(T(o),e=>e.title);_(e,c1,{text:t}),WS(i,{value:t})},dataset:t,shouldHide:!1,isInvalid:de}},CI=e=>null!=(e={em:{step:.1},cm:{step:.1},in:{step:.1},pc:{step:.1},ch:{step:.1},rem:{step:.1}}[e])?e:{step:1},kI=16,OI=e=>0<=e,_I=(e,t)=>{let o=RB(t,SI(e));e.ui.registry.addNestedMenuItem("fontsize",{text:pI,onSetup:KS(e),getSubmenuItems:()=>o.items.validateItems(o.getStyleItems())})},TI="Formats",EI=e=>xt(e)?"Formats":"Format {0}",DI=(n,e)=>({tooltip:IB(n,EI(""),""),text:D.some("Formats"),icon:D.none(),isSelectedFor:e=>()=>n.formatter.match(e),getCurrentValue:D.none,getPreviewFor:t=>()=>{var e=n.formatter.get(t);return void 0!==e?D.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):D.none()},onAction:eC(n),updateText:e=>{let t=e=>RD(e)?Ae(e.items,t):ND(e)?[{title:e.title,format:e.format}]:[];var o=Ae(jD(n),t),o=YB(n,T(o)).fold(T({title:"Formats",tooltipLabel:""}),e=>({title:e.title,tooltipLabel:e.title}));_(e,c1,{text:o.title}),PS(n,{value:o.tooltipLabel})},shouldHide:lb(n),isInvalid:e=>!n.formatter.canApply(e.format),dataset:e}),AI=(e,t)=>{var o={type:"advanced",...t.styles};let n=RB(t,DI(e,o));e.ui.registry.addNestedMenuItem("styles",{text:TI,onSetup:KS(e),getSubmenuItems:()=>n.items.validateItems(n.getStyleItems())})},MI=(e0=T([i("toggleClass"),i("fetch"),rc("onExecute"),u("getHotspot",D.some),u("getAnchorOverrides",T({})),Bl(),rc("onItemExecute"),ya("lazySink"),i("dom"),o("onOpen"),Ng("splitDropdownBehaviours",[lk,L,U]),u("matchWidth",!1),u("useMinWidth",!1),u("eventOrder",{}),ya("role"),ya("listRole")].concat(Dw())),Mw=Xp({factory:sx,schema:[i("dom")],name:"arrow",defaults:()=>({buttonBehaviours:R([U.revoke()])}),overrides:t=>({dom:{tag:"span",attributes:{role:"presentation"}},action:e=>{e.getSystem().getByUid(t.uid).each(Ki)},buttonBehaviours:R([h.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])})}),wf=Xp({factory:sx,schema:[i("dom")],name:"button",defaults:()=>({buttonBehaviours:R([U.revoke()])}),overrides:o=>({dom:{tag:"span",attributes:{role:"presentation"}},action:t=>{t.getSystem().getByUid(o.uid).each(e=>{o.onExecute(e,t)})}})}),Qw=T([Mw,wf,qp({factory:{sketch:e=>({uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}})},schema:[i("text")],name:"aria-descriptor"}),Iu({schema:[ec()],name:"menu",defaults:n=>({onExecute:(t,o)=>{t.getSystem().getByUid(n.uid).each(e=>{n.onItemExecute(e,t,o)})}})}),ki()]),Up({name:"SplitDropdown",configFields:e0(),partFields:Qw(),factory:(n,e,t,o)=>{let r=e=>{z.getCurrent(e).each(e=>{Gh.highlightFirst(e),L.focusIn(e)})},a=e=>{var t=r;yk(n,re,e,o,t,vv.HighlightMenuAndItem).get(S)};var i=e=>{e=sh(e,n,"button");return Ki(e),D.some(!0)},s={...ts([ds((o,e)=>{ih(o,n,"aria-descriptor").each(e=>{var t=N("aria");A(e.element,"id",t),A(o.element,"aria-describedby",t)})})]),...wv(D.some(a))};return{uid:n.uid,dom:n.dom,components:e,apis:{repositionMenus:e=>{h.isOn(e)&&Ok(e)}},eventOrder:{...n.eventOrder,[Di()]:["disabling","toggling","alloy.base.behaviour"]},events:s,behaviours:_p(n.splitDropdownBehaviours,[lk.config({others:{sandbox:e=>{let t=sh(e,n,"arrow");var o={onOpen:()=>{h.on(t),h.on(e)},onClose:()=>{h.off(t),h.off(e)}};return kk(n,e,o)}}}),L.config({mode:"special",onSpace:i,onEnter:i,onDown:e=>(a(e),D.some(!0))}),U.config({}),h.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:n.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:(e,t)=>e.repositionMenus(t)}})),BI=t=>({isEnabled:()=>!V.isDisabled(t),setEnabled:e=>V.set(t,!e),setText:e=>_(t,c1,{text:e}),setIcon:e=>_(t,d1,{icon:e})}),II=t=>({setActive:e=>{h.set(t,e)},isActive:()=>h.isOn(t),isEnabled:()=>!V.isDisabled(t),setEnabled:e=>V.set(t,!e),setText:e=>_(t,c1,{text:e}),setIcon:e=>_(t,d1,{icon:e})}),FI=(e,t)=>e.map(e=>({"aria-label":t.translate(e)})).getOr({}),RI=N("focus-button"),NI=(e,t,o,n,r,a,i)=>{let s=t.map(e=>mx(l1(e,"tox-tbtn",r))),l=e.map(e=>mx(s1(e,r.icons)));return{dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]),attributes:{...FI(o,r),...J(i)?{"data-mce-name":i}:{}}},components:P0([l.map(e=>e.asSpec()),s.map(e=>e.asSpec())]),eventOrder:{[si()]:["focusing","alloy.base.behaviour",o1],[Hi()]:[o1,"toolbar-group-button-events"],[Pi()]:[o1,"toolbar-group-button-events","tooltipping"]},buttonBehaviours:R([T0.toolbarButton(()=>r.checkUiComponentContext(a).shouldDisable),V0(()=>r.checkUiComponentContext(a)),P(o1,[ds((e,t)=>r1(e)),F(c1,(t,o)=>{s.bind(e=>e.getOpt(t)).each(e=>{H.set(e,[xd(r.translate(o.event.text))])})}),F(d1,(t,o)=>{l.bind(e=>e.getOpt(t)).each(e=>{H.set(e,[s1(o.event.icon,r.icons)])})}),F(si(),(e,t)=>{t.event.prevent(),b(e,RI)})])].concat(n.getOr([])))}},zI=(t,e,o,n)=>{var r=B(S),n=NI(t.icon,t.text,t.tooltip,D.none(),o,t.context,n);return sx.sketch({dom:n.dom,components:n.components,eventOrder:n1,buttonBehaviours:{...R([P("toolbar-button-events",[t1({onAction:t.onAction,getApi:e.getApi}),D0(e,r),A0(e,r)]),...t.tooltip.map(e=>yx.config(o.tooltips.getConfig({tooltipText:o.translate(e)+t.shortcut.map(e=>` (${j0(e)})`).getOr("")}))).toArray(),T0.toolbarButton(()=>!t.enabled||o.checkUiComponentContext(t.context).shouldDisable),V0(()=>o.checkUiComponentContext(t.context))].concat(e.toolbarButtonBehaviours)),[o1]:null==(r=n.buttonBehaviours)?void 0:r[o1]}})},VI=(e,t,o,n)=>zI(e,{toolbarButtonBehaviours:0<o.length?[P("toolbarButtonWith",o)]:[],getApi:BI,onSetup:e.onSetup},t,n),LI=(e,t,o,n)=>zI(e,{toolbarButtonBehaviours:[H.config({}),h.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<o.length?[P("toolbarToggleButtonWith",o)]:[]),getApi:II,onSetup:e.onSetup},t,n),HI=(t,n,e)=>{let r=B(t.tooltip.getOr("")),o=o=>({isEnabled:()=>!V.isDisabled(o),setEnabled:e=>V.set(o,!e),setIconFill:(e,t)=>{Rd(o.element,`svg path[class="${e}"], rect[class="${e}"]`).each(e=>{A(e,"fill",t)})},setActive:t=>{A(o.element,"aria-pressed",t),Rd(o.element,"span").each(e=>{o.getSystem().getByDom(e).each(e=>h.set(e,t))})},isActive:()=>Rd(o.element,"span").exists(e=>o.getSystem().getByDom(e).exists(h.isOn)),setText:t=>Rd(o.element,"span").each(e=>o.getSystem().getByDom(e).each(e=>_(e,c1,{text:t}))),setIcon:t=>Rd(o.element,"span").each(e=>o.getSystem().getByDom(e).each(e=>_(e,d1,{icon:t}))),setTooltip:e=>{var t=n.providers.translate(e);A(o.element,"aria-label",t),r.set(e)}});var a,i,s,l=B(S),c={getApi:o,onSetup:t.onSetup};return MI.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:{"aria-pressed":!1,...FI(t.tooltip,n.providers),...J(e)?{"data-mce-name":e}:{}}},onExecute:e=>{e=o(e);e.isEnabled()&&t.onAction(e)},onItemExecute:(e,t,o)=>{},splitDropdownBehaviours:R([P("split-dropdown-events",[ds((e,t)=>r1(e)),F(RI,U.focus),D0(c,l),A0(c,l)]),T0.splitButton(()=>n.providers.isDisabled()||n.providers.checkUiComponentContext(t.context).shouldDisable),V0(()=>n.providers.checkUiComponentContext(t.context)),NO.config({}),...t.tooltip.map(o=>yx.config({...n.providers.tooltips.getConfig({tooltipText:n.providers.translate(o),onShow:e=>{var t;r.get()!==o&&(t=n.providers.translate(r.get()),yx.setComponents(e,n.providers.tooltips.getComponents({tooltipText:t})))}})})).toArray()]),eventOrder:{[Hi()]:["alloy.base.behaviour","split-dropdown-events","tooltipping"],[Pi()]:["split-dropdown-events","tooltipping"]},toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:(a=o,i=t,s=n.providers,t=>gk.nu(e=>i.fetch(e)).map(e=>D.from(Lk(vr(YC(N("menu-value"),e,e=>{i.onItemAction(a(t),e)},i.columns,i.presets,_y.CLOSE_ON_EXECUTE,i.select.getOr(de),s),{movement:qC(i.columns,i.presets),menuBehaviours:O0.unnamedEvents("auto"!==i.columns?[]:[ds((o,e)=>{C0(o,4,$y(i.presets)).each(({numRows:e,numColumns:t})=>{L.setGridSize(o,e,t)})})])}))))),parts:{menu:Qy(!1,t.columns,t.presets)},components:[MI.parts.button(NI(t.icon,t.text,D.none(),D.some([h.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1}),T0.toolbarButton(de),V0(T({contextType:"any",shouldDisable:!1}))]),n.providers,t.context)),MI.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:fy("chevron-down",n.providers.icons)},buttonBehaviours:R([T0.splitButton(de),V0(T({contextType:"any",shouldDisable:!1}))])}),MI.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})},PI=[{name:"history",items:["undo","redo"]},{name:"ai",items:["aidialog","aishortcuts"]},{name:"styles",items:["styles"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],UI={button:(Rf=(r,a)=>(e,t,o,n)=>{e=r(e).mapError(e=>sa(e)).getOrDie();return a(e,t,o,n)})(Yw,(e,t,o,n)=>(e=e,t=t.shared.providers,n=n,VI(e,t,[],n))),togglebutton:Rf(Kw,(e,t,o,n)=>(e=e,t=t.shared.providers,n=n,LI(e,t,[],n))),menubutton:Rf(QA,(e,t,o,n)=>J1(e,"tox-tbtn",t,D.none(),!1,n)),splitbutton:Rf(e=>ra("SplitButton",ZA,e),(e,t,o,n)=>HI(e,t.shared,n)),grouptoolbarbutton:Rf(e=>ra("GroupToolbarButton",KA,e),(e,t,o,n)=>{let r=o.ui.registry.getAll().buttons;var a,i,s,l,c,d={[Au]:t.shared.header.isPositionedAtTop()?Bm.TopToBottom:Bm.BottomToTop};if(mb(o)!==Gv.floating)throw new Error("Toolbar groups are only supported when using floating toolbar mode");return a=e,s=e=>XI(o,{buttons:r,toolbar:e,allowToolbarGroups:!1},t,D.none()),e=d,d=n,n=(i=t).shared,l=B(S),c={toolbarButtonBehaviours:[],getApi:BI,onSetup:a.onSetup},c=[P("toolbar-group-button-events",[D0(c,l),A0(c,l)]),...a.tooltip.map(e=>yx.config(i.shared.providers.tooltips.getConfig({tooltipText:i.shared.providers.translate(e)}))).toArray()],PM.sketch({lazySink:n.getSink,fetch:()=>gk.nu(e=>{e(C(s(a.items),KM))}),markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:NI(a.icon,a.text,a.tooltip,D.some(c),n.providers,a.context,d),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:e}}}})})},WI=(t,o,n,r)=>k(UI,t.type).fold(()=>(console.error("skipping button defined by",t),D.none()),e=>D.some(e(t,o,n,r))),jI={styles:(e,t)=>{var o={type:"advanced",...t.styles};return NB(e,t,DI(e,o),EI,"StylesTextUpdate","styles")},fontsize:(e,t)=>NB(e,t,SI(e),hI,"FontSizeTextUpdate","fontsize"),fontsizeinput:(e,t)=>((l,c,d,e)=>{let m=D.none(),u=e=>e.map(e=>w.getValue(e)).getOr("");var t=ZS(l,"NodeChange SwitchMode DisabledStateChange",e=>{e=e.getComponent();m=D.some(e),d.updateInputValue(e),V.set(e,!l.selection.isEditable()||Zv(l))});let g=e=>({getComponent:T(e)});var o=B(S),n=N("custom-number-input-events");let r=(e,o,t)=>{var n=u(m);let r=d.getNewValue(n,e),a=n.length-(""+r).length,i=m.map(e=>e.element.dom.selectionStart-a),s=m.map(e=>e.element.dom.selectionEnd-a);d.onAction(r,t),m.each(t=>{w.setValue(t,r),o&&(i.each(e=>t.element.dom.selectionStart=e),s.each(e=>t.element.dom.selectionEnd=e))})},a=(e,t)=>r((e,t)=>e-t,e,t),i=(e,t)=>r((e,t)=>e+t,e,t);var s=e=>Qt(e.element).fold(D.none,e=>(_m(e),D.some(!0))),p=e=>Em(e.element)?(ro(e.element).each(e=>_m(e)),D.some(!0)):D.none(),h=(o,e,t,n)=>{var r=B(S),t=c.shared.providers.translate(t),a=N("altExecuting"),i=ZS(l,"NodeChange SwitchMode DisabledStateChange",e=>{V.set(e.getComponent(),!l.selection.isEditable()||Zv(l))}),s=e=>{V.isDisabled(e)||o(!0)};return sx.sketch({dom:{tag:"button",attributes:{"aria-label":t,"data-mce-name":e},classes:n.concat(e)},components:[i1(e,c.shared.providers.icons)],buttonBehaviours:R([V.config({}),yx.config(c.shared.providers.tooltips.getConfig({tooltipText:t})),P(a,[D0({onSetup:i,getApi:g},r),A0({getApi:g},r),F(pi(),(e,t)=>{t.event.raw.keyCode!==gI.space()&&t.event.raw.keyCode!==gI.enter()||V.isDisabled(e)||o(!1)}),F(bi(),s),F(ai(),s)])]),eventOrder:{[pi()]:[a,"keying"],[bi()]:[a,"alloy.base.behaviour"],[ai()]:[a,"alloy.base.behaviour"],[Hi()]:["alloy.base.behaviour",a,"tooltipping"],[Pi()]:[a,"tooltipping"]}})};let f=mx(h(e=>a(!1,e),"minus","Decrease font size",[])),v=mx(h(e=>i(!1,e),"plus","Increase font size",[]));h=mx({dom:{tag:"div",classes:["tox-input-wrapper"]},components:[tw.sketch({inputBehaviours:R([V.config({}),P(n,[D0({onSetup:t,getApi:g},o),A0({getApi:g},o)]),P("input-update-display-text",[F(c1,(e,t)=>{w.setValue(e,t.event.text)}),F(gi(),e=>{d.onAction(w.getValue(e))}),F(vi(),e=>{d.onAction(w.getValue(e))})]),L.config({mode:"special",onEnter:e=>(r(re,!0,!0),D.some(!0)),onEscape:s,onUp:e=>(i(!0,!1),D.some(!0)),onDown:e=>(a(!0,!1),D.some(!0)),onLeft:(e,t)=>(t.cut(),D.none()),onRight:(e,t)=>(t.cut(),D.none())})])})],behaviours:R([U.config({}),L.config({mode:"special",onEnter:p,onSpace:p,onEscape:s}),P("input-wrapper-events",[F(mi(),t=>{E([f,v],e=>{e=O.fromDom(e.get(t).element.dom);Em(e)&&Tm(e)})})])])});return{dom:{tag:"div",classes:["tox-number-input"],attributes:{...J(e)?{"data-mce-name":e}:{}}},components:[f.asSpec(),h.asSpec(),v.asSpec()],behaviours:R([U.config({}),L.config({mode:"flow",focusInside:Hp.OnEnterOrSpaceMode,cycles:!1,selector:"button, .tox-input-wrapper",onEscape:e=>Em(e.element)?D.none():(_m(e.element),D.some(!0))})])}})(e,t,(a=>{let i=()=>a.queryCommandValue("FontSize");return{updateInputValue:e=>_(e,c1,{text:i()}),onAction:(e,t)=>a.execCommand("FontSize",!1,e,{skip_focus:!t}),getNewValue:(e,t)=>{mI(e,["unsupportedLength","empty"]);var o=i(),e=mI(e,["unsupportedLength","empty"]).or(mI(o,["unsupportedLength","empty"])),n=e.map(e=>e.value).getOr(kI),r=Sb(a),e=e.map(e=>e.unit).filter(e=>""!==e).getOr(r),r=t(n,CI(e).step),t=""+(OI(r)?r:n)+e;return t!==o&&jS(a,{value:t}),t}}})(e),"fontsizeinput"),fontfamily:(e,t)=>NB(e,t,iI(e),eI,"FontFamilyTextUpdate","fontfamily"),blocks:(e,t)=>NB(e,t,JB(e),qB,"BlocksTextUpdate","blocks"),align:(e,t)=>NB(e,t,GB(e),UB,"AlignTextUpdate","align")},GI=o=>{var e=C(PI,e=>{var t=Ce(e.items,e=>et(o,e)||et(jI,e));return{name:e.name,items:t}});return Ce(e,e=>0<e.items.length)},$I=e=>{e=e.split("|");return C(e,e=>({items:e.trim().split(" ")}))},YI=e=>ee(e,e=>(et(e,"name")||et(e,"label"))&&et(e,"items")),XI=(s,l,c,d)=>{t=(e=l).toolbar,e=l.buttons;var e=!1===t?[]:void 0===t||!0===t?GI(e):y(t)?$I(t):YI(t)?t:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[]),t=C(e,e=>{var t=Ae(e.items,e=>{return 0===e.trim().length?[]:(t=s,o=l.buttons,n=e,r=l.allowToolbarGroups,a=c,i=d,k(o,n.toLowerCase()).orThunk(()=>i.bind(e=>Pe(e,e=>k(o,e+n.toLowerCase())))).fold(()=>k(jI,n.toLowerCase()).map(e=>e(t,a)),e=>"grouptoolbarbutton"!==e.type||r?WI(e,a,t,n.toLowerCase()):(console.warn(`Ignoring the '${n}' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested.`),D.none())).toArray());var t,o,n,r,a,i});return{title:D.from(s.translate(e.name)),label:lt(void 0!==e.label,s.translate(e.label)),items:t}});return Ce(t,e=>0<e.items.length)},qI=(t,e,o,n)=>{var e=e.mainUi.outerContainer,r=o.toolbar;let a=o.buttons;ee(r,y)?(r=r.map(e=>{e={toolbar:e,buttons:a,allowToolbarGroups:o.allowToolbarGroups};return XI(t,e,n,D.none())}),fB.setToolbars(e,r)):fB.setToolbar(e,XI(t,o,n,D.none()))},KI=(zw=On()).os.isiOS()&&zw.os.version.major<=12;var JI=Object.freeze({__proto__:null,render:(o,t,e,n,r)=>{let{mainUi:a,uiMotherships:i}=t,s=B(0),l=a.outerContainer;MB(o);var c,r=O.fromDom(r.targetNode),d=co(lo(r)),r=(ap(r,a.mothership),r=o,d=d,c=t,Jb(r)&&ap(c.mainUi.mothership.element,c.popupUi.mothership),rp(d,c.dialogUi.mothership),o.on("PostRender",()=>{fB.setSidebar(l,e.sidebar,Ib(o))}),o.on("SkinLoaded",()=>{qI(o,t,e,n),s.set(o.getWin().innerWidth),fB.setMenubar(l,wB(o,e)),fB.setViews(l,e.views),((o,e)=>{let t=e.uiMotherships,n=o.dom,r=o.getWin();e=o.getDoc().documentElement;let a=B(Po(r.innerWidth,r.innerHeight)),i=B(Po(e.offsetWidth,e.offsetHeight)),s=()=>{var e=a.get();e.left===r.innerWidth&&e.top===r.innerHeight||(a.set(Po(r.innerWidth,r.innerHeight)),RS(o))};e=()=>{var e=o.getDoc().documentElement,t=i.get();t.left===e.offsetWidth&&t.top===e.offsetHeight||(i.set(Po(e.offsetWidth,e.offsetHeight)),RS(o))};let l=e=>{NS(o,e)},c=(n.bind(r,"resize",s),n.bind(r,"scroll",l),eu(O.fromDom(o.getBody()),"load",e));o.on("hide",()=>{E(t,e=>{M(e.element,"display","none")})}),o.on("show",()=>{E(t,e=>{Ro(e.element,"display")})}),o.on("NodeChange",e),o.on("remove",()=>{c.unbind(),n.unbind(r,"resize",s),n.unbind(r,"scroll",l),r=null})})(o,t)}),fB.getSocket(l).getOrDie("Could not find expected socket element")),d=(KI&&(Eo(r.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),d=((t,o)=>{let n=null;return{cancel:()=>{Y(n)||(clearTimeout(n),n=null)},throttle:(...e)=>{Y(n)&&(n=setTimeout(()=>{n=null,t.apply(null,e)},o))}}})(()=>{o.dispatch("ScrollContent")},20),c=Zm(r.element,"scroll",d.throttle),o.on("remove",c.unbind)),z0(o,t),o.addCommand("ToggleSidebar",(e,t)=>{fB.toggleSidebar(l,t),o.dispatch("ToggleSidebar")}),o.addQueryValueHandler("ToggleSidebar",()=>{var e;return null!=(e=fB.whichSidebar(l))?e:""}),o.addCommand("ToggleView",(e,t)=>{if(fB.toggleView(l,t)){let t=l.element;a.mothership.broadcastOn([hp()],{target:t}),E(i,e=>{e.broadcastOn([hp()],{target:t})}),Y(fB.whichView(l))&&(o.focus(),o.nodeChanged(),fB.refreshToolbar(l)),o.dispatch("ToggleView")}}),o.addQueryValueHandler("ToggleView",()=>{var e;return null!=(e=fB.whichView(l))?e:""}),mb(o));return d!==Gv.sliding&&d!==Gv.floating||o.on("ResizeWindow ResizeEditor ResizeContent",()=>{var e=o.getWin().innerWidth;e!==s.get()&&(fB.refreshToolbar(t.mainUi.outerContainer),s.set(e))}),{iframeContainer:r.element.dom,editorContainer:l.element.dom,api:{setEnabled:e=>{e=e?"setEnabled":"setDisabled";N0(t,e)},isEnabled:()=>!V.isDisabled(l)}}}});let QI=e=>/^[0-9\.]+(|px)$/i.test(""+e)?D.some(parseInt(""+e,10)):D.none(),ZI=e=>Z(e)?e+"px":e,eF=(t,e,o)=>{e=e.filter(e=>t<e),o=o.filter(e=>e<t);return e.or(o).getOr(t)},tF=e=>{var t=eb(e);let o=nb(e),n=ab(e);return QI(t).map(e=>eF(e,o,n))},oF=e=>tF(e).getOr(eb(e)),nF=e=>{var t=tb(e);let o=ob(e),n=rb(e);return QI(t).map(e=>eF(e,o,n))},rF=e=>nF(e).getOr(tb(e)),{ToolbarLocation:aF,ToolbarMode:iF}=Zb,sF=40,lF=(e,t)=>{e=tr(e);return{pos:t?e.y:e.bottom,bounds:e}};var cF=Object.freeze({__proto__:null,render:(t,o,n,r,e)=>{let a=o.mainUi,i=lr(),s=O.fromDom(e.targetNode),l=((c,d,e,t,r)=>{let{mainUi:m,uiMotherships:o}=e,n=Xv.DOM,a=Yb(c),i=Kb(c),s=rb(c).or(nF(c)),l=t.shared.header,u=l.isPositionedAtTop,g=150;e=mb(c);let p=e===iF.sliding||e===iF.floating,h=B(!1),f=()=>h.get()&&!c.removed,v=e=>p?e.fold(T(0),e=>1<e.components().length?Vo(e.components()[1].element):0):0,b=e=>{switch(gb(c)){case aF.auto:var t,o=fB.getToolbar(m.outerContainer),o=v(o),o=Vo(e.element)-o,n=tr(d);return!(n.y>o)&&(t=qt(d),t=Math.max(t.dom.scrollHeight,Vo(t)),n.bottom<t-o||ar().bottom<n.bottom-o)?"bottom":"top";case aF.bottom:return"bottom";default:aF.top;return"top"}},x=o=>{r.on(e=>{lc.setModes(e,[o]),l.setDockingMode(o);var t=u()?Bm.TopToBottom:Bm.BottomToTop;A(e.element,Au,t)})},y=()=>{r.on(e=>{var t=s.getOrThunk(()=>Gn().width-Go(d).left-10);M(e.element,"max-width",t+"px")})},w=(s,l)=>{r.on(n=>{var e=fB.getToolbar(m.outerContainer);let r=v(e),a=tr(d),t=S(c,m.outerContainer.element);let i=t.fold(()=>a.x,e=>{var t=tr(e);return Gt(e,vo())?a.x:a.x-t.x});var e=lt(s,Math.ceil(m.outerContainer.element.dom.getBoundingClientRect().width)).filter(e=>e>g).map(e=>{var t=l.getOr(Pn()),t=window.innerWidth-(i-t.left),o=Math.max(Math.min(e,t),g);return t<e&&M(m.outerContainer.element,"width",o+"px"),{width:o+"px"}}).getOr({width:"max-content"}),o={position:"absolute",left:Math.round(i)+"px",top:t.fold(()=>u()?Math.max(a.y-Vo(n.element)+r,0):a.bottom,e=>{var t=tr(e),o=null!=(o=e.dom.scrollTop)?o:0,e=Gt(e,vo())?Math.max(a.y-Vo(n.element)+r,0):a.y-t.y+o-Vo(n.element)+r;return u()?e:a.bottom})+"px"};Eo(m.outerContainer.element,{...o,...e})})},S=(e,t)=>Jb(e)?Zs(t):D.none(),C=()=>{E(o,e=>{e.broadcastOn([fp()],{})})},k=()=>{if(!a&&(jo(m.outerContainer.element).left+qo(m.outerContainer.element)>=window.innerWidth-sF||Bo(m.outerContainer.element,"width").isSome()))return M(m.outerContainer.element,"position","absolute"),M(m.outerContainer.element,"left","0px"),Ro(m.outerContainer.element,"width"),!0;return!1},O=e=>{if(f()){a||y();var o=Pn(),n=!a&&k();if(p&&fB.refreshToolbar(m.outerContainer),!a){let t=Pn();o=lt(o.left!==t.left,o);w(n,o),o.each(e=>{Un(e.left,t.top)})}i&&r.on(e),C()}},_=()=>!(a||!i||!f())&&r.get().exists(e=>{var t=l.getDockingMode(),e=b(e);return e!==t&&(x(e),!0)});return{isVisible:f,isPositionedAtTop:u,show:()=>{h.set(!0),M(m.outerContainer.element,"display","flex"),n.addClass(c.getBody(),"mce-edit-focus"),E(o,e=>{Ro(e.element,"display")}),_(),Jb(c)?O(e=>lc.isDocked(e)?lc.reset(e):lc.refresh(e)):O(lc.refresh)},hide:()=>{h.set(!1),M(m.outerContainer.element,"display","none"),n.removeClass(c.getBody(),"mce-edit-focus"),E(o,e=>{M(e.element,"display","none")})},update:O,updateMode:()=>{_()&&O(lc.reset)},repositionPopups:C}})(t,s,o,r,i),c=fb(t),d=(BB(t),()=>{var e;i.isSet()?l.show():(i.set(fB.getHeader(a.outerContainer).getOrDie()),e=Xb(t),Jb(t)?(ap(s,a.mothership),ap(s,o.popupUi.mothership)):rp(e,a.mothership),rp(e,o.dialogUi.mothership),e=()=>{qI(t,o,n,r),fB.setMenubar(a.outerContainer,wB(t,n)),l.show(),((a,i,s,e)=>{let l=B(lF(i,s.isPositionedAtTop())),t=e=>{var{pos:t,bounds:o}=lF(i,s.isPositionedAtTop()),{pos:n,bounds:r}=l.get(),r=o.height!==r.height||o.width!==r.width;l.set({pos:t,bounds:o}),r&&RS(a,e),s.isVisible()&&(n!==t?s.update(lc.reset):r&&(s.updateMode(),s.repositionPopups()))},o=(e||(a.on("activate",s.show),a.on("deactivate",s.hide)),a.on("SkinLoaded ResizeWindow",()=>s.update(lc.reset)),a.on("NodeChange keydown",e=>{requestAnimationFrame(()=>t(e))}),0),n=DT(()=>s.update(lc.refresh),33),r=(a.on("ScrollWindow",()=>{var e=Pn().left;e!==o&&(o=e,n.throttle()),s.updateMode()}),Jb(a)&&a.on("ElementScroll",e=>{s.update(lc.refresh)}),sr());r.set(eu(O.fromDom(a.getBody()),"load",e=>t(e.raw))),a.on("remove",()=>{r.clear()})})(t,s,l,c),t.nodeChanged()},c?t.once("SkinLoaded",e):e())});t.on("show",d),t.on("hide",l.hide),c||(t.on("focus",d),t.on("blur",l.hide)),t.on("init",()=>{(t.hasFocus()||c)&&d()}),z0(t,o);e={show:d,hide:l.hide,setEnabled:e=>{e=e?"setEnabled":"setDisabled";N0(o,e)},isEnabled:()=>!V.isDisabled(a.outerContainer)};return{editorContainer:a.outerContainer.element.dom,api:e}}});let dF=()=>{let t=lr(),n=lr(),o=lr();return{dialogUi:t,popupUi:n,mainUi:o,getUiMotherships:()=>{var e=t.get().map(e=>e.mothership);let o=n.get().map(e=>e.mothership);return e.fold(()=>o.toArray(),t=>o.fold(()=>[t],e=>Gt(t.element,e.element)?[t]:[t,e]))},lazyGetInOuterOrDie:(e,t)=>()=>o.get().bind(e=>t(e.outerContainer)).getOrDie(`Could not find ${e} element in OuterContainer`)}},mF="contexttoolbar-show",uF="contexttoolbar-hide",gF=".tox-toolbar-slider__input,.tox-toolbar-textfield",pF=e=>{jv.getContent(e).each(e=>{Rd(e.element,gF).fold(()=>L.focusIn(e),_m)})},hF=e=>Am(e.element).each(e=>{Id(e,'[tabindex="-1"]').each(e=>{_m(e)})}),fF=N("forward-slide"),vF=N("backward-slide"),bF=N("change-slide-event"),xF="tox-pop--resizing",yF=o=>{let n=B([]);return jv.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:e=>{n.set([]),jv.getContent(e).each(e=>{Ro(e.element,"visibility")}),Ps(e.element,xF),Ro(e.element,"width")},onHide:()=>{o.onHide()},inlineBehaviours:R([P("context-toolbar-events",[cs(yi(),(e,t)=>{"width"===t.event.raw.propertyName&&(Ps(e.element,xF),Ro(e.element,"width"))}),F(bF,(t,e)=>{let o=t.element;Ro(o,"width");var n=Xo(o);Ro(o,"left"),Ro(o,"right"),Ro(o,"max-width"),jv.setContent(t,e.event.contents),Ls(o,xF);let r=Xo(o);M(o,"transition","none"),jv.reposition(t),Ro(o,"transition"),M(o,"width",n+"px"),e.event.focus.fold(()=>pF(t),e=>{_m(e),Am(o).isNone()&&pF(t)}),setTimeout(()=>{M(t.element,"width",r+"px")},0)}),F(fF,(t,e)=>{jv.getContent(t).each(e=>{n.set(n.get().concat([{bar:e,focus:Dm(lo(t.element))}]))}),_(t,bF,{contents:e.event.forwardContents,focus:D.none()})}),F(vF,(t,e)=>{o.onBack(),Le(n.get()).each(e=>{n.set(n.get().slice(0,n.get().length-1)),_(t,bF,{contents:Od(e.bar),focus:e.focus})})})]),L.config({mode:"special",onEscape:t=>Le(n.get()).fold(()=>o.onEscape(),e=>(b(t,vF),D.some(!0)))})]),lazySink:()=>I.value(o.sink)})},wF=t=>{let o=lr();return{setInputEnabled:e=>{e||hF(t),V.set(t,!e)},isInputEnabled:()=>!V.isDisabled(t),hide:()=>{o.isSet()||o.set(w.getValue(t)),b(t,Ii())},back:()=>{o.isSet()||o.set(w.getValue(t)),b(t,vF)},getValue:()=>o.get().getOrThunk(()=>w.getValue(t)),setValue:e=>{o.isSet()?o.set(e):w.setValue(t,e)}}},SF=(o,n)=>F(e1,(e,t)=>{e=o.get(e),e=wF(e);n.onAction(e,t.event.buttonApi)}),CF=(e,t,o)=>{let{primary:n,...r}=t.original;var a=aa(Yw({...r,type:"button",onAction:S}));return VI(a,o,[SF(e,t)])},kF=(e,t,o)=>{let{primary:n,...r}=t.original;var a=aa(Kw({...r,type:"togglebutton",onAction:S}));return LI(a,o,[SF(e,t)])},OF=e=>"contextformtogglebutton"===e.type,_F=(e,t,o)=>(OF(t)?kF:CF)(e,t,o),TF=(t,e,o)=>{let n=C(e,e=>mx(_F(t,e,o)));return{asSpecs:()=>C(n,e=>e.asSpec()),findPrimary:o=>Pe(e,(e,t)=>e.primary?D.from(n[t]).bind(e=>e.getOpt(o)).filter(se(V.isDisabled)):D.none())}},EF=(t,e,o)=>{var{width:n,height:r}=t.initValue();return R1({inDialog:!1,label:t.label,enabled:!0,context:D.none(),name:D.none(),width:n,height:r,onEnter:D.some(o),onInput:D.some(e=>t.onInput(wF(e))),onSetup:D.some(t.onSetup),getApi:D.some(wF)},e)},DF=(e,t,o)=>W.sketch({dom:{tag:"div",classes:["tox-context-form__group"]},components:[...e.toArray(),t],fieldBehaviours:R([V.config({disabled:()=>o.checkUiComponentContext("mode:design").shouldDisable,onDisabled:e=>{hF(e),W.getField(e).each(V.disable)},onEnabled:e=>{W.getField(e).each(V.enable)}})])}),AF=(t,o,e)=>{var n=B(S),r=t.label.map(e=>W.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[xd(o.translate(e))]})),e=W.parts.field({factory:tw,type:"range",inputClasses:["tox-toolbar-slider__input"],inputAttributes:{min:String(t.min()),max:String(t.max())},data:t.initValue().toString(),fromInputValue:e=>yt(e).getOr(t.min()),toInputValue:e=>String(e),inputBehaviours:R([V.config({disabled:()=>o.checkUiComponentContext("mode:design").shouldDisable}),V0(()=>o.checkUiComponentContext("mode:design")),L.config({mode:"special",onEnter:e,onLeft:(e,t)=>(t.cut(),D.none()),onRight:(e,t)=>(t.cut(),D.none())}),P("slider-events",[D0({onSetup:t.onSetup,getApi:wF,onBeforeSetup:L.focusIn},n),A0({getApi:wF},n),F(fi(),e=>{t.onInput(wF(e))})])])});return DF(r,e,o)},MF=(t,o,e)=>{var n=B(S),r=t.label.map(e=>W.parts.label({dom:{tag:"label",classes:["tox-label"]},components:[xd(o.translate(e))]})),a={...t.placeholder.map(e=>({placeholder:o.translate(e)})).getOr({})},a=W.parts.field({factory:tw,inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],inputAttributes:a,data:t.initValue(),selectOnFocus:!0,inputBehaviours:R([V.config({disabled:()=>o.checkUiComponentContext("mode:design").shouldDisable}),V0(()=>o.checkUiComponentContext("mode:design")),L.config({mode:"special",onEnter:e,onLeft:(e,t)=>(t.cut(),D.none()),onRight:(e,t)=>(t.cut(),D.none())}),P("input-events",[D0({onSetup:t.onSetup,getApi:wF,onBeforeSetup:L.focusIn},n),A0({getApi:wF},n),F(fi(),e=>{t.onInput(wF(e))})])])});return DF(r,a,o)},BF=(e,t,o)=>{e=mx(e(o,e=>n.findPrimary(e).orThunk(()=>r.findPrimary(e)).map(e=>(Ki(e),!0)))),t=Se(t.commands,e=>"start"===e.align);let n=TF(e,t.pass,o),r=TF(e,t.fail,o);return Ce([{title:D.none(),label:D.none(),items:n.asSpecs()},{title:D.none(),label:D.none(),items:[e.asSpec()]},{title:D.none(),label:D.none(),items:r.asSpecs()}],e=>0<e.items.length)},IF=(e,t)=>{switch(e.type){case"contextform":return BF(ie(MF,e),e,t);case"contextsliderform":return BF(ie(AF,e),e,t);case"contextsizeinputform":return BF(ie(EF,e),e,t)}},FF={renderContextForm:(e,t,o)=>tB({type:e,uid:N("context-toolbar"),initGroups:IF(t,o),onEscape:D.none,cyclicKeying:!0,providers:o}),buildInitGroups:IF},RF=(e,t,o)=>t.bottom-e.y>=o&&e.bottom-t.y>=o,NF=e=>{var t=e.getBoundingClientRect();return t.height<=0&&t.width<=0?(e=io(O.fromDom(e.startContainer),e.startOffset).element,(zt(e)?Jt(e):D.some(e)).filter(Nt).map(e=>e.dom.getBoundingClientRect()).getOr(t)):t},zF=e=>{var t,o=e.selection.getRng(),o=NF(o);return e.inline?(t=Pn(),er(t.left+o.left,t.top+o.top,o.width,o.height)):(t=or(O.fromDom(e.getBody())),er(t.x+o.left,t.y+o.top,o.width,o.height))},VF=(e,t)=>t.filter(e=>fo(e)&&Rt(e)).map(or).getOrThunk(()=>zF(e)),LF=(e,t,o)=>{var n=Math.max(e.x+o,t.x);return{x:n,width:Math.min(e.right-o,t.right)-n}},HF=(e,t,o,n,r,a)=>{var i=O.fromDom(e.getContainer()),s=Rd(i,".tox-editor-header").getOr(i),s=tr(s),l=s.y>=t.bottom,n=n&&!l;return e.inline&&n?{y:Math.max(s.bottom+a,o.y),bottom:o.bottom}:e.inline&&!n?{y:o.y,bottom:Math.min(s.y-a,o.bottom)}:(l="line"===r?tr(i):t,n?{y:Math.max(s.bottom+a,o.y),bottom:Math.min(l.bottom-a,o.bottom)}:{y:Math.max(l.y+a,o.y),bottom:Math.min(s.y-a,o.bottom)})},PF=(e,t,o,n=0)=>{var r=Gn(window),a=tr(O.fromDom(e.getContentAreaContainer())),i=Lb(e)||Ub(e)||jb(e),{x:s,width:l}=LF(a,r,n);return e.inline&&!i?er(s,r.y,l,r.height):(i=t.header.isPositionedAtTop(),{y:t,bottom:e}=HF(e,a,r,i,o,n),er(s,t,l,e-t))},UF=12,WF={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},jF={maxHeightFunction:yu(),maxWidthFunction:NM()},GF=(e,t)=>{var e=e.selection.getRng(),o=io(O.fromDom(e.startContainer),e.startOffset);return e.startContainer===e.endContainer&&e.startOffset===e.endOffset-1&&Gt(o.element,t)},$F=(t,e,o)=>{var n=Bo(t,"position"),e=(M(t,"position",e),o(t));return n.each(e=>M(t,"position",e)),e},YF=e=>"node"===e,XF=(e,t,o,n,r)=>{let a=zF(e);var i=n.lastElement().exists(e=>Gt(o,e));return GF(e,o)?i?vD:uD:i?$F(t,n.getMode(),()=>RF(a,tr(t),-20)&&!n.isReposition()?xD:vD):("fixed"===n.getMode()?r.y+Pn().top:r.y)+(Vo(t)+UF)<=a.y?uD:gD},qF=(i,e,s,t)=>{let o=e=>{return YF(t)?[(a=e,(e,t,o,n,r)=>({...XF(i,n,a,s,r)({...e,y:r.y,height:r.height},t,o,n,r),alwaysFit:!0}))]:[];var a};return e?{onLtr:e=>[fm,mm,um,gm,pm,hm].concat(o(e)),onRtl:e=>[fm,um,mm,pm,gm,hm].concat(o(e))}:{onLtr:e=>[hm,fm,gm,mm,pm,um].concat(o(e)),onRtl:e=>[hm,fm,pm,um,gm,mm].concat(o(e))}},KF=(e,t,o,n)=>"line"===t?{bubble:Ou(UF,0,WF),layouts:{onLtr:()=>[vm],onRtl:()=>[bm]},overrides:jF}:{bubble:Ou(0,UF,WF,1/UF),layouts:qF(e,o,n,t),overrides:jF},JF=(t,e)=>{var e=Ce(e,e=>e.predicate(t.dom)),{pass:e,fail:o}=Se(e,e=>"contexttoolbar"===e.type);return{contextToolbars:e,contextForms:o}},QF=e=>{var t,o,n,r;return e.length<=1?e:(t=t=>Ce(e,e=>e.position===t),o=(n=t=>be(e,e=>e.position===t))("selection"),n=n("node"),o||n?n&&o?(n=t("node"),r=C(t("selection"),e=>({...e,position:"node"})),n.concat(r)):t(o?"selection":"node"):t("line"))},ZF=o=>{if(o.length<=1)return o;{let e=t=>Te(o,e=>e.position===t);return e("selection").orThunk(()=>e("node")).orThunk(()=>e("line")).map(e=>e.position).fold(()=>[],t=>Ce(o,e=>e.position===t))}},eR=(e,t,o)=>{var t=JF(e,t);return 0<t.contextForms.length?D.some({elem:e,toolbars:[t.contextForms[0]]}):0<(o=JF(e,o)).contextForms.length?D.some({elem:e,toolbars:[o.contextForms[0]]}):0<t.contextToolbars.length||0<o.contextToolbars.length?(t=QF(t.contextToolbars.concat(o.contextToolbars)),D.some({elem:e,toolbars:t})):D.none()},tR=(e,t,n)=>e(t)?D.none():Xa(t,e=>{var t,o;return Nt(e)&&({contextToolbars:t,contextForms:o}=JF(e,n.inNodeScope),0<(o=0<o.length?o:ZF(t)).length)?D.some({elem:e,toolbars:o}):D.none()},e),oR=(e,t)=>{let o=O.fromDom(t.getBody()),n=e=>Gt(e,o);let r=O.fromDom(t.selection.getNode());return t=r,n(t)||$t(o,t)?eR(r,e.inNodeScope,e.inEditorScope).orThunk(()=>tR(n,r,e)):D.none()},nR=(r,a)=>{let i={},s=[],l=[],c={},d={};var e=Ue(r);return E(e,e=>{var t,o,n=r[e];"contextform"===n.type||"contextsliderform"===n.type||"contextsizeinputform"===n.type?((t,o)=>{let n=aa(o0(o));(i[t]=n).launch.map(e=>{c["form:"+t]={...o.launch,type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:()=>{a(n)}}}),("editor"===n.scope?l:s).push(n),d[t]=n})(e,n):"contexttoolbar"===n.type&&(t=e,o=n,i0(o).each(e=>{("editor"===o.scope?l:s).push(e),d[t]=e}))}),{forms:i,inNodeScope:s,inEditorScope:l,lookupTable:d,formNavigators:c}},rR="tox-pop--transition",aR=(a,e,i,r)=>{let t=r.backstage,s=t.shared,l=On().deviceType.isTouch,c=lr(),d=lr(),m=lr(),u=kd(yF({sink:i,onEscape:()=>(a.focus(),YS(a),D.some(!0)),onHide:()=>{YS(a)},onBack:()=>{XS(a)}})),g=()=>{var e=m.get().getOr("node"),t=YF(e)?1:0;return PF(a,s,e,t)},p=()=>!(a.removed||l()&&t.isContextMenuOpen()),h=()=>{var e,t;return!p()||(e=g(),t=ot(m.get(),"node")?VF(a,c.get()):zF(a),e.height<=0)||!RF(t,e,.01)},o=()=>{c.clear(),d.clear(),m.clear(),jv.hide(u)},n=()=>{var e;jv.isOpen(u)&&(e=u.element,Ro(e,"display"),h()?M(e,"display","none"):(d.set(0),jv.reposition(u)))},f=e=>({dom:{tag:"div",classes:["tox-pop__dialog"]},components:[e],behaviours:R([L.config({mode:"acyclic"}),P("pop-dialog-wrap-events",[ds(e=>{a.shortcuts.add("ctrl+F9","focus statusbar",()=>L.focusIn(e))}),ms(e=>{a.shortcuts.remove("ctrl+F9")})])])}),v=Ko(()=>nR(e,e=>{e=b([e]);_(u,fF,{forwardContents:f(e)})})),b=e=>{var t=a.ui.registry.getAll().buttons,o=v();let n={...t,...o.formNavigators};t=mb(a)===Gv.scrolling?Gv.scrolling:Gv.default,o=De(C(e,e=>{return"contexttoolbar"===e.type?(t=n,o=a0(e),XI(a,{buttons:t,toolbar:o.items,allowToolbarGroups:!1},r.backstage,D.some(["form:"]))):(t=e,o=s.providers,FF.buildInitGroups(t,o));var t,o}));return tB({type:t,uid:N("context-toolbar"),initGroups:o,onEscape:D.none,cyclicKeying:!0,providers:s.providers})},x=(e,t)=>{var o,n,r;w.cancel(),p()&&(o=b(e),n=((e,t)=>{t="node"===e?s.anchors.node(t):s.anchors.cursor(),e=KF(a,e,l(),{lastElement:c.get,isReposition:()=>ot(d.get(),0),getMode:()=>Wg.getMode(i)});return vr(t,e)})(e=e[0].position,t),m.set(e),d.set(1),e=u.element,Ro(e,"display"),r=t,ot(at(r,c.get(),Gt),!0)||(Ps(e,rR),Wg.reset(i,u)),jv.showWithinBounds(u,f(o),{anchor:n,transition:{classes:[rR],mode:"placement"}},()=>D.some(g())),t.fold(c.clear,c.set),h())&&M(e,"display","none")},y=!1,w=DT(()=>{var e;!a.hasFocus()||a.removed||y||(Ws(u.element,rR)?w.throttle():(e=v(),oR(e,a).fold(o,e=>{x(e.toolbars,D.some(e.elem))})))},17);a.on("init",()=>{a.on("remove",o),a.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",n),a.on("click keyup focus SetContent",w.throttle),a.on(uF,o),a.on(mF,t=>{var e=v();k(e.lookupTable,t.toolbarKey).each(e=>{x([e],lt(t.target!==a,t.target)),pF(u)})}),a.on("focusout",e=>{Yv.setEditorTimeout(a,()=>{Am(i.element).isNone()&&Am(u.element).isNone()&&o()},0)}),a.on("SwitchMode",()=>{a.mode.isReadOnly()&&o()}),a.on("DisabledStateChange",e=>{e.state&&o()}),a.on("ExecCommand",({command:e})=>{"toggleview"===e.toLowerCase()&&o()}),a.on("AfterProgressState",e=>{e.state?o():a.hasFocus()&&w.throttle()}),a.on("dragstart",()=>{y=!0}),a.on("dragend drop",()=>{y=!1}),a.on("NodeChange",e=>{Am(u.element).fold(w.throttle,S)})})},iR=t=>{E([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],e=>{t.ui.registry.addToggleButton(e.name,{tooltip:e.text,icon:e.icon,onAction:tC(t,e.cmd),onSetup:QS(t,e.name)})}),t.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onSetup:KS(t),onAction:tC(t,"JustifyNone")})},sR=(i,s)=>{let t=()=>{var e=s.getOptions(i);let r=s.getCurrent(i).map(s.hash),a=lr();return C(e,n=>({type:"togglemenuitem",text:s.display(n),onSetup:t=>{var e=e=>{e&&(a.on(e=>e.setActive(!1)),a.set(t)),t.setActive(e)};e(ot(r,s.hash(n)));let o=s.watcher(i,n,e);return()=>{a.clear(),o()}},onAction:()=>s.setCurrent(i,n)}))};i.ui.registry.addMenuButton(s.name,{tooltip:s.text,icon:s.icon,fetch:e=>e(t()),onSetup:s.onToolbarSetup}),i.ui.registry.addNestedMenuItem(s.name,{type:"nestedmenuitem",text:s.text,getSubmenuItems:t,onSetup:s.onMenuSetup})},lR=e=>({name:"lineheight",text:"Line height",icon:"line-height",getOptions:Pb,hash:e=>uI(e,["fixed","relative","empty"]).getOr(e),display:re,watcher:(e,t,o)=>e.formatter.formatChanged("lineheight",o,!1,{value:t}).unbind,getCurrent:e=>D.from(e.queryCommandValue("LineHeight")),setCurrent:(e,t)=>e.execCommand("LineHeight",!1,t),onToolbarSetup:KS(e),onMenuSetup:KS(e)}),cR=o=>D.from(cb(o)).map(e=>({name:"language",text:"Language",icon:"language",getOptions:T(e),hash:e=>q(e.customCode)?e.code:e.code+"/"+e.customCode,display:e=>e.title,watcher:(e,t,o)=>e.formatter.formatChanged("lang",o,!1,{value:t.code,customValue:null!=(e=t.customCode)?e:null}).unbind,getCurrent:e=>{e=O.fromDom(e.selection.getNode());return qa(e,e=>D.some(e).filter(Nt).bind(t=>So(t,"lang").map(e=>({code:e,customCode:So(t,"data-mce-lang").getOrUndefined(),title:""}))))},setCurrent:(e,t)=>e.execCommand("Lang",!1,t),onToolbarSetup:e=>{var t=sr();return e.setActive(o.formatter.match("lang",{},void 0,!0)),t.set(o.formatter.formatChanged("lang",e.setActive,!0)),qS(t.clear,KS(o)(e))},onMenuSetup:KS(o)})),dR=t=>{sR(t,lR(t)),cR(t).each(e=>sR(t,e))},mR=(e,t)=>{$B(e,t),sI(e,t),AI(e,t),QB(e,t),_I(e,t)},uR=t=>{t.ui.registry.addContext("editable",()=>t.selection.isEditable()),t.ui.registry.addContext("mode",e=>t.mode.get()===e),t.ui.registry.addContext("any",me),t.ui.registry.addContext("formatting",e=>t.formatter.canApply(e)),t.ui.registry.addContext("insert",e=>t.schema.isValidChild(t.selection.getNode().tagName,e))},gR=t=>ZS(t,"NodeChange",e=>{e.setEnabled(t.queryCommandState("outdent")&&t.selection.isEditable())}),pR=e=>{e.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:gR(e),onAction:tC(e,"outdent")}),e.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onSetup:KS(e),onAction:tC(e,"indent")})},hR=e=>{pR(e)},fR=(o,n)=>t=>{t.setActive(n.get());let e=e=>{n.set(e.state),t.setActive(e.state)};return o.on("PastePlainTextToggle",e),qS(()=>o.off("PastePlainTextToggle",e),KS(o)(t))},vR=e=>{var t=B(Bb(e)),o=()=>e.execCommand("mceTogglePlainTextPaste");e.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:o,onSetup:fR(e,t)}),e.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:o,onSetup:fR(e,t)})},bR=(e,t)=>()=>{e.execCommand("mceToggleFormat",!1,t)},xR=o=>{_T.each([{name:"bold",text:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(e,t)=>{o.ui.registry.addToggleButton(e.name,{tooltip:e.text,icon:e.icon,onSetup:QS(o,e.name),onAction:bR(o,e.name),shortcut:e.shortcut})});for(let e=1;e<=6;e++){var t="h"+e,n="Access+"+e;o.ui.registry.addToggleButton(t,{text:t.toUpperCase(),tooltip:"Heading "+e,onSetup:QS(o,t),onAction:bR(o,t),shortcut:n})}},yR=t=>{_T.each([{name:"copy",text:"Copy",action:"Copy",icon:"copy",context:"any"},{name:"help",text:"Help",action:"mceHelp",icon:"help",shortcut:"Alt+0",context:"any"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A",context:"any"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"print",text:"Print",action:"mcePrint",icon:"print",shortcut:"Meta+P",context:"any"}],e=>{t.ui.registry.addButton(e.name,{tooltip:e.text,icon:e.icon,onAction:tC(t,e.action),shortcut:e.shortcut,context:e.context})}),_T.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],e=>{t.ui.registry.addButton(e.name,{tooltip:e.text,icon:e.icon,onSetup:KS(t),onAction:tC(t,e.action)})})},wR=t=>{_T.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],e=>{t.ui.registry.addToggleButton(e.name,{tooltip:e.text,icon:e.icon,onAction:tC(t,e.action),onSetup:QS(t,e.name)})})},SR=e=>{xR(e),yR(e),wR(e)},CR=t=>{_T.each([{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C",context:"any"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A",context:"any"},{name:"print",text:"Print...",action:"mcePrint",icon:"print",shortcut:"Meta+P",context:"any"}],e=>{t.ui.registry.addMenuItem(e.name,{text:e.text,icon:e.icon,shortcut:e.shortcut,onAction:tC(t,e.action),context:e.context})}),_T.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"hr",text:"Horizontal line",action:"InsertHorizontalRule",icon:"horizontal-rule"}],e=>{t.ui.registry.addMenuItem(e.name,{text:e.text,icon:e.icon,shortcut:e.shortcut,onSetup:KS(t),onAction:tC(t,e.action)})}),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onSetup:KS(t),onAction:bR(t,"code")})},kR=e=>{SR(e),CR(e)},OR=(t,o)=>ZS(t,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",e=>{e.setEnabled(!t.mode.isReadOnly()&&t.undoManager[o]())}),_R=e=>{e.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:OR(e,"hasUndo"),onAction:tC(e,"undo")}),e.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:OR(e,"hasRedo"),onAction:tC(e,"redo")})},TR=e=>{e.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",enabled:!1,onSetup:OR(e,"hasUndo"),onAction:tC(e,"undo"),shortcut:"Meta+Z"}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",enabled:!1,onSetup:OR(e,"hasRedo"),onAction:tC(e,"redo"),shortcut:"Meta+Y"})},ER=e=>{_R(e),TR(e)},DR=t=>ZS(t,"VisualAid",e=>{e.setActive(t.hasVisual)}),AR=e=>{e.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:DR(e),onAction:tC(e,"mceToggleVisualAid"),context:"any"})},MR=e=>{e.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:tC(e,"mceToggleVisualAid"),context:"any"})},BR=e=>{MR(e),AR(e)},IR=(e,t)=>{iR(e),kR(e),mR(e,t),ER(e),$C(e),BR(e),hR(e),dR(e),vR(e),uR(e)},FR=e=>y(e)?e.split(/[ ,]/):e,RR=e=>{e=e.options.register;e("contextmenu_avoid_overlap",{processor:"string",default:""}),e("contextmenu_never_use_native",{processor:"boolean",default:!1}),e("contextmenu",{processor:e=>!1===e?{value:[],valid:!0}:y(e)||ee(e,y)?{value:FR(e),valid:!0}:{valid:!1,message:"Must be false or a string."},default:"link linkchecker image editimage table spellchecker configurepermanentpen"})},NR=(Vw=t=>e=>e.options.get(t))("contextmenu_never_use_native"),zR=Vw("contextmenu_avoid_overlap"),VR=e=>0===LR(e).length,LR=e=>{let t=e.ui.registry.getAll().contextMenus;var o=e.options.get("contextmenu");return e.options.isSet("contextmenu")?o:Ce(o,e=>et(t,e))},HR=(e,t)=>({type:"makeshift",x:e,y:t}),PR=(e,t,o)=>HR(e.x+t,e.y+o),UR=e=>"longpress"===e.type||0===e.type.indexOf("touch"),WR=e=>{var t;return UR(e)?(t=e.touches[0],HR(t.pageX,t.pageY)):HR(e.pageX,e.pageY)},jR=e=>{var t;return UR(e)?(t=e.touches[0],HR(t.clientX,t.clientY)):HR(e.clientX,e.clientY)},GR=(e,t)=>{e=Xv.DOM.getPos(e);return PR(t,e.x,e.y)},$R=(e,t)=>"contextmenu"===t.type||"longpress"===t.type?e.inline?WR(t):GR(e.getContentAreaContainer(),jR(t)):YR(e),YR=e=>({type:"selection",root:O.fromDom(e.selection.getNode())}),XR=e=>({type:"node",node:D.some(O.fromDom(e.selection.getNode())),root:O.fromDom(e.getBody())}),qR=(e,t,o)=>{switch(o){case"node":return XR(e);case"point":return $R(e,t);case"selection":return YR(e)}},KR=(e,t,o,n,r,a)=>{o=o();let i=qR(e,t,a);S1(o,_y.CLOSE_ON_EXECUTE,n,{isHorizontalMenu:!1,search:D.none()}).map(e=>{t.preventDefault(),jv.showMenuAt(r,{anchor:i},{menu:{markers:qy("normal")},data:e})})},JR={onLtr:()=>[fm,mm,um,gm,pm,hm,uD,gD,mD,cD,dD,lD],onRtl:()=>[fm,um,mm,pm,gm,hm,uD,gD,dD,lD,mD,cD]},QR=12,ZR={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},eN=(e,o)=>{var n=e.selection;if(n.isCollapsed()||o.touches.length<1)return!1;{let t=o.touches[0];o=n.getRng();return vg(e.getWin(),qu.domRange(o)).exists(e=>e.left<=t.clientX&&e.right>=t.clientX&&e.top<=t.clientY&&e.bottom>=t.clientY)}},tN=e=>{let t=e.selection.getRng(),o=()=>{Yv.setEditorTimeout(e,()=>{e.selection.setRng(t)},10),a()},n=(e.once("touchend",o),e=>{e.preventDefault(),e.stopImmediatePropagation()}),r=(e.on("mousedown",n,!0),()=>a()),a=(e.once("longpresscancel",r),()=>{e.off("touchend",o),e.off("longpresscancel",r),e.off("mousedown",n)})},oN=(e,t,o)=>{e=qR(e,t,o),t="point"===o?QR:0;return{bubble:Ou(0,t,ZR),layouts:JR,overrides:{maxWidthFunction:NM(),maxHeightFunction:yu()},...e}},nN=(o,n,e,r,a,i,s)=>{let l=oN(o,n,i);S1(e,_y.CLOSE_ON_EXECUTE,r,{isHorizontalMenu:!0,search:D.none()}).map(e=>{n.preventDefault();var t=s?vv.HighlightMenuAndItem:vv.HighlightNone;jv.showMenuWithinBounds(a,{anchor:l},{menu:{markers:qy("normal"),highlightOnOpen:t},data:e,type:"horizontal"},()=>D.some(PF(o,r.shared,"node"===i?"node":"selection"))),o.dispatch(uF)})},rN=(t,o,n,r,a,i)=>{var e=On();let s=e.os.isiOS(),l=e.os.isMacOS(),c=e.os.isAndroid(),d=e.deviceType.isTouch(),m=()=>!(c||s||l&&d),u=()=>{var e=n();nN(t,o,e,r,a,i,m())};if((l||s)&&"node"!==i){let e=()=>{tN(t),u()};eN(t,o)?e():(t.once("selectionchange",e),t.once("touchend",()=>t.off("selectionchange",e)))}else u()},aN=e=>y(e)?"|"===e:"separator"===e.type,iN={type:"separator"},sN=t=>{var e=e=>({text:e.text,icon:e.icon,enabled:e.enabled,shortcut:e.shortcut});if(y(t))return t;switch(t.type){case"separator":return iN;case"submenu":return{type:"nestedmenuitem",...e(t),getSubmenuItems:()=>{var e=t.getSubmenuItems();return y(e)?e:C(e,sN)}};default:var o=t;return{type:"menuitem",...e(o),onAction:te(o.onAction)}}},lN=(e,t)=>{var o;return 0===t.length?e:(o=Le(e).filter(e=>!aN(e)).fold(()=>[],e=>[iN]),e.concat(o).concat(t).concat([iN]))},cN=(o,e,n)=>{e=Oe(e,(t,e)=>k(o,e.toLowerCase()).map(e=>{var e=e.update(n);return y(e)&&bt(vt(e))?lN(t,e.split(" ")):$(e)&&0<e.length?(e=C(e,sN),lN(t,e)):t}).getOrThunk(()=>t.concat([e])),[]);return 0<e.length&&aN(e[e.length-1])&&e.pop(),e},dN=(e,t)=>t.ctrlKey&&!NR(e),mN=e=>"longpress"===e.type||et(e,"touches"),uN=(e,t)=>!mN(t)&&(2!==t.button||t.target===e.getBody()&&""===t.pointerType),gN=(e,t)=>uN(e,t)?e.selection.getStart(!0):t.target,pN=(e,t)=>{var o=zR(e),n=uN(e,t)?"selection":"point";return bt(o)&&(e=gN(e,t),Uk(O.fromDom(e),o))?"node":n},hN=(r,e,t)=>{let o=On().deviceType.isTouch,a=kd(jv.sketch({dom:{tag:"div"},lazySink:e,onEscape:()=>r.focus(),onShow:()=>t.setContextMenuState(!0),onHide:()=>t.setContextMenuState(!1),fireDismissalEventInstead:{},inlineBehaviours:R([P("dismissContextMenu",[F(Ui(),(e,t)=>{d.close(e),r.focus()})])])})),n=()=>jv.hide(a),i=n=>{var e;NR(r)&&n.preventDefault(),dN(r,n)||VR(r)||(e=pN(r,n),(o()?rN:KR)(r,n,()=>{var e=gN(r,n),t=r.ui.registry.getAll(),o=LR(r);return cN(t.contextMenus,o,e)},t,a,e))};r.on("init",()=>{var e="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");r.on(e,n),r.on("longpress contextmenu",i)})},fN=(Jw=za([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),t=>e=>e.translate(-t.left,-t.top)),vN=t=>e=>e.translate(t.left,t.top),bN=o=>(e,t)=>Oe(o,(e,t)=>t(e),Po(e,t)),xN=(e,t,o)=>e.fold(bN([vN(o),fN(t)]),bN([fN(t)]),bN([])),yN=(e,t,o)=>e.fold(bN([vN(o)]),bN([]),bN([vN(t)])),wN=(e,t,o)=>e.fold(bN([]),bN([fN(o)]),bN([vN(t),fN(o)])),SN=(e,t,o,n,r,a)=>{e=yN(e,r,a),t=yN(t,r,a);return Math.abs(e.left-t.left)<=o&&Math.abs(e.top-t.top)<=n},CN=(e,t,o,n,r,a)=>{e=yN(e,r,a),t=yN(t,r,a),r=Math.abs(e.left-t.left),a=Math.abs(e.top-t.top);return Po(r,a)},kN=(e,t,o)=>{e=e.fold((e,t)=>({position:D.some("absolute"),left:D.some(e+"px"),top:D.some(t+"px")}),(e,t)=>({position:D.some("absolute"),left:D.some(e-o.left+"px"),top:D.some(t-o.top+"px")}),(e,t)=>({position:D.some("fixed"),left:D.some(e+"px"),top:D.some(t+"px")}));return{right:D.none(),bottom:D.none(),...e}},ON=(e,o,n)=>e.fold((e,t)=>TN(e+o,t+n),(e,t)=>EN(e+o,t+n),(e,t)=>DN(e+o,t+n)),_N=(e,a,i,s)=>{var t=(n,r)=>(e,t)=>{var o=n(a,i,s);return r(e.getOr(o.left),t.getOr(o.top))};return e.fold(t(wN,TN),t(yN,EN),t(xN,DN))},TN=Jw.offset,EN=Jw.absolute,DN=Jw.fixed,AN=(e,t)=>{e=wo(e,t);return q(e)?NaN:parseInt(e,10)},MN=(e,t)=>{var e=e.element,o=AN(e,t.leftAttr),e=AN(e,t.topAttr);return isNaN(o)||isNaN(e)?D.none():D.some(Po(o,e))},BN=(e,t,o)=>{e=e.element;A(e,t.leftAttr,o.left+"px"),A(e,t.topAttr,o.top+"px")},IN=(e,t)=>{e=e.element;ko(e,t.leftAttr),ko(e,t.topAttr)},FN=(e,t,o,n)=>MN(e,t).fold(()=>o,e=>DN(e.left+n.left,e.top+n.top)),RN=(e,t,o,n,r,a)=>{o=FN(e,t,o,n),n=(t.mustSnap?VN:LN)(e,t,o,r,a);let i=xN(o,r,a);return BN(e,t,i),n.fold(()=>({coord:DN(i.left,i.top),extra:D.none()}),e=>({coord:e.output,extra:e.extra}))},NN=(e,t)=>{IN(e,t)},zN=(e,o,n,r)=>Pe(e,e=>{var t=e.sensor;return SN(o,t,e.range.left,e.range.top,n,r)?D.some({output:_N(e.output,o,n,r),extra:e.extra}):D.none()}),VN=(e,t,r,a,i)=>{let o=t.getSnapPoints(e);return zN(o,r,a,i).orThunk(()=>Oe(o,(t,o)=>{var e=o.sensor;let n=CN(r,e,o.range.left,o.range.top,a,i);return t.deltas.fold(()=>({deltas:D.some(n),snap:D.some(o)}),e=>(n.left+n.top)/2<=(e.left+e.top)/2?{deltas:D.some(n),snap:D.some(o)}:t)},{deltas:D.none(),snap:D.none()}).snap.map(e=>({output:_N(e.output,r,a,i),extra:e.extra})))},LN=(e,t,o,n,r)=>{t=t.getSnapPoints(e);return zN(t,o,n,r)},HN=(Gw=Object.freeze({__proto__:null,snapTo:(e,t,o,n)=>{var r,a,i=t.getTarget(e.element);t.repositionTarget&&(t=Yt(e.element),e=Pn(t),t=el(i),n=n,r=e,a=t,r={coord:_N(n.output,n.output,r,a),extra:n.extra},a=kN(r.coord,e,t),Do(i,a))}}),"data-initial-z-index"),PN=e=>{Jt(e.element).filter(Nt).each(t=>{So(t,HN).fold(()=>Ro(t,"z-index"),e=>M(t,"z-index",e)),ko(t,HN)})},UN=e=>{Jt(e.element).filter(Nt).each(t=>{Bo(t,"z-index").each(e=>{A(t,HN,e)}),M(t,"z-index",Ao(e.element,"z-index"))})},WN=(e,t)=>{e.getSystem().addToGui(t),UN(t)},jN=e=>{PN(e),e.getSystem().removeFromGui(e)},GN=(e,t,o)=>e.getSystem().build(mO.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:o})),$N=Ta("snaps",[i("getSnapPoints"),o("onSensor"),i("leftAttr"),i("topAttr"),u("lazyViewport",ar),u("mustSnap",!1)]),YN=(Zw=[u("useFixed",de),i("blockerClass"),u("getTarget",re),u("onDrag",S),u("repositionTarget",!0),u("onDrop",S),Fa("getBounds",ar),$N],t=>it(Bo(t,"left"),Bo(t,"top"),Bo(t,"position"),(e,t,o)=>("fixed"===o?DN:TN)(parseInt(e,10),parseInt(t,10))).getOrThunk(()=>{var e=jo(t);return EN(e.left,e.top)})),XN=(e,t,o,n,r)=>{var a=r.bounds,i=yN(t,o,n),s=mc(i.left,a.x,a.x+a.width-r.width),i=mc(i.top,a.y,a.y+a.height-r.height);let l=EN(s,i);return t.fold(()=>{var e=wN(l,o,n);return TN(e.left,e.top)},T(l),()=>{var e=xN(l,o,n);return DN(e.left,e.top)})},qN=(o,e,n,r,a,i,t)=>{e=e.fold(()=>{var e=ON(n,i.left,i.top),e=xN(e,r,a);return DN(e.left,e.top)},t=>{var e=RN(o,t,n,i,r,a);return e.extra.each(e=>{t.onSensor(o,e)}),e.coord});return XN(o,e,r,a,t)},KN=(e,t,o,n)=>{var r,a,i,s=t.getTarget(e.element);t.repositionTarget&&(r=Yt(e.element),r=Pn(r),a=el(s),i=YN(s),i=qN(e,t.snaps,i,r,a,n,o),o=kN(i,r,a),Do(s,o)),t.onDrag(e,s,n)},JN=(e,t)=>({bounds:e.getBounds(),height:Lo(t.element),width:qo(t.element)}),QN=(t,o,e,n,r)=>{n=e.update(n,r);let a=e.getStartData().getOrThunk(()=>JN(o,t));n.each(e=>{KN(t,o,a,e)})},ZN=(t,e,o,n)=>{e.each(jN),o.snaps.each(e=>{NN(t,e)});e=o.getTarget(t.element);n.reset(),o.onDrop(t,e)};hB=e=>(t,o)=>{let n=e=>{o.setStartData(JN(t,e))};return ts([F(Vi(),e=>{o.getStartData().each(()=>n(e))}),...e(t,o,n)])};var ez=Object.freeze({__proto__:null,getData:e=>D.from(Po(e.x,e.y)),getDelta:(e,t)=>Po(t.left-e.left,t.top-e.top)});let tz=(a,i,s)=>[F(si(),(t,e)=>{if(0!==e.event.raw.button)return;e.stop();e=()=>ZN(t,D.some(r),a,i);let o=Wk(e,200);var n,e={drop:e,delayDrop:o.schedule,forceDrop:e,move:e=>{o.cancel(),QN(t,a,i,ez,e)}};let r=GN(t,a.blockerClass,(n=e,ts([F(si(),n.forceDrop),F(di(),n.drop),F(li(),(e,t)=>{n.move(t.event)}),F(ci(),n.delayDrop)])));s(t),WN(t,r)})];r=[...Zw,ic("dragger",{handlers:hB(tz)})];var oz=Object.freeze({__proto__:null,getData:e=>{e=e.raw.touches;return 1===e.length?(e=>{e=e[0];return D.some(Po(e.clientX,e.clientY))})(e):D.none()},getDelta:(e,t)=>Po(t.left-e.left,t.top-e.top)});let nz=(r,a,i)=>{let s=lr(),l=e=>{ZN(e,s.get(),r,a),s.clear()};return[F(ni(),(t,e)=>{e.stop();var o,e=()=>l(t),e={drop:e,delayDrop:S,forceDrop:e,move:e=>{QN(t,r,a,oz,e)}};let n=GN(t,r.blockerClass,(o=e,ts([F(ni(),o.forceDrop),F(ai(),o.drop),F(ii(),o.drop),F(ri(),(e,t)=>{o.move(t.event)})])));s.set(n);i(t),WN(t,n)}),F(ri(),(e,t)=>{t.stop(),QN(e,r,a,oz,t.event)}),F(ai(),(e,t)=>{t.stop(),l(e)}),F(ii(),l)]},rz=(Aw=[...Zw,ic("dragger",{handlers:hB(nz)})],yf=[...Zw,ic("dragger",{handlers:hB((e,t,o)=>[...tz(e,t,o),...nz(e,t,o)])})],e({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:r,touch:Aw,mouseOrTouch:yf}),name:"dragging",active:{events:(e,t)=>e.dragger.handlers(e,t)},extra:{snap:e=>({sensor:e.sensor,range:e.range,output:e.output,extra:D.from(e.extra)})},state:Object.freeze({__proto__:null,init:()=>{let r=D.none(),t=D.none();var e=T({});return _s({readState:e,reset:()=>{r=D.none(),t=D.none()},update:(n,e)=>n.getData(e).bind(e=>{return t=n,o=e,e=r.map(e=>t.getDelta(e,o)),r=D.some(o),e;var t,o}),getStartData:()=>t,setStartData:e=>{t=D.some(e)}})}}),apis:Gw})),az=40,iz=az/2,sz=(e,a,i,s,t,o)=>e.fold(()=>rz.snap({sensor:EN(i-iz,s-iz),range:Po(t,o),output:EN(D.some(i),D.some(s)),extra:{td:a}}),e=>{var t=i-iz,o=s-iz,n=az,r=az,e=e.element.dom.getBoundingClientRect();return rz.snap({sensor:EN(t,o),range:Po(n,r),output:EN(D.some(i-e.width/2),D.some(s-e.height/2)),extra:{td:a}})}),lz=(e,r,a)=>({getSnapPoints:e,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:(e,t)=>{var o,n,t=t.td;o=r.get(),n=t,o.exists(e=>Gt(e,n))||(r.set(t),a(t))},mustSnap:!0}),cz=e=>mx(sx.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:R([rz.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:e}),NO.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}})),dz=(a,r)=>{let i=B([]),s=B([]),l=B(!1),c=lr(),d=lr(),t=e=>{var t=or(e);return sz(m.getOpt(r),e,t.x,t.y,t.width,t.height)};let o=e=>{var t=or(e);return sz(u.getOpt(r),e,t.right,t.bottom,t.width,t.height)};var e=lz(()=>C(i.get(),e=>t(e)),c,t=>{d.get().each(e=>{a.dispatch("TableSelectorChange",{start:t,finish:e})})}),n=lz(()=>C(s.get(),e=>o(e)),d,t=>{c.get().each(e=>{a.dispatch("TableSelectorChange",{start:e,finish:t})})});let m=cz(e),u=cz(n),g=kd(m.asSpec()),p=kd(u.asSpec()),h=(e,t,o,n)=>{var t=t.dom.getBoundingClientRect(),r=(Ro(e.element,"display"),Kt(O.fromDom(a.getBody())).dom.innerHeight),o=o(t),n=n(t,r);(o||n)&&M(e.element,"display","none")},f=(e,t,o,n)=>{o=o(t);rz.snapTo(e,o);h(e,t,e=>e[n]<0,(e,t)=>e[n]>t)},v=e=>f(g,e,t,"top"),b=e=>f(p,e,o,"bottom");if(On().deviceType.isTouch()){let n=e=>C(e,O.fromDom);a.on("TableSelectionChange",e=>{l.get()||(Zg(r,g),Zg(r,p),l.set(!0));let t=O.fromDom(e.start),o=O.fromDom(e.finish);c.set(t),d.set(o),D.from(e.otherCells).each(e=>{i.set(n(e.upOrLeftCells)),s.set(n(e.downOrRightCells)),v(t),b(o)})}),a.on("ResizeEditor ResizeWindow ScrollContent",()=>{c.get().each(v),d.get().each(b)}),a.on("TableSelectionClear",()=>{l.get()&&(op(g),op(p),l.set(!1)),c.clear(),d.clear()})}};var mz,uz='<svg height="16" viewBox="0 0 80 16" width="80" xmlns="http://www.w3.org/2000/svg"><g opacity=".8"><path d="m80 3.537v-2.202h-7.976v11.585h7.976v-2.25h-5.474v-2.621h4.812v-2.069h-4.812v-2.443zm-10.647 6.929c-.493.217-1.13.337-1.864.337s-1.276-.156-1.805-.47a3.732 3.732 0 0 1 -1.3-1.298c-.324-.554-.48-1.191-.48-1.877s.156-1.335.48-1.877a3.635 3.635 0 0 1 1.3-1.299 3.466 3.466 0 0 1 1.805-.481c.65 0 .914.06 1.263.18.36.12.698.277.986.47.289.192.578.384.842.6l.12.085v-2.586l-.023-.024c-.385-.35-.855-.614-1.384-.818-.53-.205-1.155-.313-1.877-.313-.721 0-1.6.144-2.333.445a5.773 5.773 0 0 0 -1.937 1.251 5.929 5.929 0 0 0 -1.324 1.9c-.324.735-.48 1.565-.48 2.455s.156 1.72.48 2.454c.325.734.758 1.383 1.324 1.913.553.53 1.215.938 1.937 1.25a6.286 6.286 0 0 0 2.333.434c.819 0 1.384-.108 1.961-.313.59-.216 1.083-.505 1.468-.866l.024-.024v-2.49l-.12.096c-.41.337-.878.626-1.396.866zm-14.869-4.15-4.8-5.04-.024-.025h-.902v11.67h2.502v-6.847l2.827 3.08.385.409.397-.41 2.791-3.067v6.845h2.502v-11.679h-.902l-4.788 5.052z"/><path clip-rule="evenodd" d="m15.543 5.137c0-3.032-2.466-5.113-4.957-5.137-.36 0-.745.024-1.094.096-.157.024-3.85.758-3.85.758-3.032.602-4.62 2.466-4.704 4.788-.024.89-.024 4.27-.024 4.27.036 3.165 2.406 5.138 5.017 5.126.337 0 1.119-.109 1.287-.145.144-.024.385-.084.746-.144.661-.12 1.684-.325 3.067-.602 2.37-.409 4.103-2.009 4.44-4.33.156-1.023.084-4.692.084-4.692zm-3.213 3.308-2.346.457v2.31l-5.859 1.143v-5.75l2.346-.458v3.441l3.513-.686v-3.44l-3.513.685v-2.297l5.859-1.143v5.75zm20.09-3.296-.083-1.023h-2.13v8.794h2.346v-4.884c0-1.107.95-1.985 2.057-1.997 1.095 0 1.901.89 1.901 1.997v4.884h2.346v-5.245c-.012-2.105-1.588-3.777-3.67-3.765a3.764 3.764 0 0 0 -2.778 1.25l.012-.011zm-6.014-4.102 2.346-.458v2.298l-2.346.457z" fill-rule="evenodd"/><path d="m28.752 4.126h-2.346v8.794h2.346z"/><path clip-rule="evenodd" d="m43.777 15.483 4.043-11.357h-2.418l-1.54 4.355-.445 1.324-.36-1.324-1.54-4.355h-2.418l3.151 8.794-1.083 3.08zm-21.028-5.51c0 .722.541 1.034.878 1.034s.638-.048.95-.144l.518 1.708c-.217.145-.879.518-2.13.518a2.565 2.565 0 0 1 -2.562-2.587c-.024-1.082-.024-2.49 0-4.21h-1.54v-2.142h1.54v-1.912l2.346-.458v2.37h2.201v2.142h-2.2v3.693-.012z" fill-rule="evenodd"/></g></svg>\n';let gz=(e,t)=>{var o=D.from(wo(e,"id")).getOrThunk(()=>{var e=N("aria");return A(t,"id",e),e});A(e,"aria-describedby",o)},pz=e=>{ko(e,"aria-describedby")},hz=e=>"BR"===e.nodeName||!!e.getAttribute("data-mce-bogus")||"bookmark"===e.getAttribute("data-mce-type"),fz=(a,e,i)=>{let t,s=null!=(t=e.delimiter)?t:"›",o=e=>Oe(e,(e,t,o)=>{n=t.name,r=t.element,t=o;var n,r,t=sx.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{"data-index":t}},components:[xd(n)],action:e=>{a.focus(),a.selection.select(r),a.nodeChanged()},buttonBehaviours:R([yx.config({...i.tooltips.getConfig({tooltipText:i.translate(["Select the {0} element",r.nodeName.toLowerCase()]),onShow:(e,t)=>{gz(e.element,t.element)},onHide:e=>{pz(e.element)}})}),T0.button(i.isDisabled),V0(()=>i.checkUiComponentContext("any"))])});return 0===o?e.concat([t]):e.concat([{dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0}},components:[xd(` ${s} `)]},t])},[]);return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:R([L.config({mode:"flow",selector:"div[role=button]"}),V.config({disabled:i.isDisabled}),V0(()=>i.checkUiComponentContext("any")),ux.config({}),H.config({}),P("elementPathEvents",[ds((t,e)=>{a.shortcuts.add("alt+F11","focus statusbar elementpath",()=>L.focusIn(t)),a.on("NodeChange",e=>{e=(e=>{var t=[];let o=e.length;for(;0<o--;){var n=e[o];if(1===n.nodeType&&!hz(n)){var r=LS(a,n);if(r.isDefaultPrevented()||t.push({name:r.name,element:n}),r.isPropagationStopped())break}}return t})(e.parents),e=0<e.length?o(e):[];H.set(t,e)})})])]),components:[]}},vz=((Nf=mz=mz||{})[Nf.None=0]="None",Nf[Nf.Both=1]="Both",Nf[Nf.Vertical=2]="Vertical",(e,t,o,n,r)=>{n={height:eF(n+t.top,nb(e),ab(e))};return o===mz.Both&&(n.width=eF(r+t.left,ob(e),rb(e))),n}),bz=(e,t,o)=>{let n=O.fromDom(e.getContainer());t=vz(e,t,o,Vo(n),Xo(n));je(t,(e,t)=>{Z(e)&&M(n,t,ZI(e))}),FS(e)},xz=e=>{e=Mb(e);return!1===e?mz.None:"both"===e?mz.Both:mz.Vertical},yz=(e,t,o,n)=>{o=Po(20*o,20*n);return bz(e,o,t),D.some(!0)},wz=(n,e)=>{let r=xz(n);var t;return r===mz.None?D.none():(t=r===mz.Both?"Press the arrow keys to resize the editor.":"Press the Up and Down arrow keys to resize the editor.",D.some(wy("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{"aria-label":e.translate(t),"data-mce-name":"resize-handle"},behaviours:[rz.config({mode:"mouse",repositionTarget:!1,onDrag:(e,t,o)=>bz(n,o,r),blockerClass:"tox-blocker"}),L.config({mode:"special",onLeft:()=>yz(n,r,-1,0),onRight:()=>yz(n,r,1,0),onUp:()=>yz(n,r,0,-1),onDown:()=>yz(n,r,0,1)}),ux.config({}),U.config({}),yx.config(e.tooltips.getConfig({tooltipText:e.translate("Resize")}))]},e.icons)))},Sz=(e,n)=>{let r=(e,t,o)=>H.set(e,[xd(n.translate(["{0} "+o,t[o]]))]);return sx.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:R([T0.button(n.isDisabled),V0(()=>n.checkUiComponentContext("any")),ux.config({}),H.config({}),w.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),P("wordcount-events",[gs(e=>{var t=w.getValue(e),o="words"===t.mode?"characters":"words";w.setValue(e,{mode:o,count:t.count}),r(e,t.count,o)}),ds(o=>{e.on("wordCountUpdate",e=>{var t=w.getValue(o).mode;w.setValue(o,{mode:t,count:e.wordCount}),r(o,e.wordCount,t)})})])]),eventOrder:{[Di()]:["disabling","alloy.base.behaviour","wordcount-events"]}})},Cz=(s,l)=>{let t=()=>({dom:{tag:"span",classes:["tox-statusbar__branding"]},components:[{dom:{tag:"a",attributes:{href:"https://www.tiny.cloud/powered-by-tiny?utm_campaign=poweredby&utm_source=tiny&utm_medium=referral&utm_content=v7",rel:"noopener",target:"_blank","aria-label":s.translate(["Build with {0}","TinyMCE"])},innerHtml:s.translate(["Build with {0}",uz.trim()])},behaviours:R([U.config({})])}]}),c=()=>{var e=j0("Alt+0");return{dom:{tag:"div",classes:["tox-statusbar__help-text"]},components:[xd(dy.translate(["Press {0} for help",e]))]}},d=()=>{var e=[];return s.hasPlugin("wordcount")&&e.push(Sz(s,l)),Ab(s)&&e.push(t()),{dom:{tag:"div",classes:["tox-statusbar__right-container"]},components:e}},e=()=>{var e=[];let t=Rb(s),o=Db(s),n=Ab(s)||s.hasPlugin("wordcount");var r,a,i;return o&&e.push(fz(s,{},l)),t&&e.push(c()),n&&e.push(d()),0<e.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container",...(a="tox-statusbar__text-container--flex-start",i="tox-statusbar__text-container--flex-end",t?(r="tox-statusbar__text-container-3-cols",n||o?n&&!o?[r,i]:[r,a]:[r,"tox-statusbar__text-container--space-around"]):[n&&!o?i:a])]},components:e}]:[]};var o,n;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(o=e(),n=wz(s,l),o.concat(n.toArray()))}},kz=(e,t)=>t.get().getOrDie(`UI for ${e} has not been rendered`),Oz=(d,i)=>{let s=d.inline,m=s?cF:JI,u=Kb(d)?qA:LA,l=dF(),c=lr(),g=lr(),p=lr();let h=On().deviceType.isTouch()?["tox-platform-touch"]:[],f=Gb(d),v=mb(d),b=mx({dom:{tag:"div",classes:["tox-anchorbar"]}}),x=mx({dom:{tag:"div",classes:["tox-bottom-anchorbar"]}}),y=()=>l.mainUi.get().map(e=>e.outerContainer).bind(fB.getHeader);var e=l.lazyGetInOuterOrDie("anchor bar",b.getOpt),t=l.lazyGetInOuterOrDie("bottom anchor bar",x.getOpt);let w=l.lazyGetInOuterOrDie("toolbar",fB.getToolbar),S=l.lazyGetInOuterOrDie("throbber",fB.getThrobber),C=IA({popup:()=>I.fromOption(l.popupUi.get().map(e=>e.sink),"(popup) UI has not been rendered"),dialog:()=>I.fromOption(l.dialogUi.get().map(e=>e.sink),"UI has not been rendered")},d,e,t),k=()=>{var e={attributes:{[Au]:f?Bm.BottomToTop:Bm.TopToBottom}},t=fB.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:C.popup,onEscape:()=>{d.focus()}});let o=fB.parts.toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:C.popup.shared.getSink,providers:C.popup.shared.providers,onEscape:()=>{d.focus()},onToolbarToggled:e=>{HS(d,e)},type:v,lazyToolbar:w,lazyHeader:()=>y().getOrDie("Could not find header element"),...e}),n=fB.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:C.popup.shared.providers,onEscape:()=>{d.focus()},type:v}),r=jb(d),a=Ub(d);var i=Lb(d),s=Fb(d),l=O(),c=r||a||i,s=s?[l,t]:[t];return fB.parts.header({dom:{tag:"div",classes:["tox-editor-header"].concat(c?[]:["tox-editor-header--empty"]),...e},components:De([i?s:[],r?[n]:a?[o]:[],Yb(d)?[]:[b.asSpec()]]),sticky:Kb(d),editor:d,sharedBackstage:C.popup.shared})},O=()=>fB.parts.promotion({dom:{tag:"div",classes:["tox-promotion"]}}),_=()=>({dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[fB.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),fB.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}})]}),T=e=>{var t=ZI(oF(d)),o=ZI(rF(d));return d.inline||(Fo("div","width",o)&&M(e.element,"width",o),Fo("div","height",t)?M(e.element,"height",t):M(e.element,"height","400px")),t},E=o=>{d.addShortcut("alt+F9","focus menubar",()=>{fB.focusMenubar(o)}),d.addShortcut("alt+F10","focus toolbar",()=>{fB.focusToolbar(o)}),d.addCommand("ToggleToolbarDrawer",(e,t)=>{null!=t&&t.skipFocus?fB.toggleToolbarDrawerWithoutFocusing(o):fB.toggleToolbarDrawer(o)}),d.addQueryStateHandler("ToggleToolbarDrawer",()=>fB.isToolbarDrawerToggled(o))};return{popups:{backstage:C.popup,getMothership:()=>kz("popups",p)},dialogs:{backstage:C.dialog,getMothership:()=>kz("dialogs",g)},renderUI:()=>{o=k(),a=_(),t=fB.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:C.popup}),r=fB.parts.viewWrapper({backstage:C.popup}),e=Eb(d)&&!s?D.some(Cz(d,C.popup.shared.providers)):D.none(),a=De([f?[]:[o],s?[]:[a],f?[o]:[]]),o=fB.parts.editorContainer({components:De([a,s?[]:[x.asSpec()]])}),a=qb(d),n={role:"application",...dy.isRtl()?{dir:"rtl"}:{},...a?{"aria-hidden":"true"}:{}},a=kd(fB.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(s?["tox-tinymce-inline"]:[]).concat(f?["tox-tinymce--toolbar-bottom"]:[]).concat(h),styles:{visibility:"hidden",...a?{opacity:"0",border:"0"}:{}},attributes:n},components:[o,...s?[]:[r,...e.toArray()],t],behaviours:R([V0(()=>C.popup.shared.providers.checkUiComponentContext("any")),V.config({disableClass:"tox-tinymce--disabled"}),L.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),n=uO(a),c.set(n);var e,t,o={mothership:n,outerContainer:a},n=(r=Xb(d),r=Gt(vo(),r)&&"grid"===Ao(r,"display"),e={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(h),attributes:{...dy.isRtl()?{dir:"rtl"}:{}}},behaviours:R([Wg.config({useFixed:()=>u.isDocked(y)})])},t={dom:{styles:{width:document.body.clientWidth+"px"}},events:ts([F(Li(),e=>{M(e.element,"width",document.body.clientWidth+"px")})])},e=kd(vr(e,r?t:{})),r=uO(e),g.set(r),{sink:e,mothership:r}),r=Jb(d)?(a={dom:{tag:"div",classes:["tox","tox-silver-sink","tox-silver-popup-sink","tox-tinymce-aux"].concat(h),attributes:{...dy.isRtl()?{dir:"rtl"}:{}}},behaviours:R([Wg.config({useFixed:()=>u.isDocked(y),getBounds:()=>i.getPopupSinkBounds()})])},a=kd(a),t=uO(a),p.set(t),{sink:a,mothership:t}):(e=n,p.set(e.mothership),e),a=(l.dialogUi.set(n),l.popupUi.set(r),l.mainUi.set(o),{popupUi:r,dialogUi:n,mainUi:o,uiMotherships:l.getUiMotherships()});return(e=>{var{mainUi:t,popupUi:o,uiMotherships:n}=e,{buttons:r,menuItems:a,contextToolbars:i,sidebars:s,views:l}=(Ge(ub(d),(e,t)=>{d.ui.registry.addGroupToolbarButton(t,e)}),d.ui.registry.getAll()),c=Wb(d),a={menuItems:a,menus:Qb(d),menubar:bb(d),toolbar:c.getOrThunk(()=>xb(d)),allowToolbarGroups:v===Gv.floating,buttons:r,sidebar:s,views:l},c=(E(t.outerContainer),FA(d,t.mothership,n),u.setup(d,C.popup.shared,y),IR(d,C.popup),hN(d,C.popup.shared.getSink,C.popup),lM(d),CM(d,S,C.popup.shared),aR(d,i,o.sink,{backstage:C.popup}),dz(d,o.sink),d.getElement()),r={targetNode:c,height:T(t.outerContainer)};return m.render(d,e,a,C.popup,r)})(a)}}},_z=(Bf=T([i("lazySink"),ya("dragBlockClass"),Fa("getBounds",ar),u("useTabstopAt",me),u("firstTabstop",0),u("eventOrder",{}),Ng("modalBehaviours",[L]),nc("onExecute"),ac("onEscape")]),Xl={sketch:re},Bl=T([qp({name:"draghandle",overrides:(e,t)=>({behaviours:R([rz.config({mode:"mouse",getTarget:e=>Id(e,'[role="dialog"]').getOr(e),blockerClass:e.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:e.getDragBounds})])})}),Xp({schema:[i("dom")],name:"title"}),Xp({factory:Xl,schema:[i("dom")],name:"close"}),Xp({factory:Xl,schema:[i("dom")],name:"body"}),qp({factory:Xl,schema:[i("dom")],name:"footer"}),Iu({factory:{sketch:(e,t)=>({...e,dom:t.dom,components:t.components})},schema:[u("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),u("components",[])],name:"blocker"})]),Up({name:"ModalDialog",configFields:Bf(),partFields:Bl(),factory:(r,e,t,n)=>{let a=lr();var o=N("modal-events"),i={...r.eventOrder,[Hi()]:[o].concat(r.eventOrder["alloy.system.attached"]||[])};let s=On();return{uid:r.uid,dom:r.dom,components:e,apis:{show:e=>{a.set(e);var t=r.lazySink(e).getOrDie(),o=n.blocker(),o=t.getSystem().build({...o,components:o.components.concat([Od(e)]),behaviours:R([U.config({}),P("dialog-blocker-events",[cs(ui(),()=>{fM.isBlocked(e)?S():L.focusIn(e)})])])});Zg(t,o),L.focusIn(e)},hide:t=>{a.clear(),Jt(t.element).each(e=>{t.getSystem().getByDom(e).each(e=>{op(e)})})},getBody:e=>sh(e,r,"body"),getFooter:e=>ih(e,r,"footer"),setIdle:e=>{fM.unblock(e)},setBusy:(e,t)=>{fM.block(e,t)}},eventOrder:i,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:_p(r.modalBehaviours,[H.config({}),L.config({mode:"cyclic",onEnter:r.onExecute,onEscape:r.onEscape,useTabstopAt:r.useTabstopAt,firstTabstop:r.firstTabstop}),fM.config({getRoot:a.get}),P(o,[ds(e=>{var t,o=sh(e,r,"title").element,n=o.dom.textContent;s.os.isMacOS()&&J(n)?A(e.element,"aria-label",n):(n=e.element,t=o,e=So(n,"id").fold(()=>{var e=N("dialog-label");return A(t,"id",e),e},re),A(n,"aria-labelledby",e))})])])}},apis:{show:(e,t)=>{e.show(t)},hide:(e,t)=>{e.hide(t)},getBody:(e,t)=>e.getBody(t),getFooter:(e,t)=>e.getFooter(t),setBusy:(e,t,o)=>{e.setBusy(t,o)},setIdle:(e,t)=>{e.setIdle(t)}}})),Tz=(rc=m([_w,t].concat(Xw)),Dw=Kr,Mw=[Lw("button"),Wp,Ba("align","end",["start","end"]),Fw,Iw,ka("buttonType",["primary","secondary"]),Ma("context","mode:design")],wf=[...Mw,Gp],ec=[ha("type",["submit","cancel","custom"]),...wf],ki=[ha("type",["menu"]),jp,n,Wp,xa("items",rc),...Mw],e0=[...Mw,ha("type",["togglebutton"]),n,Wp,jp,Ia("active",!1)],Qw=la("type",{submit:ec,cancel:ec,custom:ec,menu:ki,togglebutton:e0}),Rf=[_w,Gp,ha("level",["info","warn","error","success"]),If,u("url","")],m(Rf)),Ez=(zw=[_w,Gp,Iw,Lw("button"),Wp,Bw,ka("buttonType",["primary","secondary","toolbar"]),Fw,Ma("context","mode:design")],m(zw)),Dz=(Vw=[_w,t],Jw=Vw.concat([Ew]),Zw=Vw.concat([Tw,Iw,Ma("context","mode:design")]),m(Zw)),Az=(hB=Kr,e=Jw.concat([Rw("auto"),Ma("context","mode:design")]),m(e)),Mz=(r=$r([Pp,Gp,If]),Aw=Jw.concat([Ma("storageKey","default"),Ma("context","mode:design")]),m(Aw)),Bz=(yf=qr,m(Jw)),Iz=(Gw=qr,Vw.concat([Ma("tag","textarea"),pa("scriptId"),pa("scriptUrl"),Oa("onFocus"),Da("settings",void 0,Zr)])),Fz=Vw.concat([Ma("tag","textarea"),fa("init")]),Rz=oa(e=>ra("customeditor.old",Wr(Fz),e).orThunk(()=>ra("customeditor.new",Wr(Iz),e))),Nz=(Nf=qr,nc=Jw.concat([Ma("context","mode:design")]),m(nc)),zz=(ac=jr(Rr),e=>[_w,ga("columns",Xr),e]),Vz=(Xl=[_w,pa("html"),Ba("presets","presentation",["presentation","document"]),Fa("onInit",S),Ia("stretched",!1)],m(Xl)),Lz=(Iu=Jw.concat([Ia("border",!1),Ia("sandboxed",!0),Ia("streamContent",!1),Ia("transparent",!0)]),m(Iu)),Hz=(Bf=qr,m(Vw.concat([Ca("height")]))),Pz=(Bl=m([pa("url"),Sa("zoom"),Sa("cachedWidth"),Sa("cachedHeight")]),Xw=Jw.concat([Ca("inputMode"),Ca("placeholder"),Ia("maximized",!1),Iw,Ma("context","mode:design")]),m(Xw)),Uz=(rc=qr,Mw=[Gp,Pp],n=[Gp,xa("items",ca(0,()=>Uz))],f([m(Mw),m(n)])),Wz=(jp=Jw.concat([xa("items",Uz),Iw,Ma("context","mode:design")]),m(jp)),jz=(ec=qr,ki=Jw.concat([ba("items",[Gp,Pp]),Aa("size",1),Iw,Ma("context","mode:design")]),m(ki)),Gz=(e0=qr,Rf=Jw.concat([Ia("constrain",!0),Iw,Ma("context","mode:design")]),m(Rf)),$z=(Wp=m([pa("width"),pa("height")]),Bw=Vw.concat([Tw,Aa("min",0),Aa("max",0)]),m(Bw)),Yz=(ka=Xr,Fw=[_w,xa("header",qr),xa("cells",jr(qr))],m(Fw)),Xz=(zw=Jw.concat([Ca("placeholder"),Ia("maximized",!1),Iw,Ma("context","mode:design")]),m(zw)),qz=(t=qr,Ew=[ha("type",["directory","leaf"]),Ff,pa("id"),wa("menu",JA),Ca("customStateIcon"),Ca("customStateIconTooltip")],m(Ew)),Kz=(Zw=Ew.concat([xa("children",ca(0,()=>ta("type",{directory:Kz,leaf:qz})))]),m(Zw)),Jz=(Rw=ta("type",{directory:Kz,leaf:qz}),e=[_w,xa("items",Rw),Oa("onLeafAction"),Oa("onToggleExpand"),Ra("defaultExpandedIds",[],qr),Ca("defaultSelectedId")],m(e)),Qz=(If=Jw.concat([Ba("filetype","file",["image","media","file"]),Iw,Ca("picker_text"),Ma("context","mode:design")]),m(If)),Zz=(Aw=m([Pp,Nw]),t=>da("items","items",xr(),jr(oa(e=>ra("Checking item of "+t,e2,e).fold(e=>I.error(sa(e)),e=>I.value(e)))))),e2=v(()=>{return ta("type",{alertbanner:Tz,bar:m((e=Zz("bar"),[_w,e])),button:Ez,checkbox:Dz,colorinput:Mz,colorpicker:Bz,dropzone:Nz,grid:m(zz(Zz("grid"))),iframe:Lz,input:Pz,listbox:Wz,selectbox:jz,sizeinput:Gz,slider:$z,textarea:Xz,urlinput:Qz,customeditor:Rz,htmlpanel:Vz,imagepreview:Hz,collection:Az,label:m((e=Zz("label"),[_w,Tw,e,Ba("align","start",["start","center","end"]),Ca("for")])),table:Yz,tree:Jz,panel:t2});var e}),t2=(fa=[_w,u("classes",[]),xa("items",e2)],m(fa)),o2=(nc=[Lw("tab"),Ff,xa("items",e2)],Xl=[_w,ba("tabs",nc)],Iu=m(Xl),Xw=wf,f=Qw,m([pa("title"),ga("body",ta("type",{panel:t2,tabpanel:Iu})),Ma("size","normal"),Ra("buttons",[],f),u("initialData",{}),Fa("onAction",S),Fa("onChange",S),Fa("onSubmit",S),Fa("onClose",S),Fa("onCancel",S),Fa("onTabChange",S)])),n2=(Mw=m([ha("type",["cancel","custom"]),...Xw]),m([pa("title"),pa("url"),Sa("height"),Sa("width"),_a("buttons",Mw),Fa("onAction",S),Fa("onCancel",S),Fa("onClose",S),Fa("onMessage",S)])),r2=e=>j(e)?[e].concat(Ae(Ze(e),r2)):$(e)?Ae(e,r2):[],a2=e=>y(e.type)&&y(e.name),i2={checkbox:hB,colorinput:yf,colorpicker:Gw,dropzone:ac,input:rc,iframe:Bf,imagepreview:Bl,selectbox:e0,sizeinput:Wp,slider:ka,listbox:ec,size:Wp,textarea:t,urlinput:Aw,customeditor:Nf,collection:r,togglemenuitem:Dw},s2=e=>D.from(i2[e.type]),l2=e=>Ce(r2(e),a2),c2=e=>{var t;return{internalDialog:aa((t=e,ra("dialog",o2,t))),dataValidator:(e=>{e=l2(e),e=Ae(e,t=>s2(t).fold(()=>[],e=>[ga(t.name,e)]));return m(e)})(e),initialData:null!=(t=e.initialData)?t:{}}},d2={open:(e,t)=>{t=c2(t);return e(t.internalDialog,t.initialData,t.dataValidator)},openUrl:(e,t)=>e(aa((e=t,ra("dialog",n2,e)))),redial:e=>c2(e)},m2=(n=Object.freeze({__proto__:null,events:(n,r)=>{let a=(t,o)=>{n.updateState.each(e=>{e=e(t,o);r.set(e)}),n.renderComponents.each(e=>{e=e(o,r.get());(n.reuseDom?ov:tv)(t,e)})};return ts([F(Ei(),(e,t)=>{var o;t.universal||(o=n.channel,ve(t.channels,o)&&a(e,t.data))}),ds((t,e)=>{n.initialData.each(e=>{a(t,e)})})])}}),jp=Object.freeze({__proto__:null,getState:(e,t,o)=>o}),Gp=[i("channel"),ya("renderComponents"),ya("updateState"),ya("initialData"),Ia("reuseDom",!0)],Es({fields:Gp,name:"reflecting",active:n,apis:jp,state:Object.freeze({__proto__:null,init:()=>{let e=B(D.none());return{readState:()=>e.get().getOr("none"),get:e.get,set:e.set,clear:()=>e.set(D.none())}}})})),u2=e=>{let o=[],n={};return je(e,(e,t)=>{e.fold(()=>{o.push(t)},e=>{n[t]=e})}),0<o.length?I.error(o):I.value(n)},g2=(e,o,n,r)=>{var t=mx(sT.sketch(t=>({dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:C(e.items,e=>ZE(t,e,o,n,r))})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[t.asSpec()]}],behaviours:R([L.config({mode:"acyclic",useTabstopAt:se(NT)}),hT.memento(t),vT(t,{postprocess:e=>u2(e).fold(e=>(console.error(e),{}),re)}),P("dialog-body-panel",[F(ui(),(e,t)=>{e.getSystem().broadcastOn([UT],{newFocus:D.some(t.event.target)})})])])}},p2=(ki=kh({name:"TabButton",configFields:[u("uid",void 0),i("value"),da("dom","dom",Cr(()=>({attributes:{role:"tab",id:N("aria"),"aria-selected":"false"}})),Yr()),ya("action"),u("domModification",{}),Ng("tabButtonBehaviours",[U,L,w]),i("view")],factory:(e,t)=>({uid:e.uid,dom:e.dom,components:e.components,events:wv(e.action),behaviours:_p(e.tabButtonBehaviours,[U.config({}),L.config({mode:"execution",useSpace:!0,useEnter:!0}),w.config({store:{mode:"memory",initialValue:e.value}})]),domModification:e.domModification})}),Rf=T([i("tabs"),i("dom"),u("clickToDismiss",!1),Ng("tabbarBehaviours",[Gh,L]),tc(["tabClass","selectedClass"])]),Vw=zg({factory:ki,name:"tabs",unit:"tab",overrides:n=>{let r=(e,t)=>{Gh.dehighlight(e,t),_(e,Yi(),{tabbar:e,button:t})},a=(e,t)=>{Gh.highlight(e,t),_(e,$i(),{tabbar:e,button:t})};return{action:e=>{var t=e.getSystem().getByUid(n.uid).getOrDie();let o=Gh.isHighlighted(t,e);(o&&n.clickToDismiss?r:o?S:a)(t,e)},domModification:{classes:[n.markers.tabClass]}}}}),Aa=T([Vw]),Up({name:"Tabbar",configFields:Rf(),partFields:Aa(),factory:(e,t,o,n)=>({uid:e.uid,dom:e.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:_p(e.tabbarBehaviours,[Gh.config({highlightClass:e.markers.selectedClass,itemClass:e.markers.tabClass,onHighlight:(e,t)=>{A(t.element,"aria-selected","true")},onDehighlight:(e,t)=>{A(t.element,"aria-selected","false")}}),L.config({mode:"flow",getInitial:e=>Gh.getHighlighted(e).map(e=>e.element),selector:"."+e.markers.tabClass,executeOnMove:!0})])})})),h2=(Bw=kh({name:"Tabview",configFields:[Ng("tabviewBehaviours",[H])],factory:(e,t)=>({uid:e.uid,dom:e.dom,behaviours:_p(e.tabviewBehaviours,[H.config({})]),domModification:{attributes:{role:"tabpanel"}}})}),Fw=T([u("selectFirst",!0),o("onChangeTab"),o("onDismissTab"),u("tabs",[]),Ng("tabSectionBehaviours",[])]),zw=Xp({factory:p2,schema:[i("dom"),va("markers",[i("tabClass"),i("selectedClass")])],name:"tabbar",defaults:e=>({tabs:e.tabs})}),Ew=Xp({factory:Bw,name:"tabview"}),ca=T([zw,Ew]),Up({name:"TabSection",configFields:Fw(),partFields:ca(),factory:(r,e,t,o)=>{let n=(e,t)=>{ih(e,r,"tabbar").each(e=>{t(e).each(Ki)})};return{uid:r.uid,dom:r.dom,components:e,behaviours:Op(r.tabSectionBehaviours),events:ts(De([r.selectFirst?[ds((e,t)=>{n(e,Gh.getFirst)})]:[],[F($i(),(e,t)=>{(o=>{let n=w.getValue(o);ih(o,r,"tabview").each(t=>{Te(r.tabs,e=>e.value===n).each(e=>{e=e.view();So(o.element,"id").each(e=>{A(t.element,"aria-labelledby",e)}),H.set(t,e),r.onChangeTab(t,o,e)})})})(t.event.button)}),F(Yi(),(e,t)=>{t=t.event.button;r.onDismissTab(e,t)})]])),apis:{getViewItems:e=>ih(e,r,"tabview").map(e=>H.contents(e)).getOr([]),showTab:(e,o)=>{n(e,t=>{var e=Gh.getCandidates(t);return Te(e,e=>w.getValue(e)===o).filter(e=>!Gh.isHighlighted(t,e))})}}}},apis:{getViewItems:(e,t)=>e.getViewItems(t),showTab:(e,t,o)=>{e.showTab(t,o)}}})),f2=(o,n,r)=>C(o,(e,t)=>{H.set(r,o[t].view());t=n.dom.getBoundingClientRect();return H.set(r,[]),t.height}),v2=e=>Ve(Ne(e,(e,t)=>t<e?-1:e<t?1:0)),b2=(e,t,o)=>{var n=qt(e).dom,r=Id(e,".tox-dialog-wrap").getOr(e),r="fixed"===Ao(r,"position");let a;a=r?Math.max(n.clientHeight,window.innerHeight):Math.max(n.offsetHeight,n.scrollHeight);r=Vo(t),n=t.dom.offsetLeft>=o.dom.offsetLeft+Xo(o)?Math.max(Vo(o),r):r,t=parseInt(Ao(e,"margin-top"),10)||0,o=parseInt(Ao(e,"margin-bottom"),10)||0,r=Vo(e)+t+o;return a-(r-n)},x2=(e,t)=>{Ve(e).each(e=>h2.showTab(t,e.value))},y2=(e,t)=>{M(e,"height",t+"px"),M(e,"flex-basis",t+"px")},w2=(e,n,r)=>{Id(e,'[role="dialog"]').each(o=>{Rd(o,'[role="tablist"]').each(t=>{r.get().map(e=>(M(n,"height","0"),M(n,"flex-basis","0"),Math.min(e,b2(o,n,t)))).each(e=>{y2(n,e)})})})},S2=e=>Rd(e,'[role="tabpanel"]'),C2=n=>{let a=lr();return{extraEvents:[ds(e=>{let o=e.element;S2(o).each(t=>{M(t,"visibility","hidden"),e.getSystem().getByDom(t).toOptional().each(e=>{e=f2(n,t,e);v2(e).fold(a.clear,a.set)}),w2(o,t,a),Ro(t,"visibility"),x2(n,e),requestAnimationFrame(()=>{w2(o,t,a)})})}),F(Li(),e=>{let t=e.element;S2(t).each(e=>{w2(t,e,a)})}),F(TO,(e,t)=>{let r=e.element;S2(r).each(t=>{var e=Dm(lo(t)),o=(M(t,"visibility","hidden"),Bo(t,"height").map(e=>parseInt(e,10)));Ro(t,"height"),Ro(t,"flex-basis");let n=t.dom.getBoundingClientRect().height;o.forall(e=>n>e)?(a.set(n),w2(r,t,a)):o.each(e=>{y2(t,e)}),Ro(t,"visibility"),e.each(_m)})})],selectFirst:!1}},k2="send-data-to-section",O2="send-data-to-view",_2=(e,o,n,r)=>{let a=B({}),i=e=>{var e=w.getValue(e),e=u2(e).getOr({}),t=a.get(),t=vr(t,e);a.set(t)},s=e=>{var t=a.get();w.setValue(e,t)},l=B(null);var e=C(e.tabs,e=>({value:e.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"]},components:[xd(n.shared.providers.translate(e.title))],view:()=>[sT.sketch(t=>({dom:{tag:"div",classes:["tox-form"]},components:C(e.items,e=>ZE(t,e,o,n,r)),formBehaviours:R([L.config({mode:"acyclic",useTabstopAt:se(NT)}),P("TabView.form.events",[ds(s),ms(i)]),Om.config({channels:Wa([{key:k2,value:{onReceive:i}},{key:O2,value:{onReceive:s}}])})])}))]})),t=C2(e);return h2.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:(e,t,o)=>{t=w.getValue(t);_(e,_O,{name:t,oldName:l.get()}),l.set(t)},tabs:e,components:[h2.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[p2.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:R([ux.config({})])}),h2.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:t.selectFirst,tabSectionBehaviours:R([P("tabpanel",t.extraEvents),L.config({mode:"acyclic"}),z.config({find:e=>Ve(h2.getViewItems(e))}),bT(D.none(),e=>(e.getSystem().broadcastOn([k2],{}),a.get()),(e,t)=>{a.set(t),e.getSystem().broadcastOn([O2],{})})])})},T2=(e,t,o,n,r,a)=>({dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:{...o.map(e=>({id:e})).getOr({}),...r?{"aria-live":"polite"}:{}}},components:[],behaviours:R([hT.childAt(0),m2.config({channel:LT+"-"+t,updateState:(e,t)=>D.some({isTabPanel:()=>"tabpanel"===t.body.type}),renderComponents:e=>{var t=e.body;return"tabpanel"!==t.type?[g2(t,e.initialData,n,a)]:[_2(t,e.initialData,n,a)]},initialData:e})])}),E2=(e,t,o,n,r,a)=>T2(e,t,D.some(o),n,r,a),D2=(e,t,o,n)=>{e=T2(e,t,D.none(),o,!1,n);return _z.parts.body(e)},A2=e=>{e={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[IT(D.none(),{dom:{tag:"iframe",attributes:{src:e.url}},behaviours:R([ux.config({}),U.config({})])})]}],behaviours:R([L.config({mode:"acyclic",useTabstopAt:se(NT)})])};return _z.parts.body(e)},M2=Kv.deviceType.isTouch(),B2=(e,t)=>({dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[e,t]}),I2=(e,t)=>_z.parts.close(sx.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:e,buttonBehaviours:R([ux.config({})])})),F2=()=>_z.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}}),R2=(e,t)=>_z.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:dx(`<p>${cy(t.translate(e))}</p>`)}]}]}),N2=e=>_z.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:e}),z2=(e,t)=>[mO.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:e}),mO.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})],V2=t=>{var e="tox-dialog",o=e+"-wrap",n=o+"__backdrop";let r=e+"__disable-scroll";return _z.sketch({lazySink:t.lazySink,onEscape:e=>(t.onEscape(e),D.some(!0)),useTabstopAt:e=>!NT(e),firstTabstop:t.firstTabstop,dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:{position:"relative",...t.extraStyles}},components:[t.header,t.body,...t.footer.toArray()],parts:{blocker:{dom:dx(`<div class="${o}"></div>`),components:[{dom:{tag:"div",classes:M2?[n,n+"--opaque"]:[n]}}]}},dragBlockClass:o,modalBehaviours:R([U.config({}),P("dialog-events",t.dialogEvents.concat([cs(ui(),(e,t)=>{fM.isBlocked(e)?S():L.focusIn(e)}),F(Wi(),(e,t)=>{e.getSystem().broadcastOn([UT],{newFocus:t.event.newFocus})})])),P("scroll-lock",[ds(()=>{Ls(vo(),r)}),ms(()=>{Ps(vo(),r)})]),...t.extraBehaviours]),eventOrder:{[Di()]:["dialog-events"],[Hi()]:["scroll-lock","dialog-events","alloy.base.behaviour"],[Pi()]:["alloy.base.behaviour","dialog-events","scroll-lock"],...t.eventOrder}})},L2=e=>sx.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close"),"data-mce-name":"close"}},buttonBehaviours:R([ux.config({}),yx.config(e.tooltips.getConfig({tooltipText:e.translate("Close")}))]),components:[wy("close",{tag:"span",classes:["tox-icon"]},e.icons)],action:e=>{b(e,wO)}}),H2=(e,t,o,n)=>({dom:{tag:"h1",classes:["tox-dialog__title"],attributes:{...o.map(e=>({id:e})).getOr({})}},components:[],behaviours:R([m2.config({channel:VT+"-"+t,initialData:e,renderComponents:e=>[xd(n.translate(e.title))]})])}),P2=()=>({dom:dx('<div class="tox-dialog__draghandle"></div>')}),U2=(e,t,o,n)=>mO.sketch({dom:dx('<div class="tox-dialog__header"></div>'),components:[H2(e,t,D.some(o),n),P2(),L2(n)],containerBehaviours:R([rz.config({mode:"mouse",blockerClass:"blocker",getTarget:e=>Nd(e,'[role="dialog"]').getOrDie(),snaps:{getSnapPoints:()=>[],leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}),W2=(e,t,o)=>{var t=_z.parts.title(H2(e,t,D.none(),o)),n=_z.parts.draghandle(P2()),o=_z.parts.close(L2(o)),t=[t].concat(e.draggable?[n]:[]).concat([o]);return mO.sketch({dom:dx('<div class="tox-dialog__header"></div>'),components:t})},j2=(e,t,o)=>W2({title:o.shared.providers.translate(e),draggable:o.dialog.isDraggableModal()},t,o.shared.providers),G2=(e,t,o,n)=>({dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":o.translate(e)},styles:{left:"0px",right:"0px",bottom:"0px",top:n.getOr(0)+"px",position:"absolute"}},behaviours:t,components:[{dom:dx('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}),$2=(e,r,t)=>({onClose:()=>t.closeWindow(),onBlock:o=>{let n=Rd(e().element,".tox-dialog__header").map(e=>Vo(e));_z.setBusy(e(),(e,t)=>G2(o.message,t,r,n))},onUnblock:()=>{_z.setIdle(e())}}),Y2="tox-dialog--fullscreen",X2="tox-dialog--width-lg",q2="tox-dialog--width-md",K2=e=>{switch(e){case"large":return D.some(X2);case"medium":return D.some(q2);default:return D.none()}},J2=(e,t)=>{let o=O.fromDom(t.element.dom);Ws(o,Y2)||(Gs(o,[X2,q2]),K2(e).each(e=>Ls(o,e)))},Q2=(e,t)=>{var e=O.fromDom(e.element.dom),o=qs(e),o=Te(o,e=>e===X2||e===q2).or(K2(t));$s(e,[Y2,...o.toArray()])},Z2=(e,t,o)=>kd(V2({...e,firstTabstop:1,lazySink:o.shared.getSink,extraBehaviours:[yT({}),...e.extraBehaviours],onEscape:e=>{b(e,wO)},dialogEvents:t,eventOrder:{[Ei()]:[m2.name(),Om.name()],[Hi()]:["scroll-lock",m2.name(),"messages","dialog-events","alloy.base.behaviour"],[Pi()]:["alloy.base.behaviour","dialog-events","messages",m2.name(),"scroll-lock"]}})),eV=(e,n={})=>C(e,e=>{return"menu"===e.type?(t=e,o=C(t.items,e=>{var t=k(n,e.name).getOr(B(!1));return{...e,storage:t}}),{...t,items:o}):e;var t,o}),tV=e=>Oe(e,(e,t)=>"menu"===t.type?(t=t,Oe(t.items,(e,t)=>(e[t.name]=t.storage,e),e)):e,{}),oV=(e,r)=>[ss(ui(),RT),e(yO,(e,t,o,n)=>{Em(n.element)&&Dm(lo(n.element)).each(Tm),r.onClose(),t.onClose()}),e(wO,(e,t,o,n)=>{t.onCancel(e),b(n,yO)}),F(OO,(e,t)=>r.onUnblock()),F(kO,(e,t)=>r.onBlock(t.event))],nV=(i,e)=>{var t=(e,a)=>F(e,(o,n)=>{var t,r;t=o,r=(e,t)=>{a(i(),e,n.event,o)},m2.getState(t).get().each(e=>{r(e,t)})});return[...oV(t,e),t(SO,(e,t,o)=>{t.onAction(e,{name:o.name})})]},rV=(i,e,l)=>{var t=(e,a)=>F(e,(o,n)=>{var t,r;t=o,r=(e,t)=>{a(i(),e,n.event,o)},m2.getState(t).get().each(e=>{r(e.internalDialog,t)})});return[...oV(t,e),t(CO,(e,t)=>t.onSubmit(e)),t(bO,(e,t,o)=>{t.onChange(e,{name:o.name})}),t(SO,(e,t,o,n)=>{let r=()=>n.getSystem().isConnected()?L.focusIn(n):void 0,a=e=>Co(e,"disabled")||So(e,"aria-disabled").exists(e=>"true"===e);var i=lo(n.element);let s=Dm(i);t.onAction(e,{name:o.name,value:o.value}),Dm(i).fold(r,t=>{a(t)||s.exists(e=>$t(t,e)&&a(e))?r():l().toOptional().filter(e=>!$t(e.element,t)).each(r)})}),t(_O,(e,t,o)=>{t.onTabChange(e,{newTabName:o.name,oldTabName:o.oldName})}),ms(e=>{var t=i();w.setValue(e,t.getData())})]},aV=(e,t)=>ME(e,e.type,t),iV=(t,e,o)=>Te(e,e=>e.name===o).bind(e=>e.memento.getOpt(t)),sV=(e,t)=>{var t=t.map(e=>e.footerButtons).getOr([]),t=Se(t,e=>"start"===e.align),o=(e,t)=>mO.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+e]},components:C(t,e=>e.memento.asSpec())});return[o("start",t.pass),o("end",t.fail)]},lV=(e,t,n)=>({dom:dx('<div class="tox-dialog__footer"></div>'),components:[],behaviours:R([m2.config({channel:HT+"-"+t,initialData:e,updateState:(t,e)=>{let o=C(e.buttons,e=>{var t=mx(aV(e,n));return{name:e.name,align:e.align,memento:t}});return D.some({lookupByName:e=>iV(t,o,e),footerButtons:o})},renderComponents:sV})])}),cV=(e,t,o)=>lV(e,t,o),dV=(e,t,o)=>_z.parts.footer(lV(e,t,o)),mV=(e,t)=>{var o;return e.getRoot().getSystem().isConnected()?(o=z.getCurrent(e.getFormWrapper()).getOr(e.getFormWrapper()),sT.getField(o,t).orThunk(()=>e.getFooter().bind(e=>m2.getState(e).get()).bind(e=>e.lookupByName(t)))):D.none()},uV=(e,t)=>{e=e.getRoot();return m2.getState(e).get().map(e=>aa(ra("data",e.dataValidator,t))).getOr(t)},gV=(a,i,s)=>{let e=e=>{var t=a.getRoot();t.getSystem().isConnected()&&e(t)};let l={getData:()=>{var e=a.getRoot(),e=e.getSystem().isConnected()?a.getFormWrapper():e,e=w.getValue(e),t=Ge(s,e=>e.get());return{...e,...t}},setData:r=>{e(e=>{var t=l.getData();let o=vr(t,r);var t=uV(a,o),n=a.getFormWrapper();w.setValue(n,t),je(s,(e,t)=>{et(o,t)&&e.set(o[t])})})},setEnabled:(e,t)=>{mV(a,e).each(t?V.enable:V.disable)},focus:e=>{mV(a,e).each(U.focus)},block:t=>{if(!y(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");e(e=>{_(e,kO,{message:t})})},unblock:()=>{e(e=>{b(e,OO)})},showTab:o=>{e(e=>{var t=a.getBody();m2.getState(t).get().exists(e=>e.isTabPanel())&&z.getCurrent(t).each(e=>{h2.showTab(e,o)})})},redial:r=>{e(e=>{var t=a.getId(),o=i(r),n=eV(o.internalDialog.buttons,s);e.getSystem().broadcastOn([zT+"-"+t],o),e.getSystem().broadcastOn([VT+"-"+t],o.internalDialog),e.getSystem().broadcastOn([LT+"-"+t],o.internalDialog),e.getSystem().broadcastOn([HT+"-"+t],{...o.internalDialog,buttons:n}),l.setData(o.initialData)})},close:()=>{e(e=>{b(e,yO)})},toggleFullscreen:a.toggleFullscreen};return l},pV=(e,t,o)=>{let n=N("dialog");var r=e.internalDialog,a=j2(r.title,n,o);let i=B(r.size);var s=K2(i.get()).toArray(),l=D2({body:r.body,initialData:r.initialData},n,o,e=>mV(u,e)),r=eV(r.buttons),c=tV(r),r=lt(0!==r.length,dV({buttons:r},n,o)),d=rV(()=>g,$2(()=>m,o.shared.providers,t),o.shared.getSink),a={id:n,header:a,body:l,footer:r,extraClasses:s,extraBehaviours:[m2.config({channel:zT+"-"+n,updateState:(e,t)=>(i.set(t.internalDialog.size),J2(t.internalDialog.size,e),D.some(t)),initialData:e})],extraStyles:{}};let m=Z2(a,d,o),u={getId:T(n),getRoot:T(m),getBody:()=>_z.getBody(m),getFooter:()=>_z.getFooter(m),getFormWrapper:()=>{var e=_z.getBody(m);return z.getCurrent(e).getOr(e)},toggleFullscreen:()=>{Q2(m,i.get())}},g=gV(u,t.redial,c);return{dialog:m,instanceApi:g}},hV=(e,t,r,o=!1,n)=>{var a=N("dialog"),i=N("dialog-label"),s=N("dialog-content"),l=e.internalDialog;let c=B(l.size);var d=K2(c.get()).toArray();let m=mx(U2({title:l.title,draggable:!0},a,i,r.shared.providers)),u=mx(E2({body:l.body,initialData:l.initialData},a,s,r,o,e=>mV(f,e)));s=eV(l.buttons),o=tV(s);let g=lt(0!==s.length,mx(cV({buttons:s},a,r)));var s=rV(()=>v,{onBlock:n=>{fM.block(h,(e,t)=>{var o=m.getOpt(h).map(e=>Vo(e.element));return G2(n.message,t,r.shared.providers,o)})},onUnblock:()=>{fM.unblock(h)},onClose:()=>t.closeWindow()},r.shared.getSink),p=On().os;let h=kd({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline",...d],attributes:{role:"dialog",...p.isMacOS()?{"aria-label":l.title}:{"aria-labelledby":i}}},eventOrder:{[Ei()]:[m2.name(),Om.name()],[Di()]:["execute-on-form"],[Hi()]:["reflecting","execute-on-form"]},behaviours:R([L.config({mode:"cyclic",onEscape:e=>(b(e,yO),D.some(!0)),useTabstopAt:e=>!NT(e)&&("button"!==Ft(e)||"disabled"!==wo(e,"disabled")),firstTabstop:1}),m2.config({channel:zT+"-"+a,updateState:(e,t)=>(c.set(t.internalDialog.size),J2(t.internalDialog.size,e),n(),D.some(t)),initialData:e}),U.config({}),P("execute-on-form",s.concat([cs(ui(),(e,t)=>{L.focusIn(e)}),F(Wi(),(e,t)=>{e.getSystem().broadcastOn([UT],{newFocus:t.event.newFocus})})])),fM.config({getRoot:()=>D.some(h)}),H.config({}),yT({})]),components:[m.asSpec(),u.asSpec(),...g.map(e=>e.asSpec()).toArray()]});let f={getId:T(a),getRoot:T(h),getFooter:()=>g.map(e=>e.get(h)),getBody:()=>u.get(h),getFormWrapper:()=>{var e=u.get(h);return z.getCurrent(e).getOr(e)},toggleFullscreen:()=>{Q2(h,c.get())}},v=gV(f,t.redial,o);return{dialog:h,instanceApi:v}};var fV=tinymce.util.Tools.resolve("tinymce.util.URI");let vV=t=>{let e=e=>{t.getSystem().isConnected()&&e(t)};return{block:t=>{if(!y(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");e(e=>{_(e,kO,{message:t})})},unblock:()=>{e(e=>{b(e,OO)})},close:()=>{e(e=>{b(e,yO)})},sendMessage:t=>{e(e=>{e.getSystem().broadcastOn([PT],t)})}}},bV=["insertContent","setContent","execCommand","close","block","unblock"],xV=e=>j(e)&&-1!==bV.indexOf(e.mceAction),yV=e=>!xV(e)&&j(e)&&et(e,"mceAction"),wV=(e,t,o)=>{switch(o.mceAction){case"insertContent":e.insertContent(o.content);break;case"setContent":e.setContent(o.content);break;case"execCommand":var n=!!X(o.ui)&&o.ui;e.execCommand(o.cmd,n,o.value);break;case"close":t.close();break;case"block":t.block(o.message);break;case"unblock":t.unblock()}},SV=(t,e,o,n)=>{let r=N("dialog");var a=j2(t.title,r,n),i=A2(t),s=t.buttons.bind(e=>0===e.length?D.none():D.some(dV({buttons:e},r,n))),e=nV(()=>h,$2(()=>p,n.shared.providers,e)),l={...t.height.fold(()=>({}),e=>({height:e+"px","max-height":e+"px"})),...t.width.fold(()=>({}),e=>({width:e+"px","max-width":e+"px"}))},c=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[];let d=new fV(t.url,{base_uri:new fV(window.location.href)}),m=d.protocol+"://"+d.host+(d.port?":"+d.port:""),u=sr();var g=[m2.config({channel:zT+"-"+r,updateState:(e,t)=>D.some(t),initialData:t}),P("messages",[ds(()=>{var e=Zm(O.fromDom(window),"message",e=>{d.isSameOrigin(new fV(e.raw.origin))&&(e=e.raw.data,xV(e)?wV(o,h,e):yV(e)&&t.onMessage(h,e))});u.set(e)}),ms(u.clear)]),Om.config({channels:{[PT]:{onReceive:(e,t)=>{Rd(e.element,"iframe").each(e=>{e=e.dom.contentWindow;J(e)&&e.postMessage(t,m)})}}}})],a={id:r,header:a,body:i,footer:s,extraClasses:c,extraBehaviours:g,extraStyles:l};let p=Z2(a,e,n),h=vV(p);return{dialog:p,instanceApi:h}},CV=s=>{let l=s.shared;return{open:(e,t)=>{var o=()=>{_z.hide(i),t()},n=mx(ME({context:"any",name:"close-alert",text:"OK",primary:!0,buttonType:D.some("primary"),align:"end",enabled:!0,icon:D.none()},"cancel",s)),r=F2(),a=I2(o,l.providers);let i=kd(V2({lazySink:()=>l.getSink(),header:B2(r,a),body:R2(e,l.providers),footer:D.some(N2(z2([],[n.asSpec()]))),onEscape:o,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[F(wO,o)],eventOrder:{}}));_z.show(i);r=n.get(i);U.focus(r)}}},kV=l=>{let c=l.shared;return{open:(e,t)=>{let o=e=>{_z.hide(s),t(e)};var n=mx(ME({context:"any",name:"yes",text:"Yes",primary:!0,buttonType:D.some("primary"),align:"end",enabled:!0,icon:D.none()},"submit",l)),r=ME({context:"any",name:"no",text:"No",primary:!1,buttonType:D.some("secondary"),align:"end",enabled:!0,icon:D.none()},"cancel",l),a=F2(),i=I2(()=>o(!1),c.providers);let s=kd(V2({lazySink:()=>c.getSink(),header:B2(a,i),body:R2(e,c.providers),footer:D.some(N2(z2([],[r,n.asSpec()]))),onEscape:()=>o(!1),extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[F(wO,()=>o(!1)),F(CO,()=>o(!0))],eventOrder:{}}));_z.show(s);a=n.get(s);U.focus(a)}}},OV=(e,t)=>aa(ra("data",t,e)),_V=e=>Uk(e,".tox-alert-dialog")||Uk(e,".tox-confirm-dialog"),TV=(t,e,o)=>e&&o?[]:[lc.config({contextual:{lazyContext:()=>D.some(tr(O.fromDom(t.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"],lazyViewport:e=>ax(t,e.element).map(e=>({bounds:ix(e),optScrollEnv:D.some({currentScrollTop:e.element.dom.scrollTop,scrollElmTop:jo(e.element).top})})).getOrThunk(()=>({bounds:ar(),optScrollEnv:D.none()}))})],EV=p=>{let h=p.editor,d=Kb(h),o=CV(p.backstages.dialog),n=kV(p.backstages.dialog);let r=(e,s,l,c)=>d2.open((e,t,o)=>{t=OV(t,o);let n=lr(),r=p.backstages.popup.shared.header.isPositionedAtTop();o={dataValidator:o,initialData:t,internalDialog:e};let a=()=>n.on(e=>{jv.reposition(e),d&&r||lc.refresh(e)}),i=hV(o,{redial:d2.redial,closeWindow:()=>{n.on(jv.hide),h.off("ResizeEditor",a),n.clear(),l(i.instanceApi)}},p.backstages.popup,c.ariaAttrs,a);e=kd(jv.sketch({lazySink:p.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:c.persistent?{event:"doNotDismissYet"}:{},...r?{}:{fireRepositionEventInstead:{}},inlineBehaviours:R([P("window-manager-inline-events",[F(Ui(),(e,t)=>{b(i.dialog,wO)})]),...TV(h,d,r)]),isExtraPart:(e,t)=>_V(t)}));n.set(e);return jv.showWithinBounds(e,Od(i.dialog),{anchor:s},()=>{var e=h.inline?vo():O.fromDom(h.getContainer()),e=tr(e);return D.some(e)}),d&&r||(lc.refresh(e),h.on("ResizeEditor",a)),i.instanceApi.setData(t),L.focusIn(i.dialog),i.instanceApi},e);return{open:(e,t,o)=>{if(!q(t)){if("toolbar"===t.inline)return r(e,p.backstages.popup.shared.anchors.inlineDialog(),o,t);if("bottom"===t.inline)return((e,m,u,g)=>{const t=(e,t,o)=>{const n=OV(t,o);const r=lr();const a=p.backstages.popup.shared.header.isPositionedAtTop();const i={dataValidator:o,initialData:n,internalDialog:e};const s=()=>r.on(e=>{jv.reposition(e);lc.refresh(e)});const l=hV(i,{redial:d2.redial,closeWindow:()=>{r.on(jv.hide);h.off("ResizeEditor ScrollWindow ElementScroll",s);r.clear();u(l.instanceApi)}},p.backstages.popup,g.ariaAttrs,s);const c=kd(jv.sketch({lazySink:p.backstages.popup.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:g.persistent?{event:"doNotDismissYet"}:{},...a?{}:{fireRepositionEventInstead:{}},inlineBehaviours:R([P("window-manager-inline-events",[F(Ui(),(e,t)=>{b(l.dialog,wO)})]),lc.config({contextual:{lazyContext:()=>D.some(tr(O.fromDom(h.getContentAreaContainer()))),fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top","bottom"],lazyViewport:e=>{const t=ax(h,e.element);return t.map(e=>{const t=ix(e);return{bounds:t,optScrollEnv:D.some({currentScrollTop:e.element.dom.scrollTop,scrollElmTop:jo(e.element).top})}}).getOrThunk(()=>({bounds:ar(),optScrollEnv:D.none()}))}})]),isExtraPart:(e,t)=>_V(t)}));r.set(c);const d=()=>{return p.backstages.popup.shared.getSink().toOptional().bind(e=>{const t=ax(h,e.element);const o=15;const n=t.map(e=>ix(e)).getOr(ar());const r=tr(O.fromDom(h.getContentAreaContainer()));const a=nr(r,n);return D.some(er(a.x,a.y,a.width,a.height-o))})};jv.showWithinBounds(c,Od(l.dialog),{anchor:m},d);lc.refresh(c);h.on("ResizeEditor ScrollWindow ElementScroll ResizeWindow",s);l.instanceApi.setData(n);L.focusIn(l.dialog);return l.instanceApi};return d2.open(t,e)})(e,p.backstages.popup.shared.anchors.inlineBottomDialog(),o,t);if("cursor"===t.inline)return r(e,p.backstages.popup.shared.anchors.cursor(),o,t)}return((e,i)=>{const t=(e,t,o)=>{const n=t;const r={dataValidator:o,initialData:n,internalDialog:e};const a=pV(r,{redial:d2.redial,closeWindow:()=>{_z.hide(a.dialog);i(a.instanceApi)}},p.backstages.dialog);_z.show(a.dialog);a.instanceApi.setData(n);return a.instanceApi};return d2.open(t,e)})(e,o)},openUrl:(e,t)=>((e,o)=>{const t=e=>{const t=SV(e,{closeWindow:()=>{_z.hide(t.dialog);o(t.instanceApi)}},h,p.backstages.dialog);_z.show(t.dialog);return t.instanceApi};return d2.openUrl(t,e)})(e,t),alert:(e,t)=>{o.open(e,t)},close:e=>{e.close()},confirm:(e,t)=>{n.open(e,t)}}};c.add("silver",t=>{a=t,Jv(a),yC(a),RR(a);let o=()=>ar(),{dialogs:e,popups:n,renderUI:r}=Oz(t,{getPopupSinkBounds:()=>o()});Pk.register(t,n.backstage.shared);var a=EV({editor:t,backstages:{popup:n.backstage,dialog:e.backstage}});let i=lr();return{renderUI:()=>{var e=r();return ax(t,n.getMothership().element).each(e=>{o=()=>ix(e)}),e},getWindowManagerImpl:T(a),getNotificationManagerImpl:()=>ky(t,{backstage:n.backstage},n.getMothership(),i)}})})();