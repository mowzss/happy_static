layui.define(["util","element","layer","jquery","pageTab","menu"],function(e){let a=layui.util,t=layui.layer,n=layui.jquery,i=layui.pageTab,l=layui.menu,s=layui.element,r={config:{tabFilter:"layout-filter-tab",tabsContent:"#happy-content > .layui-body-tabs",menuUrl:""},render:function(e){this.config=n.extend({},this.config,e),this.renderTabs(),l.render(this.config.menuUrl),this.events(),this.initTabs(),i.rightMenu({filter:this.config.tabFilter}),this.closeLoading()},initTabs:function(){var e=JSON.parse(sessionStorage.getItem("tabsList"))||[];let a=String(sessionStorage.getItem("tabsActiveId"));e.forEach(e=>{i.addTab(e)}),a&&e.some(e=>e.id===a)?s.tabChange(this.config.tabFilter,a):0<e.length&&s.tabChange(this.config.tabFilter,e[0].id),s.init()},renderTabs:function(){var e=`
        <div class="layui-body-tabs layui-tab-rollTool layui-tab" lay-allowclose="true" lay-unauto lay-filter="${r.config.tabFilter}">
            <ul class="layui-tab-title"></ul>
            <div class="layui-tab-content"></div>
            <div class="layui-tab-subsidiary">
                <span class="layui-tab-subsidiary-refresh" lay-header-event="refreshTab">
                    <em class="layui-icon layui-icon-refresh"></em>
                </span>
                <span class="layui-tab-subsidiary-screen-full" lay-header-event="tabFullScreen">
                    <em class="layui-icon layui-icon-screen-full"></em>
                </span>
                <span class="layui-tab-subsidiary-prev" lay-header-event="moveTabs" data-value="prev"><em class="layui-icon layui-icon-prev"></em></span>
                <span class="layui-tab-subsidiary-next" lay-header-event="moveTabs" data-value="next"><em class="layui-icon layui-icon-next"></em></span>
                 
            </div>
        </div>
    `;n("#happy-content").html(e),s.render("tab",r.config.tabFilter)},closeLoading:function(){n(".loading-mask").addClass("hidden")},events:function(){i.onTab(),a.event("lay-header-event",{cleanCache:function(e){let a=e.data("url");t.confirm("确认清理缓存？",function(){sessionStorage.clear(),a?n.ajax({url:a,type:"GET",success:function(e){t.msg(e.msg)}}):t.msg("本地缓存已清空")})},fullScreen:function(e){let a=e.find("em");if(document.fullscreenElement)try{i.exitFullscreen().then(()=>{a.removeClass("layui-icon-screen-restore").addClass("layui-icon-screen-full"),e.attr("title","全屏")}).catch(e=>{t.msg("无法退出全屏模式,请手动操作")})}catch(e){t.msg("无法退出全屏模式,请手动操作")}else try{i.requestFullscreen(document.documentElement).then(()=>{a.removeClass("layui-icon-screen-full").addClass("layui-icon-screen-restore"),e.attr("title","退出全屏")}).catch(e=>{t.msg("无法进入全屏模式,请手动操作")})}catch(e){t.msg("无法进入全屏模式,请手动操作")}},tabFullScreen:function(e){n(".right-menu").find('[data-event="toggleFullScreen"]').trigger("click")},menuSwitch:function(e){var a=n(".happy-admin-layout").find(".layui-layout-admin");a.hasClass("mini-nav")?(n(".layui-nav-item i").css("left",25),a.removeClass("mini-nav"),localStorage.setItem("mimiMenu","false")):(n(".layui-nav-item i").css("left",20),a.addClass("mini-nav"),localStorage.setItem("mimiMenu","true"))},refreshTab:function(){i.refreshTab()},moveTabs:function(e){e=e.data("value");i.moveTabs(e)}}),a.event("lay-on",{open:function(){}}),s.on("nav(lay-nav)",function(e){var a,t,e=n(e);1===e.parents(".mini-nav").length&&n('[lay-header-event="menuSwitch"]').trigger("click"),0===e.find(".layui-nav-more").length&&(a=(e=n(this)).find(".happy-nav-title").html(),t=e.attr("lay-id"),e=e.attr("lay-url"),i.addTab({id:t,title:a,url:e,change:!0}))}),this.onBody()},onBody:function(){n("body").on("click","[data-open]",function(e){var a=n(e.target).data("open"),t=a.split("?")[0],e=n(e.target).text();i.addTab({id:t,title:e,url:a,allowClose:!0,change:!0})})}};e("admin",r)});