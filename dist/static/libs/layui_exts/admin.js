layui.define(["util","element","layer","jquery","pageTab"],function(a){let e=layui.util,n=layui.jquery,l=layui.pageTab,i=layui.element,t={config:{tabFilter:"layout-filter-tab",tabsContent:"#happy-content > .layui-body-tabs",recordTabs:!0,tabsList:[]},render:function(){this.renderTabs(),this.events(),this.onMenu(),l.rightMenu({filter:this.config.tabFilter}),l.changeTab(),this.closeLoading()},renderTabs:function(){var a=`
        <div class="layui-body-tabs layui-tab-rollTool layui-tab" lay-unauto lay-filter="${t.config.tabFilter}" lay-allowclose="true">
            <ul class="layui-tab-title"></ul>
            <div class="layui-tab-content"></div>
            <div class="layui-tab-subsidiary">
                <span class="layui-tab-subsidiary-refresh">
                    <em class="layui-icon layui-icon-refresh" lay-header-event="refreshTab"></em>
                </span>
                <span class="layui-tab-subsidiary-prev" lay-header-event="moveTabs" data-value="prev"><em class="layui-icon layui-icon-prev"></em></span>
                <span class="layui-tab-subsidiary-next" lay-header-event="moveTabs" data-value="next"><em class="layui-icon layui-icon-next"></em></span>
            </div>
        </div>
    `;n(t.config.tabsContent).html(a),i.init()},closeLoading:function(){n(".loading-mask").addClass("hidden")},events:function(){e.event("lay-header-event",{menuSwitch:function(a){var e=n(".happy-admin-layout").find(".layui-layout-admin");e.hasClass("mini-nav")?(n(".layui-nav-item i").css("left",25),e.removeClass("mini-nav"),localStorage.setItem("mimiMenu","false")):(n(".layui-nav-item i").css("left",20),e.addClass("mini-nav"),localStorage.setItem("mimiMenu","true"))},refreshTab:function(){l.refreshTab()},moveTabs:function(a){a=a.data("value");l.moveTabs(a)}})},onMenu:function(){i.on("nav(lay-nav)",function(a){var e,i,a=n(a);1===a.parents(".mini-nav").length&&n('[lay-header-event="menuSwitch"]').trigger("click"),0===a.find(".layui-nav-more").length&&(e=(a=n(this)).find(".happy-nav-title").html(),i=a.attr("lay-id"),a=a.attr("lay-url"),l.addTab({id:i,title:e,url:a}))})},buildMenu:function(a){var e=Date.now(),a=a+(a.includes("?")?"&":"?")+"ts="+e;n.ajax({url:a,method:"GET",success:function(a){var e;a&&0<a.length?(e=function e(a){var i="";a.forEach(function(a){0===a.type?(i=(i+='<li class="layui-nav-item"><a>')+'<i class="'+a.icon+'"></i><span class="happy-nav-title">'+a.title+"</span></a>",a.children&&0<a.children.length&&(i=(i+='<dl class="layui-nav-child">')+e(a.children)+"</dl>"),i+="</li>"):1===a.type&&(i=(i=(i=(i+='<li class="layui-nav-item">')+'<a lay-url="'+a.href+'" lay-id="'+a.id+'">')+'<span class="happy-nav-title">'+a.title+"</span>")+"</a></li>")});return i}(a),n("#menu-container ul").html(e),layui.element.init(),(e=function e(a){for(var i of a){if(1===i.type)return i;if(i.children&&0<i.children.length){let a=e(i.children);if(a)return a}}return null}(a))&&l.addTab({id:e.id,title:e.title,url:e.href,active:!0,allowClose:!1})):console.error("菜单数据为空")},error:function(a,e,i){console.error("获取菜单数据失败:",i)}})}};a("admin",t)});