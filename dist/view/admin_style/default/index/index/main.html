<div class="happy-container">
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md12">
            <div class="layui-card">
                <div class="layui-card-header">
                    运行状态
                </div>
                <div class="layui-card-body">
                    <table>
                        <colgroup>
                            <col width="100"></col>
                            <col width="80"></col>
                            <col width="40"></col>
                            <col></col>
                        </colgroup>
                        <tr>
                            <td>当前运行状态:</td>
                            <td>
                                {notempty name="$is_debug"}
                                <button class="layui-btn layui-btn-xs layui-bg-red">调试模式</button>
                                {else/}
                                <button class="layui-btn layui-btn-xs">线上模式</button>
                                {/notempty}
                            </td>
                            <td>
                                <button class="layui-btn layui-btn-xs layui-btn-primary" id="run_mode"
                                        data-status="{$is_debug?0:1}">切换
                                </button>
                            </td>
                            <td></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        <div class="layui-col-md8">
            <div class="layui-row layui-col-space10">
                <div class="layui-col-md6">
                    <div class="layui-card">
                        <div class="layui-card-header">
                            快捷菜单
                        </div>
                        <div class="layui-card-body">
                            <div class="layui-row layui-col-space10">
                                <div class="layui-col-md3 layui-col-sm3 layui-col-xs3">
                                    <div class="shortcut-menu" data-id="home1" data-title="主页"
                                         data-url="http://www.bing.com">
                                        <i class="layui-icon layui-icon-home"></i>
                                    </div>
                                    <span class="shortcut-menu-label">主页</span>
                                </div>
                                <div class="layui-col-md3 layui-col-sm3 layui-col-xs3">
                                    <div class="shortcut-menu" data-id="home2" data-title="弹层"
                                         data-url="http://www.bing.com">
                                        <i class="layui-icon layui-icon-camera"></i>
                                    </div>
                                    <span class="shortcut-menu-label">弹层</span>
                                </div>
                                <div class="layui-col-md3 layui-col-sm3 layui-col-xs3">
                                    <div class="shortcut-menu" data-id="home2" data-title="聊天"
                                         data-url="http://www.bing.com">
                                        <i class="layui-icon layui-icon-star"></i>
                                    </div>
                                    <span class="shortcut-menu-label">聊天</span>
                                </div>
                                <div class="layui-col-md3 layui-col-sm3 layui-col-xs3">
                                    <div class="shortcut-menu" data-id="home3" data-title="相机"
                                         data-url="http://www.bing.com">
                                        <i class="layui-icon layui-icon-camera"></i>
                                    </div>
                                    <span class="shortcut-menu-label">相机</span>
                                </div>
                                <div class="layui-col-md3 layui-col-sm3 layui-col-xs3">
                                    <div class="shortcut-menu" data-id="home4" data-title="表单"
                                         data-url="http://www.bing.com">
                                        <i class="layui-icon layui-icon-console"></i>
                                    </div>
                                    <span class="shortcut-menu-label">表单</span>
                                </div>
                                <div class="layui-col-md3 layui-col-sm3 layui-col-xs3">
                                    <div class="shortcut-menu" data-id="home5" data-title="安全"
                                         data-url="http://www.bing.com">
                                        <i class="layui-icon layui-icon-auz"></i>
                                    </div>
                                    <span class="shortcut-menu-label">安全</span>
                                </div>
                                <div class="layui-col-md3 layui-col-sm3 layui-col-xs3">
                                    <div class="shortcut-menu" data-id="home6" data-title="公告"
                                         data-url="http://www.bing.com">
                                        <i class="layui-icon layui-icon-cart"></i>
                                    </div>
                                    <span class="shortcut-menu-label">公告</span>
                                </div>
                                <div class="layui-col-md3 layui-col-sm3 layui-col-xs3">
                                    <div class="shortcut-menu" data-id="home7" data-title="更多"
                                         data-url="http://www.bing.com">
                                        <i class="layui-icon layui-icon-app"></i>
                                    </div>
                                    <span class="shortcut-menu-label">更多</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-col-md6">
                    <div class="layui-card">
                        <div class="layui-card-header">
                            代办任务
                        </div>
                        <div class="layui-card-body">
                            <div class="layui-row layui-col-space10">
                                <div class="layui-col-md6 layui-col-sm6 layui-col-xs6">
                                    <div class="deputy">
                                        <div class="deputy-label">待审评论</div>
                                        <div class="deputy-count">21</div>
                                    </div>
                                </div>
                                <div class="layui-col-md6 layui-col-sm6 layui-col-xs6">
                                    <div class="deputy">
                                        <div class="deputy-label">待审帖子</div>
                                        <div class="deputy-count">32</div>
                                    </div>
                                </div>
                                <div class="layui-col-md6 layui-col-sm6 layui-col-xs6">
                                    <div class="deputy">
                                        <div class="deputy-label">待审文章</div>
                                        <div class="deputy-count">14</div>
                                    </div>
                                </div>
                                <div class="layui-col-md6 layui-col-sm6 layui-col-xs6">
                                    <div class="deputy">
                                        <div class="deputy-label">待审用户</div>
                                        <div class="deputy-count">63</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="layui-col-md12">
                    {notempty name="$happy_modules"}
                    <div class="layui-card">
                        <div class="layui-card-header">已安装模块包</div>
                        <div class="layui-card-body">
                            <table class="layui-table">
                                <colgroup>
                                    <col width="200"></col>
                                    <col></col>
                                    <col></col>
                                </colgroup>
                                <thead>
                                <tr>
                                    <th>名称</th>
                                    <th>描述</th>
                                    <th>版本</th>
                                </tr>
                                </thead>
                                <tbody>
                                {volist name="happy_modules" id="vo"}
                                <tr>
                                    <td>{$vo.name}</td>
                                    <td>{$vo.description}</td>
                                    <td>{$vo.version}</td>
                                </tr>
                                {/volist}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    {/notempty}
                    {notempty name="$system_modules"}
                    <div class="layui-card">
                        <div class="layui-card-header">开源项目包</div>
                        <div class="layui-card-body">
                            <table class="layui-table">
                                <colgroup>
                                    <col width="200"></col>
                                    <col></col>
                                    <col></col>
                                    <col></col>
                                    <col></col>
                                </colgroup>
                                <thead>
                                <tr>
                                    <th>名称</th>
                                    <th>类型</th>
                                    <th>描述</th>
                                    <th>开源协议</th>
                                    <th>版本</th>
                                    <th>项目主页</th>
                                </tr>
                                </thead>
                                <tbody>
                                {volist name="system_modules" id="vo"}
                                <tr>
                                    <td>{$vo.name}</td>
                                    <td>{$vo.type}</td>
                                    <td>{$vo.description}</td>
                                    <td>
                                        {if is_array($vo.license)}
                                        {volist name="$vo.license" id="vs"}
                                        <span>
                                        {$vs}
                                        </span>
                                        {/volist}
                                        {else}
                                        {$vo.license}
                                        {/if}
                                    </td>
                                    <td>{$vo.version}</td>
                                    <td>{$vo.homepage}</td>
                                </tr>
                                {/volist}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    {/notempty}
                </div>
            </div>
        </div>
        <div class="layui-col-md4">
            <div class="layui-card">
                <div class="layui-card-header">系统信息</div>
                <div class="layui-card-body">
                    <table class="layui-table">
                        <colgroup>
                            <col width="100">
                            <col>
                        </colgroup>
                        <tbody class="layui-table-body">
                        <tr>
                            <td>服务器:</td>
                            <td>{$system.info}</td>
                        </tr>
                        <tr>
                            <td>服务器IP:</td>
                            <td>{$system.ip}</td>
                        </tr>
                        <tr>
                            <td>运行环境</td>
                            <td>{$system.php_os}</td>
                        </tr>
                        <tr>
                            <td>运行模式</td>
                            <td>{$system.php_sapi}</td>
                        </tr>
                        <tr>
                            <td>php版本</td>
                            <td>{$system.php_version}</td>
                        </tr>
                        <tr>
                            <td>mysql版本:</td>
                            <td>{$system.mysql_version}</td>
                        </tr>
                        <tr>
                            <td>运行内存:</td>
                            <td>{$system.php_run_memory}</td>
                        </tr>
                        <tr>
                            <td>磁盘空间:</td>
                            <td>{$system.disk_total_space}</td>
                        </tr>
                        <tr>
                            <td>剩余空间:</td>
                            <td>{$system.disk_free_space}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="layui-card">
                <div class="layui-card-header">php扩展信息</div>
                <div class="layui-card-body">
                    <table class="layui-table">
                        <colgroup>
                            <col width="100">
                            <col>
                        </colgroup>
                        <tbody class="layui-table-body">
                        {foreach $php_ext as $key=>$vo }
                        <tr>
                            <td>{$key}:</td>
                            <td>{$vo}</td>
                        </tr>
                        {/foreach}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    layui.use(['layer',], function () {
        var $ = layui.jquery,
            layer = layui.layer;
        $('#run_mode').click(function () {
            let status = $(this).attr('data-status');
            $.ajax({
                url: "{:urls('runMode')}",
                type: 'post',
                data: {status: status},
                dataType: 'json',
                success: function (res) {
                    if (res.code === 0) {
                        layer.msg(res.msg, {icon: 1, time: 1000}, function () {
                            reload()
                        })
                    } else {
                        layer.msg(res.msg, {icon: 2, time: 1000}, function () {
                            reload()
                        })
                    }

                    function reload() {
                        $("[lay-header-event='refreshTab']").trigger('click')
                    }
                }

            })
        })
    });
</script>
